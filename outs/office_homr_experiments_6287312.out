Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: photo
Train domains: ['cartoon', 'art_painting', 'sketch']
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 2.0814, Accuracy: 5.71%
Epoch 2/5, Loss: 0.3284, Accuracy: 82.86%
Epoch 3/5, Loss: 0.1001, Accuracy: 100.00%
Epoch 4/5, Loss: 0.0141, Accuracy: 100.00%
Epoch 5/5, Loss: 0.0024, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0008, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: cartoon
Epoch 1/5, Loss: 1.9970, Accuracy: 42.86%
Epoch 2/5, Loss: 1.3391, Accuracy: 51.43%
Epoch 3/5, Loss: 0.8855, Accuracy: 60.00%
Epoch 4/5, Loss: 0.8757, Accuracy: 68.57%
Epoch 5/5, Loss: 0.6718, Accuracy: 77.14%
Training on domain: art_painting
Epoch 1/5, Loss: 0.9456, Accuracy: 57.14%
Epoch 2/5, Loss: 0.6113, Accuracy: 62.86%
Epoch 3/5, Loss: 0.5586, Accuracy: 68.57%
Epoch 4/5, Loss: 0.4617, Accuracy: 74.29%
Epoch 5/5, Loss: 0.3988, Accuracy: 77.14%
Training on domain: sketch
Epoch 1/5, Loss: 2.0330, Accuracy: 17.14%
Epoch 2/5, Loss: 1.8687, Accuracy: 22.86%
Epoch 3/5, Loss: 1.7808, Accuracy: 34.29%
Epoch 4/5, Loss: 1.5580, Accuracy: 31.43%
Epoch 5/5, Loss: 1.7161, Accuracy: 37.14%
Baseline 2 - Test Loss: 0.0009, Test Accuracy: 100.00%
Baseline 3: Sequential LoRA training with weight merging
Training on domain: cartoon
Epoch 1/5, Loss: 0.7111, Accuracy: 80.00%
Epoch 2/5, Loss: 0.8514, Accuracy: 85.71%
Epoch 3/5, Loss: 0.3949, Accuracy: 85.71%
Epoch 4/5, Loss: 0.3350, Accuracy: 85.71%
Epoch 5/5, Loss: 0.2942, Accuracy: 88.57%
Training on domain: art_painting
Epoch 1/5, Loss: 0.3215, Accuracy: 85.71%
Epoch 2/5, Loss: 0.3721, Accuracy: 88.57%
Epoch 3/5, Loss: 0.2940, Accuracy: 97.14%
Epoch 4/5, Loss: 0.2717, Accuracy: 97.14%
Epoch 5/5, Loss: 0.2267, Accuracy: 100.00%
Training on domain: sketch
Epoch 1/5, Loss: 1.4991, Accuracy: 37.14%
Epoch 2/5, Loss: 1.0466, Accuracy: 54.29%
Epoch 3/5, Loss: 1.0650, Accuracy: 65.71%
Epoch 4/5, Loss: 1.0543, Accuracy: 71.43%
Epoch 5/5, Loss: 0.9057, Accuracy: 77.14%
Baseline 3 - Test Loss: 0.0007, Test Accuracy: 100.00%
Baseline 4: Weighted average of LoRA adapters
Training coefficients for weighted average of LoRA adapters
