Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: sketch
Train domains: ['photo', 'art_painting', 'cartoon']
Baseline 1: Training and testing on test domain only
Epoch 1/10, Loss: 1.4401, Accuracy: 39.83%
Epoch 2/10, Loss: 0.7469, Accuracy: 70.96%
Epoch 3/10, Loss: 0.3701, Accuracy: 86.36%
Epoch 4/10, Loss: 0.1934, Accuracy: 92.92%
Epoch 5/10, Loss: 0.1568, Accuracy: 94.58%
Epoch 6/10, Loss: 0.0807, Accuracy: 96.97%
Epoch 7/10, Loss: 0.0655, Accuracy: 97.86%
Epoch 8/10, Loss: 0.0517, Accuracy: 98.24%
Epoch 9/10, Loss: 0.0717, Accuracy: 97.53%
Epoch 10/10, Loss: 0.0449, Accuracy: 98.60%
Baseline 1 - Test Loss: 0.0242, Test Accuracy: 99.16%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: photo
Epoch 1/10, Loss: 1.0924, Accuracy: 61.02%
Epoch 2/10, Loss: 0.0516, Accuracy: 98.98%
Epoch 3/10, Loss: 0.0103, Accuracy: 99.88%
Epoch 4/10, Loss: 0.0024, Accuracy: 100.00%
Epoch 5/10, Loss: 0.0013, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0009, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0006, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0005, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0004, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0003, Accuracy: 100.00%
Training on domain: art_painting
Epoch 1/10, Loss: 0.4432, Accuracy: 87.65%
Epoch 2/10, Loss: 0.0676, Accuracy: 98.29%
Epoch 3/10, Loss: 0.0146, Accuracy: 99.90%
Epoch 4/10, Loss: 0.0043, Accuracy: 100.00%
Epoch 5/10, Loss: 0.0022, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0015, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0011, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0008, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0006, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0005, Accuracy: 100.00%
Training on domain: cartoon
Epoch 1/10, Loss: 0.3721, Accuracy: 87.67%
Epoch 2/10, Loss: 0.0989, Accuracy: 96.72%
Epoch 3/10, Loss: 0.0349, Accuracy: 98.93%
Epoch 4/10, Loss: 0.0060, Accuracy: 99.96%
Epoch 5/10, Loss: 0.0022, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0013, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0009, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0007, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0005, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0004, Accuracy: 100.00%
Evaluating final model on test domain
Baseline 2 - Test Loss: 2.2613, Test Accuracy: 44.46%
Final model for PACS saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/PACS_final_model.pth
Running baseline experiments for dataset: VLCS
Using device: cuda
Total number of domains: 4
Test domain: Caltech101
Train domains: ['VOC2007', 'SUN09', 'LabelMe']
Baseline 1: Training and testing on test domain only
Epoch 1/10, Loss: 0.1162, Accuracy: 96.11%
Epoch 2/10, Loss: 0.0099, Accuracy: 99.79%
Epoch 3/10, Loss: 0.0204, Accuracy: 99.22%
Epoch 4/10, Loss: 0.0415, Accuracy: 99.08%
Epoch 5/10, Loss: 0.0196, Accuracy: 99.36%
Epoch 6/10, Loss: 0.0009, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0321, Accuracy: 99.01%
Epoch 8/10, Loss: 0.0171, Accuracy: 99.43%
Epoch 9/10, Loss: 0.0005, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0000, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0000, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: VOC2007
Epoch 1/10, Loss: 0.9736, Accuracy: 64.16%
Epoch 2/10, Loss: 0.2917, Accuracy: 89.75%
Epoch 3/10, Loss: 0.1406, Accuracy: 95.41%
Epoch 4/10, Loss: 0.0571, Accuracy: 98.64%
Epoch 5/10, Loss: 0.0209, Accuracy: 99.53%
Epoch 6/10, Loss: 0.0066, Accuracy: 99.91%
Epoch 7/10, Loss: 0.0026, Accuracy: 99.97%
Epoch 8/10, Loss: 0.0016, Accuracy: 99.97%
Epoch 9/10, Loss: 0.0009, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0006, Accuracy: 100.00%
Training on domain: SUN09
Epoch 1/10, Loss: 0.5923, Accuracy: 83.42%
Epoch 2/10, Loss: 0.3039, Accuracy: 89.18%
Epoch 3/10, Loss: 0.1717, Accuracy: 94.52%
Epoch 4/10, Loss: 0.0802, Accuracy: 97.93%
Epoch 5/10, Loss: 0.0280, Accuracy: 99.63%
Epoch 6/10, Loss: 0.0094, Accuracy: 99.85%
Epoch 7/10, Loss: 0.0039, Accuracy: 99.97%
Epoch 8/10, Loss: 0.0020, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0013, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0009, Accuracy: 100.00%
Training on domain: LabelMe
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 1/10, Loss: 1.0465, Accuracy: 74.06%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Epoch 2/10, Loss: 0.5181, Accuracy: 79.93%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Epoch 3/10, Loss: 0.4156, Accuracy: 84.71%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 4/10, Loss: 0.3182, Accuracy: 88.70%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Epoch 5/10, Loss: 0.2143, Accuracy: 92.58%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Epoch 6/10, Loss: 0.1054, Accuracy: 97.40%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Epoch 7/10, Loss: 0.0423, Accuracy: 99.10%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Epoch 8/10, Loss: 0.0131, Accuracy: 99.77%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Epoch 9/10, Loss: 0.0071, Accuracy: 99.85%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Epoch 10/10, Loss: 0.0042, Accuracy: 99.85%
Evaluating final model on test domain
Baseline 2 - Test Loss: 0.2208, Test Accuracy: 93.99%
Final model for VLCS saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/VLCS_final_model.pth

Summary of Results:
Dataset: PACS
  Baseline 1 Accuracy: 99.16%
  Baseline 2 Accuracy: 44.46%
---
Dataset: VLCS
  Baseline 1 Accuracy: 99.85%
  Baseline 2 Accuracy: 93.99%
---
