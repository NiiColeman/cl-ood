Using device: cuda

Dataset: Office-Home
Number of classes: 65
Number of domains: 4
Total number of samples: 5171
Number of training samples: 4136
Number of validation samples: 1035

Trying: lr=1e-4, batch_size=32, num_epochs=5
Epoch 1/5, Train Loss: 2.1419, Train Acc: 48.48%, Val Loss: 1.0360, Val Acc: 72.17%
Epoch 2/5, Train Loss: 0.5184, Train Acc: 85.95%, Val Loss: 1.0977, Val Acc: 72.27%
Epoch 3/5, Train Loss: 0.2312, Train Acc: 93.52%, Val Loss: 1.0579, Val Acc: 73.72%
Epoch 4/5, Train Loss: 0.1340, Train Acc: 95.65%, Val Loss: 1.3259, Val Acc: 70.92%
Epoch 5/5, Train Loss: 0.1380, Train Acc: 95.94%, Val Loss: 1.3495, Val Acc: 72.46%

Trying: lr=1e-5, batch_size=32, num_epochs=5
Epoch 1/5, Train Loss: 3.0269, Train Acc: 31.58%, Val Loss: 1.3175, Val Acc: 70.92%
Epoch 2/5, Train Loss: 0.5989, Train Acc: 86.32%, Val Loss: 0.8425, Val Acc: 80.77%
Epoch 3/5, Train Loss: 0.1436, Train Acc: 97.51%, Val Loss: 0.7661, Val Acc: 81.74%
Epoch 4/5, Train Loss: 0.0523, Train Acc: 99.30%, Val Loss: 0.7248, Val Acc: 81.74%
Epoch 5/5, Train Loss: 0.0287, Train Acc: 99.56%, Val Loss: 0.7187, Val Acc: 82.03%

Best hyperparameters for Office-Home without LoRA:
Best params: {'lr': '1e-5', 'batch_size': 32, 'num_epochs': 5}
Best validation accuracy: 82.03%
Best model without LoRA saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/best_model_Office-Home_without_lora.pth

LoRA Hyperparameter Search for Dataset: Office-Home
Number of classes: 65
Number of domains: 4
Total number of samples: 5171
Number of training samples: 4136
Number of validation samples: 1035

Trying LoRA params: r=8, alpha=8, dropout=0.1
Epoch 1/5, Train Loss: 4.5172, Train Acc: 1.40%, Val Loss: 4.4524, Val Acc: 1.35%
Epoch 2/5, Train Loss: 4.4600, Train Acc: 1.50%, Val Loss: 4.4027, Val Acc: 1.55%
Epoch 3/5, Train Loss: 4.4055, Train Acc: 1.52%, Val Loss: 4.3558, Val Acc: 1.64%
Epoch 4/5, Train Loss: 4.3520, Train Acc: 1.38%, Val Loss: 4.3086, Val Acc: 1.55%
Epoch 5/5, Train Loss: 4.3024, Train Acc: 1.47%, Val Loss: 4.2708, Val Acc: 1.64%

Trying LoRA params: r=8, alpha=16, dropout=0.1
Epoch 1/5, Train Loss: 4.5573, Train Acc: 1.11%, Val Loss: 4.5484, Val Acc: 1.16%
Epoch 2/5, Train Loss: 4.4774, Train Acc: 1.28%, Val Loss: 4.4808, Val Acc: 1.35%
Epoch 3/5, Train Loss: 4.4069, Train Acc: 1.38%, Val Loss: 4.4221, Val Acc: 1.35%
Epoch 4/5, Train Loss: 4.3481, Train Acc: 1.40%, Val Loss: 4.3718, Val Acc: 1.35%
Epoch 5/5, Train Loss: 4.2997, Train Acc: 1.33%, Val Loss: 4.3264, Val Acc: 1.45%

Trying LoRA params: r=8, alpha=32, dropout=0.1
Epoch 1/5, Train Loss: 4.5290, Train Acc: 1.23%, Val Loss: 4.4574, Val Acc: 0.68%
Epoch 2/5, Train Loss: 4.4277, Train Acc: 1.28%, Val Loss: 4.3701, Val Acc: 0.97%
Epoch 3/5, Train Loss: 4.3396, Train Acc: 1.45%, Val Loss: 4.2971, Val Acc: 1.55%
