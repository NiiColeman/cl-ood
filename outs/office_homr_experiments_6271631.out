Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: sketch
Train domains: ['art_painting', 'cartoon', 'photo']
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 3.0408, Accuracy: 0.00%
Epoch 2/5, Loss: 2.6130, Accuracy: 6.43%
Epoch 3/5, Loss: 2.1220, Accuracy: 14.29%
Epoch 4/5, Loss: 1.9372, Accuracy: 14.29%
Epoch 5/5, Loss: 1.8705, Accuracy: 14.29%
Baseline 1 - Test Loss: 1.7188, Test Accuracy: 17.86%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: art_painting
Epoch 1/5, Loss: 2.0059, Accuracy: 14.29%
Epoch 2/5, Loss: 1.9440, Accuracy: 13.57%
Epoch 3/5, Loss: 1.9179, Accuracy: 21.43%
Epoch 4/5, Loss: 1.8948, Accuracy: 25.00%
Epoch 5/5, Loss: 1.8815, Accuracy: 26.43%
Training on domain: cartoon
Epoch 1/5, Loss: 1.9178, Accuracy: 15.71%
Epoch 2/5, Loss: 1.8875, Accuracy: 17.14%
Epoch 3/5, Loss: 1.8666, Accuracy: 18.57%
Epoch 4/5, Loss: 1.8274, Accuracy: 30.71%
Epoch 5/5, Loss: 1.7946, Accuracy: 40.71%
Training on domain: photo
Epoch 1/5, Loss: 1.8535, Accuracy: 29.29%
Epoch 2/5, Loss: 1.7861, Accuracy: 34.29%
Epoch 3/5, Loss: 1.7467, Accuracy: 41.43%
Epoch 4/5, Loss: 1.7108, Accuracy: 46.43%
Epoch 5/5, Loss: 1.6310, Accuracy: 47.86%
Baseline 2 - Test Loss: 1.7175, Test Accuracy: 37.86%
Baseline 3: Sequential LoRA training with weight merging
Training on domain: art_painting
Epoch 1/5, Loss: 1.7741, Accuracy: 28.57%
Epoch 2/5, Loss: 1.7192, Accuracy: 33.57%
Epoch 3/5, Loss: 1.6571, Accuracy: 41.43%
Epoch 4/5, Loss: 1.5887, Accuracy: 45.71%
Epoch 5/5, Loss: 1.4908, Accuracy: 49.29%
Training on domain: cartoon
Epoch 1/5, Loss: 1.6404, Accuracy: 39.29%
Epoch 2/5, Loss: 1.5613, Accuracy: 42.86%
Epoch 3/5, Loss: 1.4936, Accuracy: 45.71%
Epoch 4/5, Loss: 1.4092, Accuracy: 51.43%
Epoch 5/5, Loss: 1.2949, Accuracy: 62.86%
Training on domain: photo
Epoch 1/5, Loss: 1.4634, Accuracy: 41.43%
Epoch 2/5, Loss: 1.2971, Accuracy: 53.57%
Epoch 3/5, Loss: 1.1742, Accuracy: 65.00%
Epoch 4/5, Loss: 1.0572, Accuracy: 67.14%
Epoch 5/5, Loss: 0.9758, Accuracy: 69.29%
Baseline 3 - Test Loss: 1.8571, Test Accuracy: 22.14%
Baseline 4: Weighted average of LoRA adapters
Training coefficients for weighted average of LoRA adapters
