Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: art_painting
Train domains: ['cartoon', 'sketch', 'photo']
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 4.0982, Accuracy: 11.43%
Epoch 2/5, Loss: 0.4607, Accuracy: 88.57%
Epoch 3/5, Loss: 0.3703, Accuracy: 62.86%
Epoch 4/5, Loss: 0.0565, Accuracy: 100.00%
Epoch 5/5, Loss: 0.0112, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0034, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: cartoon
Epoch 1/5, Loss: 2.0180, Accuracy: 51.43%
Epoch 2/5, Loss: 1.4652, Accuracy: 57.14%
Epoch 3/5, Loss: 0.7330, Accuracy: 62.86%
Epoch 4/5, Loss: 0.9942, Accuracy: 71.43%
Epoch 5/5, Loss: 0.9133, Accuracy: 77.14%
Training on domain: sketch
Epoch 1/5, Loss: 1.9396, Accuracy: 28.57%
Epoch 2/5, Loss: 1.7458, Accuracy: 42.86%
Epoch 3/5, Loss: 1.5774, Accuracy: 48.57%
Epoch 4/5, Loss: 1.3427, Accuracy: 54.29%
Epoch 5/5, Loss: 1.0156, Accuracy: 62.86%
Training on domain: photo
Epoch 1/5, Loss: 0.6140, Accuracy: 74.29%
Epoch 2/5, Loss: 0.8265, Accuracy: 77.14%
Epoch 3/5, Loss: 0.5367, Accuracy: 82.86%
Epoch 4/5, Loss: 0.4518, Accuracy: 91.43%
Epoch 5/5, Loss: 0.2266, Accuracy: 91.43%
Baseline 2 - Test Loss: 0.0024, Test Accuracy: 100.00%
Baseline 3: Sequential LoRA training with weight merging
Training on domain: cartoon
Epoch 1/5, Loss: 0.7648, Accuracy: 77.14%
Epoch 2/5, Loss: 0.4688, Accuracy: 82.86%
Epoch 3/5, Loss: 0.4066, Accuracy: 91.43%
Epoch 4/5, Loss: 0.4365, Accuracy: 94.29%
Epoch 5/5, Loss: 0.3233, Accuracy: 97.14%
Training on domain: sketch
Epoch 1/5, Loss: 1.0107, Accuracy: 60.00%
Epoch 2/5, Loss: 1.0169, Accuracy: 80.00%
Epoch 3/5, Loss: 1.0316, Accuracy: 77.14%
Epoch 4/5, Loss: 1.0040, Accuracy: 77.14%
Epoch 5/5, Loss: 0.8079, Accuracy: 71.43%
Training on domain: photo
Epoch 1/5, Loss: 0.1966, Accuracy: 94.29%
Epoch 2/5, Loss: 0.2551, Accuracy: 97.14%
Epoch 3/5, Loss: 0.0814, Accuracy: 100.00%
Epoch 4/5, Loss: 0.0828, Accuracy: 100.00%
Epoch 5/5, Loss: 0.0545, Accuracy: 100.00%
Baseline 3 - Test Loss: 0.0014, Test Accuracy: 100.00%
Baseline 4: Weighted average of LoRA adapters
Training coefficients for weighted average of LoRA adapters
