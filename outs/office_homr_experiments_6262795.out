No auxiliary_datasets specified. Using ['PACS', 'VLCS'] as auxiliary datasets.
Using device: cuda
Configuration:
{
  "datasets": {
    "PACS": {
      "path": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/PACS",
      "num_classes": 7
    },
    "VLCS": {
      "path": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS",
      "num_classes": 5
    },
    "OfficeHome": {
      "path": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home",
      "num_classes": 65
    }
  },
  "base_model": "vit_base_patch16_224",
  "max_samples_per_class": 20,
  "batch_size": 32,
  "num_epochs": 10,
  "learning_rate": "1e-4",
  "lora_r": 8,
  "lora_alpha": 32,
  "lora_dropout": 0.05,
  "output_dir": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs",
  "test_dataset": "OfficeHome",
  "auxiliary_datasets": [
    "PACS",
    "VLCS"
  ]
}
Loading dataset: PACS
Dataset config: {'path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/PACS', 'num_classes': 7}
Loading dataset: VLCS
Dataset config: {'path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS', 'num_classes': 5}
Loading dataset: OfficeHome
Dataset config: {'path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home', 'num_classes': 65}
Baseline 1: Training and testing on test domain only
Epoch 1/10, Loss: 1.6902, Accuracy: 58.33%
