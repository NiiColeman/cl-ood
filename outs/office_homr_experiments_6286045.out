Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: art_painting
Train domains: ['photo', 'sketch', 'cartoon']
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 3.4354, Accuracy: 22.86%
Epoch 2/5, Loss: 0.4603, Accuracy: 77.14%
Epoch 3/5, Loss: 0.1129, Accuracy: 97.14%
Epoch 4/5, Loss: 0.0129, Accuracy: 100.00%
Epoch 5/5, Loss: 0.0040, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0019, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: photo
Epoch 1/5, Loss: 1.0649, Accuracy: 82.86%
Epoch 2/5, Loss: 0.6869, Accuracy: 85.71%
Epoch 3/5, Loss: 0.3770, Accuracy: 91.43%
Epoch 4/5, Loss: 0.4699, Accuracy: 91.43%
Epoch 5/5, Loss: 0.2599, Accuracy: 94.29%
Training on domain: sketch
Epoch 1/5, Loss: 2.1662, Accuracy: 22.86%
Epoch 2/5, Loss: 2.2317, Accuracy: 22.86%
Epoch 3/5, Loss: 2.0733, Accuracy: 22.86%
Epoch 4/5, Loss: 1.6988, Accuracy: 31.43%
Epoch 5/5, Loss: 1.8738, Accuracy: 31.43%
Training on domain: cartoon
Epoch 1/5, Loss: 2.0407, Accuracy: 42.86%
Epoch 2/5, Loss: 1.9591, Accuracy: 57.14%
Epoch 3/5, Loss: 0.9331, Accuracy: 60.00%
Epoch 4/5, Loss: 1.1682, Accuracy: 68.57%
Epoch 5/5, Loss: 0.7945, Accuracy: 71.43%
Baseline 2 - Test Loss: 0.0011, Test Accuracy: 100.00%
Baseline 3: Sequential LoRA training with weight merging
Training on domain: photo
Epoch 1/5, Loss: 0.3159, Accuracy: 97.14%
Epoch 2/5, Loss: 0.1797, Accuracy: 97.14%
Epoch 3/5, Loss: 0.3976, Accuracy: 97.14%
Epoch 4/5, Loss: 0.1492, Accuracy: 97.14%
Epoch 5/5, Loss: 0.2352, Accuracy: 100.00%
Training on domain: sketch
Epoch 1/5, Loss: 1.6656, Accuracy: 42.86%
Epoch 2/5, Loss: 1.1032, Accuracy: 45.71%
Epoch 3/5, Loss: 1.5229, Accuracy: 48.57%
Epoch 4/5, Loss: 1.1189, Accuracy: 48.57%
Epoch 5/5, Loss: 1.1943, Accuracy: 54.29%
Training on domain: cartoon
Epoch 1/5, Loss: 0.4580, Accuracy: 82.86%
Epoch 2/5, Loss: 0.5226, Accuracy: 94.29%
Epoch 3/5, Loss: 0.3541, Accuracy: 97.14%
Epoch 4/5, Loss: 0.3355, Accuracy: 97.14%
Epoch 5/5, Loss: 0.1993, Accuracy: 97.14%
Baseline 3 - Test Loss: 0.0009, Test Accuracy: 100.00%
Baseline 4: Weighted average of LoRA adapters
Training coefficients for weighted average of LoRA adapters
