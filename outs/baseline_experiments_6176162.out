Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: sketch
Train domains: ['photo', 'art_painting', 'cartoon']
Baseline 1: Training and testing on test domain only
Epoch 1/10, Loss: 2.1580, Accuracy: 17.86%
Epoch 2/10, Loss: 2.0515, Accuracy: 20.00%
Epoch 3/10, Loss: 1.8465, Accuracy: 22.86%
Epoch 4/10, Loss: 1.6058, Accuracy: 32.14%
Epoch 5/10, Loss: 1.5765, Accuracy: 34.29%
Epoch 6/10, Loss: 1.4632, Accuracy: 37.86%
Epoch 7/10, Loss: 1.3218, Accuracy: 43.57%
Epoch 8/10, Loss: 1.2386, Accuracy: 46.43%
Epoch 9/10, Loss: 1.0681, Accuracy: 54.29%
Epoch 10/10, Loss: 0.8881, Accuracy: 65.71%
Baseline 1 - Test Loss: 0.9474, Test Accuracy: 62.14%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: photo
Epoch 1/10, Loss: 2.2664, Accuracy: 7.14%
Epoch 2/10, Loss: 1.8877, Accuracy: 18.57%
Epoch 3/10, Loss: 1.5817, Accuracy: 35.00%
Epoch 4/10, Loss: 1.2690, Accuracy: 59.29%
Epoch 5/10, Loss: 0.9452, Accuracy: 83.57%
Epoch 6/10, Loss: 0.6142, Accuracy: 92.86%
Epoch 7/10, Loss: 0.3133, Accuracy: 98.57%
Epoch 8/10, Loss: 0.1343, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0550, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0270, Accuracy: 100.00%
Training on domain: art_painting
Epoch 1/10, Loss: 2.0036, Accuracy: 47.86%
Epoch 2/10, Loss: 1.1543, Accuracy: 62.14%
Epoch 3/10, Loss: 0.7465, Accuracy: 78.57%
Epoch 4/10, Loss: 0.4853, Accuracy: 82.86%
Epoch 5/10, Loss: 0.2810, Accuracy: 95.00%
Epoch 6/10, Loss: 0.1872, Accuracy: 97.86%
Epoch 7/10, Loss: 0.1105, Accuracy: 99.29%
Epoch 8/10, Loss: 0.0699, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0464, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0325, Accuracy: 100.00%
Training on domain: cartoon
Epoch 1/10, Loss: 1.3405, Accuracy: 48.57%
Epoch 2/10, Loss: 0.8034, Accuracy: 70.71%
Epoch 3/10, Loss: 0.5868, Accuracy: 86.43%
Epoch 4/10, Loss: 0.3975, Accuracy: 90.71%
Epoch 5/10, Loss: 0.2688, Accuracy: 94.29%
Epoch 6/10, Loss: 0.1582, Accuracy: 96.43%
Epoch 7/10, Loss: 0.0967, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0588, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0327, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0223, Accuracy: 100.00%
Evaluating final model on test domain
Baseline 2 - Test Loss: 1.6542, Test Accuracy: 42.14%
Final model for PACS saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/PACS_final_model.pth
Running baseline experiments for dataset: VLCS
Using device: cuda
Total number of domains: 4
Test domain: Caltech101
Train domains: ['SUN09', 'VOC2007', 'LabelMe']
Baseline 1: Training and testing on test domain only
Epoch 1/10, Loss: 0.6148, Accuracy: 72.00%
Epoch 2/10, Loss: 0.0211, Accuracy: 99.00%
Epoch 3/10, Loss: 0.0704, Accuracy: 99.00%
Epoch 4/10, Loss: 0.0056, Accuracy: 100.00%
Epoch 5/10, Loss: 0.0017, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0004, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0000, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0000, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0000, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0000, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0000, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: SUN09
Epoch 1/10, Loss: 1.9695, Accuracy: 18.00%
Epoch 2/10, Loss: 1.7076, Accuracy: 26.00%
Epoch 3/10, Loss: 1.5178, Accuracy: 34.00%
Epoch 4/10, Loss: 1.3505, Accuracy: 47.00%
Epoch 5/10, Loss: 1.0706, Accuracy: 62.00%
Epoch 6/10, Loss: 0.8588, Accuracy: 68.00%
Epoch 7/10, Loss: 0.8048, Accuracy: 78.00%
Epoch 8/10, Loss: 0.7333, Accuracy: 87.00%
Epoch 9/10, Loss: 0.4470, Accuracy: 94.00%
Epoch 10/10, Loss: 0.3142, Accuracy: 97.00%
Training on domain: VOC2007
Epoch 1/10, Loss: 1.5537, Accuracy: 39.00%
Epoch 2/10, Loss: 1.1842, Accuracy: 50.00%
Epoch 3/10, Loss: 1.0269, Accuracy: 61.00%
Epoch 4/10, Loss: 0.8599, Accuracy: 76.00%
Epoch 5/10, Loss: 0.6184, Accuracy: 82.00%
Epoch 6/10, Loss: 0.5276, Accuracy: 89.00%
Epoch 7/10, Loss: 0.3642, Accuracy: 93.00%
Epoch 8/10, Loss: 0.3655, Accuracy: 98.00%
Epoch 9/10, Loss: 0.2319, Accuracy: 100.00%
Epoch 10/10, Loss: 0.1276, Accuracy: 100.00%
Training on domain: LabelMe
Epoch 1/10, Loss: 1.5296, Accuracy: 47.00%
Epoch 2/10, Loss: 0.9531, Accuracy: 58.00%
Epoch 3/10, Loss: 0.9308, Accuracy: 59.00%
Epoch 4/10, Loss: 0.6532, Accuracy: 73.00%
Epoch 5/10, Loss: 0.7297, Accuracy: 83.00%
Epoch 6/10, Loss: 0.3871, Accuracy: 89.00%
Epoch 7/10, Loss: 0.3176, Accuracy: 93.00%
Epoch 8/10, Loss: 0.2645, Accuracy: 99.00%
Epoch 9/10, Loss: 0.1975, Accuracy: 100.00%
Epoch 10/10, Loss: 0.1268, Accuracy: 100.00%
Evaluating final model on test domain
Baseline 2 - Test Loss: 1.1328, Test Accuracy: 51.00%
Final model for VLCS saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/VLCS_final_model.pth

Summary of Results:
Dataset: PACS
  Baseline 1 Accuracy: 42.14%
  Baseline 2 Accuracy: 42.14%
---
Dataset: VLCS
  Baseline 1 Accuracy: 51.00%
  Baseline 2 Accuracy: 51.00%
---
