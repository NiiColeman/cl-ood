no lora test2
Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: photo
Train domains: ['sketch', 'cartoon', 'art_painting']
Baseline 1: Training and testing on test domain only
Epoch 1/10, Loss: 0.2005, Accuracy: 93.77%
Epoch 2/10, Loss: 0.0750, Accuracy: 97.78%
Epoch 3/10, Loss: 0.0259, Accuracy: 98.98%
Epoch 4/10, Loss: 0.0358, Accuracy: 99.34%
Epoch 5/10, Loss: 0.0428, Accuracy: 98.80%
Epoch 6/10, Loss: 0.0816, Accuracy: 97.54%
Epoch 7/10, Loss: 0.0433, Accuracy: 98.62%
Epoch 8/10, Loss: 0.0106, Accuracy: 99.70%
Epoch 9/10, Loss: 0.0003, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0001, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0001, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: sketch
Epoch 1/10, Loss: 1.1016, Accuracy: 55.56%
Epoch 2/10, Loss: 0.5361, Accuracy: 78.98%
Epoch 3/10, Loss: 0.3237, Accuracy: 88.06%
Epoch 4/10, Loss: 0.2019, Accuracy: 92.75%
Epoch 5/10, Loss: 0.0898, Accuracy: 97.53%
Epoch 6/10, Loss: 0.0401, Accuracy: 99.31%
Epoch 7/10, Loss: 0.0131, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0040, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0021, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0014, Accuracy: 100.00%
Training on domain: cartoon
Epoch 1/10, Loss: 0.9074, Accuracy: 69.24%
Epoch 2/10, Loss: 0.1879, Accuracy: 94.80%
Epoch 3/10, Loss: 0.0578, Accuracy: 98.76%
Epoch 4/10, Loss: 0.0145, Accuracy: 99.87%
Epoch 5/10, Loss: 0.0074, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0032, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0020, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0014, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0011, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0009, Accuracy: 100.00%
Training on domain: art_painting
Epoch 1/10, Loss: 0.3777, Accuracy: 89.60%
Epoch 2/10, Loss: 0.0628, Accuracy: 97.95%
Epoch 3/10, Loss: 0.0112, Accuracy: 99.90%
Epoch 4/10, Loss: 0.0036, Accuracy: 100.00%
Epoch 5/10, Loss: 0.0022, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0015, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0011, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0009, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0007, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0006, Accuracy: 100.00%
Evaluating final model on test domain
Baseline 2 - Test Loss: 0.0585, Test Accuracy: 98.68%
Final model for PACS saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/PACS_final_model.pth
Running baseline experiments for dataset: VLCS
Using device: cuda
Total number of domains: 4
Test domain: LabelMe
Train domains: ['Caltech101', 'VOC2007', 'SUN09']
Baseline 1: Training and testing on test domain only
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 1/10, Loss: 0.7171, Accuracy: 71.95%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Epoch 2/10, Loss: 0.4686, Accuracy: 82.87%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Epoch 3/10, Loss: 0.3119, Accuracy: 89.23%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 4/10, Loss: 0.2336, Accuracy: 92.21%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Epoch 5/10, Loss: 0.1501, Accuracy: 94.92%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 6/10, Loss: 0.1022, Accuracy: 96.42%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 7/10, Loss: 0.1072, Accuracy: 96.39%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Epoch 8/10, Loss: 0.0714, Accuracy: 97.52%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Epoch 9/10, Loss: 0.0776, Accuracy: 97.48%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Epoch 10/10, Loss: 0.0816, Accuracy: 97.44%
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Baseline 1 - Test Loss: 0.0439, Test Accuracy: 98.57%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: Caltech101
Epoch 1/10, Loss: 0.7028, Accuracy: 72.16%
Epoch 2/10, Loss: 0.0248, Accuracy: 99.72%
Epoch 3/10, Loss: 0.0015, Accuracy: 100.00%
Epoch 4/10, Loss: 0.0007, Accuracy: 100.00%
Epoch 5/10, Loss: 0.0004, Accuracy: 100.00%
Epoch 6/10, Loss: 0.0003, Accuracy: 100.00%
Epoch 7/10, Loss: 0.0002, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0002, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0002, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0001, Accuracy: 100.00%
Training on domain: VOC2007
Epoch 1/10, Loss: 0.6892, Accuracy: 77.31%
Epoch 2/10, Loss: 0.3008, Accuracy: 89.96%
Epoch 3/10, Loss: 0.1589, Accuracy: 94.96%
Epoch 4/10, Loss: 0.0707, Accuracy: 98.07%
Epoch 5/10, Loss: 0.0255, Accuracy: 99.56%
Epoch 6/10, Loss: 0.0104, Accuracy: 99.88%
Epoch 7/10, Loss: 0.0048, Accuracy: 99.97%
Epoch 8/10, Loss: 0.0025, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0015, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0010, Accuracy: 100.00%
Training on domain: SUN09
Epoch 1/10, Loss: 0.6316, Accuracy: 80.87%
Epoch 2/10, Loss: 0.3262, Accuracy: 88.57%
Epoch 3/10, Loss: 0.1813, Accuracy: 94.12%
Epoch 4/10, Loss: 0.0994, Accuracy: 97.32%
Epoch 5/10, Loss: 0.0393, Accuracy: 99.39%
Epoch 6/10, Loss: 0.0151, Accuracy: 99.88%
Epoch 7/10, Loss: 0.0068, Accuracy: 100.00%
Epoch 8/10, Loss: 0.0029, Accuracy: 100.00%
Epoch 9/10, Loss: 0.0019, Accuracy: 100.00%
Epoch 10/10, Loss: 0.0013, Accuracy: 100.00%
Evaluating final model on test domain
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/7e457522cdcb4790b70f8b7eefb8e4b0.jpg: image file is truncated (1477 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/person/54acb3ec4dbc42d3bcff926091dbadd1.jpg: image file is truncated (99 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/a4fc44181c584986888c78fea2c1d310.jpg: image file is truncated (4038 bytes not processed)
Error loading image /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS/LabelMe/car/44b07a801b794b0ebadf75eabe761386.jpg: image file is truncated (1525 bytes not processed)
Baseline 2 - Test Loss: 4.1530, Test Accuracy: 65.36%
Final model for VLCS saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/VLCS_final_model.pth

Summary of Results:
Dataset: PACS
  Baseline 1 Accuracy: 100.00%
  Baseline 2 Accuracy: 98.68%
---
Dataset: VLCS
  Baseline 1 Accuracy: 98.57%
  Baseline 2 Accuracy: 65.36%
---
