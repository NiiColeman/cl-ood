
--- Run 1/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: cartoon
Train domains: ['photo', 'art_painting', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.7145, Train Accuracy: 42.86%
Val Loss: 2.3289, Val Accuracy: 7.94%
Epoch 2/10, Train Loss: 0.8813, Train Accuracy: 85.71%
Val Loss: 2.4721, Val Accuracy: 9.52%
Epoch 3/10, Train Loss: 0.4290, Train Accuracy: 85.71%
Val Loss: 2.6507, Val Accuracy: 11.11%
Epoch 4/10, Train Loss: 0.2208, Train Accuracy: 100.00%
Val Loss: 2.7765, Val Accuracy: 11.11%
Epoch 5/10, Train Loss: 0.0926, Train Accuracy: 100.00%
Val Loss: 2.8677, Val Accuracy: 11.11%
Epoch 6/10, Train Loss: 0.0351, Train Accuracy: 100.00%
Val Loss: 2.9509, Val Accuracy: 17.46%
Epoch 7/10, Train Loss: 0.0134, Train Accuracy: 100.00%
Val Loss: 3.0302, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 0.0058, Train Accuracy: 100.00%
Val Loss: 3.1005, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 0.0028, Train Accuracy: 100.00%
Val Loss: 3.1630, Val Accuracy: 19.05%
Epoch 10/10, Train Loss: 0.0017, Train Accuracy: 100.00%
Val Loss: 3.2201, Val Accuracy: 19.05%
Baseline Model - Final Test Loss: 3.1005, Test Accuracy: 19.05%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1778, Train Accuracy: 14.29%
Val Loss: 2.0321, Val Accuracy: 35.71%
Epoch 2/10, Train Loss: 2.0304, Train Accuracy: 21.43%
Val Loss: 1.9288, Val Accuracy: 35.71%
Epoch 3/10, Train Loss: 1.8633, Train Accuracy: 30.36%
Val Loss: 1.8379, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.7120, Train Accuracy: 39.29%
Val Loss: 1.7468, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.5842, Train Accuracy: 39.29%
Val Loss: 1.6598, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.4429, Train Accuracy: 50.00%
Val Loss: 1.5746, Val Accuracy: 50.00%
Epoch 7/10, Train Loss: 1.3155, Train Accuracy: 58.93%
Val Loss: 1.4891, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.1762, Train Accuracy: 76.79%
Val Loss: 1.4053, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 1.0563, Train Accuracy: 87.50%
Val Loss: 1.3213, Val Accuracy: 71.43%
Epoch 10/10, Train Loss: 0.9427, Train Accuracy: 92.86%
Val Loss: 1.2413, Val Accuracy: 71.43%
photo adapter trained. Validation Accuracy: 71.43%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 1.9302, Train Accuracy: 26.79%
Val Loss: 1.9516, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 1.7455, Train Accuracy: 37.50%
Val Loss: 1.8989, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 1.5627, Train Accuracy: 41.07%
Val Loss: 1.8680, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.4422, Train Accuracy: 51.79%
Val Loss: 1.8296, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.2927, Train Accuracy: 66.07%
Val Loss: 1.7812, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.1451, Train Accuracy: 69.64%
Val Loss: 1.7329, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.0277, Train Accuracy: 76.79%
Val Loss: 1.6864, Val Accuracy: 42.86%
Epoch 8/10, Train Loss: 0.9042, Train Accuracy: 82.14%
Val Loss: 1.6476, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 0.7986, Train Accuracy: 87.50%
Val Loss: 1.6142, Val Accuracy: 57.14%
Epoch 10/10, Train Loss: 0.7056, Train Accuracy: 92.86%
Val Loss: 1.5724, Val Accuracy: 57.14%
art_painting adapter trained. Validation Accuracy: 57.14%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.0641, Train Accuracy: 21.43%
Val Loss: 1.8139, Val Accuracy: 42.86%
Epoch 2/10, Train Loss: 1.8245, Train Accuracy: 26.79%
Val Loss: 1.6850, Val Accuracy: 50.00%
Epoch 3/10, Train Loss: 1.6682, Train Accuracy: 39.29%
Val Loss: 1.5967, Val Accuracy: 50.00%
Epoch 4/10, Train Loss: 1.5302, Train Accuracy: 53.57%
Val Loss: 1.5332, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.4174, Train Accuracy: 55.36%
Val Loss: 1.4731, Val Accuracy: 50.00%
Epoch 6/10, Train Loss: 1.3289, Train Accuracy: 62.50%
Val Loss: 1.4185, Val Accuracy: 50.00%
Epoch 7/10, Train Loss: 1.2328, Train Accuracy: 66.07%
Val Loss: 1.3574, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.1668, Train Accuracy: 64.29%
Val Loss: 1.2902, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 1.0986, Train Accuracy: 66.07%
Val Loss: 1.2280, Val Accuracy: 50.00%
Epoch 10/10, Train Loss: 0.9769, Train Accuracy: 67.86%
Val Loss: 1.1616, Val Accuracy: 57.14%
sketch adapter trained. Validation Accuracy: 57.14%

Training coefficients for adapter merging
Epoch 1, Loss: 2.1151, Accuracy: 28.57%
Coefficients: [0.12490708 0.12351926 0.7515736 ]
Epoch 2, Loss: 2.1115, Accuracy: 28.57%
Coefficients: [0.07830364 0.07052422 0.85117215]
Epoch 3, Loss: 2.1128, Accuracy: 28.57%
Coefficients: [0.06183388 0.05141519 0.88675094]
Epoch 4, Loss: 2.1137, Accuracy: 28.57%
Coefficients: [0.05582402 0.04691453 0.8972614 ]
Epoch 5, Loss: 2.1123, Accuracy: 28.57%
Coefficients: [0.05296545 0.04590817 0.9011264 ]
Epoch 6, Loss: 2.1186, Accuracy: 28.57%
Coefficients: [0.05212435 0.04606787 0.9018078 ]
Epoch 7, Loss: 2.1148, Accuracy: 28.57%
Coefficients: [0.05181047 0.04626792 0.90192163]
Epoch 8, Loss: 2.1139, Accuracy: 28.57%
Coefficients: [0.05164504 0.04640638 0.9019486 ]
Epoch 9, Loss: 2.1150, Accuracy: 28.57%
Coefficients: [0.05157516 0.04649269 0.9019322 ]
Epoch 10, Loss: 2.1179, Accuracy: 28.57%
Coefficients: [0.0515661  0.04655593 0.901878  ]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.12490708 0.12351926 0.7515736 ]

Merged model - Test Loss: 1.8792, Test Accuracy: 36.51%

--- Run 2/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: cartoon
Train domains: ['photo', 'art_painting', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.7145, Train Accuracy: 42.86%
Val Loss: 2.3289, Val Accuracy: 7.94%
Epoch 2/10, Train Loss: 0.8813, Train Accuracy: 85.71%
Val Loss: 2.4721, Val Accuracy: 9.52%
Epoch 3/10, Train Loss: 0.4290, Train Accuracy: 85.71%
Val Loss: 2.6507, Val Accuracy: 11.11%
Epoch 4/10, Train Loss: 0.2208, Train Accuracy: 100.00%
Val Loss: 2.7765, Val Accuracy: 11.11%
Epoch 5/10, Train Loss: 0.0926, Train Accuracy: 100.00%
Val Loss: 2.8677, Val Accuracy: 11.11%
Epoch 6/10, Train Loss: 0.0351, Train Accuracy: 100.00%
Val Loss: 2.9509, Val Accuracy: 17.46%
Epoch 7/10, Train Loss: 0.0134, Train Accuracy: 100.00%
Val Loss: 3.0302, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 0.0058, Train Accuracy: 100.00%
Val Loss: 3.1005, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 0.0028, Train Accuracy: 100.00%
Val Loss: 3.1630, Val Accuracy: 19.05%
Epoch 10/10, Train Loss: 0.0017, Train Accuracy: 100.00%
Val Loss: 3.2201, Val Accuracy: 19.05%
Baseline Model - Final Test Loss: 3.1005, Test Accuracy: 19.05%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1778, Train Accuracy: 14.29%
Val Loss: 2.0321, Val Accuracy: 35.71%
Epoch 2/10, Train Loss: 2.0304, Train Accuracy: 21.43%
Val Loss: 1.9288, Val Accuracy: 35.71%
Epoch 3/10, Train Loss: 1.8633, Train Accuracy: 30.36%
Val Loss: 1.8379, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.7120, Train Accuracy: 39.29%
Val Loss: 1.7468, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.5842, Train Accuracy: 39.29%
Val Loss: 1.6598, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.4429, Train Accuracy: 50.00%
Val Loss: 1.5746, Val Accuracy: 50.00%
Epoch 7/10, Train Loss: 1.3155, Train Accuracy: 58.93%
Val Loss: 1.4891, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.1762, Train Accuracy: 76.79%
Val Loss: 1.4053, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 1.0563, Train Accuracy: 87.50%
Val Loss: 1.3213, Val Accuracy: 71.43%
Epoch 10/10, Train Loss: 0.9427, Train Accuracy: 92.86%
Val Loss: 1.2412, Val Accuracy: 71.43%
photo adapter trained. Validation Accuracy: 71.43%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 1.9302, Train Accuracy: 26.79%
Val Loss: 1.9516, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 1.7455, Train Accuracy: 37.50%
Val Loss: 1.8989, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 1.5627, Train Accuracy: 41.07%
Val Loss: 1.8681, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.4422, Train Accuracy: 51.79%
Val Loss: 1.8296, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.2927, Train Accuracy: 66.07%
Val Loss: 1.7812, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.1451, Train Accuracy: 69.64%
Val Loss: 1.7329, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.0277, Train Accuracy: 76.79%
Val Loss: 1.6864, Val Accuracy: 42.86%
Epoch 8/10, Train Loss: 0.9043, Train Accuracy: 82.14%
Val Loss: 1.6476, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 0.7987, Train Accuracy: 87.50%
Val Loss: 1.6141, Val Accuracy: 57.14%
Epoch 10/10, Train Loss: 0.7056, Train Accuracy: 92.86%
Val Loss: 1.5725, Val Accuracy: 57.14%
art_painting adapter trained. Validation Accuracy: 57.14%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.0641, Train Accuracy: 21.43%
Val Loss: 1.8139, Val Accuracy: 42.86%
Epoch 2/10, Train Loss: 1.8245, Train Accuracy: 26.79%
Val Loss: 1.6850, Val Accuracy: 50.00%
Epoch 3/10, Train Loss: 1.6682, Train Accuracy: 39.29%
Val Loss: 1.5967, Val Accuracy: 50.00%
Epoch 4/10, Train Loss: 1.5302, Train Accuracy: 53.57%
Val Loss: 1.5332, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.4174, Train Accuracy: 55.36%
Val Loss: 1.4731, Val Accuracy: 50.00%
Epoch 6/10, Train Loss: 1.3289, Train Accuracy: 62.50%
Val Loss: 1.4185, Val Accuracy: 50.00%
Epoch 7/10, Train Loss: 1.2328, Train Accuracy: 66.07%
Val Loss: 1.3574, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.1668, Train Accuracy: 64.29%
Val Loss: 1.2902, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 1.0986, Train Accuracy: 66.07%
Val Loss: 1.2280, Val Accuracy: 50.00%
Epoch 10/10, Train Loss: 0.9769, Train Accuracy: 67.86%
Val Loss: 1.1616, Val Accuracy: 57.14%
sketch adapter trained. Validation Accuracy: 57.14%

Training coefficients for adapter merging
Epoch 1, Loss: 2.1151, Accuracy: 28.57%
Coefficients: [0.12490708 0.12351926 0.7515736 ]
Epoch 2, Loss: 2.1115, Accuracy: 28.57%
Coefficients: [0.07830569 0.07052635 0.8511679 ]
Epoch 3, Loss: 2.1128, Accuracy: 28.57%
Coefficients: [0.06183681 0.0514189  0.88674426]
Epoch 4, Loss: 2.1137, Accuracy: 28.57%
Coefficients: [0.05582712 0.04691902 0.89725393]
Epoch 5, Loss: 2.1123, Accuracy: 28.57%
Coefficients: [0.0529683  0.04591269 0.901119  ]
Epoch 6, Loss: 2.1186, Accuracy: 28.57%
Coefficients: [0.0521271  0.04607229 0.90180063]
Epoch 7, Loss: 2.1148, Accuracy: 28.57%
Coefficients: [0.05181319 0.04627231 0.9019145 ]
Epoch 8, Loss: 2.1139, Accuracy: 28.57%
Coefficients: [0.05164775 0.04641075 0.9019415 ]
Epoch 9, Loss: 2.1150, Accuracy: 28.57%
Coefficients: [0.05157782 0.04649706 0.90192515]
Epoch 10, Loss: 2.1179, Accuracy: 28.57%
Coefficients: [0.05156878 0.04656029 0.9018709 ]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.12490708 0.12351926 0.7515736 ]

Merged model - Test Loss: 1.8792, Test Accuracy: 36.51%

--- Run 3/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: cartoon
Train domains: ['photo', 'art_painting', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.7145, Train Accuracy: 42.86%
Val Loss: 2.3289, Val Accuracy: 7.94%
Epoch 2/10, Train Loss: 0.8813, Train Accuracy: 85.71%
Val Loss: 2.4721, Val Accuracy: 9.52%
Epoch 3/10, Train Loss: 0.4290, Train Accuracy: 85.71%
Val Loss: 2.6507, Val Accuracy: 11.11%
Epoch 4/10, Train Loss: 0.2208, Train Accuracy: 100.00%
Val Loss: 2.7765, Val Accuracy: 11.11%
Epoch 5/10, Train Loss: 0.0926, Train Accuracy: 100.00%
Val Loss: 2.8677, Val Accuracy: 11.11%
Epoch 6/10, Train Loss: 0.0351, Train Accuracy: 100.00%
Val Loss: 2.9509, Val Accuracy: 17.46%
Epoch 7/10, Train Loss: 0.0134, Train Accuracy: 100.00%
Val Loss: 3.0302, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 0.0058, Train Accuracy: 100.00%
Val Loss: 3.1005, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 0.0028, Train Accuracy: 100.00%
Val Loss: 3.1630, Val Accuracy: 19.05%
Epoch 10/10, Train Loss: 0.0017, Train Accuracy: 100.00%
Val Loss: 3.2201, Val Accuracy: 19.05%
Baseline Model - Final Test Loss: 3.1005, Test Accuracy: 19.05%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1778, Train Accuracy: 14.29%
Val Loss: 2.0321, Val Accuracy: 35.71%
Epoch 2/10, Train Loss: 2.0304, Train Accuracy: 21.43%
Val Loss: 1.9288, Val Accuracy: 35.71%
Epoch 3/10, Train Loss: 1.8633, Train Accuracy: 30.36%
Val Loss: 1.8379, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.7120, Train Accuracy: 39.29%
Val Loss: 1.7468, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.5842, Train Accuracy: 39.29%
Val Loss: 1.6598, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.4429, Train Accuracy: 50.00%
Val Loss: 1.5746, Val Accuracy: 50.00%
Epoch 7/10, Train Loss: 1.3155, Train Accuracy: 58.93%
Val Loss: 1.4891, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.1762, Train Accuracy: 76.79%
Val Loss: 1.4053, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 1.0563, Train Accuracy: 87.50%
Val Loss: 1.3213, Val Accuracy: 71.43%
Epoch 10/10, Train Loss: 0.9427, Train Accuracy: 92.86%
Val Loss: 1.2412, Val Accuracy: 71.43%
photo adapter trained. Validation Accuracy: 71.43%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 1.9302, Train Accuracy: 26.79%
Val Loss: 1.9516, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 1.7455, Train Accuracy: 37.50%
Val Loss: 1.8989, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 1.5627, Train Accuracy: 41.07%
Val Loss: 1.8680, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.4422, Train Accuracy: 51.79%
Val Loss: 1.8296, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.2927, Train Accuracy: 66.07%
Val Loss: 1.7812, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.1451, Train Accuracy: 69.64%
Val Loss: 1.7329, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.0277, Train Accuracy: 76.79%
Val Loss: 1.6864, Val Accuracy: 42.86%
Epoch 8/10, Train Loss: 0.9042, Train Accuracy: 82.14%
Val Loss: 1.6476, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 0.7986, Train Accuracy: 87.50%
Val Loss: 1.6144, Val Accuracy: 57.14%
Epoch 10/10, Train Loss: 0.7055, Train Accuracy: 92.86%
Val Loss: 1.5724, Val Accuracy: 57.14%
art_painting adapter trained. Validation Accuracy: 57.14%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.0641, Train Accuracy: 21.43%
Val Loss: 1.8139, Val Accuracy: 42.86%
Epoch 2/10, Train Loss: 1.8245, Train Accuracy: 26.79%
Val Loss: 1.6850, Val Accuracy: 50.00%
Epoch 3/10, Train Loss: 1.6682, Train Accuracy: 39.29%
Val Loss: 1.5967, Val Accuracy: 50.00%
Epoch 4/10, Train Loss: 1.5302, Train Accuracy: 53.57%
Val Loss: 1.5332, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.4174, Train Accuracy: 55.36%
Val Loss: 1.4731, Val Accuracy: 50.00%
Epoch 6/10, Train Loss: 1.3289, Train Accuracy: 62.50%
Val Loss: 1.4185, Val Accuracy: 50.00%
Epoch 7/10, Train Loss: 1.2328, Train Accuracy: 66.07%
Val Loss: 1.3574, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.1668, Train Accuracy: 64.29%
Val Loss: 1.2902, Val Accuracy: 57.14%
Epoch 9/10, Train Loss: 1.0986, Train Accuracy: 66.07%
Val Loss: 1.2280, Val Accuracy: 50.00%
Epoch 10/10, Train Loss: 0.9769, Train Accuracy: 67.86%
Val Loss: 1.1616, Val Accuracy: 57.14%
sketch adapter trained. Validation Accuracy: 57.14%

Training coefficients for adapter merging
Epoch 1, Loss: 2.1151, Accuracy: 28.57%
Coefficients: [0.12490708 0.12351926 0.7515736 ]
Epoch 2, Loss: 2.1115, Accuracy: 28.57%
Coefficients: [0.07829174 0.07051677 0.8511915 ]
Epoch 3, Loss: 2.1128, Accuracy: 28.57%
Coefficients: [0.06182002 0.05140797 0.8867719 ]
Epoch 4, Loss: 2.1137, Accuracy: 28.57%
Coefficients: [0.05580973 0.04690776 0.8972825 ]
Epoch 5, Loss: 2.1123, Accuracy: 28.57%
Coefficients: [0.05295139 0.04590135 0.9011473 ]
Epoch 6, Loss: 2.1186, Accuracy: 28.57%
Coefficients: [0.05211022 0.04606085 0.90182894]
Epoch 7, Loss: 2.1148, Accuracy: 28.57%
Coefficients: [0.05179628 0.04626079 0.90194297]
Epoch 8, Loss: 2.1139, Accuracy: 28.57%
Coefficients: [0.05163081 0.04639917 0.90197   ]
Epoch 9, Loss: 2.1150, Accuracy: 28.57%
Coefficients: [0.05156091 0.04648545 0.90195364]
Epoch 10, Loss: 2.1179, Accuracy: 28.57%
Coefficients: [0.05155183 0.04654865 0.9018995 ]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.12490708 0.12351926 0.7515736 ]

Merged model - Test Loss: 1.8792, Test Accuracy: 36.51%

Summary of All Runs:
Base Model Accuracy: 19.05% ± 0.00%
Merged Model Accuracy: 36.51% ± 0.00%
Average Coefficients:
  photo: 0.1249 ± 0.0000
  art_painting: 0.1235 ± 0.0000
  sketch: 0.7516 ± 0.0000
