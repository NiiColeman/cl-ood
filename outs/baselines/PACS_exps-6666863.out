
==================================================
Running experiments for dataset: PACS
==================================================
Dataset config for PACS:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/PACS', 'max_samples_per_class': 100, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 15, 'learning_rate': 0.001, 'lora_r': 16, 'lora_alpha': 16, 'lora_dropout': 0.05, 'coefficient_learning_rate': 1, 'coefficient_epochs': 15, 'seed': 42}
Type of dataset_config: <class 'dict'>
Contents of dataset_config:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/PACS', 'max_samples_per_class': 100, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 15, 'learning_rate': 0.001, 'lora_r': 16, 'lora_alpha': 16, 'lora_dropout': 0.05, 'coefficient_learning_rate': 1, 'coefficient_epochs': 15, 'seed': 42}

Run 1/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: art_painting
Training domains: ['sketch', 'cartoon', 'photo']
Test domain: art_painting
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.8404
Epoch 2, Average Loss: 2.3142
Epoch 3, Average Loss: 2.0835
Epoch 4, Average Loss: 1.9988
Epoch 5, Average Loss: 1.9858
Epoch 6, Average Loss: 2.0226
Epoch 7, Average Loss: 1.9489
Epoch 8, Average Loss: 1.9692
Epoch 9, Average Loss: 1.9019
Epoch 10, Average Loss: 1.8824
Epoch 11, Average Loss: 1.7727
Epoch 12, Average Loss: 1.8572
Epoch 13, Average Loss: 1.9468
Epoch 14, Average Loss: 1.7920
Epoch 15, Average Loss: 1.7938
Accuracy: 25.1429
Training domains: ['sketch', 'cartoon', 'photo']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.1755
Epoch 2, Average Loss: 0.4368
Epoch 3, Average Loss: 0.2058
Epoch 4, Average Loss: 0.1065
Epoch 5, Average Loss: 0.0118
Epoch 6, Average Loss: 0.0114
Epoch 7, Average Loss: 0.0034
Epoch 8, Average Loss: 0.0011
Epoch 9, Average Loss: 0.0003
Epoch 10, Average Loss: 0.0002
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 73.4286
Accuracy of sketch model on test domain: 73.4286

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 0.7457
Epoch 2, Average Loss: 0.0738
Epoch 3, Average Loss: 0.0157
Epoch 4, Average Loss: 0.0042
Epoch 5, Average Loss: 0.0069
Epoch 6, Average Loss: 0.0056
Epoch 7, Average Loss: 0.0016
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 85.1429
Accuracy of cartoon model on test domain: 85.1429

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.4075
Epoch 2, Average Loss: 0.0079
Epoch 3, Average Loss: 0.0039
Epoch 4, Average Loss: 0.0105
Epoch 5, Average Loss: 0.0004
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0000
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 80.8571
Accuracy of photo model on test domain: 80.8571

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.0117
Coefficient Epoch 2, Average Loss: 1.6565
Coefficient Epoch 3, Average Loss: 1.4894
Coefficient Epoch 4, Average Loss: 0.9985
Coefficient Epoch 5, Average Loss: 0.3808
Coefficient Epoch 6, Average Loss: 0.3389
Coefficient Epoch 7, Average Loss: 0.3350
Coefficient Epoch 8, Average Loss: 0.2937
Coefficient Epoch 9, Average Loss: 0.2921
Coefficient Epoch 10, Average Loss: 0.3205
Coefficient Epoch 11, Average Loss: 0.3257
Coefficient Epoch 12, Average Loss: 0.2957
Coefficient Epoch 13, Average Loss: 0.2933
Coefficient Epoch 14, Average Loss: 0.3236
Coefficient Epoch 15, Average Loss: 0.3723
Final device check:
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Coefficient training complete.
Learned coefficients: [0.4561712145805359, 0.2317558377981186, 0.3120729327201843]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 87.4286
Final model accuracy on test domain: 87.4286

Run 2/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: photo
Training domains: ['sketch', 'cartoon', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 3.7430
Epoch 2, Average Loss: 2.1835
Epoch 3, Average Loss: 2.0691
Epoch 4, Average Loss: 2.0709
Epoch 5, Average Loss: 1.9305
Epoch 6, Average Loss: 1.9517
Epoch 7, Average Loss: 1.9436
Epoch 8, Average Loss: 1.9728
Epoch 9, Average Loss: 1.8925
Epoch 10, Average Loss: 1.8084
Epoch 11, Average Loss: 1.7122
Epoch 12, Average Loss: 1.6908
Epoch 13, Average Loss: 1.6381
Epoch 14, Average Loss: 1.5668
Epoch 15, Average Loss: 1.3319
Accuracy: 32.2857
Training domains: ['sketch', 'cartoon', 'art_painting']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.0281
Epoch 2, Average Loss: 0.3705
Epoch 3, Average Loss: 0.1478
Epoch 4, Average Loss: 0.0395
Epoch 5, Average Loss: 0.1046
Epoch 6, Average Loss: 0.0350
Epoch 7, Average Loss: 0.0053
Epoch 8, Average Loss: 0.0039
Epoch 9, Average Loss: 0.0009
Epoch 10, Average Loss: 0.0002
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 76.0000
Accuracy of sketch model on test domain: 76.0000

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 0.7965
Epoch 2, Average Loss: 0.0868
Epoch 3, Average Loss: 0.0371
Epoch 4, Average Loss: 0.0043
Epoch 5, Average Loss: 0.0012
Epoch 6, Average Loss: 0.0007
Epoch 7, Average Loss: 0.0002
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 84.8571
Accuracy of cartoon model on test domain: 84.8571

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 0.7469
Epoch 2, Average Loss: 0.0441
Epoch 3, Average Loss: 0.0078
Epoch 4, Average Loss: 0.0196
Epoch 5, Average Loss: 0.0085
Epoch 6, Average Loss: 0.0015
Epoch 7, Average Loss: 0.0007
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 99.4286
Accuracy of art_painting model on test domain: 99.4286

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model art_painting device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.0033
Coefficient Epoch 2, Average Loss: 0.0000
Coefficient Epoch 3, Average Loss: 0.0507
Coefficient Epoch 4, Average Loss: 0.0002
Coefficient Epoch 5, Average Loss: 0.0048
Coefficient Epoch 6, Average Loss: 0.0001
Coefficient Epoch 7, Average Loss: 0.0001
Coefficient Epoch 8, Average Loss: 0.0000
Coefficient Epoch 9, Average Loss: 0.0000
Coefficient Epoch 10, Average Loss: 0.0000
Coefficient Epoch 11, Average Loss: 0.0000
Coefficient Epoch 12, Average Loss: 0.0000
Coefficient Epoch 13, Average Loss: 0.0000
Coefficient Epoch 14, Average Loss: 0.0000
Coefficient Epoch 15, Average Loss: 0.0000
Final device check:
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.023314155638217926, 0.0456271655857563, 0.9310587048530579]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 99.4286
Final model accuracy on test domain: 99.4286

Run 3/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: cartoon
Training domains: ['sketch', 'photo', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 6.5260
Epoch 2, Average Loss: 2.6494
Epoch 3, Average Loss: 2.0169
Epoch 4, Average Loss: 1.9428
Epoch 5, Average Loss: 1.9600
Epoch 6, Average Loss: 1.8445
Epoch 7, Average Loss: 1.8037
Epoch 8, Average Loss: 1.6316
Epoch 9, Average Loss: 1.5542
Epoch 10, Average Loss: 1.4473
Epoch 11, Average Loss: 1.4039
Epoch 12, Average Loss: 1.3489
Epoch 13, Average Loss: 1.2454
Epoch 14, Average Loss: 1.4316
Epoch 15, Average Loss: 1.3401
Accuracy: 40.2857
Training domains: ['sketch', 'photo', 'art_painting']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.0502
Epoch 2, Average Loss: 0.3499
Epoch 3, Average Loss: 0.1509
Epoch 4, Average Loss: 0.0240
Epoch 5, Average Loss: 0.0159
Epoch 6, Average Loss: 0.0057
Epoch 7, Average Loss: 0.0156
Epoch 8, Average Loss: 0.0140
Epoch 9, Average Loss: 0.0061
Epoch 10, Average Loss: 0.0031
Epoch 11, Average Loss: 0.0031
Epoch 12, Average Loss: 0.0242
Epoch 13, Average Loss: 0.0804
Epoch 14, Average Loss: 0.0774
Epoch 15, Average Loss: 0.0713
Merged model device: cuda:0
Accuracy: 70.5714
Accuracy of sketch model on test domain: 70.5714

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.3886
Epoch 2, Average Loss: 0.0273
Epoch 3, Average Loss: 0.0539
Epoch 4, Average Loss: 0.0088
Epoch 5, Average Loss: 0.0004
Epoch 6, Average Loss: 0.0001
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 55.4286
Accuracy of photo model on test domain: 55.4286

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 0.8086
Epoch 2, Average Loss: 0.0373
Epoch 3, Average Loss: 0.0022
Epoch 4, Average Loss: 0.0005
Epoch 5, Average Loss: 0.0002
Epoch 6, Average Loss: 0.0001
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 74.2857
Accuracy of art_painting model on test domain: 74.2857

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.7022
Coefficient Epoch 2, Average Loss: 1.2074
Coefficient Epoch 3, Average Loss: 0.7169
Coefficient Epoch 4, Average Loss: 0.6085
Coefficient Epoch 5, Average Loss: 0.6449
Coefficient Epoch 6, Average Loss: 0.6617
Coefficient Epoch 7, Average Loss: 0.7379
Coefficient Epoch 8, Average Loss: 0.8276
Coefficient Epoch 9, Average Loss: 0.6494
Coefficient Epoch 10, Average Loss: 0.7002
Coefficient Epoch 11, Average Loss: 0.7097
Coefficient Epoch 12, Average Loss: 0.8652
Coefficient Epoch 13, Average Loss: 0.6859
Coefficient Epoch 14, Average Loss: 0.6485
Coefficient Epoch 15, Average Loss: 0.6597
Final device check:
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.40634968876838684, 0.2611996829509735, 0.33245059847831726]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 77.1429
Final model accuracy on test domain: 77.1429

Run 4/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: cartoon
Training domains: ['sketch', 'photo', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.2294
Epoch 2, Average Loss: 2.0453
Epoch 3, Average Loss: 1.9132
Epoch 4, Average Loss: 1.8759
Epoch 5, Average Loss: 1.8157
Epoch 6, Average Loss: 1.7527
Epoch 7, Average Loss: 1.6622
Epoch 8, Average Loss: 1.5181
Epoch 9, Average Loss: 1.4305
Epoch 10, Average Loss: 1.4830
Epoch 11, Average Loss: 1.4832
Epoch 12, Average Loss: 1.2160
Epoch 13, Average Loss: 1.0314
Epoch 14, Average Loss: 1.0603
Epoch 15, Average Loss: 1.1674
Accuracy: 45.7143
Training domains: ['sketch', 'photo', 'art_painting']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.1212
Epoch 2, Average Loss: 0.4257
Epoch 3, Average Loss: 0.2061
Epoch 4, Average Loss: 0.0493
Epoch 5, Average Loss: 0.0186
Epoch 6, Average Loss: 0.0859
Epoch 7, Average Loss: 0.0294
Epoch 8, Average Loss: 0.0050
Epoch 9, Average Loss: 0.0101
Epoch 10, Average Loss: 0.0221
Epoch 11, Average Loss: 0.0056
Epoch 12, Average Loss: 0.0007
Epoch 13, Average Loss: 0.0003
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 73.1429
Accuracy of sketch model on test domain: 73.1429

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.3258
Epoch 2, Average Loss: 0.0247
Epoch 3, Average Loss: 0.0023
Epoch 4, Average Loss: 0.0001
Epoch 5, Average Loss: 0.0000
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0000
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 53.4286
Accuracy of photo model on test domain: 53.4286

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 0.6600
Epoch 2, Average Loss: 0.0343
Epoch 3, Average Loss: 0.0039
Epoch 4, Average Loss: 0.0093
Epoch 5, Average Loss: 0.0145
Epoch 6, Average Loss: 0.0036
Epoch 7, Average Loss: 0.0005
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 76.5714
Accuracy of art_painting model on test domain: 76.5714

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.2331
Coefficient Epoch 2, Average Loss: 2.3291
Coefficient Epoch 3, Average Loss: 0.9727
Coefficient Epoch 4, Average Loss: 0.8635
Coefficient Epoch 5, Average Loss: 0.7144
Coefficient Epoch 6, Average Loss: 0.7176
Coefficient Epoch 7, Average Loss: 0.7756
Coefficient Epoch 8, Average Loss: 0.6654
Coefficient Epoch 9, Average Loss: 0.6399
Coefficient Epoch 10, Average Loss: 0.6300
Coefficient Epoch 11, Average Loss: 0.6366
Coefficient Epoch 12, Average Loss: 0.6585
Coefficient Epoch 13, Average Loss: 0.7627
Coefficient Epoch 14, Average Loss: 0.6626
Coefficient Epoch 15, Average Loss: 0.6597
Final device check:
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3361507058143616, 0.30381274223327637, 0.36003655195236206]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 75.4286
Final model accuracy on test domain: 75.4286

Run 5/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: cartoon
Training domains: ['sketch', 'photo', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 5.8771
Epoch 2, Average Loss: 2.8961
Epoch 3, Average Loss: 2.2728
Epoch 4, Average Loss: 2.1436
Epoch 5, Average Loss: 2.2439
Epoch 6, Average Loss: 2.1812
Epoch 7, Average Loss: 2.1645
Epoch 8, Average Loss: 1.9887
Epoch 9, Average Loss: 1.9828
Epoch 10, Average Loss: 1.8747
Epoch 11, Average Loss: 1.8652
Epoch 12, Average Loss: 1.8774
Epoch 13, Average Loss: 1.8763
Epoch 14, Average Loss: 1.9084
Epoch 15, Average Loss: 1.8703
Accuracy: 24.2857
Training domains: ['sketch', 'photo', 'art_painting']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 0.9788
Epoch 2, Average Loss: 0.4725
Epoch 3, Average Loss: 0.1555
Epoch 4, Average Loss: 0.0517
Epoch 5, Average Loss: 0.0897
Epoch 6, Average Loss: 0.0550
Epoch 7, Average Loss: 0.0852
Epoch 8, Average Loss: 0.0403
Epoch 9, Average Loss: 0.0149
Epoch 10, Average Loss: 0.0013
Epoch 11, Average Loss: 0.0006
Epoch 12, Average Loss: 0.0002
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 71.4286
Accuracy of sketch model on test domain: 71.4286

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.3517
Epoch 2, Average Loss: 0.0227
Epoch 3, Average Loss: 0.0169
Epoch 4, Average Loss: 0.0071
Epoch 5, Average Loss: 0.0033
Epoch 6, Average Loss: 0.0254
Epoch 7, Average Loss: 0.0190
Epoch 8, Average Loss: 0.0158
Epoch 9, Average Loss: 0.0021
Epoch 10, Average Loss: 0.0007
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 36.8571
Accuracy of photo model on test domain: 36.8571

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 0.6653
Epoch 2, Average Loss: 0.0517
Epoch 3, Average Loss: 0.0146
Epoch 4, Average Loss: 0.0076
Epoch 5, Average Loss: 0.0102
Epoch 6, Average Loss: 0.0027
Epoch 7, Average Loss: 0.0003
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 76.8571
Accuracy of art_painting model on test domain: 76.8571

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.1947
Coefficient Epoch 2, Average Loss: 0.7590
Coefficient Epoch 3, Average Loss: 0.9808
Coefficient Epoch 4, Average Loss: 0.8780
Coefficient Epoch 5, Average Loss: 0.6824
Coefficient Epoch 6, Average Loss: 0.6576
Coefficient Epoch 7, Average Loss: 0.6519
Coefficient Epoch 8, Average Loss: 0.7234
Coefficient Epoch 9, Average Loss: 0.8528
Coefficient Epoch 10, Average Loss: 0.8068
Coefficient Epoch 11, Average Loss: 0.7484
Coefficient Epoch 12, Average Loss: 0.7019
Coefficient Epoch 13, Average Loss: 0.6360
Coefficient Epoch 14, Average Loss: 0.7073
Coefficient Epoch 15, Average Loss: 0.7400
Final device check:
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.37058785557746887, 0.3126329779624939, 0.316779226064682]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 72.0000
Final model accuracy on test domain: 72.0000

Run 6/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: art_painting
Training domains: ['sketch', 'cartoon', 'photo']
Test domain: art_painting
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.6688
Epoch 2, Average Loss: 2.1595
Epoch 3, Average Loss: 1.9974
Epoch 4, Average Loss: 2.0836
Epoch 5, Average Loss: 1.9368
Epoch 6, Average Loss: 2.0374
Epoch 7, Average Loss: 1.9505
Epoch 8, Average Loss: 1.8943
Epoch 9, Average Loss: 1.8615
Epoch 10, Average Loss: 1.8689
Epoch 11, Average Loss: 1.8949
Epoch 12, Average Loss: 1.7862
Epoch 13, Average Loss: 1.8141
Epoch 14, Average Loss: 1.8330
Epoch 15, Average Loss: 1.6262
Accuracy: 23.7143
Training domains: ['sketch', 'cartoon', 'photo']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.1548
Epoch 2, Average Loss: 0.4028
Epoch 3, Average Loss: 0.2480
Epoch 4, Average Loss: 0.1258
Epoch 5, Average Loss: 0.0169
Epoch 6, Average Loss: 0.0125
Epoch 7, Average Loss: 0.0021
Epoch 8, Average Loss: 0.0007
Epoch 9, Average Loss: 0.0004
Epoch 10, Average Loss: 0.0003
Epoch 11, Average Loss: 0.0002
Epoch 12, Average Loss: 0.0002
Epoch 13, Average Loss: 0.0002
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 57.4286
Accuracy of sketch model on test domain: 57.4286

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 0.7301
Epoch 2, Average Loss: 0.0892
Epoch 3, Average Loss: 0.0153
Epoch 4, Average Loss: 0.0028
Epoch 5, Average Loss: 0.0005
Epoch 6, Average Loss: 0.0002
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 86.8571
Accuracy of cartoon model on test domain: 86.8571

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.3277
Epoch 2, Average Loss: 0.0245
Epoch 3, Average Loss: 0.0013
Epoch 4, Average Loss: 0.0001
Epoch 5, Average Loss: 0.0000
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0000
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 74.8571
Accuracy of photo model on test domain: 74.8571

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.9599
Coefficient Epoch 2, Average Loss: 0.8004
Coefficient Epoch 3, Average Loss: 0.5327
Coefficient Epoch 4, Average Loss: 0.4280
Coefficient Epoch 5, Average Loss: 0.3534
Coefficient Epoch 6, Average Loss: 0.3647
Coefficient Epoch 7, Average Loss: 0.3788
Coefficient Epoch 8, Average Loss: 0.4971
Coefficient Epoch 9, Average Loss: 0.6271
Coefficient Epoch 10, Average Loss: 0.3861
Coefficient Epoch 11, Average Loss: 0.4186
Coefficient Epoch 12, Average Loss: 0.3657
Coefficient Epoch 13, Average Loss: 0.3222
Coefficient Epoch 14, Average Loss: 0.3705
Coefficient Epoch 15, Average Loss: 0.3475
Final device check:
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3782312870025635, 0.24932388961315155, 0.3724448084831238]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 83.7143
Final model accuracy on test domain: 83.7143

Run 7/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: cartoon
Training domains: ['sketch', 'photo', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.7771
Epoch 2, Average Loss: 1.9562
Epoch 3, Average Loss: 1.8592
Epoch 4, Average Loss: 1.7935
Epoch 5, Average Loss: 1.8077
Epoch 6, Average Loss: 1.7291
Epoch 7, Average Loss: 1.6322
Epoch 8, Average Loss: 1.5740
Epoch 9, Average Loss: 1.4604
Epoch 10, Average Loss: 1.3741
Epoch 11, Average Loss: 1.3183
Epoch 12, Average Loss: 1.1566
Epoch 13, Average Loss: 1.1788
Epoch 14, Average Loss: 1.1435
Epoch 15, Average Loss: 1.0101
Accuracy: 41.1429
Training domains: ['sketch', 'photo', 'art_painting']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.0462
Epoch 2, Average Loss: 0.3735
Epoch 3, Average Loss: 0.1390
Epoch 4, Average Loss: 0.0368
Epoch 5, Average Loss: 0.0082
Epoch 6, Average Loss: 0.0010
Epoch 7, Average Loss: 0.0004
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0002
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 64.0000
Accuracy of sketch model on test domain: 64.0000

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.3434
Epoch 2, Average Loss: 0.0142
Epoch 3, Average Loss: 0.0008
Epoch 4, Average Loss: 0.0083
Epoch 5, Average Loss: 0.0003
Epoch 6, Average Loss: 0.0001
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 50.2857
Accuracy of photo model on test domain: 50.2857

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 0.8469
Epoch 2, Average Loss: 0.0595
Epoch 3, Average Loss: 0.0184
Epoch 4, Average Loss: 0.0029
Epoch 5, Average Loss: 0.0003
Epoch 6, Average Loss: 0.0002
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 72.2857
Accuracy of art_painting model on test domain: 72.2857

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.1038
Coefficient Epoch 2, Average Loss: 1.7136
Coefficient Epoch 3, Average Loss: 1.1431
Coefficient Epoch 4, Average Loss: 0.6427
Coefficient Epoch 5, Average Loss: 0.5952
Coefficient Epoch 6, Average Loss: 0.5805
Coefficient Epoch 7, Average Loss: 0.6497
Coefficient Epoch 8, Average Loss: 0.6386
Coefficient Epoch 9, Average Loss: 0.6875
Coefficient Epoch 10, Average Loss: 0.8286
Coefficient Epoch 11, Average Loss: 0.6053
Coefficient Epoch 12, Average Loss: 0.5557
Coefficient Epoch 13, Average Loss: 0.5343
Coefficient Epoch 14, Average Loss: 0.5617
Coefficient Epoch 15, Average Loss: 0.6069
Final device check:
Expert model sketch device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.4262916147708893, 0.17322584986686707, 0.4004824757575989]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 76.0000
Final model accuracy on test domain: 76.0000

Run 8/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: photo
Training domains: ['sketch', 'cartoon', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 5.5382
Epoch 2, Average Loss: 2.6105
Epoch 3, Average Loss: 2.2714
Epoch 4, Average Loss: 2.1133
Epoch 5, Average Loss: 1.9862
Epoch 6, Average Loss: 1.9833
Epoch 7, Average Loss: 1.9942
Epoch 8, Average Loss: 2.0590
Epoch 9, Average Loss: 2.1088
Epoch 10, Average Loss: 1.9816
Epoch 11, Average Loss: 1.9574
Epoch 12, Average Loss: 1.9267
Epoch 13, Average Loss: 1.9577
Epoch 14, Average Loss: 2.0548
Epoch 15, Average Loss: 2.0747
Accuracy: 14.8571
Training domains: ['sketch', 'cartoon', 'art_painting']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.0496
Epoch 2, Average Loss: 0.4069
Epoch 3, Average Loss: 0.1816
Epoch 4, Average Loss: 0.0586
Epoch 5, Average Loss: 0.0158
Epoch 6, Average Loss: 0.0051
Epoch 7, Average Loss: 0.0035
Epoch 8, Average Loss: 0.0010
Epoch 9, Average Loss: 0.0006
Epoch 10, Average Loss: 0.0002
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 65.4286
Accuracy of sketch model on test domain: 65.4286

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 0.7455
Epoch 2, Average Loss: 0.0958
Epoch 3, Average Loss: 0.0186
Epoch 4, Average Loss: 0.0030
Epoch 5, Average Loss: 0.0035
Epoch 6, Average Loss: 0.0012
Epoch 7, Average Loss: 0.0002
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 87.4286
Accuracy of cartoon model on test domain: 87.4286

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 0.7153
Epoch 2, Average Loss: 0.0259
Epoch 3, Average Loss: 0.0196
Epoch 4, Average Loss: 0.0253
Epoch 5, Average Loss: 0.0099
Epoch 6, Average Loss: 0.0064
Epoch 7, Average Loss: 0.0109
Epoch 8, Average Loss: 0.0006
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 99.4286
Accuracy of art_painting model on test domain: 99.4286

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model art_painting device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.2119
Coefficient Epoch 2, Average Loss: 0.1583
Coefficient Epoch 3, Average Loss: 0.1807
Coefficient Epoch 4, Average Loss: 0.1493
Coefficient Epoch 5, Average Loss: 0.0763
Coefficient Epoch 6, Average Loss: 0.0705
Coefficient Epoch 7, Average Loss: 0.0772
Coefficient Epoch 8, Average Loss: 0.1057
Coefficient Epoch 9, Average Loss: 0.1020
Coefficient Epoch 10, Average Loss: 0.0477
Coefficient Epoch 11, Average Loss: 0.0856
Coefficient Epoch 12, Average Loss: 0.0691
Coefficient Epoch 13, Average Loss: 0.0456
Coefficient Epoch 14, Average Loss: 0.0391
Coefficient Epoch 15, Average Loss: 0.0649
Final device check:
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.2112341970205307, 0.1941717267036438, 0.5945940613746643]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 99.7143
Final model accuracy on test domain: 99.7143

Run 9/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: art_painting
Training domains: ['sketch', 'cartoon', 'photo']
Test domain: art_painting
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.4097
Epoch 2, Average Loss: 2.5625
Epoch 3, Average Loss: 2.0870
Epoch 4, Average Loss: 1.9989
Epoch 5, Average Loss: 1.9544
Epoch 6, Average Loss: 1.9948
Epoch 7, Average Loss: 1.9040
Epoch 8, Average Loss: 1.9308
Epoch 9, Average Loss: 1.8637
Epoch 10, Average Loss: 1.8023
Epoch 11, Average Loss: 1.7446
Epoch 12, Average Loss: 1.8081
Epoch 13, Average Loss: 1.7244
Epoch 14, Average Loss: 1.7638
Epoch 15, Average Loss: 1.6613
Accuracy: 24.8571
Training domains: ['sketch', 'cartoon', 'photo']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.1012
Epoch 2, Average Loss: 0.4211
Epoch 3, Average Loss: 0.2039
Epoch 4, Average Loss: 0.1262
Epoch 5, Average Loss: 0.0403
Epoch 6, Average Loss: 0.0224
Epoch 7, Average Loss: 0.0036
Epoch 8, Average Loss: 0.0005
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 61.7143
Accuracy of sketch model on test domain: 61.7143

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 0.7289
Epoch 2, Average Loss: 0.0978
Epoch 3, Average Loss: 0.0234
Epoch 4, Average Loss: 0.0302
Epoch 5, Average Loss: 0.0036
Epoch 6, Average Loss: 0.0004
Epoch 7, Average Loss: 0.0002
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 84.8571
Accuracy of cartoon model on test domain: 84.8571

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.2980
Epoch 2, Average Loss: 0.0084
Epoch 3, Average Loss: 0.0156
Epoch 4, Average Loss: 0.0051
Epoch 5, Average Loss: 0.0028
Epoch 6, Average Loss: 0.0016
Epoch 7, Average Loss: 0.0020
Epoch 8, Average Loss: 0.0004
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 71.4286
Accuracy of photo model on test domain: 71.4286

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.4478
Coefficient Epoch 2, Average Loss: 1.8835
Coefficient Epoch 3, Average Loss: 1.3242
Coefficient Epoch 4, Average Loss: 0.5314
Coefficient Epoch 5, Average Loss: 0.4632
Coefficient Epoch 6, Average Loss: 0.4256
Coefficient Epoch 7, Average Loss: 0.4376
Coefficient Epoch 8, Average Loss: 0.4590
Coefficient Epoch 9, Average Loss: 0.4419
Coefficient Epoch 10, Average Loss: 0.4407
Coefficient Epoch 11, Average Loss: 0.4231
Coefficient Epoch 12, Average Loss: 0.5061
Coefficient Epoch 13, Average Loss: 0.6399
Coefficient Epoch 14, Average Loss: 0.4858
Coefficient Epoch 15, Average Loss: 0.4719
Final device check:
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3937057554721832, 0.3172261416912079, 0.2890680730342865]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 86.5714
Final model accuracy on test domain: 86.5714

Run 10/10
Preparing data...
Domains: ['sketch', 'cartoon', 'photo', 'art_painting']
Selected test domain: art_painting
Training domains: ['sketch', 'cartoon', 'photo']
Test domain: art_painting
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 3.8050
Epoch 2, Average Loss: 2.1424
Epoch 3, Average Loss: 2.0106
Epoch 4, Average Loss: 1.9052
Epoch 5, Average Loss: 1.8900
Epoch 6, Average Loss: 1.8567
Epoch 7, Average Loss: 1.8104
Epoch 8, Average Loss: 1.8027
Epoch 9, Average Loss: 1.8064
Epoch 10, Average Loss: 1.7510
Epoch 11, Average Loss: 1.6362
Epoch 12, Average Loss: 1.6765
Epoch 13, Average Loss: 1.5351
Epoch 14, Average Loss: 1.4584
Epoch 15, Average Loss: 1.3630
Accuracy: 28.2857
Training domains: ['sketch', 'cartoon', 'photo']

Training expert models...

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.1138
Epoch 2, Average Loss: 0.4793
Epoch 3, Average Loss: 0.1857
Epoch 4, Average Loss: 0.0764
Epoch 5, Average Loss: 0.0627
Epoch 6, Average Loss: 0.0329
Epoch 7, Average Loss: 0.0105
Epoch 8, Average Loss: 0.0077
Epoch 9, Average Loss: 0.0008
Epoch 10, Average Loss: 0.0003
Epoch 11, Average Loss: 0.0002
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0001
Merged model device: cuda:0
Accuracy: 58.0000
Accuracy of sketch model on test domain: 58.0000

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 0.8418
Epoch 2, Average Loss: 0.0703
Epoch 3, Average Loss: 0.0222
Epoch 4, Average Loss: 0.0035
Epoch 5, Average Loss: 0.0009
Epoch 6, Average Loss: 0.0002
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Epoch 11, Average Loss: 0.0001
Epoch 12, Average Loss: 0.0001
Epoch 13, Average Loss: 0.0001
Epoch 14, Average Loss: 0.0001
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 80.0000
Accuracy of cartoon model on test domain: 80.0000

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 0.3888
Epoch 2, Average Loss: 0.0068
Epoch 3, Average Loss: 0.0027
Epoch 4, Average Loss: 0.0128
Epoch 5, Average Loss: 0.0071
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Epoch 11, Average Loss: 0.0000
Epoch 12, Average Loss: 0.0000
Epoch 13, Average Loss: 0.0000
Epoch 14, Average Loss: 0.0000
Epoch 15, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 73.1429
Accuracy of photo model on test domain: 73.1429

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.2289
Coefficient Epoch 2, Average Loss: 1.6757
Coefficient Epoch 3, Average Loss: 1.3295
Coefficient Epoch 4, Average Loss: 0.5537
Coefficient Epoch 5, Average Loss: 0.4020
Coefficient Epoch 6, Average Loss: 0.3742
Coefficient Epoch 7, Average Loss: 0.4116
Coefficient Epoch 8, Average Loss: 0.3667
Coefficient Epoch 9, Average Loss: 0.3913
Coefficient Epoch 10, Average Loss: 0.3446
Coefficient Epoch 11, Average Loss: 0.4038
Coefficient Epoch 12, Average Loss: 0.3372
Coefficient Epoch 13, Average Loss: 0.3301
Coefficient Epoch 14, Average Loss: 0.3317
Coefficient Epoch 15, Average Loss: 0.3922
Final device check:
Expert model sketch device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Coefficient training complete.
Learned coefficients: [0.4024106562137604, 0.2760889232158661, 0.32150039076805115]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 79.7143
Final model accuracy on test domain: 79.7143

Summary for PACS:
Debug: Type of results: <class 'list'>
Debug: Content of results: [{'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 73.42857142857143, 'cartoon': 85.14285714285714, 'photo': 80.85714285714286}, 'final_accuracy': 87.42857142857143, 'coefficients': [0.4561712145805359, 0.2317558377981186, 0.3120729327201843]}, {'test_domain': 'photo', 'domain_accuracies': {'sketch': 76.0, 'cartoon': 84.85714285714285, 'art_painting': 99.42857142857143}, 'final_accuracy': 99.42857142857143, 'coefficients': [0.023314155638217926, 0.0456271655857563, 0.9310587048530579]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 70.57142857142857, 'photo': 55.42857142857143, 'art_painting': 74.28571428571429}, 'final_accuracy': 77.14285714285715, 'coefficients': [0.40634968876838684, 0.2611996829509735, 0.33245059847831726]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 73.14285714285714, 'photo': 53.42857142857142, 'art_painting': 76.57142857142857}, 'final_accuracy': 75.42857142857143, 'coefficients': [0.3361507058143616, 0.30381274223327637, 0.36003655195236206]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 71.42857142857143, 'photo': 36.857142857142854, 'art_painting': 76.85714285714286}, 'final_accuracy': 72.0, 'coefficients': [0.37058785557746887, 0.3126329779624939, 0.316779226064682]}, {'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 57.42857142857143, 'cartoon': 86.85714285714286, 'photo': 74.85714285714286}, 'final_accuracy': 83.71428571428572, 'coefficients': [0.3782312870025635, 0.24932388961315155, 0.3724448084831238]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 64.0, 'photo': 50.28571428571429, 'art_painting': 72.28571428571429}, 'final_accuracy': 76.0, 'coefficients': [0.4262916147708893, 0.17322584986686707, 0.4004824757575989]}, {'test_domain': 'photo', 'domain_accuracies': {'sketch': 65.42857142857143, 'cartoon': 87.42857142857143, 'art_painting': 99.42857142857143}, 'final_accuracy': 99.71428571428571, 'coefficients': [0.2112341970205307, 0.1941717267036438, 0.5945940613746643]}, {'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 61.71428571428571, 'cartoon': 84.85714285714285, 'photo': 71.42857142857143}, 'final_accuracy': 86.57142857142858, 'coefficients': [0.3937057554721832, 0.3172261416912079, 0.2890680730342865]}, {'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 57.99999999999999, 'cartoon': 80.0, 'photo': 73.14285714285714}, 'final_accuracy': 79.71428571428572, 'coefficients': [0.4024106562137604, 0.2760889232158661, 0.32150039076805115]}]
Final Model Accuracy: 83.7143 ± 9.2167
Domain-specific Accuracies:
  sketch: 67.1143 ± 6.3586
  cartoon: 84.8571 ± 2.3905
  photo: 62.0357 ± 14.2302
  art_painting: 83.1429 ± 11.6151
Average Coefficients:
  Coefficient 1: 0.3404 ± 0.1230
  Coefficient 2: 0.2365 ± 0.0784
  Coefficient 3: 0.4230 ± 0.1883
Debug: Type of results: <class 'dict'>
Debug: Content of results: {'PACS': [{'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 73.42857142857143, 'cartoon': 85.14285714285714, 'photo': 80.85714285714286}, 'final_accuracy': 87.42857142857143, 'coefficients': [0.4561712145805359, 0.2317558377981186, 0.3120729327201843]}, {'test_domain': 'photo', 'domain_accuracies': {'sketch': 76.0, 'cartoon': 84.85714285714285, 'art_painting': 99.42857142857143}, 'final_accuracy': 99.42857142857143, 'coefficients': [0.023314155638217926, 0.0456271655857563, 0.9310587048530579]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 70.57142857142857, 'photo': 55.42857142857143, 'art_painting': 74.28571428571429}, 'final_accuracy': 77.14285714285715, 'coefficients': [0.40634968876838684, 0.2611996829509735, 0.33245059847831726]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 73.14285714285714, 'photo': 53.42857142857142, 'art_painting': 76.57142857142857}, 'final_accuracy': 75.42857142857143, 'coefficients': [0.3361507058143616, 0.30381274223327637, 0.36003655195236206]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 71.42857142857143, 'photo': 36.857142857142854, 'art_painting': 76.85714285714286}, 'final_accuracy': 72.0, 'coefficients': [0.37058785557746887, 0.3126329779624939, 0.316779226064682]}, {'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 57.42857142857143, 'cartoon': 86.85714285714286, 'photo': 74.85714285714286}, 'final_accuracy': 83.71428571428572, 'coefficients': [0.3782312870025635, 0.24932388961315155, 0.3724448084831238]}, {'test_domain': 'cartoon', 'domain_accuracies': {'sketch': 64.0, 'photo': 50.28571428571429, 'art_painting': 72.28571428571429}, 'final_accuracy': 76.0, 'coefficients': [0.4262916147708893, 0.17322584986686707, 0.4004824757575989]}, {'test_domain': 'photo', 'domain_accuracies': {'sketch': 65.42857142857143, 'cartoon': 87.42857142857143, 'art_painting': 99.42857142857143}, 'final_accuracy': 99.71428571428571, 'coefficients': [0.2112341970205307, 0.1941717267036438, 0.5945940613746643]}, {'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 61.71428571428571, 'cartoon': 84.85714285714285, 'photo': 71.42857142857143}, 'final_accuracy': 86.57142857142858, 'coefficients': [0.3937057554721832, 0.3172261416912079, 0.2890680730342865]}, {'test_domain': 'art_painting', 'domain_accuracies': {'sketch': 57.99999999999999, 'cartoon': 80.0, 'photo': 73.14285714285714}, 'final_accuracy': 79.71428571428572, 'coefficients': [0.4024106562137604, 0.2760889232158661, 0.32150039076805115]}]}
No valid results to summarize.
