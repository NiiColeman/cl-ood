
--- Run 1/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: photo
Training domains: ['art_painting', 'cartoon', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: photo
Train domains: ['art_painting', 'cartoon', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.9815, Train Accuracy: 42.86%
Val Loss: 2.1178, Val Accuracy: 17.46%
Epoch 2/10, Train Loss: 1.1514, Train Accuracy: 71.43%
Val Loss: 2.0733, Val Accuracy: 20.63%
Epoch 3/10, Train Loss: 0.6454, Train Accuracy: 100.00%
Val Loss: 2.0500, Val Accuracy: 25.40%
Epoch 4/10, Train Loss: 0.3763, Train Accuracy: 100.00%
Val Loss: 2.0367, Val Accuracy: 25.40%
Epoch 5/10, Train Loss: 0.2156, Train Accuracy: 100.00%
Val Loss: 2.0245, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 0.1185, Train Accuracy: 100.00%
Val Loss: 2.0179, Val Accuracy: 30.16%
Epoch 7/10, Train Loss: 0.0616, Train Accuracy: 100.00%
Val Loss: 2.0174, Val Accuracy: 31.75%
Epoch 8/10, Train Loss: 0.0321, Train Accuracy: 100.00%
Val Loss: 2.0202, Val Accuracy: 31.75%
Epoch 9/10, Train Loss: 0.0170, Train Accuracy: 100.00%
Val Loss: 2.0272, Val Accuracy: 33.33%
Epoch 10/10, Train Loss: 0.0093, Train Accuracy: 100.00%
Val Loss: 2.0369, Val Accuracy: 33.33%
Baseline Model - Final Test Loss: 2.0272, Test Accuracy: 33.33%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.2761, Train Accuracy: 16.07%
Val Loss: 1.9635, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.1709, Train Accuracy: 19.64%
Val Loss: 1.9535, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 2.0644, Train Accuracy: 19.64%
Val Loss: 1.9434, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.9627, Train Accuracy: 21.43%
Val Loss: 1.9340, Val Accuracy: 21.43%
Epoch 5/10, Train Loss: 1.8842, Train Accuracy: 30.36%
Val Loss: 1.9279, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.7940, Train Accuracy: 33.93%
Val Loss: 1.9223, Val Accuracy: 21.43%
Epoch 7/10, Train Loss: 1.6973, Train Accuracy: 35.71%
Val Loss: 1.9177, Val Accuracy: 21.43%
Epoch 8/10, Train Loss: 1.5767, Train Accuracy: 42.86%
Val Loss: 1.9121, Val Accuracy: 21.43%
Epoch 9/10, Train Loss: 1.5108, Train Accuracy: 51.79%
Val Loss: 1.9055, Val Accuracy: 14.29%
Epoch 10/10, Train Loss: 1.4016, Train Accuracy: 55.36%
Val Loss: 1.9022, Val Accuracy: 21.43%
art_painting adapter trained. Validation Accuracy: 21.43%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3822, Train Accuracy: 12.50%
Val Loss: 2.3814, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.2233, Train Accuracy: 12.50%
Val Loss: 2.3081, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 2.1461, Train Accuracy: 14.29%
Val Loss: 2.2590, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 2.0670, Train Accuracy: 12.50%
Val Loss: 2.2168, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 1.9764, Train Accuracy: 12.50%
Val Loss: 2.1703, Val Accuracy: 14.29%
Epoch 6/10, Train Loss: 1.9083, Train Accuracy: 14.29%
Val Loss: 2.1259, Val Accuracy: 14.29%
Epoch 7/10, Train Loss: 1.8230, Train Accuracy: 17.86%
Val Loss: 2.0967, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.7578, Train Accuracy: 21.43%
Val Loss: 2.0720, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.6817, Train Accuracy: 30.36%
Val Loss: 2.0550, Val Accuracy: 21.43%
Epoch 10/10, Train Loss: 1.6044, Train Accuracy: 35.71%
Val Loss: 2.0436, Val Accuracy: 21.43%
cartoon adapter trained. Validation Accuracy: 21.43%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.2373, Train Accuracy: 19.64%
Val Loss: 2.0729, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 2.0583, Train Accuracy: 17.86%
Val Loss: 1.9488, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 1.9523, Train Accuracy: 21.43%
Val Loss: 1.8445, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.8190, Train Accuracy: 26.79%
Val Loss: 1.7604, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.6917, Train Accuracy: 37.50%
Val Loss: 1.6857, Val Accuracy: 42.86%
Epoch 6/10, Train Loss: 1.6049, Train Accuracy: 41.07%
Val Loss: 1.6256, Val Accuracy: 42.86%
Epoch 7/10, Train Loss: 1.5354, Train Accuracy: 48.21%
Val Loss: 1.5785, Val Accuracy: 21.43%
Epoch 8/10, Train Loss: 1.4977, Train Accuracy: 48.21%
Val Loss: 1.5367, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.4621, Train Accuracy: 53.57%
Val Loss: 1.4989, Val Accuracy: 42.86%
Epoch 10/10, Train Loss: 1.3580, Train Accuracy: 57.14%
Val Loss: 1.4561, Val Accuracy: 35.71%
sketch adapter trained. Validation Accuracy: 42.86%

Training coefficients for adapter merging
Initial coefficients: [0.33517542 0.3314434  0.33338118]
Epoch 1, Loss: 1.9709, Accuracy: 42.86%
Coefficients: [0.10707904 0.10596214 0.7869588 ]
Epoch 2, Loss: 1.9704, Accuracy: 42.86%
Coefficients: [0.06624429 0.17978178 0.7539739 ]
Epoch 3, Loss: 1.9686, Accuracy: 42.86%
Coefficients: [0.03704436 0.09076063 0.87219495]
Epoch 4, Loss: 1.9697, Accuracy: 42.86%
Coefficients: [0.02190361 0.06302745 0.91506904]
Epoch 5, Loss: 1.9671, Accuracy: 42.86%
Coefficients: [0.01157567 0.0350382  0.95338625]
Epoch 6, Loss: 1.9704, Accuracy: 42.86%
Coefficients: [0.00627631 0.01753803 0.9761856 ]
Epoch 7, Loss: 1.9736, Accuracy: 42.86%
Coefficients: [0.00374294 0.0096826  0.9865745 ]
Epoch 8, Loss: 1.9712, Accuracy: 42.86%
Coefficients: [0.00237939 0.00560855 0.99201196]
Epoch 9, Loss: 1.9738, Accuracy: 42.86%
Coefficients: [0.00159732 0.00346632 0.99493635]
Epoch 10, Loss: 1.9701, Accuracy: 42.86%
Coefficients: [0.00112633 0.00226792 0.99660563]
Best coefficient accuracy: 42.86%
Final best coefficients: [0.10707904 0.10596214 0.7869588 ]

Merged model - Test Loss: 2.1760, Test Accuracy: 15.87%

Single Run Summary:
Test Domain: photo
Domain Accuracies:
  art_painting: 21.43%
  cartoon: 21.43%
  sketch: 42.86%
Final Accuracy: 15.87%
Coefficients: ['0.1071', '0.1060', '0.7870']

--- Run 2/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: cartoon
Training domains: ['art_painting', 'photo', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: cartoon
Train domains: ['art_painting', 'photo', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.2367, Train Accuracy: 14.29%
Val Loss: 2.2775, Val Accuracy: 3.17%
Epoch 2/10, Train Loss: 2.2136, Train Accuracy: 14.29%
Val Loss: 2.2752, Val Accuracy: 4.76%
Epoch 3/10, Train Loss: 2.1887, Train Accuracy: 14.29%
Val Loss: 2.2730, Val Accuracy: 4.76%
Epoch 4/10, Train Loss: 2.1614, Train Accuracy: 14.29%
Val Loss: 2.2708, Val Accuracy: 4.76%
Epoch 5/10, Train Loss: 2.1402, Train Accuracy: 14.29%
Val Loss: 2.2689, Val Accuracy: 4.76%
Epoch 6/10, Train Loss: 2.1132, Train Accuracy: 14.29%
Val Loss: 2.2672, Val Accuracy: 4.76%
Epoch 7/10, Train Loss: 2.0902, Train Accuracy: 14.29%
Val Loss: 2.2657, Val Accuracy: 4.76%
Epoch 8/10, Train Loss: 2.0805, Train Accuracy: 14.29%
Val Loss: 2.2642, Val Accuracy: 4.76%
Epoch 9/10, Train Loss: 2.0507, Train Accuracy: 14.29%
Val Loss: 2.2629, Val Accuracy: 4.76%
Epoch 10/10, Train Loss: 2.0230, Train Accuracy: 14.29%
Val Loss: 2.2617, Val Accuracy: 4.76%
Baseline Model - Final Test Loss: 2.2752, Test Accuracy: 4.76%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.2626, Train Accuracy: 14.29%
Val Loss: 2.0699, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 2.1469, Train Accuracy: 16.07%
Val Loss: 2.0432, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 2.0456, Train Accuracy: 21.43%
Val Loss: 2.0114, Val Accuracy: 28.57%
Epoch 4/10, Train Loss: 1.9844, Train Accuracy: 21.43%
Val Loss: 1.9759, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.9041, Train Accuracy: 23.21%
Val Loss: 1.9414, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.8022, Train Accuracy: 26.79%
Val Loss: 1.9054, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.7041, Train Accuracy: 32.14%
Val Loss: 1.8660, Val Accuracy: 42.86%
Epoch 8/10, Train Loss: 1.5998, Train Accuracy: 41.07%
Val Loss: 1.8261, Val Accuracy: 42.86%
Epoch 9/10, Train Loss: 1.4964, Train Accuracy: 53.57%
Val Loss: 1.7904, Val Accuracy: 42.86%
Epoch 10/10, Train Loss: 1.4083, Train Accuracy: 60.71%
Val Loss: 1.7549, Val Accuracy: 42.86%
art_painting adapter trained. Validation Accuracy: 42.86%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.2488, Train Accuracy: 17.86%
Val Loss: 1.9071, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.1453, Train Accuracy: 17.86%
Val Loss: 1.8864, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 2.0899, Train Accuracy: 21.43%
Val Loss: 1.8681, Val Accuracy: 28.57%
Epoch 4/10, Train Loss: 2.0073, Train Accuracy: 21.43%
Val Loss: 1.8478, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.9275, Train Accuracy: 21.43%
Val Loss: 1.8265, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.8430, Train Accuracy: 23.21%
Val Loss: 1.8049, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.7749, Train Accuracy: 28.57%
Val Loss: 1.7835, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.6976, Train Accuracy: 37.50%
Val Loss: 1.7539, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.6145, Train Accuracy: 41.07%
Val Loss: 1.7146, Val Accuracy: 35.71%
Epoch 10/10, Train Loss: 1.5357, Train Accuracy: 48.21%
Val Loss: 1.6685, Val Accuracy: 35.71%
photo adapter trained. Validation Accuracy: 35.71%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.1363, Train Accuracy: 25.00%
Val Loss: 2.3684, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.0153, Train Accuracy: 23.21%
Val Loss: 2.2534, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.8548, Train Accuracy: 23.21%
Val Loss: 2.1501, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.7497, Train Accuracy: 30.36%
Val Loss: 2.0702, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.6391, Train Accuracy: 39.29%
Val Loss: 1.9937, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.5668, Train Accuracy: 44.64%
Val Loss: 1.9264, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.4879, Train Accuracy: 48.21%
Val Loss: 1.8638, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.4396, Train Accuracy: 55.36%
Val Loss: 1.8079, Val Accuracy: 21.43%
Epoch 9/10, Train Loss: 1.3733, Train Accuracy: 51.79%
Val Loss: 1.7452, Val Accuracy: 21.43%
Epoch 10/10, Train Loss: 1.3581, Train Accuracy: 57.14%
Val Loss: 1.6924, Val Accuracy: 28.57%
sketch adapter trained. Validation Accuracy: 28.57%

Training coefficients for adapter merging
Initial coefficients: [0.33463806 0.33448213 0.33087978]
Epoch 1, Loss: 2.2836, Accuracy: 0.00%
Coefficients: [0.4708019  0.06368843 0.46550962]
Epoch 2, Loss: 2.2920, Accuracy: 0.00%
Coefficients: [0.21244088 0.02466869 0.7628904 ]
Epoch 3, Loss: 2.2901, Accuracy: 0.00%
Coefficients: [0.0539466  0.00806506 0.93798834]
Epoch 4, Loss: 2.2890, Accuracy: 0.00%
Coefficients: [0.01331587 0.00274194 0.9839422 ]
Epoch 5, Loss: 2.2854, Accuracy: 0.00%
Coefficients: [0.00394865 0.00106017 0.99499124]
Epoch 6, Loss: 2.2926, Accuracy: 0.00%
Coefficients: [1.4034003e-03 4.6827100e-04 9.9812824e-01]
Epoch 7, Loss: 2.2839, Accuracy: 0.00%
Coefficients: [5.5892376e-04 2.2649672e-04 9.9921465e-01]
Epoch 8, Loss: 2.2842, Accuracy: 0.00%
Coefficients: [2.4785925e-04 1.1916680e-04 9.9963295e-01]
Epoch 9, Loss: 2.2894, Accuracy: 0.00%
Coefficients: [1.20348515e-04 6.73812756e-05 9.99812305e-01]
Epoch 10, Loss: 2.2927, Accuracy: 0.00%
Coefficients: [6.316685e-05 4.052255e-05 9.998963e-01]
Best coefficient accuracy: 0.00%
Final best coefficients: [0.33463806 0.33448213 0.33087978]

Merged model - Test Loss: 2.2713, Test Accuracy: 4.76%

Single Run Summary:
Test Domain: cartoon
Domain Accuracies:
  art_painting: 42.86%
  photo: 35.71%
  sketch: 28.57%
Final Accuracy: 4.76%
Coefficients: ['0.3346', '0.3345', '0.3309']

--- Run 3/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: sketch
Training domains: ['art_painting', 'cartoon', 'photo']

Running LoRA with Separate Classifiers experiment
Test domain: sketch
Train domains: ['art_painting', 'cartoon', 'photo']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.3771, Train Accuracy: 42.86%
Val Loss: 1.3647, Val Accuracy: 53.97%
Epoch 2/10, Train Loss: 1.3662, Train Accuracy: 42.86%
Val Loss: 1.3644, Val Accuracy: 53.97%
Epoch 3/10, Train Loss: 1.3488, Train Accuracy: 42.86%
Val Loss: 1.3641, Val Accuracy: 53.97%
Epoch 4/10, Train Loss: 1.3329, Train Accuracy: 57.14%
Val Loss: 1.3639, Val Accuracy: 52.38%
Epoch 5/10, Train Loss: 1.3160, Train Accuracy: 57.14%
Val Loss: 1.3637, Val Accuracy: 50.79%
Epoch 6/10, Train Loss: 1.3039, Train Accuracy: 57.14%
Val Loss: 1.3636, Val Accuracy: 50.79%
Epoch 7/10, Train Loss: 1.2944, Train Accuracy: 57.14%
Val Loss: 1.3635, Val Accuracy: 50.79%
Epoch 8/10, Train Loss: 1.2757, Train Accuracy: 57.14%
Val Loss: 1.3635, Val Accuracy: 50.79%
Epoch 9/10, Train Loss: 1.2700, Train Accuracy: 57.14%
Val Loss: 1.3635, Val Accuracy: 50.79%
Epoch 10/10, Train Loss: 1.2433, Train Accuracy: 57.14%
Val Loss: 1.3635, Val Accuracy: 50.79%
Baseline Model - Final Test Loss: 1.3647, Test Accuracy: 53.97%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.1885, Train Accuracy: 21.43%
Val Loss: 2.3173, Val Accuracy: 0.00%
Epoch 2/10, Train Loss: 2.1065, Train Accuracy: 26.79%
Val Loss: 2.2828, Val Accuracy: 0.00%
Epoch 3/10, Train Loss: 1.9711, Train Accuracy: 26.79%
Val Loss: 2.2544, Val Accuracy: 0.00%
Epoch 4/10, Train Loss: 1.9181, Train Accuracy: 30.36%
Val Loss: 2.2287, Val Accuracy: 0.00%
Epoch 5/10, Train Loss: 1.8000, Train Accuracy: 39.29%
Val Loss: 2.2115, Val Accuracy: 0.00%
Epoch 6/10, Train Loss: 1.7131, Train Accuracy: 39.29%
Val Loss: 2.2034, Val Accuracy: 0.00%
Epoch 7/10, Train Loss: 1.6019, Train Accuracy: 42.86%
Val Loss: 2.1742, Val Accuracy: 0.00%
Epoch 8/10, Train Loss: 1.5138, Train Accuracy: 42.86%
Val Loss: 2.1416, Val Accuracy: 7.14%
Epoch 9/10, Train Loss: 1.4424, Train Accuracy: 46.43%
Val Loss: 2.1050, Val Accuracy: 14.29%
Epoch 10/10, Train Loss: 1.3478, Train Accuracy: 51.79%
Val Loss: 2.0689, Val Accuracy: 14.29%
art_painting adapter trained. Validation Accuracy: 14.29%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3887, Train Accuracy: 10.71%
Val Loss: 2.2610, Val Accuracy: 14.29%
Epoch 2/10, Train Loss: 2.2627, Train Accuracy: 10.71%
Val Loss: 2.2268, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 2.1578, Train Accuracy: 12.50%
Val Loss: 2.1951, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 2.0580, Train Accuracy: 14.29%
Val Loss: 2.1587, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 1.9687, Train Accuracy: 14.29%
Val Loss: 2.1271, Val Accuracy: 14.29%
Epoch 6/10, Train Loss: 1.8768, Train Accuracy: 17.86%
Val Loss: 2.0963, Val Accuracy: 14.29%
Epoch 7/10, Train Loss: 1.7982, Train Accuracy: 19.64%
Val Loss: 2.0696, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.7015, Train Accuracy: 28.57%
Val Loss: 2.0445, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.6126, Train Accuracy: 33.93%
Val Loss: 2.0246, Val Accuracy: 14.29%
Epoch 10/10, Train Loss: 1.5585, Train Accuracy: 42.86%
Val Loss: 2.0091, Val Accuracy: 14.29%
cartoon adapter trained. Validation Accuracy: 14.29%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1017, Train Accuracy: 17.86%
Val Loss: 2.4013, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.0240, Train Accuracy: 19.64%
Val Loss: 2.3549, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 1.9810, Train Accuracy: 21.43%
Val Loss: 2.3116, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.9101, Train Accuracy: 23.21%
Val Loss: 2.2662, Val Accuracy: 21.43%
Epoch 5/10, Train Loss: 1.8225, Train Accuracy: 23.21%
Val Loss: 2.2209, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.7674, Train Accuracy: 28.57%
Val Loss: 2.1730, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.6921, Train Accuracy: 35.71%
Val Loss: 2.1185, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.6163, Train Accuracy: 41.07%
Val Loss: 2.0417, Val Accuracy: 28.57%
Epoch 9/10, Train Loss: 1.5509, Train Accuracy: 50.00%
Val Loss: 1.9742, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.4543, Train Accuracy: 51.79%
Val Loss: 1.9183, Val Accuracy: 28.57%
photo adapter trained. Validation Accuracy: 28.57%

Training coefficients for adapter merging
Initial coefficients: [0.33751827 0.32989776 0.33258396]
Epoch 1, Loss: 2.5779, Accuracy: 0.00%
Coefficients: [0.06450415 0.4658551  0.46964076]
Epoch 2, Loss: 2.5768, Accuracy: 0.00%
Coefficients: [0.01484709 0.427393   0.5577599 ]
Epoch 3, Loss: 2.5776, Accuracy: 0.00%
Coefficients: [0.00587784 0.614623   0.37949923]
Epoch 4, Loss: 2.5756, Accuracy: 0.00%
Coefficients: [0.00222326 0.85756236 0.14021434]
Epoch 5, Loss: 2.5756, Accuracy: 0.00%
Coefficients: [9.138424e-04 9.330496e-01 6.603648e-02]
Epoch 6, Loss: 2.5767, Accuracy: 0.00%
Coefficients: [4.2515763e-04 9.6332121e-01 3.6253639e-02]
Epoch 7, Loss: 2.5776, Accuracy: 0.00%
Coefficients: [2.2435957e-04 9.7646731e-01 2.3308367e-02]
Epoch 8, Loss: 2.5785, Accuracy: 0.00%
Coefficients: [1.2828826e-04 9.8385113e-01 1.6020613e-02]
Epoch 9, Loss: 2.5767, Accuracy: 0.00%
Coefficients: [7.7848723e-05 9.8848814e-01 1.1434051e-02]
Epoch 10, Loss: 2.5771, Accuracy: 0.00%
Coefficients: [4.8713297e-05 9.9190873e-01 8.0425441e-03]
Best coefficient accuracy: 0.00%
Final best coefficients: [0.33751827 0.32989776 0.33258396]

Merged model - Test Loss: 2.0581, Test Accuracy: 20.63%

Single Run Summary:
Test Domain: sketch
Domain Accuracies:
  art_painting: 14.29%
  cartoon: 14.29%
  photo: 28.57%
Final Accuracy: 20.63%
Coefficients: ['0.3375', '0.3299', '0.3326']

--- Run 4/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: art_painting
Training domains: ['cartoon', 'photo', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: art_painting
Train domains: ['cartoon', 'photo', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.0123, Train Accuracy: 42.86%
Val Loss: 1.9973, Val Accuracy: 19.05%
Epoch 2/10, Train Loss: 1.9954, Train Accuracy: 42.86%
Val Loss: 1.9957, Val Accuracy: 19.05%
Epoch 3/10, Train Loss: 1.9698, Train Accuracy: 42.86%
Val Loss: 1.9945, Val Accuracy: 19.05%
Epoch 4/10, Train Loss: 1.9423, Train Accuracy: 42.86%
Val Loss: 1.9931, Val Accuracy: 19.05%
Epoch 5/10, Train Loss: 1.9268, Train Accuracy: 42.86%
Val Loss: 1.9917, Val Accuracy: 19.05%
Epoch 6/10, Train Loss: 1.9083, Train Accuracy: 42.86%
Val Loss: 1.9904, Val Accuracy: 19.05%
Epoch 7/10, Train Loss: 1.8814, Train Accuracy: 42.86%
Val Loss: 1.9890, Val Accuracy: 19.05%
Epoch 8/10, Train Loss: 1.8617, Train Accuracy: 42.86%
Val Loss: 1.9877, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 1.8435, Train Accuracy: 42.86%
Val Loss: 1.9862, Val Accuracy: 19.05%
Epoch 10/10, Train Loss: 1.8226, Train Accuracy: 42.86%
Val Loss: 1.9848, Val Accuracy: 20.63%
Baseline Model - Final Test Loss: 1.9848, Test Accuracy: 20.63%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3793, Train Accuracy: 14.29%
Val Loss: 2.3170, Val Accuracy: 0.00%
Epoch 2/10, Train Loss: 2.2428, Train Accuracy: 14.29%
Val Loss: 2.2871, Val Accuracy: 7.14%
Epoch 3/10, Train Loss: 2.1473, Train Accuracy: 12.50%
Val Loss: 2.2601, Val Accuracy: 7.14%
Epoch 4/10, Train Loss: 2.0540, Train Accuracy: 14.29%
Val Loss: 2.2435, Val Accuracy: 7.14%
Epoch 5/10, Train Loss: 1.9684, Train Accuracy: 14.29%
Val Loss: 2.2223, Val Accuracy: 7.14%
Epoch 6/10, Train Loss: 1.8698, Train Accuracy: 17.86%
Val Loss: 2.2023, Val Accuracy: 7.14%
Epoch 7/10, Train Loss: 1.8236, Train Accuracy: 21.43%
Val Loss: 2.1847, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.7139, Train Accuracy: 25.00%
Val Loss: 2.1689, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.6563, Train Accuracy: 32.14%
Val Loss: 2.1585, Val Accuracy: 14.29%
Epoch 10/10, Train Loss: 1.5619, Train Accuracy: 39.29%
Val Loss: 2.1502, Val Accuracy: 14.29%
cartoon adapter trained. Validation Accuracy: 14.29%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1726, Train Accuracy: 17.86%
Val Loss: 2.1877, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.0995, Train Accuracy: 17.86%
Val Loss: 2.1560, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 2.0084, Train Accuracy: 19.64%
Val Loss: 2.1264, Val Accuracy: 28.57%
Epoch 4/10, Train Loss: 1.9480, Train Accuracy: 23.21%
Val Loss: 2.0943, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.8584, Train Accuracy: 23.21%
Val Loss: 2.0593, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.8097, Train Accuracy: 26.79%
Val Loss: 2.0237, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.7027, Train Accuracy: 32.14%
Val Loss: 1.9865, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.6591, Train Accuracy: 37.50%
Val Loss: 1.9502, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.5480, Train Accuracy: 42.86%
Val Loss: 1.9120, Val Accuracy: 35.71%
Epoch 10/10, Train Loss: 1.4674, Train Accuracy: 57.14%
Val Loss: 1.8672, Val Accuracy: 35.71%
photo adapter trained. Validation Accuracy: 35.71%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.1901, Train Accuracy: 23.21%
Val Loss: 2.3209, Val Accuracy: 14.29%
Epoch 2/10, Train Loss: 2.0632, Train Accuracy: 30.36%
Val Loss: 2.1713, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.9166, Train Accuracy: 30.36%
Val Loss: 2.0377, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.8007, Train Accuracy: 32.14%
Val Loss: 1.9160, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.7059, Train Accuracy: 37.50%
Val Loss: 1.8178, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.6165, Train Accuracy: 39.29%
Val Loss: 1.7436, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.5493, Train Accuracy: 41.07%
Val Loss: 1.6871, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.4922, Train Accuracy: 42.86%
Val Loss: 1.6368, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.4338, Train Accuracy: 48.21%
Val Loss: 1.5956, Val Accuracy: 35.71%
Epoch 10/10, Train Loss: 1.3501, Train Accuracy: 53.57%
Val Loss: 1.5510, Val Accuracy: 42.86%
sketch adapter trained. Validation Accuracy: 42.86%

Training coefficients for adapter merging
Initial coefficients: [0.33758417 0.33204237 0.33037347]
Epoch 1, Loss: 1.8770, Accuracy: 28.57%
Coefficients: [0.10849911 0.10695204 0.7845488 ]
Epoch 2, Loss: 1.8744, Accuracy: 28.57%
Coefficients: [0.02837741 0.02247621 0.9491464 ]
Epoch 3, Loss: 1.8710, Accuracy: 28.57%
Coefficients: [0.00942337 0.00652149 0.9840551 ]
Epoch 4, Loss: 1.8769, Accuracy: 28.57%
Coefficients: [0.0041979  0.00252915 0.9932729 ]
Epoch 5, Loss: 1.8738, Accuracy: 28.57%
Coefficients: [0.00205973 0.00110518 0.9968352 ]
Epoch 6, Loss: 1.8705, Accuracy: 28.57%
Coefficients: [1.0978964e-03 5.3691783e-04 9.9836522e-01]
Epoch 7, Loss: 1.8709, Accuracy: 28.57%
Coefficients: [6.2412472e-04 2.8283062e-04 9.9909306e-01]
Epoch 8, Loss: 1.8763, Accuracy: 28.57%
Coefficients: [3.7939937e-04 1.6071369e-04 9.9945992e-01]
Epoch 9, Loss: 1.8750, Accuracy: 28.57%
Coefficients: [2.4413731e-04 9.7486634e-05 9.9965835e-01]
Epoch 10, Loss: 1.8743, Accuracy: 28.57%
Coefficients: [1.6477870e-04 6.2390376e-05 9.9977285e-01]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.10849911 0.10695204 0.7845488 ]

Merged model - Test Loss: 2.1739, Test Accuracy: 17.46%

Single Run Summary:
Test Domain: art_painting
Domain Accuracies:
  cartoon: 14.29%
  photo: 35.71%
  sketch: 42.86%
Final Accuracy: 17.46%
Coefficients: ['0.1085', '0.1070', '0.7845']

--- Run 5/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: photo
Training domains: ['art_painting', 'cartoon', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: photo
Train domains: ['art_painting', 'cartoon', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.9475, Train Accuracy: 28.57%
Val Loss: 2.1854, Val Accuracy: 19.05%
Epoch 2/10, Train Loss: 1.9388, Train Accuracy: 28.57%
Val Loss: 2.1843, Val Accuracy: 19.05%
Epoch 3/10, Train Loss: 1.9246, Train Accuracy: 28.57%
Val Loss: 2.1832, Val Accuracy: 19.05%
Epoch 4/10, Train Loss: 1.9124, Train Accuracy: 28.57%
Val Loss: 2.1821, Val Accuracy: 19.05%
Epoch 5/10, Train Loss: 1.9045, Train Accuracy: 28.57%
Val Loss: 2.1810, Val Accuracy: 19.05%
Epoch 6/10, Train Loss: 1.8950, Train Accuracy: 28.57%
Val Loss: 2.1799, Val Accuracy: 19.05%
Epoch 7/10, Train Loss: 1.8804, Train Accuracy: 28.57%
Val Loss: 2.1788, Val Accuracy: 19.05%
Epoch 8/10, Train Loss: 1.8725, Train Accuracy: 28.57%
Val Loss: 2.1778, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 1.8620, Train Accuracy: 28.57%
Val Loss: 2.1767, Val Accuracy: 19.05%
Epoch 10/10, Train Loss: 1.8550, Train Accuracy: 28.57%
Val Loss: 2.1756, Val Accuracy: 19.05%
Baseline Model - Final Test Loss: 2.1854, Test Accuracy: 19.05%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.2885, Train Accuracy: 12.50%
Val Loss: 1.8672, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 2.2376, Train Accuracy: 17.86%
Val Loss: 1.8511, Val Accuracy: 35.71%
Epoch 3/10, Train Loss: 2.1107, Train Accuracy: 17.86%
Val Loss: 1.8346, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 2.0258, Train Accuracy: 19.64%
Val Loss: 1.8153, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.9052, Train Accuracy: 23.21%
Val Loss: 1.7917, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.8269, Train Accuracy: 30.36%
Val Loss: 1.7661, Val Accuracy: 42.86%
Epoch 7/10, Train Loss: 1.7470, Train Accuracy: 35.71%
Val Loss: 1.7391, Val Accuracy: 42.86%
Epoch 8/10, Train Loss: 1.6374, Train Accuracy: 41.07%
Val Loss: 1.7153, Val Accuracy: 42.86%
Epoch 9/10, Train Loss: 1.5300, Train Accuracy: 44.64%
Val Loss: 1.6937, Val Accuracy: 42.86%
Epoch 10/10, Train Loss: 1.4596, Train Accuracy: 53.57%
Val Loss: 1.6687, Val Accuracy: 50.00%
art_painting adapter trained. Validation Accuracy: 50.00%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3627, Train Accuracy: 12.50%
Val Loss: 2.3881, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.2441, Train Accuracy: 12.50%
Val Loss: 2.3634, Val Accuracy: 7.14%
Epoch 3/10, Train Loss: 2.1185, Train Accuracy: 12.50%
Val Loss: 2.3128, Val Accuracy: 7.14%
Epoch 4/10, Train Loss: 2.0370, Train Accuracy: 14.29%
Val Loss: 2.2819, Val Accuracy: 7.14%
Epoch 5/10, Train Loss: 1.9257, Train Accuracy: 14.29%
Val Loss: 2.2482, Val Accuracy: 7.14%
Epoch 6/10, Train Loss: 1.8251, Train Accuracy: 19.64%
Val Loss: 2.2204, Val Accuracy: 7.14%
Epoch 7/10, Train Loss: 1.7731, Train Accuracy: 25.00%
Val Loss: 2.1988, Val Accuracy: 7.14%
Epoch 8/10, Train Loss: 1.7030, Train Accuracy: 28.57%
Val Loss: 2.1870, Val Accuracy: 7.14%
Epoch 9/10, Train Loss: 1.6144, Train Accuracy: 37.50%
Val Loss: 2.1749, Val Accuracy: 7.14%
Epoch 10/10, Train Loss: 1.5294, Train Accuracy: 41.07%
Val Loss: 2.1644, Val Accuracy: 14.29%
cartoon adapter trained. Validation Accuracy: 14.29%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.2379, Train Accuracy: 16.07%
Val Loss: 2.1004, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.0656, Train Accuracy: 21.43%
Val Loss: 1.9936, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 1.9282, Train Accuracy: 23.21%
Val Loss: 1.9055, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.7930, Train Accuracy: 26.79%
Val Loss: 1.8511, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.6817, Train Accuracy: 37.50%
Val Loss: 1.8149, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.6074, Train Accuracy: 46.43%
Val Loss: 1.7898, Val Accuracy: 21.43%
Epoch 7/10, Train Loss: 1.5211, Train Accuracy: 46.43%
Val Loss: 1.7737, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.4676, Train Accuracy: 48.21%
Val Loss: 1.7615, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.4072, Train Accuracy: 53.57%
Val Loss: 1.7368, Val Accuracy: 35.71%
Epoch 10/10, Train Loss: 1.3555, Train Accuracy: 51.79%
Val Loss: 1.6964, Val Accuracy: 35.71%
sketch adapter trained. Validation Accuracy: 35.71%

Training coefficients for adapter merging
Initial coefficients: [0.33441103 0.33071616 0.3348728 ]
Epoch 1, Loss: 1.9401, Accuracy: 28.57%
Coefficients: [0.10652842 0.10534456 0.788127  ]
Epoch 2, Loss: 1.9412, Accuracy: 28.57%
Coefficients: [0.06853696 0.0247869  0.9066762 ]
Epoch 3, Loss: 1.9375, Accuracy: 28.57%
Coefficients: [0.02245668 0.00573448 0.9718088 ]
Epoch 4, Loss: 1.9399, Accuracy: 28.57%
Coefficients: [0.00840343 0.00157666 0.9900199 ]
Epoch 5, Loss: 1.9387, Accuracy: 28.57%
Coefficients: [3.1626397e-03 4.9814623e-04 9.9633920e-01]
Epoch 6, Loss: 1.9370, Accuracy: 28.57%
Coefficients: [1.346901e-03 1.830016e-04 9.984701e-01]
Epoch 7, Loss: 1.9376, Accuracy: 28.57%
Coefficients: [6.219874e-04 7.541779e-05 9.993026e-01]
Epoch 8, Loss: 1.9415, Accuracy: 28.57%
Coefficients: [3.1894585e-04 3.4700130e-05 9.9964643e-01]
Epoch 9, Loss: 1.9411, Accuracy: 28.57%
Coefficients: [1.7614079e-04 1.7419554e-05 9.9980646e-01]
Epoch 10, Loss: 1.9411, Accuracy: 28.57%
Coefficients: [1.0401379e-04 9.4273046e-06 9.9988651e-01]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.10652842 0.10534456 0.788127  ]

Merged model - Test Loss: 2.1709, Test Accuracy: 19.05%

Single Run Summary:
Test Domain: photo
Domain Accuracies:
  art_painting: 50.00%
  cartoon: 14.29%
  sketch: 35.71%
Final Accuracy: 19.05%
Coefficients: ['0.1065', '0.1053', '0.7881']

--- Run 6/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: cartoon
Training domains: ['art_painting', 'photo', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: cartoon
Train domains: ['art_painting', 'photo', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.6648, Train Accuracy: 0.00%
Val Loss: 2.2250, Val Accuracy: 4.76%
Epoch 2/10, Train Loss: 2.6461, Train Accuracy: 0.00%
Val Loss: 2.2240, Val Accuracy: 4.76%
Epoch 3/10, Train Loss: 2.6235, Train Accuracy: 0.00%
Val Loss: 2.2230, Val Accuracy: 4.76%
Epoch 4/10, Train Loss: 2.6054, Train Accuracy: 0.00%
Val Loss: 2.2220, Val Accuracy: 4.76%
Epoch 5/10, Train Loss: 2.5877, Train Accuracy: 0.00%
Val Loss: 2.2211, Val Accuracy: 4.76%
Epoch 6/10, Train Loss: 2.5697, Train Accuracy: 0.00%
Val Loss: 2.2202, Val Accuracy: 4.76%
Epoch 7/10, Train Loss: 2.5504, Train Accuracy: 0.00%
Val Loss: 2.2193, Val Accuracy: 4.76%
Epoch 8/10, Train Loss: 2.5333, Train Accuracy: 0.00%
Val Loss: 2.2184, Val Accuracy: 4.76%
Epoch 9/10, Train Loss: 2.5096, Train Accuracy: 0.00%
Val Loss: 2.2176, Val Accuracy: 4.76%
Epoch 10/10, Train Loss: 2.4945, Train Accuracy: 0.00%
Val Loss: 2.2168, Val Accuracy: 4.76%
Baseline Model - Final Test Loss: 2.2250, Test Accuracy: 4.76%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.1220, Train Accuracy: 19.64%
Val Loss: 2.6165, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.0305, Train Accuracy: 21.43%
Val Loss: 2.5644, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.9378, Train Accuracy: 23.21%
Val Loss: 2.5202, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 1.8502, Train Accuracy: 25.00%
Val Loss: 2.4916, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 1.7400, Train Accuracy: 33.93%
Val Loss: 2.4475, Val Accuracy: 14.29%
Epoch 6/10, Train Loss: 1.6567, Train Accuracy: 37.50%
Val Loss: 2.3952, Val Accuracy: 14.29%
Epoch 7/10, Train Loss: 1.5506, Train Accuracy: 44.64%
Val Loss: 2.3416, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.4632, Train Accuracy: 50.00%
Val Loss: 2.2889, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.3752, Train Accuracy: 51.79%
Val Loss: 2.2350, Val Accuracy: 14.29%
Epoch 10/10, Train Loss: 1.2735, Train Accuracy: 62.50%
Val Loss: 2.1810, Val Accuracy: 14.29%
art_painting adapter trained. Validation Accuracy: 14.29%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1718, Train Accuracy: 17.86%
Val Loss: 2.1967, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.1033, Train Accuracy: 17.86%
Val Loss: 2.1575, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 2.0156, Train Accuracy: 21.43%
Val Loss: 2.1206, Val Accuracy: 28.57%
Epoch 4/10, Train Loss: 1.9580, Train Accuracy: 21.43%
Val Loss: 2.0829, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.8684, Train Accuracy: 23.21%
Val Loss: 2.0460, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.7901, Train Accuracy: 25.00%
Val Loss: 2.0081, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.7069, Train Accuracy: 30.36%
Val Loss: 1.9694, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.6300, Train Accuracy: 37.50%
Val Loss: 1.9298, Val Accuracy: 28.57%
Epoch 9/10, Train Loss: 1.5576, Train Accuracy: 46.43%
Val Loss: 1.8853, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.4794, Train Accuracy: 50.00%
Val Loss: 1.8385, Val Accuracy: 28.57%
photo adapter trained. Validation Accuracy: 28.57%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.1825, Train Accuracy: 17.86%
Val Loss: 2.2603, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.0334, Train Accuracy: 17.86%
Val Loss: 2.1355, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 1.9221, Train Accuracy: 21.43%
Val Loss: 2.0180, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.7977, Train Accuracy: 32.14%
Val Loss: 1.9029, Val Accuracy: 28.57%
Epoch 5/10, Train Loss: 1.6952, Train Accuracy: 37.50%
Val Loss: 1.7975, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.5924, Train Accuracy: 44.64%
Val Loss: 1.7057, Val Accuracy: 42.86%
Epoch 7/10, Train Loss: 1.4855, Train Accuracy: 48.21%
Val Loss: 1.6242, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.4499, Train Accuracy: 51.79%
Val Loss: 1.5745, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.3805, Train Accuracy: 55.36%
Val Loss: 1.5321, Val Accuracy: 42.86%
Epoch 10/10, Train Loss: 1.3116, Train Accuracy: 51.79%
Val Loss: 1.4966, Val Accuracy: 42.86%
sketch adapter trained. Validation Accuracy: 42.86%

Training coefficients for adapter merging
Initial coefficients: [0.33537138 0.32943264 0.33519605]
Epoch 1, Loss: 2.6197, Accuracy: 0.00%
Coefficients: [0.47222996 0.46388826 0.06388174]
Epoch 2, Loss: 2.6204, Accuracy: 0.00%
Coefficients: [0.17013474 0.8078333  0.02203195]
Epoch 3, Loss: 2.6210, Accuracy: 0.00%
Coefficients: [0.04064345 0.9524672  0.00688932]
Epoch 4, Loss: 2.6184, Accuracy: 0.00%
Coefficients: [0.00926531 0.9885117  0.00222298]
Epoch 5, Loss: 2.6196, Accuracy: 0.00%
Coefficients: [2.604739e-03 9.965611e-01 8.341864e-04]
Epoch 6, Loss: 2.6186, Accuracy: 0.00%
Coefficients: [8.671993e-04 9.987759e-01 3.568706e-04]
Epoch 7, Loss: 2.6134, Accuracy: 0.00%
Coefficients: [3.2888094e-04 9.9950206e-01 1.6902530e-04]
Epoch 8, Loss: 2.6260, Accuracy: 0.00%
Coefficients: [1.4029592e-04 9.9977201e-01 8.7654233e-05]
Epoch 9, Loss: 2.6229, Accuracy: 0.00%
Coefficients: [6.5917651e-05 9.9988508e-01 4.8972717e-05]
Epoch 10, Loss: 2.6206, Accuracy: 0.00%
Coefficients: [3.3591521e-05 9.9993730e-01 2.9136321e-05]
Best coefficient accuracy: 0.00%
Final best coefficients: [0.33537138 0.32943264 0.33519605]

Merged model - Test Loss: 2.2027, Test Accuracy: 9.52%

Single Run Summary:
Test Domain: cartoon
Domain Accuracies:
  art_painting: 14.29%
  photo: 28.57%
  sketch: 42.86%
Final Accuracy: 9.52%
Coefficients: ['0.3354', '0.3294', '0.3352']

--- Run 7/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: sketch
Training domains: ['art_painting', 'cartoon', 'photo']

Running LoRA with Separate Classifiers experiment
Test domain: sketch
Train domains: ['art_painting', 'cartoon', 'photo']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.1048, Train Accuracy: 57.14%
Val Loss: 1.3344, Val Accuracy: 52.38%
Epoch 2/10, Train Loss: 1.0886, Train Accuracy: 57.14%
Val Loss: 1.3344, Val Accuracy: 55.56%
Epoch 3/10, Train Loss: 1.0660, Train Accuracy: 57.14%
Val Loss: 1.3345, Val Accuracy: 55.56%
Epoch 4/10, Train Loss: 1.0498, Train Accuracy: 57.14%
Val Loss: 1.3347, Val Accuracy: 53.97%
Epoch 5/10, Train Loss: 1.0296, Train Accuracy: 57.14%
Val Loss: 1.3350, Val Accuracy: 53.97%
Epoch 6/10, Train Loss: 1.0138, Train Accuracy: 57.14%
Val Loss: 1.3353, Val Accuracy: 53.97%
Epoch 7/10, Train Loss: 0.9985, Train Accuracy: 57.14%
Val Loss: 1.3357, Val Accuracy: 50.79%
Epoch 8/10, Train Loss: 0.9830, Train Accuracy: 57.14%
Val Loss: 1.3361, Val Accuracy: 50.79%
Epoch 9/10, Train Loss: 0.9678, Train Accuracy: 57.14%
Val Loss: 1.3366, Val Accuracy: 53.97%
Epoch 10/10, Train Loss: 0.9561, Train Accuracy: 57.14%
Val Loss: 1.3370, Val Accuracy: 55.56%
Baseline Model - Final Test Loss: 1.3344, Test Accuracy: 55.56%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.2973, Train Accuracy: 14.29%
Val Loss: 1.9619, Val Accuracy: 28.57%
Epoch 2/10, Train Loss: 2.1886, Train Accuracy: 17.86%
Val Loss: 1.9477, Val Accuracy: 35.71%
Epoch 3/10, Train Loss: 2.0532, Train Accuracy: 17.86%
Val Loss: 1.9336, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.9898, Train Accuracy: 21.43%
Val Loss: 1.9212, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.8627, Train Accuracy: 32.14%
Val Loss: 1.9113, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.7842, Train Accuracy: 33.93%
Val Loss: 1.9024, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.6633, Train Accuracy: 42.86%
Val Loss: 1.8947, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.5521, Train Accuracy: 48.21%
Val Loss: 1.8890, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.4821, Train Accuracy: 50.00%
Val Loss: 1.8864, Val Accuracy: 35.71%
Epoch 10/10, Train Loss: 1.3881, Train Accuracy: 66.07%
Val Loss: 1.8842, Val Accuracy: 28.57%
art_painting adapter trained. Validation Accuracy: 35.71%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3702, Train Accuracy: 14.29%
Val Loss: 2.3739, Val Accuracy: 0.00%
Epoch 2/10, Train Loss: 2.2661, Train Accuracy: 14.29%
Val Loss: 2.2855, Val Accuracy: 0.00%
Epoch 3/10, Train Loss: 2.1713, Train Accuracy: 16.07%
Val Loss: 2.2265, Val Accuracy: 0.00%
Epoch 4/10, Train Loss: 2.0615, Train Accuracy: 16.07%
Val Loss: 2.1848, Val Accuracy: 0.00%
Epoch 5/10, Train Loss: 1.9692, Train Accuracy: 16.07%
Val Loss: 2.1372, Val Accuracy: 0.00%
Epoch 6/10, Train Loss: 1.9181, Train Accuracy: 17.86%
Val Loss: 2.0961, Val Accuracy: 0.00%
Epoch 7/10, Train Loss: 1.8403, Train Accuracy: 19.64%
Val Loss: 2.0570, Val Accuracy: 0.00%
Epoch 8/10, Train Loss: 1.7877, Train Accuracy: 23.21%
Val Loss: 2.0210, Val Accuracy: 0.00%
Epoch 9/10, Train Loss: 1.7235, Train Accuracy: 23.21%
Val Loss: 1.9877, Val Accuracy: 0.00%
Epoch 10/10, Train Loss: 1.6048, Train Accuracy: 26.79%
Val Loss: 1.9558, Val Accuracy: 0.00%
Warning: No best LoRA state found for domain cartoon. Using the final state.
Warning: No best head state found for domain cartoon. Using the final state.
cartoon adapter trained. Validation Accuracy: 0.00%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.2472, Train Accuracy: 17.86%
Val Loss: 1.9845, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.1530, Train Accuracy: 17.86%
Val Loss: 1.9474, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 2.0788, Train Accuracy: 21.43%
Val Loss: 1.9153, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 2.0149, Train Accuracy: 23.21%
Val Loss: 1.8789, Val Accuracy: 21.43%
Epoch 5/10, Train Loss: 1.9346, Train Accuracy: 23.21%
Val Loss: 1.8449, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.8920, Train Accuracy: 30.36%
Val Loss: 1.8127, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.8216, Train Accuracy: 30.36%
Val Loss: 1.7778, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.7317, Train Accuracy: 35.71%
Val Loss: 1.7405, Val Accuracy: 28.57%
Epoch 9/10, Train Loss: 1.6496, Train Accuracy: 39.29%
Val Loss: 1.6999, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.5908, Train Accuracy: 44.64%
Val Loss: 1.6570, Val Accuracy: 28.57%
photo adapter trained. Validation Accuracy: 28.57%

Training coefficients for adapter merging
Initial coefficients: [0.3358523 0.3331955 0.3309522]
Epoch 1, Loss: 2.0704, Accuracy: 28.57%
Coefficients: [0.47048694 0.46676573 0.06274737]
Epoch 2, Loss: 2.0688, Accuracy: 28.57%
Coefficients: [0.37355688 0.6099475  0.01649562]
Epoch 3, Loss: 2.0692, Accuracy: 28.57%
Coefficients: [0.14174677 0.8526612  0.00559203]
Epoch 4, Loss: 2.0677, Accuracy: 28.57%
Coefficients: [0.05298298 0.9451171  0.0018999 ]
Epoch 5, Loss: 2.0749, Accuracy: 28.57%
Coefficients: [3.5821237e-02 9.6322733e-01 9.5142116e-04]
Epoch 6, Loss: 2.0714, Accuracy: 28.57%
Coefficients: [2.2419704e-02 9.7709149e-01 4.8875209e-04]
Epoch 7, Loss: 2.0732, Accuracy: 28.57%
Coefficients: [1.6971838e-02 9.8273623e-01 2.9190854e-04]
Epoch 8, Loss: 2.0688, Accuracy: 28.57%
Coefficients: [1.32065145e-02 9.86608684e-01 1.84736477e-04]
Epoch 9, Loss: 2.0787, Accuracy: 28.57%
Coefficients: [1.2759741e-02 9.8710477e-01 1.3550807e-04]
Epoch 10, Loss: 2.0689, Accuracy: 28.57%
Coefficients: [1.26792919e-02 9.87216651e-01 1.04025516e-04]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.47048694 0.46676573 0.06274737]

Merged model - Test Loss: 2.1302, Test Accuracy: 15.87%

Single Run Summary:
Test Domain: sketch
Domain Accuracies:
  art_painting: 35.71%
  cartoon: 0.00%
  photo: 28.57%
Final Accuracy: 15.87%
Coefficients: ['0.4705', '0.4668', '0.0627']

--- Run 8/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: art_painting
Training domains: ['cartoon', 'photo', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: art_painting
Train domains: ['cartoon', 'photo', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.8248, Train Accuracy: 28.57%
Val Loss: 2.0351, Val Accuracy: 19.05%
Epoch 2/10, Train Loss: 1.8102, Train Accuracy: 28.57%
Val Loss: 2.0337, Val Accuracy: 19.05%
Epoch 3/10, Train Loss: 1.7870, Train Accuracy: 28.57%
Val Loss: 2.0322, Val Accuracy: 19.05%
Epoch 4/10, Train Loss: 1.7722, Train Accuracy: 28.57%
Val Loss: 2.0308, Val Accuracy: 19.05%
Epoch 5/10, Train Loss: 1.7502, Train Accuracy: 28.57%
Val Loss: 2.0295, Val Accuracy: 19.05%
Epoch 6/10, Train Loss: 1.7351, Train Accuracy: 28.57%
Val Loss: 2.0283, Val Accuracy: 19.05%
Epoch 7/10, Train Loss: 1.7123, Train Accuracy: 28.57%
Val Loss: 2.0270, Val Accuracy: 19.05%
Epoch 8/10, Train Loss: 1.6914, Train Accuracy: 28.57%
Val Loss: 2.0257, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 1.6713, Train Accuracy: 42.86%
Val Loss: 2.0244, Val Accuracy: 19.05%
Epoch 10/10, Train Loss: 1.6507, Train Accuracy: 42.86%
Val Loss: 2.0233, Val Accuracy: 19.05%
Baseline Model - Final Test Loss: 2.0351, Test Accuracy: 19.05%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3177, Train Accuracy: 14.29%
Val Loss: 2.6089, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.1708, Train Accuracy: 14.29%
Val Loss: 2.5425, Val Accuracy: 0.00%
Epoch 3/10, Train Loss: 2.0876, Train Accuracy: 16.07%
Val Loss: 2.4425, Val Accuracy: 0.00%
Epoch 4/10, Train Loss: 2.0052, Train Accuracy: 16.07%
Val Loss: 2.3758, Val Accuracy: 0.00%
Epoch 5/10, Train Loss: 1.9296, Train Accuracy: 16.07%
Val Loss: 2.3236, Val Accuracy: 0.00%
Epoch 6/10, Train Loss: 1.8797, Train Accuracy: 17.86%
Val Loss: 2.2808, Val Accuracy: 0.00%
Epoch 7/10, Train Loss: 1.8142, Train Accuracy: 17.86%
Val Loss: 2.2378, Val Accuracy: 0.00%
Epoch 8/10, Train Loss: 1.7528, Train Accuracy: 23.21%
Val Loss: 2.1969, Val Accuracy: 0.00%
Epoch 9/10, Train Loss: 1.6480, Train Accuracy: 28.57%
Val Loss: 2.1557, Val Accuracy: 0.00%
Epoch 10/10, Train Loss: 1.5861, Train Accuracy: 39.29%
Val Loss: 2.1182, Val Accuracy: 0.00%
cartoon adapter trained. Validation Accuracy: 7.14%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.1789, Train Accuracy: 17.86%
Val Loss: 2.1883, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.0467, Train Accuracy: 19.64%
Val Loss: 2.1476, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 1.9914, Train Accuracy: 21.43%
Val Loss: 2.1063, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.9567, Train Accuracy: 23.21%
Val Loss: 2.0653, Val Accuracy: 21.43%
Epoch 5/10, Train Loss: 1.8878, Train Accuracy: 25.00%
Val Loss: 2.0209, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.8133, Train Accuracy: 30.36%
Val Loss: 1.9866, Val Accuracy: 28.57%
Epoch 7/10, Train Loss: 1.7423, Train Accuracy: 32.14%
Val Loss: 1.9449, Val Accuracy: 28.57%
Epoch 8/10, Train Loss: 1.6601, Train Accuracy: 39.29%
Val Loss: 1.8901, Val Accuracy: 28.57%
Epoch 9/10, Train Loss: 1.6069, Train Accuracy: 46.43%
Val Loss: 1.8296, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.5115, Train Accuracy: 50.00%
Val Loss: 1.7635, Val Accuracy: 28.57%
photo adapter trained. Validation Accuracy: 28.57%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.2106, Train Accuracy: 23.21%
Val Loss: 2.1822, Val Accuracy: 14.29%
Epoch 2/10, Train Loss: 2.0348, Train Accuracy: 23.21%
Val Loss: 2.0637, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.9053, Train Accuracy: 23.21%
Val Loss: 1.9571, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 1.7927, Train Accuracy: 28.57%
Val Loss: 1.8629, Val Accuracy: 21.43%
Epoch 5/10, Train Loss: 1.6976, Train Accuracy: 37.50%
Val Loss: 1.7788, Val Accuracy: 28.57%
Epoch 6/10, Train Loss: 1.6123, Train Accuracy: 41.07%
Val Loss: 1.7113, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.5405, Train Accuracy: 39.29%
Val Loss: 1.6625, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.4846, Train Accuracy: 42.86%
Val Loss: 1.6178, Val Accuracy: 28.57%
Epoch 9/10, Train Loss: 1.4246, Train Accuracy: 48.21%
Val Loss: 1.5824, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.3486, Train Accuracy: 55.36%
Val Loss: 1.5522, Val Accuracy: 42.86%
sketch adapter trained. Validation Accuracy: 42.86%

Training coefficients for adapter merging
Initial coefficients: [0.33299455 0.3341506  0.33285484]
Epoch 1, Loss: 2.3272, Accuracy: 14.29%
Coefficients: [0.46765098 0.4690847  0.06326432]
Epoch 2, Loss: 2.3259, Accuracy: 14.29%
Coefficients: [0.8115988  0.16583434 0.02256683]
Epoch 3, Loss: 2.3250, Accuracy: 14.29%
Coefficients: [0.866478   0.12275488 0.01076711]
Epoch 4, Loss: 2.3241, Accuracy: 14.29%
Coefficients: [0.7674626  0.2244103  0.00812716]
Epoch 5, Loss: 2.3152, Accuracy: 14.29%
Coefficients: [0.8588792  0.13651201 0.00460874]
Epoch 6, Loss: 2.3250, Accuracy: 14.29%
Coefficients: [0.91972315 0.07767313 0.00260368]
Epoch 7, Loss: 2.3184, Accuracy: 14.29%
Coefficients: [0.95982844 0.03875934 0.00141212]
Epoch 8, Loss: 2.3272, Accuracy: 14.29%
Coefficients: [9.7827864e-01 2.0911951e-02 8.0945942e-04]
Epoch 9, Loss: 2.3293, Accuracy: 14.29%
Coefficients: [9.8707670e-01 1.2425378e-02 4.9795996e-04]
Epoch 10, Loss: 2.3283, Accuracy: 14.29%
Coefficients: [9.9171913e-01 7.9552811e-03 3.2555443e-04]
Best coefficient accuracy: 14.29%
Final best coefficients: [0.46765098 0.4690847  0.06326432]

Merged model - Test Loss: 2.1531, Test Accuracy: 17.46%

Single Run Summary:
Test Domain: art_painting
Domain Accuracies:
  cartoon: 7.14%
  photo: 28.57%
  sketch: 42.86%
Final Accuracy: 17.46%
Coefficients: ['0.4677', '0.4691', '0.0633']

--- Run 9/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: photo
Training domains: ['art_painting', 'cartoon', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: photo
Train domains: ['art_painting', 'cartoon', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.7168, Train Accuracy: 28.57%
Val Loss: 2.1991, Val Accuracy: 17.46%
Epoch 2/10, Train Loss: 1.7041, Train Accuracy: 28.57%
Val Loss: 2.1995, Val Accuracy: 17.46%
Epoch 3/10, Train Loss: 1.6901, Train Accuracy: 28.57%
Val Loss: 2.1998, Val Accuracy: 17.46%
Epoch 4/10, Train Loss: 1.6812, Train Accuracy: 28.57%
Val Loss: 2.2000, Val Accuracy: 17.46%
Epoch 5/10, Train Loss: 1.6677, Train Accuracy: 28.57%
Val Loss: 2.2000, Val Accuracy: 17.46%
Epoch 6/10, Train Loss: 1.6599, Train Accuracy: 28.57%
Val Loss: 2.1994, Val Accuracy: 17.46%
Epoch 7/10, Train Loss: 1.6460, Train Accuracy: 28.57%
Val Loss: 2.1992, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 1.6390, Train Accuracy: 28.57%
Val Loss: 2.1997, Val Accuracy: 17.46%
Epoch 9/10, Train Loss: 1.6306, Train Accuracy: 28.57%
Val Loss: 2.2002, Val Accuracy: 17.46%
Epoch 10/10, Train Loss: 1.6198, Train Accuracy: 28.57%
Val Loss: 2.2005, Val Accuracy: 17.46%
Baseline Model - Final Test Loss: 2.1991, Test Accuracy: 17.46%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.1868, Train Accuracy: 19.64%
Val Loss: 2.4005, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.0587, Train Accuracy: 21.43%
Val Loss: 2.3721, Val Accuracy: 21.43%
Epoch 3/10, Train Loss: 1.9865, Train Accuracy: 21.43%
Val Loss: 2.3434, Val Accuracy: 21.43%
Epoch 4/10, Train Loss: 1.9042, Train Accuracy: 23.21%
Val Loss: 2.3122, Val Accuracy: 21.43%
Epoch 5/10, Train Loss: 1.8008, Train Accuracy: 26.79%
Val Loss: 2.2801, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.7066, Train Accuracy: 33.93%
Val Loss: 2.2464, Val Accuracy: 21.43%
Epoch 7/10, Train Loss: 1.6031, Train Accuracy: 35.71%
Val Loss: 2.2120, Val Accuracy: 21.43%
Epoch 8/10, Train Loss: 1.5107, Train Accuracy: 41.07%
Val Loss: 2.1768, Val Accuracy: 21.43%
Epoch 9/10, Train Loss: 1.4076, Train Accuracy: 48.21%
Val Loss: 2.1409, Val Accuracy: 21.43%
Epoch 10/10, Train Loss: 1.3281, Train Accuracy: 58.93%
Val Loss: 2.1038, Val Accuracy: 28.57%
art_painting adapter trained. Validation Accuracy: 28.57%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.4389, Train Accuracy: 8.93%
Val Loss: 2.0883, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.3348, Train Accuracy: 8.93%
Val Loss: 2.0316, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 2.2090, Train Accuracy: 10.71%
Val Loss: 2.0026, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 2.1123, Train Accuracy: 12.50%
Val Loss: 1.9771, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 2.0033, Train Accuracy: 16.07%
Val Loss: 1.9559, Val Accuracy: 14.29%
Epoch 6/10, Train Loss: 1.9484, Train Accuracy: 16.07%
Val Loss: 1.9342, Val Accuracy: 14.29%
Epoch 7/10, Train Loss: 1.8698, Train Accuracy: 17.86%
Val Loss: 1.9093, Val Accuracy: 7.14%
Epoch 8/10, Train Loss: 1.7998, Train Accuracy: 23.21%
Val Loss: 1.8927, Val Accuracy: 7.14%
Epoch 9/10, Train Loss: 1.7144, Train Accuracy: 23.21%
Val Loss: 1.8841, Val Accuracy: 14.29%
Epoch 10/10, Train Loss: 1.6186, Train Accuracy: 35.71%
Val Loss: 1.8833, Val Accuracy: 14.29%
cartoon adapter trained. Validation Accuracy: 21.43%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.2624, Train Accuracy: 16.07%
Val Loss: 1.9075, Val Accuracy: 35.71%
Epoch 2/10, Train Loss: 2.1129, Train Accuracy: 14.29%
Val Loss: 1.8256, Val Accuracy: 42.86%
Epoch 3/10, Train Loss: 1.9622, Train Accuracy: 21.43%
Val Loss: 1.7491, Val Accuracy: 42.86%
Epoch 4/10, Train Loss: 1.8364, Train Accuracy: 25.00%
Val Loss: 1.6859, Val Accuracy: 50.00%
Epoch 5/10, Train Loss: 1.7330, Train Accuracy: 30.36%
Val Loss: 1.6406, Val Accuracy: 50.00%
Epoch 6/10, Train Loss: 1.6348, Train Accuracy: 33.93%
Val Loss: 1.6079, Val Accuracy: 57.14%
Epoch 7/10, Train Loss: 1.5537, Train Accuracy: 37.50%
Val Loss: 1.5852, Val Accuracy: 50.00%
Epoch 8/10, Train Loss: 1.5093, Train Accuracy: 42.86%
Val Loss: 1.5611, Val Accuracy: 50.00%
Epoch 9/10, Train Loss: 1.4376, Train Accuracy: 53.57%
Val Loss: 1.5252, Val Accuracy: 42.86%
Epoch 10/10, Train Loss: 1.3598, Train Accuracy: 57.14%
Val Loss: 1.4848, Val Accuracy: 42.86%
sketch adapter trained. Validation Accuracy: 57.14%

Training coefficients for adapter merging
Initial coefficients: [0.33396536 0.33214754 0.33388707]
Epoch 1, Loss: 1.7008, Accuracy: 28.57%
Coefficients: [0.46851635 0.06306532 0.46841836]
Epoch 2, Loss: 1.6996, Accuracy: 28.57%
Coefficients: [0.70103717 0.01811214 0.28085065]
Epoch 3, Loss: 1.6980, Accuracy: 28.57%
Coefficients: [0.8885847  0.00477549 0.10663977]
Epoch 4, Loss: 1.7015, Accuracy: 42.86%
Coefficients: [0.95492345 0.00145705 0.04361943]
Epoch 5, Loss: 1.7001, Accuracy: 28.57%
Coefficients: [9.7973448e-01 5.1424664e-04 1.9751348e-02]
Epoch 6, Loss: 1.7008, Accuracy: 28.57%
Coefficients: [9.8970324e-01 2.0972727e-04 1.0086922e-02]
Epoch 7, Loss: 1.6999, Accuracy: 28.57%
Coefficients: [9.9434799e-01 9.5112169e-05 5.5569573e-03]
Epoch 8, Loss: 1.6999, Accuracy: 28.57%
Coefficients: [9.9673247e-01 4.6824603e-05 3.2207456e-03]
Epoch 9, Loss: 1.6996, Accuracy: 28.57%
Coefficients: [9.9800652e-01 2.4840328e-05 1.9685975e-03]
Epoch 10, Loss: 1.6983, Accuracy: 42.86%
Coefficients: [9.9873143e-01 1.4020089e-05 1.2545548e-03]
Best coefficient accuracy: 42.86%
Final best coefficients: [0.95492345 0.00145705 0.04361943]

Merged model - Test Loss: 2.1947, Test Accuracy: 17.46%

Single Run Summary:
Test Domain: photo
Domain Accuracies:
  art_painting: 28.57%
  cartoon: 21.43%
  sketch: 57.14%
Final Accuracy: 17.46%
Coefficients: ['0.9549', '0.0015', '0.0436']

--- Run 10/10 ---
Domains: ['art_painting', 'cartoon', 'photo', 'sketch']
Selected test domain: cartoon
Training domains: ['art_painting', 'photo', 'sketch']

Running LoRA with Separate Classifiers experiment
Test domain: cartoon
Train domains: ['art_painting', 'photo', 'sketch']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.4266, Train Accuracy: 0.00%
Val Loss: 2.2368, Val Accuracy: 4.76%
Epoch 2/10, Train Loss: 2.4001, Train Accuracy: 0.00%
Val Loss: 2.2327, Val Accuracy: 4.76%
Epoch 3/10, Train Loss: 2.3726, Train Accuracy: 0.00%
Val Loss: 2.2289, Val Accuracy: 4.76%
Epoch 4/10, Train Loss: 2.3496, Train Accuracy: 0.00%
Val Loss: 2.2254, Val Accuracy: 4.76%
Epoch 5/10, Train Loss: 2.3264, Train Accuracy: 14.29%
Val Loss: 2.2221, Val Accuracy: 4.76%
Epoch 6/10, Train Loss: 2.3049, Train Accuracy: 14.29%
Val Loss: 2.2190, Val Accuracy: 4.76%
Epoch 7/10, Train Loss: 2.2773, Train Accuracy: 14.29%
Val Loss: 2.2160, Val Accuracy: 4.76%
Epoch 8/10, Train Loss: 2.2556, Train Accuracy: 14.29%
Val Loss: 2.2132, Val Accuracy: 6.35%
Epoch 9/10, Train Loss: 2.2374, Train Accuracy: 14.29%
Val Loss: 2.2105, Val Accuracy: 6.35%
Epoch 10/10, Train Loss: 2.2176, Train Accuracy: 14.29%
Val Loss: 2.2079, Val Accuracy: 6.35%
Baseline Model - Final Test Loss: 2.2132, Test Accuracy: 6.35%

Training LoRA adapter for domain: art_painting
Epoch 1/10, Train Loss: 2.1161, Train Accuracy: 19.64%
Val Loss: 2.5825, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.0019, Train Accuracy: 25.00%
Val Loss: 2.5496, Val Accuracy: 7.14%
Epoch 3/10, Train Loss: 1.9487, Train Accuracy: 25.00%
Val Loss: 2.5185, Val Accuracy: 7.14%
Epoch 4/10, Train Loss: 1.8355, Train Accuracy: 28.57%
Val Loss: 2.4856, Val Accuracy: 7.14%
Epoch 5/10, Train Loss: 1.7435, Train Accuracy: 33.93%
Val Loss: 2.4535, Val Accuracy: 7.14%
Epoch 6/10, Train Loss: 1.6920, Train Accuracy: 44.64%
Val Loss: 2.4173, Val Accuracy: 7.14%
Epoch 7/10, Train Loss: 1.5787, Train Accuracy: 46.43%
Val Loss: 2.3832, Val Accuracy: 7.14%
Epoch 8/10, Train Loss: 1.4852, Train Accuracy: 50.00%
Val Loss: 2.3453, Val Accuracy: 7.14%
Epoch 9/10, Train Loss: 1.4109, Train Accuracy: 51.79%
Val Loss: 2.3046, Val Accuracy: 7.14%
Epoch 10/10, Train Loss: 1.3458, Train Accuracy: 62.50%
Val Loss: 2.2634, Val Accuracy: 7.14%
art_painting adapter trained. Validation Accuracy: 7.14%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 2.2092, Train Accuracy: 14.29%
Val Loss: 2.1069, Val Accuracy: 35.71%
Epoch 2/10, Train Loss: 2.1163, Train Accuracy: 14.29%
Val Loss: 2.0699, Val Accuracy: 35.71%
Epoch 3/10, Train Loss: 2.0488, Train Accuracy: 19.64%
Val Loss: 2.0144, Val Accuracy: 35.71%
Epoch 4/10, Train Loss: 1.9557, Train Accuracy: 19.64%
Val Loss: 1.9359, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.9136, Train Accuracy: 26.79%
Val Loss: 1.8839, Val Accuracy: 35.71%
Epoch 6/10, Train Loss: 1.8401, Train Accuracy: 30.36%
Val Loss: 1.8405, Val Accuracy: 35.71%
Epoch 7/10, Train Loss: 1.7712, Train Accuracy: 33.93%
Val Loss: 1.7972, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.6798, Train Accuracy: 39.29%
Val Loss: 1.7518, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.6015, Train Accuracy: 42.86%
Val Loss: 1.7063, Val Accuracy: 35.71%
Epoch 10/10, Train Loss: 1.5349, Train Accuracy: 46.43%
Val Loss: 1.6577, Val Accuracy: 35.71%
photo adapter trained. Validation Accuracy: 35.71%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.2955, Train Accuracy: 21.43%
Val Loss: 1.8406, Val Accuracy: 21.43%
Epoch 2/10, Train Loss: 2.1198, Train Accuracy: 17.86%
Val Loss: 1.7534, Val Accuracy: 28.57%
Epoch 3/10, Train Loss: 1.9787, Train Accuracy: 21.43%
Val Loss: 1.6946, Val Accuracy: 28.57%
Epoch 4/10, Train Loss: 1.8386, Train Accuracy: 25.00%
Val Loss: 1.6611, Val Accuracy: 35.71%
Epoch 5/10, Train Loss: 1.7210, Train Accuracy: 35.71%
Val Loss: 1.6412, Val Accuracy: 42.86%
Epoch 6/10, Train Loss: 1.6564, Train Accuracy: 41.07%
Val Loss: 1.6334, Val Accuracy: 42.86%
Epoch 7/10, Train Loss: 1.5440, Train Accuracy: 48.21%
Val Loss: 1.6366, Val Accuracy: 35.71%
Epoch 8/10, Train Loss: 1.4920, Train Accuracy: 51.79%
Val Loss: 1.6431, Val Accuracy: 35.71%
Epoch 9/10, Train Loss: 1.4301, Train Accuracy: 53.57%
Val Loss: 1.6378, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.3508, Train Accuracy: 55.36%
Val Loss: 1.6149, Val Accuracy: 28.57%
sketch adapter trained. Validation Accuracy: 42.86%

Training coefficients for adapter merging
Initial coefficients: [0.33557516 0.33650073 0.3279241 ]
Epoch 1, Loss: 2.3703, Accuracy: 28.57%
Coefficients: [0.10653676 0.7893558  0.10410745]
Epoch 2, Loss: 2.3704, Accuracy: 28.57%
Coefficients: [0.07695723 0.8969631  0.02607969]
Epoch 3, Loss: 2.3735, Accuracy: 28.57%
Coefficients: [0.09706446 0.89036703 0.01256848]
Epoch 4, Loss: 2.3690, Accuracy: 28.57%
Coefficients: [0.13278966 0.8601418  0.00706855]
Epoch 5, Loss: 2.3721, Accuracy: 28.57%
Coefficients: [0.17362851 0.8220097  0.00436178]
Epoch 6, Loss: 2.3706, Accuracy: 28.57%
Coefficients: [0.32601947 0.6707343  0.00324628]
Epoch 7, Loss: 2.3676, Accuracy: 28.57%
Coefficients: [0.34068727 0.6571233  0.00218944]
Epoch 8, Loss: 2.3719, Accuracy: 28.57%
Coefficients: [0.30366123 0.69483197 0.00150678]
Epoch 9, Loss: 2.3678, Accuracy: 28.57%
Coefficients: [0.20527957 0.7937358  0.00098465]
Epoch 10, Loss: 2.3704, Accuracy: 28.57%
Coefficients: [0.2850185  0.71414286 0.00083865]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.10653676 0.7893558  0.10410745]

Merged model - Test Loss: 2.2411, Test Accuracy: 6.35%

Single Run Summary:
Test Domain: cartoon
Domain Accuracies:
  art_painting: 7.14%
  photo: 35.71%
  sketch: 42.86%
Final Accuracy: 6.35%
Coefficients: ['0.1065', '0.7894', '0.1041']

Overall Summary of All Runs:
