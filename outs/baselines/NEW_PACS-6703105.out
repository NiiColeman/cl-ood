
--- Run 1/3 ---

Running LoRA with TIES experiment
Test domain: sketch
Train domains: ['cartoon', 'art_painting', 'photo']
Baseline Epoch 1/10, Train Loss: 1.5390, Train Accuracy: 43.43%
Val Loss: 1.1778, Val Accuracy: 59.98%
Baseline Epoch 2/10, Train Loss: 0.8216, Train Accuracy: 73.36%
Val Loss: 0.9010, Val Accuracy: 63.67%
Baseline Epoch 3/10, Train Loss: 0.4141, Train Accuracy: 86.13%
Val Loss: 0.8006, Val Accuracy: 67.68%
Baseline Epoch 4/10, Train Loss: 0.2074, Train Accuracy: 94.16%
Val Loss: 0.8774, Val Accuracy: 68.17%
Baseline Epoch 5/10, Train Loss: 0.0818, Train Accuracy: 99.27%
Val Loss: 0.8605, Val Accuracy: 70.92%
Baseline Epoch 6/10, Train Loss: 0.0390, Train Accuracy: 99.64%
Val Loss: 0.8230, Val Accuracy: 72.34%
Baseline Epoch 7/10, Train Loss: 0.0214, Train Accuracy: 100.00%
Val Loss: 0.8441, Val Accuracy: 72.14%
Baseline Epoch 8/10, Train Loss: 0.0074, Train Accuracy: 100.00%
Val Loss: 0.8638, Val Accuracy: 72.71%
Baseline Epoch 9/10, Train Loss: 0.0055, Train Accuracy: 100.00%
Val Loss: 0.8410, Val Accuracy: 73.64%
Baseline Epoch 10/10, Train Loss: 0.0034, Train Accuracy: 100.00%
Val Loss: 0.8586, Val Accuracy: 73.76%
Baseline Model - Final Test Accuracy: 73.76%

Training LoRA adapter for domain: cartoon

Training LoRA adapter for domain: cartoon
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.7234, Train Accuracy: 32.53%
Val Loss: 1.1751, Val Accuracy: 59.91%
Epoch 2/10, Train Loss: 0.7204, Train Accuracy: 76.53%
Val Loss: 0.4649, Val Accuracy: 86.14%
Epoch 3/10, Train Loss: 0.2902, Train Accuracy: 91.20%
Val Loss: 0.3267, Val Accuracy: 89.98%
Epoch 4/10, Train Loss: 0.1454, Train Accuracy: 95.89%
Val Loss: 0.3044, Val Accuracy: 90.19%
Epoch 5/10, Train Loss: 0.0833, Train Accuracy: 98.13%
Val Loss: 0.2410, Val Accuracy: 92.54%
Epoch 6/10, Train Loss: 0.0437, Train Accuracy: 99.25%
Val Loss: 0.2337, Val Accuracy: 92.32%
Epoch 7/10, Train Loss: 0.0337, Train Accuracy: 99.47%
Val Loss: 0.2534, Val Accuracy: 92.96%
Epoch 8/10, Train Loss: 0.0187, Train Accuracy: 99.89%
Val Loss: 0.2103, Val Accuracy: 93.82%
Epoch 9/10, Train Loss: 0.0097, Train Accuracy: 100.00%
Val Loss: 0.2003, Val Accuracy: 95.10%
Epoch 10/10, Train Loss: 0.0059, Train Accuracy: 100.00%
Val Loss: 0.1968, Val Accuracy: 94.88%
Best validation accuracy for cartoon: 95.10%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
cartoon adapter trained. Validation Accuracy: 95.10%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Training LoRA adapter for domain: art_painting

Training LoRA adapter for domain: art_painting
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.7155, Train Accuracy: 35.53%
Val Loss: 1.2386, Val Accuracy: 59.51%
Epoch 2/10, Train Loss: 0.6227, Train Accuracy: 83.21%
Val Loss: 0.3158, Val Accuracy: 91.71%
Epoch 3/10, Train Loss: 0.1670, Train Accuracy: 96.09%
Val Loss: 0.2133, Val Accuracy: 93.41%
Epoch 4/10, Train Loss: 0.0753, Train Accuracy: 98.53%
Val Loss: 0.1874, Val Accuracy: 94.15%
Epoch 5/10, Train Loss: 0.0473, Train Accuracy: 99.02%
Val Loss: 0.1333, Val Accuracy: 95.61%
Epoch 6/10, Train Loss: 0.0161, Train Accuracy: 99.88%
Val Loss: 0.1228, Val Accuracy: 95.61%
Epoch 7/10, Train Loss: 0.0079, Train Accuracy: 100.00%
Val Loss: 0.1124, Val Accuracy: 96.59%
Epoch 8/10, Train Loss: 0.0056, Train Accuracy: 100.00%
Val Loss: 0.1109, Val Accuracy: 96.34%
Epoch 9/10, Train Loss: 0.0042, Train Accuracy: 100.00%
Val Loss: 0.1103, Val Accuracy: 96.34%
Epoch 10/10, Train Loss: 0.0038, Train Accuracy: 100.00%
Val Loss: 0.1102, Val Accuracy: 97.07%
Best validation accuracy for art_painting: 97.07%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
art_painting adapter trained. Validation Accuracy: 97.07%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Training LoRA adapter for domain: photo

Training LoRA adapter for domain: photo
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.6559, Train Accuracy: 38.40%
Val Loss: 0.9874, Val Accuracy: 68.56%
Epoch 2/10, Train Loss: 0.5594, Train Accuracy: 88.85%
Val Loss: 0.1828, Val Accuracy: 96.71%
Epoch 3/10, Train Loss: 0.0844, Train Accuracy: 98.80%
Val Loss: 0.0397, Val Accuracy: 99.40%
Epoch 4/10, Train Loss: 0.0185, Train Accuracy: 99.85%
Val Loss: 0.0187, Val Accuracy: 99.70%
Epoch 5/10, Train Loss: 0.0063, Train Accuracy: 100.00%
Val Loss: 0.0186, Val Accuracy: 99.10%
Epoch 6/10, Train Loss: 0.0034, Train Accuracy: 100.00%
Val Loss: 0.0170, Val Accuracy: 99.10%
Epoch 7/10, Train Loss: 0.0023, Train Accuracy: 100.00%
Val Loss: 0.0151, Val Accuracy: 99.10%
Epoch 8/10, Train Loss: 0.0017, Train Accuracy: 100.00%
Val Loss: 0.0105, Val Accuracy: 99.70%
Epoch 9/10, Train Loss: 0.0013, Train Accuracy: 100.00%
Val Loss: 0.0126, Val Accuracy: 99.40%
Epoch 10/10, Train Loss: 0.0010, Train Accuracy: 100.00%
Val Loss: 0.0127, Val Accuracy: 99.40%
Best validation accuracy for photo: 99.70%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
photo adapter trained. Validation Accuracy: 99.70%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Number of trained LoRA adapters: 3

Evaluating individual LoRA adapters on the test domain:
Created LoRA model: <class 'peft.peft_model.PeftModel'>
cartoon adapter - Test Loss: 2.5901, Test Accuracy: 33.74%
Created LoRA model: <class 'peft.peft_model.PeftModel'>
art_painting adapter - Test Loss: 1.2682, Test Accuracy: 51.50%
Created LoRA model: <class 'peft.peft_model.PeftModel'>
photo adapter - Test Loss: 1.6635, Test Accuracy: 39.94%

Training coefficients for adapter merging
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Coefficient gradients: tensor([6.3621e-10, 6.3621e-10, 6.3621e-10], device='cuda:0')
Coefficient gradients: tensor([-4.0245e-09, -4.0245e-09, -4.0245e-09], device='cuda:0')
Coefficient gradients: tensor([-3.3743e-09, -3.3743e-09, -3.3743e-09], device='cuda:0')
Coefficient gradients: tensor([-7.7934e-11, -7.7934e-11, -7.7934e-11], device='cuda:0')
Coefficient gradients: tensor([4.6450e-09, 4.6450e-09, 4.6450e-09], device='cuda:0')
Coefficient gradients: tensor([1.0134e-09, 1.0134e-09, 1.0134e-09], device='cuda:0')
Coefficient gradients: tensor([-4.8277e-10, -4.8277e-10, -4.8277e-10], device='cuda:0')
Coefficient gradients: tensor([-4.0555e-09, -4.0555e-09, -4.0555e-09], device='cuda:0')
Coefficient gradients: tensor([-5.0134e-09, -5.0134e-09, -5.0134e-09], device='cuda:0')
Epoch 1, Loss: 1.5867, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.2274e-09, -1.2274e-09, -1.2274e-09], device='cuda:0')
Coefficient gradients: tensor([-2.7248e-09, -2.7248e-09, -2.7248e-09], device='cuda:0')
Coefficient gradients: tensor([2.1650e-10, 2.1650e-10, 2.1650e-10], device='cuda:0')
Coefficient gradients: tensor([4.7816e-09, 4.7816e-09, 4.7816e-09], device='cuda:0')
Coefficient gradients: tensor([-9.3535e-09, -9.3535e-09, -9.3535e-09], device='cuda:0')
Coefficient gradients: tensor([1.1407e-09, 1.1407e-09, 1.1407e-09], device='cuda:0')
Coefficient gradients: tensor([-6.2711e-09, -6.2711e-09, -6.2711e-09], device='cuda:0')
Coefficient gradients: tensor([-5.4673e-09, -5.4673e-09, -5.4673e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1658e-09, -1.1658e-09, -1.1658e-09], device='cuda:0')
Epoch 2, Loss: 1.5813, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([4.5571e-09, 4.5571e-09, 4.5571e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1586e-09, -1.1586e-09, -1.1586e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7264e-09, -4.7264e-09, -4.7264e-09], device='cuda:0')
Coefficient gradients: tensor([-2.8853e-09, -2.8853e-09, -2.8853e-09], device='cuda:0')
Coefficient gradients: tensor([-5.1866e-09, -5.1866e-09, -5.1866e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4843e-10, -4.4843e-10, -4.4843e-10], device='cuda:0')
Coefficient gradients: tensor([-7.5767e-09, -7.5767e-09, -7.5767e-09], device='cuda:0')
Coefficient gradients: tensor([7.4997e-10, 7.4997e-10, 7.4997e-10], device='cuda:0')
Coefficient gradients: tensor([3.8812e-10, 3.8812e-10, 3.8812e-10], device='cuda:0')
Epoch 3, Loss: 1.5846, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([7.4885e-10, 7.4885e-10, 7.4885e-10], device='cuda:0')
Coefficient gradients: tensor([2.5737e-10, 2.5737e-10, 2.5737e-10], device='cuda:0')
Coefficient gradients: tensor([-2.5243e-09, -2.5243e-09, -2.5243e-09], device='cuda:0')
Coefficient gradients: tensor([-5.4356e-09, -5.4356e-09, -5.4356e-09], device='cuda:0')
Coefficient gradients: tensor([-7.5081e-10, -7.5081e-10, -7.5081e-10], device='cuda:0')
Coefficient gradients: tensor([-1.1016e-10, -1.1016e-10, -1.1016e-10], device='cuda:0')
Coefficient gradients: tensor([7.0981e-10, 7.0981e-10, 7.0981e-10], device='cuda:0')
Coefficient gradients: tensor([1.0313e-09, 1.0313e-09, 1.0313e-09], device='cuda:0')
Coefficient gradients: tensor([-5.2220e-10, -5.2220e-10, -5.2220e-10], device='cuda:0')
Epoch 4, Loss: 1.5986, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.2234e-09, -4.2234e-09, -4.2234e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7301e-09, -4.7301e-09, -4.7301e-09], device='cuda:0')
Coefficient gradients: tensor([-6.2265e-09, -6.2265e-09, -6.2265e-09], device='cuda:0')
Coefficient gradients: tensor([-3.7694e-09, -3.7694e-09, -3.7694e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2943e-10, -2.2943e-10, -2.2943e-10], device='cuda:0')
Coefficient gradients: tensor([5.1147e-10, 5.1147e-10, 5.1147e-10], device='cuda:0')
Coefficient gradients: tensor([-5.9861e-09, -5.9861e-09, -5.9861e-09], device='cuda:0')
Coefficient gradients: tensor([-5.3973e-10, -5.3973e-10, -5.3973e-10], device='cuda:0')
Coefficient gradients: tensor([-4.6124e-09, -4.6124e-09, -4.6124e-09], device='cuda:0')
Epoch 5, Loss: 1.5881, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.5570e-10, -3.5570e-10, -3.5570e-10], device='cuda:0')
Coefficient gradients: tensor([-4.7197e-09, -4.7197e-09, -4.7197e-09], device='cuda:0')
Coefficient gradients: tensor([-5.5660e-09, -5.5660e-09, -5.5660e-09], device='cuda:0')
Coefficient gradients: tensor([-3.8221e-10, -3.8221e-10, -3.8221e-10], device='cuda:0')
Coefficient gradients: tensor([-1.2405e-09, -1.2405e-09, -1.2405e-09], device='cuda:0')
Coefficient gradients: tensor([-4.6302e-09, -4.6302e-09, -4.6302e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0397e-09, -1.0397e-09, -1.0397e-09], device='cuda:0')
Coefficient gradients: tensor([-8.7872e-09, -8.7872e-09, -8.7872e-09], device='cuda:0')
Coefficient gradients: tensor([3.6226e-09, 3.6226e-09, 3.6226e-09], device='cuda:0')
Epoch 6, Loss: 1.5984, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-7.0473e-12, -7.0473e-12, -7.0473e-12], device='cuda:0')
Coefficient gradients: tensor([5.0443e-10, 5.0443e-10, 5.0443e-10], device='cuda:0')
Coefficient gradients: tensor([-4.1026e-09, -4.1026e-09, -4.1026e-09], device='cuda:0')
Coefficient gradients: tensor([-4.5701e-09, -4.5701e-09, -4.5701e-09], device='cuda:0')
Coefficient gradients: tensor([3.5558e-09, 3.5558e-09, 3.5558e-09], device='cuda:0')
Coefficient gradients: tensor([-5.5713e-10, -5.5713e-10, -5.5713e-10], device='cuda:0')
Coefficient gradients: tensor([-2.9705e-11, -2.9705e-11, -2.9705e-11], device='cuda:0')
Coefficient gradients: tensor([-8.4657e-09, -8.4657e-09, -8.4657e-09], device='cuda:0')
Coefficient gradients: tensor([-6.3302e-09, -6.3302e-09, -6.3302e-09], device='cuda:0')
Epoch 7, Loss: 1.5945, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-6.2261e-09, -6.2261e-09, -6.2261e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0152e-09, -1.0152e-09, -1.0152e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1605e-09, -4.1605e-09, -4.1605e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4139e-09, -4.4139e-09, -4.4139e-09], device='cuda:0')
Coefficient gradients: tensor([-7.6946e-09, -7.6946e-09, -7.6946e-09], device='cuda:0')
Coefficient gradients: tensor([-6.8868e-10, -6.8868e-10, -6.8868e-10], device='cuda:0')
Coefficient gradients: tensor([-3.8398e-09, -3.8398e-09, -3.8398e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2253e-09, -2.2253e-09, -2.2253e-09], device='cuda:0')
Coefficient gradients: tensor([5.3925e-10, 5.3925e-10, 5.3925e-10], device='cuda:0')
Epoch 8, Loss: 1.5908, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.1387e-09, -4.1387e-09, -4.1387e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1603e-09, -1.1603e-09, -1.1603e-09], device='cuda:0')
Coefficient gradients: tensor([-9.5372e-09, -9.5372e-09, -9.5372e-09], device='cuda:0')
Coefficient gradients: tensor([-4.6161e-09, -4.6161e-09, -4.6161e-09], device='cuda:0')
Coefficient gradients: tensor([-4.3814e-09, -4.3814e-09, -4.3814e-09], device='cuda:0')
Coefficient gradients: tensor([-4.2527e-10, -4.2527e-10, -4.2527e-10], device='cuda:0')
Coefficient gradients: tensor([3.6716e-09, 3.6716e-09, 3.6716e-09], device='cuda:0')
Coefficient gradients: tensor([1.0355e-09, 1.0355e-09, 1.0355e-09], device='cuda:0')
Coefficient gradients: tensor([1.3634e-09, 1.3634e-09, 1.3634e-09], device='cuda:0')
Epoch 9, Loss: 1.5832, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.0408e-09, -4.0408e-09, -4.0408e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5467e-08, -1.5467e-08, -1.5467e-08], device='cuda:0')
Coefficient gradients: tensor([2.6045e-09, 2.6045e-09, 2.6045e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4881e-09, -4.4881e-09, -4.4881e-09], device='cuda:0')
Coefficient gradients: tensor([-3.2043e-09, -3.2043e-09, -3.2043e-09], device='cuda:0')
Coefficient gradients: tensor([-7.0699e-10, -7.0699e-10, -7.0699e-10], device='cuda:0')
Coefficient gradients: tensor([-3.7350e-09, -3.7350e-09, -3.7350e-09], device='cuda:0')
Coefficient gradients: tensor([6.7019e-10, 6.7019e-10, 6.7019e-10], device='cuda:0')
Coefficient gradients: tensor([6.5487e-11, 6.5487e-11, 6.5487e-11], device='cuda:0')
Epoch 10, Loss: 1.5741, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-2.0510e-10, -2.0510e-10, -2.0510e-10], device='cuda:0')
Coefficient gradients: tensor([-2.0862e-10, -2.0862e-10, -2.0862e-10], device='cuda:0')
Coefficient gradients: tensor([-8.8252e-09, -8.8252e-09, -8.8252e-09], device='cuda:0')
Coefficient gradients: tensor([-2.0900e-09, -2.0900e-09, -2.0900e-09], device='cuda:0')
Coefficient gradients: tensor([-8.8576e-10, -8.8576e-10, -8.8576e-10], device='cuda:0')
Coefficient gradients: tensor([-1.7828e-10, -1.7828e-10, -1.7828e-10], device='cuda:0')
Coefficient gradients: tensor([-7.6956e-09, -7.6956e-09, -7.6956e-09], device='cuda:0')
Coefficient gradients: tensor([-6.1435e-09, -6.1435e-09, -6.1435e-09], device='cuda:0')
Coefficient gradients: tensor([4.1330e-09, 4.1330e-09, 4.1330e-09], device='cuda:0')
Epoch 11, Loss: 1.5526, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9019e-09, -3.9019e-09, -3.9019e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7098e-09, -4.7098e-09, -4.7098e-09], device='cuda:0')
Coefficient gradients: tensor([-3.7986e-09, -3.7986e-09, -3.7986e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5531e-10, -1.5531e-10, -1.5531e-10], device='cuda:0')
Coefficient gradients: tensor([-1.7073e-10, -1.7073e-10, -1.7073e-10], device='cuda:0')
Coefficient gradients: tensor([-3.9856e-09, -3.9856e-09, -3.9856e-09], device='cuda:0')
Coefficient gradients: tensor([-3.7814e-09, -3.7814e-09, -3.7814e-09], device='cuda:0')
Coefficient gradients: tensor([4.5495e-09, 4.5495e-09, 4.5495e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1700e-09, -1.1700e-09, -1.1700e-09], device='cuda:0')
Epoch 12, Loss: 1.5772, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.6172e-09, -4.6172e-09, -4.6172e-09], device='cuda:0')
Coefficient gradients: tensor([-1.9897e-09, -1.9897e-09, -1.9897e-09], device='cuda:0')
Coefficient gradients: tensor([1.2049e-09, 1.2049e-09, 1.2049e-09], device='cuda:0')
Coefficient gradients: tensor([-6.5377e-09, -6.5377e-09, -6.5377e-09], device='cuda:0')
Coefficient gradients: tensor([4.0123e-10, 4.0123e-10, 4.0123e-10], device='cuda:0')
Coefficient gradients: tensor([-9.5949e-10, -9.5949e-10, -9.5949e-10], device='cuda:0')
Coefficient gradients: tensor([-4.7148e-09, -4.7148e-09, -4.7148e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1213e-09, -1.1213e-09, -1.1213e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1178e-10, -1.1178e-10, -1.1178e-10], device='cuda:0')
Epoch 13, Loss: 1.5760, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-8.8043e-09, -8.8043e-09, -8.8043e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7752e-09, -4.7752e-09, -4.7752e-09], device='cuda:0')
Coefficient gradients: tensor([-6.2202e-09, -6.2202e-09, -6.2202e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7673e-09, -4.7673e-09, -4.7673e-09], device='cuda:0')
Coefficient gradients: tensor([-8.0851e-09, -8.0851e-09, -8.0851e-09], device='cuda:0')
Coefficient gradients: tensor([2.1082e-09, 2.1082e-09, 2.1082e-09], device='cuda:0')
Coefficient gradients: tensor([-5.6454e-10, -5.6454e-10, -5.6454e-10], device='cuda:0')
Coefficient gradients: tensor([-3.7615e-09, -3.7615e-09, -3.7615e-09], device='cuda:0')
Coefficient gradients: tensor([2.1044e-09, 2.1044e-09, 2.1044e-09], device='cuda:0')
Epoch 14, Loss: 1.5791, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.6125e-08, -1.6125e-08, -1.6125e-08], device='cuda:0')
Coefficient gradients: tensor([-4.7340e-11, -4.7340e-11, -4.7340e-11], device='cuda:0')
Coefficient gradients: tensor([4.4379e-09, 4.4379e-09, 4.4379e-09], device='cuda:0')
Coefficient gradients: tensor([-1.4244e-09, -1.4244e-09, -1.4244e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5901e-08, -1.5901e-08, -1.5901e-08], device='cuda:0')
Coefficient gradients: tensor([-7.3428e-10, -7.3428e-10, -7.3428e-10], device='cuda:0')
Coefficient gradients: tensor([-4.9119e-09, -4.9119e-09, -4.9119e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1240e-09, -4.1240e-09, -4.1240e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1428e-12, -1.1428e-12, -1.1428e-12], device='cuda:0')
Epoch 15, Loss: 1.5616, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9210e-09, -3.9210e-09, -3.9210e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5360e-08, -1.5360e-08, -1.5360e-08], device='cuda:0')
Coefficient gradients: tensor([-5.3046e-10, -5.3046e-10, -5.3046e-10], device='cuda:0')
Coefficient gradients: tensor([-1.5259e-09, -1.5259e-09, -1.5259e-09], device='cuda:0')
Coefficient gradients: tensor([2.1953e-09, 2.1953e-09, 2.1953e-09], device='cuda:0')
Coefficient gradients: tensor([-6.1336e-10, -6.1336e-10, -6.1336e-10], device='cuda:0')
Coefficient gradients: tensor([-9.6359e-09, -9.6359e-09, -9.6359e-09], device='cuda:0')
Coefficient gradients: tensor([-8.6832e-10, -8.6832e-10, -8.6832e-10], device='cuda:0')
Coefficient gradients: tensor([-2.2285e-09, -2.2285e-09, -2.2285e-09], device='cuda:0')
Epoch 16, Loss: 1.5796, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.1083e-09, -4.1083e-09, -4.1083e-09], device='cuda:0')
Coefficient gradients: tensor([-3.2897e-09, -3.2897e-09, -3.2897e-09], device='cuda:0')
Coefficient gradients: tensor([-7.8131e-09, -7.8131e-09, -7.8131e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0530e-09, -1.0530e-09, -1.0530e-09], device='cuda:0')
Coefficient gradients: tensor([-1.2567e-09, -1.2567e-09, -1.2567e-09], device='cuda:0')
Coefficient gradients: tensor([9.3113e-10, 9.3113e-10, 9.3113e-10], device='cuda:0')
Coefficient gradients: tensor([-8.8596e-09, -8.8596e-09, -8.8596e-09], device='cuda:0')
Coefficient gradients: tensor([5.5020e-10, 5.5020e-10, 5.5020e-10], device='cuda:0')
Coefficient gradients: tensor([-4.4436e-10, -4.4436e-10, -4.4436e-10], device='cuda:0')
Epoch 17, Loss: 1.5750, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.4280e-09, -4.4280e-09, -4.4280e-09], device='cuda:0')
Coefficient gradients: tensor([-6.4230e-09, -6.4230e-09, -6.4230e-09], device='cuda:0')
Coefficient gradients: tensor([-2.0963e-09, -2.0963e-09, -2.0963e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5528e-09, -1.5528e-09, -1.5528e-09], device='cuda:0')
Coefficient gradients: tensor([1.1257e-09, 1.1257e-09, 1.1257e-09], device='cuda:0')
Coefficient gradients: tensor([-2.9600e-09, -2.9600e-09, -2.9600e-09], device='cuda:0')
Coefficient gradients: tensor([4.2094e-09, 4.2094e-09, 4.2094e-09], device='cuda:0')
Coefficient gradients: tensor([5.4666e-10, 5.4666e-10, 5.4666e-10], device='cuda:0')
Coefficient gradients: tensor([3.7428e-11, 3.7428e-11, 3.7428e-11], device='cuda:0')
Epoch 18, Loss: 1.5778, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-5.5017e-10, -5.5017e-10, -5.5017e-10], device='cuda:0')
Coefficient gradients: tensor([-3.8423e-09, -3.8423e-09, -3.8423e-09], device='cuda:0')
Coefficient gradients: tensor([-4.2869e-09, -4.2869e-09, -4.2869e-09], device='cuda:0')
Coefficient gradients: tensor([5.6843e-14, 5.6843e-14, 5.6843e-14], device='cuda:0')
Coefficient gradients: tensor([-3.8784e-09, -3.8784e-09, -3.8784e-09], device='cuda:0')
Coefficient gradients: tensor([2.1722e-10, 2.1722e-10, 2.1722e-10], device='cuda:0')
Coefficient gradients: tensor([-3.8085e-09, -3.8085e-09, -3.8085e-09], device='cuda:0')
Coefficient gradients: tensor([-1.4145e-09, -1.4145e-09, -1.4145e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5970e-08, -1.5970e-08, -1.5970e-08], device='cuda:0')
Epoch 19, Loss: 1.6020, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9102e-09, -3.9102e-09, -3.9102e-09], device='cuda:0')
Coefficient gradients: tensor([1.6460e-09, 1.6460e-09, 1.6460e-09], device='cuda:0')
Coefficient gradients: tensor([-7.9651e-09, -7.9651e-09, -7.9651e-09], device='cuda:0')
Coefficient gradients: tensor([-3.3722e-10, -3.3722e-10, -3.3722e-10], device='cuda:0')
Coefficient gradients: tensor([-3.7555e-09, -3.7555e-09, -3.7555e-09], device='cuda:0')
Coefficient gradients: tensor([-7.6293e-09, -7.6293e-09, -7.6293e-09], device='cuda:0')
Coefficient gradients: tensor([-4.0313e-09, -4.0313e-09, -4.0313e-09], device='cuda:0')
Coefficient gradients: tensor([-4.3551e-11, -4.3551e-11, -4.3551e-11], device='cuda:0')
Coefficient gradients: tensor([-2.0276e-09, -2.0276e-09, -2.0276e-09], device='cuda:0')
Epoch 20, Loss: 1.6086, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Best coefficient accuracy: 39.42%
Final best coefficients: [0.33333334 0.33333334 0.33333334]

Merged model with TIES - Test Loss: 1.6662, Test Accuracy: 39.98%

--- Run 2/3 ---

Running LoRA with TIES experiment
Test domain: sketch
Train domains: ['cartoon', 'art_painting', 'photo']
Baseline Epoch 1/10, Train Loss: 1.5390, Train Accuracy: 43.43%
Val Loss: 1.1778, Val Accuracy: 59.98%
Baseline Epoch 2/10, Train Loss: 0.8216, Train Accuracy: 73.36%
Val Loss: 0.9010, Val Accuracy: 63.67%
Baseline Epoch 3/10, Train Loss: 0.4141, Train Accuracy: 86.13%
Val Loss: 0.8006, Val Accuracy: 67.68%
Baseline Epoch 4/10, Train Loss: 0.2074, Train Accuracy: 94.16%
Val Loss: 0.8774, Val Accuracy: 68.17%
Baseline Epoch 5/10, Train Loss: 0.0818, Train Accuracy: 99.27%
Val Loss: 0.8605, Val Accuracy: 70.92%
Baseline Epoch 6/10, Train Loss: 0.0390, Train Accuracy: 99.64%
Val Loss: 0.8229, Val Accuracy: 72.34%
Baseline Epoch 7/10, Train Loss: 0.0214, Train Accuracy: 100.00%
Val Loss: 0.8441, Val Accuracy: 72.14%
Baseline Epoch 8/10, Train Loss: 0.0074, Train Accuracy: 100.00%
Val Loss: 0.8638, Val Accuracy: 72.71%
Baseline Epoch 9/10, Train Loss: 0.0055, Train Accuracy: 100.00%
Val Loss: 0.8410, Val Accuracy: 73.64%
Baseline Epoch 10/10, Train Loss: 0.0034, Train Accuracy: 100.00%
Val Loss: 0.8586, Val Accuracy: 73.76%
Baseline Model - Final Test Accuracy: 73.76%

Training LoRA adapter for domain: cartoon

Training LoRA adapter for domain: cartoon
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.7231, Train Accuracy: 32.59%
Val Loss: 1.1744, Val Accuracy: 60.13%
Epoch 2/10, Train Loss: 0.7219, Train Accuracy: 76.43%
Val Loss: 0.4653, Val Accuracy: 85.29%
Epoch 3/10, Train Loss: 0.2919, Train Accuracy: 91.15%
Val Loss: 0.3252, Val Accuracy: 89.34%
Epoch 4/10, Train Loss: 0.1442, Train Accuracy: 95.89%
Val Loss: 0.2974, Val Accuracy: 91.68%
Epoch 5/10, Train Loss: 0.0822, Train Accuracy: 97.76%
Val Loss: 0.2413, Val Accuracy: 92.54%
Epoch 6/10, Train Loss: 0.0428, Train Accuracy: 99.25%
Val Loss: 0.2275, Val Accuracy: 93.60%
Epoch 7/10, Train Loss: 0.0322, Train Accuracy: 99.68%
Val Loss: 0.2459, Val Accuracy: 92.96%
Epoch 8/10, Train Loss: 0.0156, Train Accuracy: 100.00%
Val Loss: 0.2109, Val Accuracy: 94.03%
Epoch 9/10, Train Loss: 0.0095, Train Accuracy: 100.00%
Val Loss: 0.2002, Val Accuracy: 95.31%
Epoch 10/10, Train Loss: 0.0058, Train Accuracy: 100.00%
Val Loss: 0.1979, Val Accuracy: 95.31%
Best validation accuracy for cartoon: 95.31%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
cartoon adapter trained. Validation Accuracy: 95.31%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Training LoRA adapter for domain: art_painting

Training LoRA adapter for domain: art_painting
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.7155, Train Accuracy: 35.53%
Val Loss: 1.2385, Val Accuracy: 59.51%
Epoch 2/10, Train Loss: 0.6231, Train Accuracy: 83.27%
Val Loss: 0.3141, Val Accuracy: 91.71%
Epoch 3/10, Train Loss: 0.1677, Train Accuracy: 96.15%
Val Loss: 0.2127, Val Accuracy: 93.90%
Epoch 4/10, Train Loss: 0.0739, Train Accuracy: 98.41%
Val Loss: 0.1672, Val Accuracy: 94.63%
Epoch 5/10, Train Loss: 0.0443, Train Accuracy: 99.15%
Val Loss: 0.1302, Val Accuracy: 95.85%
Epoch 6/10, Train Loss: 0.0149, Train Accuracy: 99.88%
Val Loss: 0.1199, Val Accuracy: 96.10%
Epoch 7/10, Train Loss: 0.0077, Train Accuracy: 100.00%
Val Loss: 0.1115, Val Accuracy: 96.83%
Epoch 8/10, Train Loss: 0.0054, Train Accuracy: 100.00%
Val Loss: 0.1095, Val Accuracy: 96.59%
Epoch 9/10, Train Loss: 0.0041, Train Accuracy: 100.00%
Val Loss: 0.1087, Val Accuracy: 96.83%
Epoch 10/10, Train Loss: 0.0037, Train Accuracy: 100.00%
Val Loss: 0.1084, Val Accuracy: 96.59%
Best validation accuracy for art_painting: 96.83%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
art_painting adapter trained. Validation Accuracy: 96.83%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Training LoRA adapter for domain: photo

Training LoRA adapter for domain: photo
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.6559, Train Accuracy: 38.40%
Val Loss: 0.9875, Val Accuracy: 68.56%
Epoch 2/10, Train Loss: 0.5603, Train Accuracy: 88.40%
Val Loss: 0.1833, Val Accuracy: 97.01%
Epoch 3/10, Train Loss: 0.0851, Train Accuracy: 98.80%
Val Loss: 0.0396, Val Accuracy: 99.40%
Epoch 4/10, Train Loss: 0.0184, Train Accuracy: 99.93%
Val Loss: 0.0190, Val Accuracy: 99.70%
Epoch 5/10, Train Loss: 0.0064, Train Accuracy: 100.00%
Val Loss: 0.0178, Val Accuracy: 99.10%
Epoch 6/10, Train Loss: 0.0035, Train Accuracy: 100.00%
Val Loss: 0.0159, Val Accuracy: 99.10%
Epoch 7/10, Train Loss: 0.0023, Train Accuracy: 100.00%
Val Loss: 0.0141, Val Accuracy: 99.10%
Epoch 8/10, Train Loss: 0.0017, Train Accuracy: 100.00%
Val Loss: 0.0096, Val Accuracy: 99.70%
Epoch 9/10, Train Loss: 0.0013, Train Accuracy: 100.00%
Val Loss: 0.0113, Val Accuracy: 99.40%
Epoch 10/10, Train Loss: 0.0010, Train Accuracy: 100.00%
Val Loss: 0.0115, Val Accuracy: 99.40%
Best validation accuracy for photo: 99.70%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
photo adapter trained. Validation Accuracy: 99.70%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Number of trained LoRA adapters: 3

Evaluating individual LoRA adapters on the test domain:
Created LoRA model: <class 'peft.peft_model.PeftModel'>
cartoon adapter - Test Loss: 2.7478, Test Accuracy: 33.54%
Created LoRA model: <class 'peft.peft_model.PeftModel'>
art_painting adapter - Test Loss: 1.2557, Test Accuracy: 51.54%
Created LoRA model: <class 'peft.peft_model.PeftModel'>
photo adapter - Test Loss: 1.6747, Test Accuracy: 39.74%

Training coefficients for adapter merging
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Coefficient gradients: tensor([-4.4355e-09, -4.4355e-09, -4.4355e-09], device='cuda:0')
Coefficient gradients: tensor([-4.0192e-09, -4.0192e-09, -4.0192e-09], device='cuda:0')
Coefficient gradients: tensor([1.6229e-09, 1.6229e-09, 1.6229e-09], device='cuda:0')
Coefficient gradients: tensor([-2.8229e-10, -2.8229e-10, -2.8229e-10], device='cuda:0')
Coefficient gradients: tensor([-1.5442e-08, -1.5442e-08, -1.5442e-08], device='cuda:0')
Coefficient gradients: tensor([-4.8634e-10, -4.8634e-10, -4.8634e-10], device='cuda:0')
Coefficient gradients: tensor([-1.5430e-08, -1.5430e-08, -1.5430e-08], device='cuda:0')
Coefficient gradients: tensor([-4.2345e-09, -4.2345e-09, -4.2345e-09], device='cuda:0')
Coefficient gradients: tensor([4.7253e-09, 4.7253e-09, 4.7253e-09], device='cuda:0')
Epoch 1, Loss: 1.5953, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([1.0635e-09, 1.0635e-09, 1.0635e-09], device='cuda:0')
Coefficient gradients: tensor([-2.7792e-09, -2.7792e-09, -2.7792e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1224e-09, -1.1224e-09, -1.1224e-09], device='cuda:0')
Coefficient gradients: tensor([-3.2260e-10, -3.2260e-10, -3.2260e-10], device='cuda:0')
Coefficient gradients: tensor([-4.6549e-09, -4.6549e-09, -4.6549e-09], device='cuda:0')
Coefficient gradients: tensor([-1.9086e-10, -1.9086e-10, -1.9086e-10], device='cuda:0')
Coefficient gradients: tensor([-6.5184e-09, -6.5184e-09, -6.5184e-09], device='cuda:0')
Coefficient gradients: tensor([-4.8444e-10, -4.8444e-10, -4.8444e-10], device='cuda:0')
Coefficient gradients: tensor([-3.6739e-09, -3.6739e-09, -3.6739e-09], device='cuda:0')
Epoch 2, Loss: 1.5891, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.5374e-08, -1.5374e-08, -1.5374e-08], device='cuda:0')
Coefficient gradients: tensor([1.2312e-09, 1.2312e-09, 1.2312e-09], device='cuda:0')
Coefficient gradients: tensor([-4.8253e-09, -4.8253e-09, -4.8253e-09], device='cuda:0')
Coefficient gradients: tensor([2.0280e-09, 2.0280e-09, 2.0280e-09], device='cuda:0')
Coefficient gradients: tensor([-5.4333e-09, -5.4333e-09, -5.4333e-09], device='cuda:0')
Coefficient gradients: tensor([-1.9240e-09, -1.9240e-09, -1.9240e-09], device='cuda:0')
Coefficient gradients: tensor([-7.6505e-09, -7.6505e-09, -7.6505e-09], device='cuda:0')
Coefficient gradients: tensor([-1.8432e-09, -1.8432e-09, -1.8432e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2933e-09, -2.2933e-09, -2.2933e-09], device='cuda:0')
Epoch 3, Loss: 1.5936, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([6.7057e-10, 6.7057e-10, 6.7057e-10], device='cuda:0')
Coefficient gradients: tensor([1.6350e-10, 1.6350e-10, 1.6350e-10], device='cuda:0')
Coefficient gradients: tensor([-2.6188e-09, -2.6188e-09, -2.6188e-09], device='cuda:0')
Coefficient gradients: tensor([4.4620e-09, 4.4620e-09, 4.4620e-09], device='cuda:0')
Coefficient gradients: tensor([-8.2567e-09, -8.2567e-09, -8.2567e-09], device='cuda:0')
Coefficient gradients: tensor([2.0745e-09, 2.0745e-09, 2.0745e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4929e-09, -4.4929e-09, -4.4929e-09], device='cuda:0')
Coefficient gradients: tensor([-1.7281e-10, -1.7281e-10, -1.7281e-10], device='cuda:0')
Coefficient gradients: tensor([-5.8973e-09, -5.8973e-09, -5.8973e-09], device='cuda:0')
Epoch 4, Loss: 1.6077, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-9.3013e-09, -9.3013e-09, -9.3013e-09], device='cuda:0')
Coefficient gradients: tensor([1.3802e-10, 1.3802e-10, 1.3802e-10], device='cuda:0')
Coefficient gradients: tensor([-1.6360e-08, -1.6360e-08, -1.6360e-08], device='cuda:0')
Coefficient gradients: tensor([-8.8675e-09, -8.8675e-09, -8.8675e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5360e-09, -1.5360e-09, -1.5360e-09], device='cuda:0')
Coefficient gradients: tensor([-4.5941e-09, -4.5941e-09, -4.5941e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1279e-09, -1.1279e-09, -1.1279e-09], device='cuda:0')
Coefficient gradients: tensor([5.8048e-10, 5.8048e-10, 5.8048e-10], device='cuda:0')
Coefficient gradients: tensor([-9.7772e-09, -9.7772e-09, -9.7772e-09], device='cuda:0')
Epoch 5, Loss: 1.5969, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-2.9718e-09, -2.9718e-09, -2.9718e-09], device='cuda:0')
Coefficient gradients: tensor([-4.9023e-09, -4.9023e-09, -4.9023e-09], device='cuda:0')
Coefficient gradients: tensor([-5.7514e-09, -5.7514e-09, -5.7514e-09], device='cuda:0')
Coefficient gradients: tensor([7.0517e-10, 7.0517e-10, 7.0517e-10], device='cuda:0')
Coefficient gradients: tensor([-4.9082e-11, -4.9082e-11, -4.9082e-11], device='cuda:0')
Coefficient gradients: tensor([-4.6959e-09, -4.6959e-09, -4.6959e-09], device='cuda:0')
Coefficient gradients: tensor([-3.5106e-09, -3.5106e-09, -3.5106e-09], device='cuda:0')
Coefficient gradients: tensor([9.2785e-10, 9.2785e-10, 9.2785e-10], device='cuda:0')
Coefficient gradients: tensor([-1.5351e-09, -1.5351e-09, -1.5351e-09], device='cuda:0')
Epoch 6, Loss: 1.6073, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([5.0709e-10, 5.0709e-10, 5.0709e-10], device='cuda:0')
Coefficient gradients: tensor([4.7262e-10, 4.7262e-10, 4.7262e-10], device='cuda:0')
Coefficient gradients: tensor([8.2876e-10, 8.2876e-10, 8.2876e-10], device='cuda:0')
Coefficient gradients: tensor([2.0469e-10, 2.0469e-10, 2.0469e-10], device='cuda:0')
Coefficient gradients: tensor([-1.7082e-09, -1.7082e-09, -1.7082e-09], device='cuda:0')
Coefficient gradients: tensor([-1.9309e-09, -1.9309e-09, -1.9309e-09], device='cuda:0')
Coefficient gradients: tensor([-1.3731e-09, -1.3731e-09, -1.3731e-09], device='cuda:0')
Coefficient gradients: tensor([-8.6116e-09, -8.6116e-09, -8.6116e-09], device='cuda:0')
Coefficient gradients: tensor([3.5297e-09, 3.5297e-09, 3.5297e-09], device='cuda:0')
Epoch 7, Loss: 1.6028, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.3812e-09, -1.3812e-09, -1.3812e-09], device='cuda:0')
Coefficient gradients: tensor([2.6074e-10, 2.6074e-10, 2.6074e-10], device='cuda:0')
Coefficient gradients: tensor([-4.3366e-09, -4.3366e-09, -4.3366e-09], device='cuda:0')
Coefficient gradients: tensor([-9.5539e-09, -9.5539e-09, -9.5539e-09], device='cuda:0')
Coefficient gradients: tensor([-2.8602e-09, -2.8602e-09, -2.8602e-09], device='cuda:0')
Coefficient gradients: tensor([-5.7055e-09, -5.7055e-09, -5.7055e-09], device='cuda:0')
Coefficient gradients: tensor([-3.9601e-09, -3.9601e-09, -3.9601e-09], device='cuda:0')
Coefficient gradients: tensor([-1.2150e-09, -1.2150e-09, -1.2150e-09], device='cuda:0')
Coefficient gradients: tensor([3.3735e-10, 3.3735e-10, 3.3735e-10], device='cuda:0')
Epoch 8, Loss: 1.5993, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.4211e-09, -4.4211e-09, -4.4211e-09], device='cuda:0')
Coefficient gradients: tensor([-2.6537e-11, -2.6537e-11, -2.6537e-11], device='cuda:0')
Coefficient gradients: tensor([-4.5941e-09, -4.5941e-09, -4.5941e-09], device='cuda:0')
Coefficient gradients: tensor([4.1124e-11, 4.1124e-11, 4.1124e-11], device='cuda:0')
Coefficient gradients: tensor([-4.6404e-09, -4.6404e-09, -4.6404e-09], device='cuda:0')
Coefficient gradients: tensor([-5.6506e-10, -5.6506e-10, -5.6506e-10], device='cuda:0')
Coefficient gradients: tensor([3.7617e-09, 3.7617e-09, 3.7617e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5214e-09, -1.5214e-09, -1.5214e-09], device='cuda:0')
Coefficient gradients: tensor([-8.5327e-09, -8.5327e-09, -8.5327e-09], device='cuda:0')
Epoch 9, Loss: 1.5909, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([7.0090e-10, 7.0090e-10, 7.0090e-10], device='cuda:0')
Coefficient gradients: tensor([-1.5415e-08, -1.5415e-08, -1.5415e-08], device='cuda:0')
Coefficient gradients: tensor([-7.6723e-09, -7.6723e-09, -7.6723e-09], device='cuda:0')
Coefficient gradients: tensor([-4.5613e-09, -4.5613e-09, -4.5613e-09], device='cuda:0')
Coefficient gradients: tensor([-3.2345e-09, -3.2345e-09, -3.2345e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2095e-09, -2.2095e-09, -2.2095e-09], device='cuda:0')
Coefficient gradients: tensor([-3.8741e-09, -3.8741e-09, -3.8741e-09], device='cuda:0')
Coefficient gradients: tensor([-4.2706e-09, -4.2706e-09, -4.2706e-09], device='cuda:0')
Coefficient gradients: tensor([-1.3401e-09, -1.3401e-09, -1.3401e-09], device='cuda:0')
Epoch 10, Loss: 1.5831, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([8.1143e-10, 8.1143e-10, 8.1143e-10], device='cuda:0')
Coefficient gradients: tensor([-2.0701e-10, -2.0701e-10, -2.0701e-10], device='cuda:0')
Coefficient gradients: tensor([-1.8876e-08, -1.8876e-08, -1.8876e-08], device='cuda:0')
Coefficient gradients: tensor([2.5057e-10, 2.5057e-10, 2.5057e-10], device='cuda:0')
Coefficient gradients: tensor([-3.5607e-09, -3.5607e-09, -3.5607e-09], device='cuda:0')
Coefficient gradients: tensor([-3.6399e-10, -3.6399e-10, -3.6399e-10], device='cuda:0')
Coefficient gradients: tensor([-7.7619e-09, -7.7619e-09, -7.7619e-09], device='cuda:0')
Coefficient gradients: tensor([3.7219e-09, 3.7219e-09, 3.7219e-09], device='cuda:0')
Coefficient gradients: tensor([-9.9249e-10, -9.9249e-10, -9.9249e-10], device='cuda:0')
Epoch 11, Loss: 1.5610, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.0196e-09, -4.0196e-09, -4.0196e-09], device='cuda:0')
Coefficient gradients: tensor([2.5377e-10, 2.5377e-10, 2.5377e-10], device='cuda:0')
Coefficient gradients: tensor([-3.9987e-09, -3.9987e-09, -3.9987e-09], device='cuda:0')
Coefficient gradients: tensor([-7.8697e-09, -7.8697e-09, -7.8697e-09], device='cuda:0')
Coefficient gradients: tensor([2.3460e-09, 2.3460e-09, 2.3460e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1057e-09, -4.1057e-09, -4.1057e-09], device='cuda:0')
Coefficient gradients: tensor([-3.8512e-09, -3.8512e-09, -3.8512e-09], device='cuda:0')
Coefficient gradients: tensor([-5.6625e-09, -5.6625e-09, -5.6625e-09], device='cuda:0')
Coefficient gradients: tensor([-1.2855e-09, -1.2855e-09, -1.2855e-09], device='cuda:0')
Epoch 12, Loss: 1.5856, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.7901e-09, -4.7901e-09, -4.7901e-09], device='cuda:0')
Coefficient gradients: tensor([-2.1038e-09, -2.1038e-09, -2.1038e-09], device='cuda:0')
Coefficient gradients: tensor([-8.8026e-09, -8.8026e-09, -8.8026e-09], device='cuda:0')
Coefficient gradients: tensor([-6.7030e-09, -6.7030e-09, -6.7030e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7762e-09, -4.7762e-09, -4.7762e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1420e-09, -1.1420e-09, -1.1420e-09], device='cuda:0')
Coefficient gradients: tensor([1.0340e-10, 1.0340e-10, 1.0340e-10], device='cuda:0')
Coefficient gradients: tensor([4.6749e-11, 4.6749e-11, 4.6749e-11], device='cuda:0')
Coefficient gradients: tensor([-1.2533e-09, -1.2533e-09, -1.2533e-09], device='cuda:0')
Epoch 13, Loss: 1.5836, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9189e-09, -3.9189e-09, -3.9189e-09], device='cuda:0')
Coefficient gradients: tensor([-4.9530e-09, -4.9530e-09, -4.9530e-09], device='cuda:0')
Coefficient gradients: tensor([-1.3308e-09, -1.3308e-09, -1.3308e-09], device='cuda:0')
Coefficient gradients: tensor([-9.8551e-09, -9.8551e-09, -9.8551e-09], device='cuda:0')
Coefficient gradients: tensor([-8.1720e-10, -8.1720e-10, -8.1720e-10], device='cuda:0')
Coefficient gradients: tensor([-3.1044e-09, -3.1044e-09, -3.1044e-09], device='cuda:0')
Coefficient gradients: tensor([-3.1715e-09, -3.1715e-09, -3.1715e-09], device='cuda:0')
Coefficient gradients: tensor([1.1879e-09, 1.1879e-09, 1.1879e-09], device='cuda:0')
Coefficient gradients: tensor([-2.9648e-09, -2.9648e-09, -2.9648e-09], device='cuda:0')
Epoch 14, Loss: 1.5879, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.5120e-09, -1.5120e-09, -1.5120e-09], device='cuda:0')
Coefficient gradients: tensor([2.3508e-10, 2.3508e-10, 2.3508e-10], device='cuda:0')
Coefficient gradients: tensor([-6.2004e-10, -6.2004e-10, -6.2004e-10], device='cuda:0')
Coefficient gradients: tensor([-1.6564e-09, -1.6564e-09, -1.6564e-09], device='cuda:0')
Coefficient gradients: tensor([3.8496e-09, 3.8496e-09, 3.8496e-09], device='cuda:0')
Coefficient gradients: tensor([-8.1145e-09, -8.1145e-09, -8.1145e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5086e-08, -1.5086e-08, -1.5086e-08], device='cuda:0')
Coefficient gradients: tensor([-4.2236e-09, -4.2236e-09, -4.2236e-09], device='cuda:0')
Coefficient gradients: tensor([5.5064e-11, 5.5064e-11, 5.5064e-11], device='cuda:0')
Epoch 15, Loss: 1.5683, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.1343e-09, -4.1343e-09, -4.1343e-09], device='cuda:0')
Coefficient gradients: tensor([-5.4405e-09, -5.4405e-09, -5.4405e-09], device='cuda:0')
Coefficient gradients: tensor([4.2005e-09, 4.2005e-09, 4.2005e-09], device='cuda:0')
Coefficient gradients: tensor([-3.9740e-09, -3.9740e-09, -3.9740e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1426e-10, -4.1426e-10, -4.1426e-10], device='cuda:0')
Coefficient gradients: tensor([4.4115e-10, 4.4115e-10, 4.4115e-10], device='cuda:0')
Coefficient gradients: tensor([-4.8297e-09, -4.8297e-09, -4.8297e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0306e-09, -1.0306e-09, -1.0306e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2636e-09, -2.2636e-09, -2.2636e-09], device='cuda:0')
Epoch 16, Loss: 1.5882, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([1.0482e-09, 1.0482e-09, 1.0482e-09], device='cuda:0')
Coefficient gradients: tensor([-9.3355e-10, -9.3355e-10, -9.3355e-10], device='cuda:0')
Coefficient gradients: tensor([1.8944e-09, 1.8944e-09, 1.8944e-09], device='cuda:0')
Coefficient gradients: tensor([-1.2069e-09, -1.2069e-09, -1.2069e-09], device='cuda:0')
Coefficient gradients: tensor([9.9015e-10, 9.9015e-10, 9.9015e-10], device='cuda:0')
Coefficient gradients: tensor([-4.1463e-09, -4.1463e-09, -4.1463e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1000e-09, -4.1000e-09, -4.1000e-09], device='cuda:0')
Coefficient gradients: tensor([-9.5415e-09, -9.5415e-09, -9.5415e-09], device='cuda:0')
Coefficient gradients: tensor([-7.9913e-09, -7.9913e-09, -7.9913e-09], device='cuda:0')
Epoch 17, Loss: 1.5837, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.4285e-09, -4.4285e-09, -4.4285e-09], device='cuda:0')
Coefficient gradients: tensor([-6.5080e-09, -6.5080e-09, -6.5080e-09], device='cuda:0')
Coefficient gradients: tensor([-7.1044e-09, -7.1044e-09, -7.1044e-09], device='cuda:0')
Coefficient gradients: tensor([-5.0394e-10, -5.0394e-10, -5.0394e-10], device='cuda:0')
Coefficient gradients: tensor([1.1642e-09, 1.1642e-09, 1.1642e-09], device='cuda:0')
Coefficient gradients: tensor([-7.9817e-09, -7.9817e-09, -7.9817e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0267e-09, -1.0267e-09, -1.0267e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7064e-09, -4.7064e-09, -4.7064e-09], device='cuda:0')
Coefficient gradients: tensor([-1.5270e-10, -1.5270e-10, -1.5270e-10], device='cuda:0')
Epoch 18, Loss: 1.5871, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.0656e-08, -1.0656e-08, -1.0656e-08], device='cuda:0')
Coefficient gradients: tensor([-8.9728e-09, -8.9728e-09, -8.9728e-09], device='cuda:0')
Coefficient gradients: tensor([4.0863e-10, 4.0863e-10, 4.0863e-10], device='cuda:0')
Coefficient gradients: tensor([-2.5825e-10, -2.5825e-10, -2.5825e-10], device='cuda:0')
Coefficient gradients: tensor([9.4100e-10, 9.4100e-10, 9.4100e-10], device='cuda:0')
Coefficient gradients: tensor([-3.7409e-10, -3.7409e-10, -3.7409e-10], device='cuda:0')
Coefficient gradients: tensor([-1.2080e-09, -1.2080e-09, -1.2080e-09], device='cuda:0')
Coefficient gradients: tensor([9.5171e-10, 9.5171e-10, 9.5171e-10], device='cuda:0')
Coefficient gradients: tensor([-1.2484e-09, -1.2484e-09, -1.2484e-09], device='cuda:0')
Epoch 19, Loss: 1.6107, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.1643e-09, -4.1643e-09, -4.1643e-09], device='cuda:0')
Coefficient gradients: tensor([-9.5231e-10, -9.5231e-10, -9.5231e-10], device='cuda:0')
Coefficient gradients: tensor([-3.0573e-09, -3.0573e-09, -3.0573e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1303e-09, -4.1303e-09, -4.1303e-09], device='cuda:0')
Coefficient gradients: tensor([-3.8571e-09, -3.8571e-09, -3.8571e-09], device='cuda:0')
Coefficient gradients: tensor([2.1538e-09, 2.1538e-09, 2.1538e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1182e-09, -4.1182e-09, -4.1182e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0016e-09, -1.0016e-09, -1.0016e-09], device='cuda:0')
Coefficient gradients: tensor([-2.4236e-09, -2.4236e-09, -2.4236e-09], device='cuda:0')
Epoch 20, Loss: 1.6184, Accuracy: 39.78%
Coefficients: [0.33333334 0.33333334 0.33333334]
Best coefficient accuracy: 39.78%
Final best coefficients: [0.33333334 0.33333334 0.33333334]

Merged model with TIES - Test Loss: 1.6663, Test Accuracy: 39.82%

--- Run 3/3 ---

Running LoRA with TIES experiment
Test domain: sketch
Train domains: ['cartoon', 'art_painting', 'photo']
Baseline Epoch 1/10, Train Loss: 1.5390, Train Accuracy: 43.43%
Val Loss: 1.1778, Val Accuracy: 59.98%
Baseline Epoch 2/10, Train Loss: 0.8216, Train Accuracy: 73.36%
Val Loss: 0.9010, Val Accuracy: 63.67%
Baseline Epoch 3/10, Train Loss: 0.4141, Train Accuracy: 86.13%
Val Loss: 0.8006, Val Accuracy: 67.68%
Baseline Epoch 4/10, Train Loss: 0.2074, Train Accuracy: 94.16%
Val Loss: 0.8774, Val Accuracy: 68.17%
Baseline Epoch 5/10, Train Loss: 0.0818, Train Accuracy: 99.27%
Val Loss: 0.8605, Val Accuracy: 70.92%
Baseline Epoch 6/10, Train Loss: 0.0390, Train Accuracy: 99.64%
Val Loss: 0.8230, Val Accuracy: 72.34%
Baseline Epoch 7/10, Train Loss: 0.0214, Train Accuracy: 100.00%
Val Loss: 0.8441, Val Accuracy: 72.14%
Baseline Epoch 8/10, Train Loss: 0.0074, Train Accuracy: 100.00%
Val Loss: 0.8638, Val Accuracy: 72.71%
Baseline Epoch 9/10, Train Loss: 0.0055, Train Accuracy: 100.00%
Val Loss: 0.8410, Val Accuracy: 73.64%
Baseline Epoch 10/10, Train Loss: 0.0034, Train Accuracy: 100.00%
Val Loss: 0.8586, Val Accuracy: 73.76%
Baseline Model - Final Test Accuracy: 73.76%

Training LoRA adapter for domain: cartoon

Training LoRA adapter for domain: cartoon
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.7233, Train Accuracy: 32.53%
Val Loss: 1.1743, Val Accuracy: 59.91%
Epoch 2/10, Train Loss: 0.7188, Train Accuracy: 76.48%
Val Loss: 0.4644, Val Accuracy: 84.86%
Epoch 3/10, Train Loss: 0.2937, Train Accuracy: 90.77%
Val Loss: 0.3230, Val Accuracy: 90.41%
Epoch 4/10, Train Loss: 0.1492, Train Accuracy: 95.68%
Val Loss: 0.3078, Val Accuracy: 91.04%
Epoch 5/10, Train Loss: 0.0829, Train Accuracy: 97.97%
Val Loss: 0.2477, Val Accuracy: 92.54%
Epoch 6/10, Train Loss: 0.0432, Train Accuracy: 99.31%
Val Loss: 0.2358, Val Accuracy: 92.32%
Epoch 7/10, Train Loss: 0.0334, Train Accuracy: 99.41%
Val Loss: 0.2570, Val Accuracy: 92.32%
Epoch 8/10, Train Loss: 0.0165, Train Accuracy: 99.89%
Val Loss: 0.2257, Val Accuracy: 93.18%
Epoch 9/10, Train Loss: 0.0098, Train Accuracy: 100.00%
Val Loss: 0.2066, Val Accuracy: 94.88%
Epoch 10/10, Train Loss: 0.0061, Train Accuracy: 100.00%
Val Loss: 0.2008, Val Accuracy: 94.88%
Best validation accuracy for cartoon: 94.88%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
cartoon adapter trained. Validation Accuracy: 94.88%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Training LoRA adapter for domain: art_painting

Training LoRA adapter for domain: art_painting
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.7155, Train Accuracy: 35.53%
Val Loss: 1.2385, Val Accuracy: 59.51%
Epoch 2/10, Train Loss: 0.6231, Train Accuracy: 83.33%
Val Loss: 0.3112, Val Accuracy: 91.71%
Epoch 3/10, Train Loss: 0.1678, Train Accuracy: 96.03%
Val Loss: 0.2066, Val Accuracy: 93.66%
Epoch 4/10, Train Loss: 0.0759, Train Accuracy: 98.60%
Val Loss: 0.1626, Val Accuracy: 95.61%
Epoch 5/10, Train Loss: 0.0450, Train Accuracy: 99.15%
Val Loss: 0.1336, Val Accuracy: 96.34%
Epoch 6/10, Train Loss: 0.0150, Train Accuracy: 99.88%
Val Loss: 0.1203, Val Accuracy: 96.34%
Epoch 7/10, Train Loss: 0.0075, Train Accuracy: 100.00%
Val Loss: 0.1103, Val Accuracy: 96.83%
Epoch 8/10, Train Loss: 0.0053, Train Accuracy: 100.00%
Val Loss: 0.1100, Val Accuracy: 96.34%
Epoch 9/10, Train Loss: 0.0040, Train Accuracy: 100.00%
Val Loss: 0.1088, Val Accuracy: 96.83%
Epoch 10/10, Train Loss: 0.0037, Train Accuracy: 100.00%
Val Loss: 0.1094, Val Accuracy: 96.59%
Best validation accuracy for art_painting: 96.83%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
art_painting adapter trained. Validation Accuracy: 96.83%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Training LoRA adapter for domain: photo

Training LoRA adapter for domain: photo
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Epoch 1/10, Train Loss: 1.6559, Train Accuracy: 38.40%
Val Loss: 0.9874, Val Accuracy: 68.56%
Epoch 2/10, Train Loss: 0.5593, Train Accuracy: 88.70%
Val Loss: 0.1837, Val Accuracy: 96.41%
Epoch 3/10, Train Loss: 0.0847, Train Accuracy: 98.88%
Val Loss: 0.0397, Val Accuracy: 99.40%
Epoch 4/10, Train Loss: 0.0185, Train Accuracy: 99.78%
Val Loss: 0.0188, Val Accuracy: 99.70%
Epoch 5/10, Train Loss: 0.0063, Train Accuracy: 100.00%
Val Loss: 0.0188, Val Accuracy: 99.10%
Epoch 6/10, Train Loss: 0.0034, Train Accuracy: 100.00%
Val Loss: 0.0171, Val Accuracy: 99.10%
Epoch 7/10, Train Loss: 0.0023, Train Accuracy: 100.00%
Val Loss: 0.0153, Val Accuracy: 99.10%
Epoch 8/10, Train Loss: 0.0017, Train Accuracy: 100.00%
Val Loss: 0.0105, Val Accuracy: 99.70%
Epoch 9/10, Train Loss: 0.0013, Train Accuracy: 100.00%
Val Loss: 0.0126, Val Accuracy: 99.40%
Epoch 10/10, Train Loss: 0.0010, Train Accuracy: 100.00%
Val Loss: 0.0128, Val Accuracy: 99.40%
Best validation accuracy for photo: 99.70%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])
photo adapter trained. Validation Accuracy: 99.70%
LoRA state keys: dict_keys(['base_model.model.blocks.0.attn.qkv.lora_A.weight', 'base_model.model.blocks.0.attn.qkv.lora_B.weight', 'base_model.model.blocks.1.attn.qkv.lora_A.weight', 'base_model.model.blocks.1.attn.qkv.lora_B.weight', 'base_model.model.blocks.2.attn.qkv.lora_A.weight', 'base_model.model.blocks.2.attn.qkv.lora_B.weight', 'base_model.model.blocks.3.attn.qkv.lora_A.weight', 'base_model.model.blocks.3.attn.qkv.lora_B.weight', 'base_model.model.blocks.4.attn.qkv.lora_A.weight', 'base_model.model.blocks.4.attn.qkv.lora_B.weight', 'base_model.model.blocks.5.attn.qkv.lora_A.weight', 'base_model.model.blocks.5.attn.qkv.lora_B.weight', 'base_model.model.blocks.6.attn.qkv.lora_A.weight', 'base_model.model.blocks.6.attn.qkv.lora_B.weight', 'base_model.model.blocks.7.attn.qkv.lora_A.weight', 'base_model.model.blocks.7.attn.qkv.lora_B.weight', 'base_model.model.blocks.8.attn.qkv.lora_A.weight', 'base_model.model.blocks.8.attn.qkv.lora_B.weight', 'base_model.model.blocks.9.attn.qkv.lora_A.weight', 'base_model.model.blocks.9.attn.qkv.lora_B.weight', 'base_model.model.blocks.10.attn.qkv.lora_A.weight', 'base_model.model.blocks.10.attn.qkv.lora_B.weight', 'base_model.model.blocks.11.attn.qkv.lora_A.weight', 'base_model.model.blocks.11.attn.qkv.lora_B.weight'])

Number of trained LoRA adapters: 3

Evaluating individual LoRA adapters on the test domain:
Created LoRA model: <class 'peft.peft_model.PeftModel'>
cartoon adapter - Test Loss: 2.5993, Test Accuracy: 34.14%
Created LoRA model: <class 'peft.peft_model.PeftModel'>
art_painting adapter - Test Loss: 1.2606, Test Accuracy: 51.42%
Created LoRA model: <class 'peft.peft_model.PeftModel'>
photo adapter - Test Loss: 1.6651, Test Accuracy: 39.98%

Training coefficients for adapter merging
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Created LoRA model: <class 'peft.peft_model.PeftModel'>
Coefficient gradients: tensor([-4.3797e-09, -4.3797e-09, -4.3797e-09], device='cuda:0')
Coefficient gradients: tensor([-3.9641e-09, -3.9641e-09, -3.9641e-09], device='cuda:0')
Coefficient gradients: tensor([-8.3265e-09, -8.3265e-09, -8.3265e-09], device='cuda:0')
Coefficient gradients: tensor([-7.5047e-10, -7.5047e-10, -7.5047e-10], device='cuda:0')
Coefficient gradients: tensor([-3.5314e-10, -3.5314e-10, -3.5314e-10], device='cuda:0')
Coefficient gradients: tensor([-2.9084e-10, -2.9084e-10, -2.9084e-10], device='cuda:0')
Coefficient gradients: tensor([-5.4184e-09, -5.4184e-09, -5.4184e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1105e-09, -4.1105e-09, -4.1105e-09], device='cuda:0')
Coefficient gradients: tensor([-1.4931e-08, -1.4931e-08, -1.4931e-08], device='cuda:0')
Epoch 1, Loss: 1.5873, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-8.7098e-09, -8.7098e-09, -8.7098e-09], device='cuda:0')
Coefficient gradients: tensor([-2.7232e-09, -2.7232e-09, -2.7232e-09], device='cuda:0')
Coefficient gradients: tensor([-7.4571e-11, -7.4571e-11, -7.4571e-11], device='cuda:0')
Coefficient gradients: tensor([-1.5120e-08, -1.5120e-08, -1.5120e-08], device='cuda:0')
Coefficient gradients: tensor([5.5082e-10, 5.5082e-10, 5.5082e-10], device='cuda:0')
Coefficient gradients: tensor([-3.8847e-09, -3.8847e-09, -3.8847e-09], device='cuda:0')
Coefficient gradients: tensor([3.6207e-09, 3.6207e-09, 3.6207e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7980e-10, -4.7980e-10, -4.7980e-10], device='cuda:0')
Coefficient gradients: tensor([1.3550e-09, 1.3550e-09, 1.3550e-09], device='cuda:0')
Epoch 2, Loss: 1.5819, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.8241e-10, -3.8241e-10, -3.8241e-10], device='cuda:0')
Coefficient gradients: tensor([-1.2002e-09, -1.2002e-09, -1.2002e-09], device='cuda:0')
Coefficient gradients: tensor([2.3210e-10, 2.3210e-10, 2.3210e-10], device='cuda:0')
Coefficient gradients: tensor([2.0838e-09, 2.0838e-09, 2.0838e-09], device='cuda:0')
Coefficient gradients: tensor([4.7694e-09, 4.7694e-09, 4.7694e-09], device='cuda:0')
Coefficient gradients: tensor([-1.7849e-09, -1.7849e-09, -1.7849e-09], device='cuda:0')
Coefficient gradients: tensor([-1.7518e-08, -1.7518e-08, -1.7518e-08], device='cuda:0')
Coefficient gradients: tensor([-1.7683e-09, -1.7683e-09, -1.7683e-09], device='cuda:0')
Coefficient gradients: tensor([3.9236e-10, 3.9236e-10, 3.9236e-10], device='cuda:0')
Epoch 3, Loss: 1.5855, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-9.2117e-09, -9.2117e-09, -9.2117e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2537e-09, -2.2537e-09, -2.2537e-09], device='cuda:0')
Coefficient gradients: tensor([-7.4971e-09, -7.4971e-09, -7.4971e-09], device='cuda:0')
Coefficient gradients: tensor([4.5024e-09, 4.5024e-09, 4.5024e-09], device='cuda:0')
Coefficient gradients: tensor([-7.6385e-10, -7.6385e-10, -7.6385e-10], device='cuda:0')
Coefficient gradients: tensor([-1.4168e-10, -1.4168e-10, -1.4168e-10], device='cuda:0')
Coefficient gradients: tensor([-4.2942e-09, -4.2942e-09, -4.2942e-09], device='cuda:0')
Coefficient gradients: tensor([1.0547e-09, 1.0547e-09, 1.0547e-09], device='cuda:0')
Coefficient gradients: tensor([-5.5230e-09, -5.5230e-09, -5.5230e-09], device='cuda:0')
Epoch 4, Loss: 1.5995, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-9.1982e-09, -9.1982e-09, -9.1982e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2602e-09, -2.2602e-09, -2.2602e-09], device='cuda:0')
Coefficient gradients: tensor([-6.2573e-09, -6.2573e-09, -6.2573e-09], device='cuda:0')
Coefficient gradients: tensor([-3.7813e-09, -3.7813e-09, -3.7813e-09], device='cuda:0')
Coefficient gradients: tensor([-2.2153e-10, -2.2153e-10, -2.2153e-10], device='cuda:0')
Coefficient gradients: tensor([-4.4651e-09, -4.4651e-09, -4.4651e-09], device='cuda:0')
Coefficient gradients: tensor([-6.0203e-09, -6.0203e-09, -6.0203e-09], device='cuda:0')
Coefficient gradients: tensor([8.4551e-11, 8.4551e-11, 8.4551e-11], device='cuda:0')
Coefficient gradients: tensor([2.8975e-10, 2.8975e-10, 2.8975e-10], device='cuda:0')
Epoch 5, Loss: 1.5892, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-2.8765e-09, -2.8765e-09, -2.8765e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7185e-09, -4.7185e-09, -4.7185e-09], device='cuda:0')
Coefficient gradients: tensor([4.3691e-09, 4.3691e-09, 4.3691e-09], device='cuda:0')
Coefficient gradients: tensor([-1.6592e-09, -1.6592e-09, -1.6592e-09], device='cuda:0')
Coefficient gradients: tensor([-1.2821e-09, -1.2821e-09, -1.2821e-09], device='cuda:0')
Coefficient gradients: tensor([-4.5923e-09, -4.5923e-09, -4.5923e-09], device='cuda:0')
Coefficient gradients: tensor([-3.5456e-09, -3.5456e-09, -3.5456e-09], device='cuda:0')
Coefficient gradients: tensor([-3.8508e-09, -3.8508e-09, -3.8508e-09], device='cuda:0')
Coefficient gradients: tensor([-6.3218e-09, -6.3218e-09, -6.3218e-09], device='cuda:0')
Epoch 6, Loss: 1.5994, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([5.6466e-10, 5.6466e-10, 5.6466e-10], device='cuda:0')
Coefficient gradients: tensor([-4.4718e-09, -4.4718e-09, -4.4718e-09], device='cuda:0')
Coefficient gradients: tensor([8.7309e-10, 8.7309e-10, 8.7309e-10], device='cuda:0')
Coefficient gradients: tensor([-4.5944e-09, -4.5944e-09, -4.5944e-09], device='cuda:0')
Coefficient gradients: tensor([3.5790e-09, 3.5790e-09, 3.5790e-09], device='cuda:0')
Coefficient gradients: tensor([-1.8245e-09, -1.8245e-09, -1.8245e-09], device='cuda:0')
Coefficient gradients: tensor([-3.7530e-09, -3.7530e-09, -3.7530e-09], device='cuda:0')
Coefficient gradients: tensor([-8.5183e-09, -8.5183e-09, -8.5183e-09], device='cuda:0')
Coefficient gradients: tensor([-6.3407e-09, -6.3407e-09, -6.3407e-09], device='cuda:0')
Epoch 7, Loss: 1.5953, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.3046e-09, -1.3046e-09, -1.3046e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0384e-09, -1.0384e-09, -1.0384e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1984e-09, -4.1984e-09, -4.1984e-09], device='cuda:0')
Coefficient gradients: tensor([-4.3739e-09, -4.3739e-09, -4.3739e-09], device='cuda:0')
Coefficient gradients: tensor([-2.3134e-10, -2.3134e-10, -2.3134e-10], device='cuda:0')
Coefficient gradients: tensor([-7.0509e-10, -7.0509e-10, -7.0509e-10], device='cuda:0')
Coefficient gradients: tensor([-3.8338e-09, -3.8338e-09, -3.8338e-09], device='cuda:0')
Coefficient gradients: tensor([-1.0509e-09, -1.0509e-09, -1.0509e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4300e-09, -4.4300e-09, -4.4300e-09], device='cuda:0')
Epoch 8, Loss: 1.5916, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.1640e-09, -4.1640e-09, -4.1640e-09], device='cuda:0')
Coefficient gradients: tensor([-1.1460e-09, -1.1460e-09, -1.1460e-09], device='cuda:0')
Coefficient gradients: tensor([-9.5240e-09, -9.5240e-09, -9.5240e-09], device='cuda:0')
Coefficient gradients: tensor([-4.6502e-09, -4.6502e-09, -4.6502e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4468e-09, -4.4468e-09, -4.4468e-09], device='cuda:0')
Coefficient gradients: tensor([-7.8949e-09, -7.8949e-09, -7.8949e-09], device='cuda:0')
Coefficient gradients: tensor([-6.2703e-09, -6.2703e-09, -6.2703e-09], device='cuda:0')
Coefficient gradients: tensor([-2.0348e-10, -2.0348e-10, -2.0348e-10], device='cuda:0')
Coefficient gradients: tensor([-3.6245e-09, -3.6245e-09, -3.6245e-09], device='cuda:0')
Epoch 9, Loss: 1.5840, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.1297e-09, -4.1297e-09, -4.1297e-09], device='cuda:0')
Coefficient gradients: tensor([-5.2450e-10, -5.2450e-10, -5.2450e-10], device='cuda:0')
Coefficient gradients: tensor([-7.3885e-09, -7.3885e-09, -7.3885e-09], device='cuda:0')
Coefficient gradients: tensor([-4.4396e-09, -4.4396e-09, -4.4396e-09], device='cuda:0')
Coefficient gradients: tensor([-7.1246e-10, -7.1246e-10, -7.1246e-10], device='cuda:0')
Coefficient gradients: tensor([-1.2303e-10, -1.2303e-10, -1.2303e-10], device='cuda:0')
Coefficient gradients: tensor([-3.7570e-09, -3.7570e-09, -3.7570e-09], device='cuda:0')
Coefficient gradients: tensor([6.5275e-10, 6.5275e-10, 6.5275e-10], device='cuda:0')
Coefficient gradients: tensor([5.2405e-11, 5.2405e-11, 5.2405e-11], device='cuda:0')
Epoch 10, Loss: 1.5751, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.4689e-09, -1.4689e-09, -1.4689e-09], device='cuda:0')
Coefficient gradients: tensor([-7.7020e-09, -7.7020e-09, -7.7020e-09], device='cuda:0')
Coefficient gradients: tensor([1.0694e-09, 1.0694e-09, 1.0694e-09], device='cuda:0')
Coefficient gradients: tensor([-2.0806e-09, -2.0806e-09, -2.0806e-09], device='cuda:0')
Coefficient gradients: tensor([1.6452e-09, 1.6452e-09, 1.6452e-09], device='cuda:0')
Coefficient gradients: tensor([-1.8171e-10, -1.8171e-10, -1.8171e-10], device='cuda:0')
Coefficient gradients: tensor([-7.7421e-09, -7.7421e-09, -7.7421e-09], device='cuda:0')
Coefficient gradients: tensor([3.7749e-09, 3.7749e-09, 3.7749e-09], device='cuda:0')
Coefficient gradients: tensor([3.7243e-10, 3.7243e-10, 3.7243e-10], device='cuda:0')
Epoch 11, Loss: 1.5534, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9310e-09, -3.9310e-09, -3.9310e-09], device='cuda:0')
Coefficient gradients: tensor([-4.6369e-09, -4.6369e-09, -4.6369e-09], device='cuda:0')
Coefficient gradients: tensor([1.1247e-09, 1.1247e-09, 1.1247e-09], device='cuda:0')
Coefficient gradients: tensor([-2.7450e-09, -2.7450e-09, -2.7450e-09], device='cuda:0')
Coefficient gradients: tensor([2.3289e-09, 2.3289e-09, 2.3289e-09], device='cuda:0')
Coefficient gradients: tensor([-3.9573e-09, -3.9573e-09, -3.9573e-09], device='cuda:0')
Coefficient gradients: tensor([-8.7281e-09, -8.7281e-09, -8.7281e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7011e-10, -4.7011e-10, -4.7011e-10], device='cuda:0')
Coefficient gradients: tensor([2.4163e-12, 2.4163e-12, 2.4163e-12], device='cuda:0')
Epoch 12, Loss: 1.5783, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.5894e-09, -4.5894e-09, -4.5894e-09], device='cuda:0')
Coefficient gradients: tensor([-1.9947e-09, -1.9947e-09, -1.9947e-09], device='cuda:0')
Coefficient gradients: tensor([-8.7568e-09, -8.7568e-09, -8.7568e-09], device='cuda:0')
Coefficient gradients: tensor([3.3803e-09, 3.3803e-09, 3.3803e-09], device='cuda:0')
Coefficient gradients: tensor([3.5221e-10, 3.5221e-10, 3.5221e-10], device='cuda:0')
Coefficient gradients: tensor([-1.0055e-09, -1.0055e-09, -1.0055e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7616e-09, -4.7616e-09, -4.7616e-09], device='cuda:0')
Coefficient gradients: tensor([1.2412e-10, 1.2412e-10, 1.2412e-10], device='cuda:0')
Coefficient gradients: tensor([-1.3070e-09, -1.3070e-09, -1.3070e-09], device='cuda:0')
Epoch 13, Loss: 1.5767, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([1.1531e-09, 1.1531e-09, 1.1531e-09], device='cuda:0')
Coefficient gradients: tensor([-4.7976e-09, -4.7976e-09, -4.7976e-09], device='cuda:0')
Coefficient gradients: tensor([-1.6189e-08, -1.6189e-08, -1.6189e-08], device='cuda:0')
Coefficient gradients: tensor([2.5059e-10, 2.5059e-10, 2.5059e-10], device='cuda:0')
Coefficient gradients: tensor([-6.9363e-10, -6.9363e-10, -6.9363e-10], device='cuda:0')
Coefficient gradients: tensor([2.0365e-09, 2.0365e-09, 2.0365e-09], device='cuda:0')
Coefficient gradients: tensor([-3.0787e-09, -3.0787e-09, -3.0787e-09], device='cuda:0')
Coefficient gradients: tensor([-1.4602e-11, -1.4602e-11, -1.4602e-11], device='cuda:0')
Coefficient gradients: tensor([-2.8810e-09, -2.8810e-09, -2.8810e-09], device='cuda:0')
Epoch 14, Loss: 1.5800, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-1.2980e-09, -1.2980e-09, -1.2980e-09], device='cuda:0')
Coefficient gradients: tensor([7.2472e-11, 7.2472e-11, 7.2472e-11], device='cuda:0')
Coefficient gradients: tensor([-5.5501e-09, -5.5501e-09, -5.5501e-09], device='cuda:0')
Coefficient gradients: tensor([-1.4803e-09, -1.4803e-09, -1.4803e-09], device='cuda:0')
Coefficient gradients: tensor([-9.9183e-10, -9.9183e-10, -9.9183e-10], device='cuda:0')
Coefficient gradients: tensor([1.7923e-09, 1.7923e-09, 1.7923e-09], device='cuda:0')
Coefficient gradients: tensor([5.3873e-11, 5.3873e-11, 5.3873e-11], device='cuda:0')
Coefficient gradients: tensor([-4.1321e-09, -4.1321e-09, -4.1321e-09], device='cuda:0')
Coefficient gradients: tensor([1.1804e-10, 1.1804e-10, 1.1804e-10], device='cuda:0')
Epoch 15, Loss: 1.5620, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9516e-09, -3.9516e-09, -3.9516e-09], device='cuda:0')
Coefficient gradients: tensor([-5.3827e-09, -5.3827e-09, -5.3827e-09], device='cuda:0')
Coefficient gradients: tensor([-5.5090e-09, -5.5090e-09, -5.5090e-09], device='cuda:0')
Coefficient gradients: tensor([-2.5896e-10, -2.5896e-10, -2.5896e-10], device='cuda:0')
Coefficient gradients: tensor([-2.7823e-09, -2.7823e-09, -2.7823e-09], device='cuda:0')
Coefficient gradients: tensor([-5.3853e-11, -5.3853e-11, -5.3853e-11], device='cuda:0')
Coefficient gradients: tensor([-4.6875e-09, -4.6875e-09, -4.6875e-09], device='cuda:0')
Coefficient gradients: tensor([-5.8697e-09, -5.8697e-09, -5.8697e-09], device='cuda:0')
Coefficient gradients: tensor([1.9418e-10, 1.9418e-10, 1.9418e-10], device='cuda:0')
Epoch 16, Loss: 1.5807, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.0875e-09, -4.0875e-09, -4.0875e-09], device='cuda:0')
Coefficient gradients: tensor([1.6336e-09, 1.6336e-09, 1.6336e-09], device='cuda:0')
Coefficient gradients: tensor([-1.7757e-08, -1.7757e-08, -1.7757e-08], device='cuda:0')
Coefficient gradients: tensor([-1.0676e-09, -1.0676e-09, -1.0676e-09], device='cuda:0')
Coefficient gradients: tensor([-9.4231e-11, -9.4231e-11, -9.4231e-11], device='cuda:0')
Coefficient gradients: tensor([-3.9705e-09, -3.9705e-09, -3.9705e-09], device='cuda:0')
Coefficient gradients: tensor([-8.8696e-09, -8.8696e-09, -8.8696e-09], device='cuda:0')
Coefficient gradients: tensor([5.0491e-10, 5.0491e-10, 5.0491e-10], device='cuda:0')
Coefficient gradients: tensor([-2.9569e-09, -2.9569e-09, -2.9569e-09], device='cuda:0')
Epoch 17, Loss: 1.5760, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-4.4071e-09, -4.4071e-09, -4.4071e-09], device='cuda:0')
Coefficient gradients: tensor([3.4681e-09, 3.4681e-09, 3.4681e-09], device='cuda:0')
Coefficient gradients: tensor([2.8885e-09, 2.8885e-09, 2.8885e-09], device='cuda:0')
Coefficient gradients: tensor([-3.5603e-10, -3.5603e-10, -3.5603e-10], device='cuda:0')
Coefficient gradients: tensor([1.1194e-09, 1.1194e-09, 1.1194e-09], device='cuda:0')
Coefficient gradients: tensor([-4.2851e-10, -4.2851e-10, -4.2851e-10], device='cuda:0')
Coefficient gradients: tensor([-8.2139e-10, -8.2139e-10, -8.2139e-10], device='cuda:0')
Coefficient gradients: tensor([-9.4179e-09, -9.4179e-09, -9.4179e-09], device='cuda:0')
Coefficient gradients: tensor([-4.8383e-10, -4.8383e-10, -4.8383e-10], device='cuda:0')
Epoch 18, Loss: 1.5788, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-5.7017e-10, -5.7017e-10, -5.7017e-10], device='cuda:0')
Coefficient gradients: tensor([1.1044e-09, 1.1044e-09, 1.1044e-09], device='cuda:0')
Coefficient gradients: tensor([-4.3403e-09, -4.3403e-09, -4.3403e-09], device='cuda:0')
Coefficient gradients: tensor([-6.7223e-11, -6.7223e-11, -6.7223e-11], device='cuda:0')
Coefficient gradients: tensor([-3.8845e-09, -3.8845e-09, -3.8845e-09], device='cuda:0')
Coefficient gradients: tensor([-4.1117e-10, -4.1117e-10, -4.1117e-10], device='cuda:0')
Coefficient gradients: tensor([1.1986e-09, 1.1986e-09, 1.1986e-09], device='cuda:0')
Coefficient gradients: tensor([-1.7132e-10, -1.7132e-10, -1.7132e-10], device='cuda:0')
Coefficient gradients: tensor([-1.0674e-09, -1.0674e-09, -1.0674e-09], device='cuda:0')
Epoch 19, Loss: 1.6028, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Coefficient gradients: tensor([-3.9420e-09, -3.9420e-09, -3.9420e-09], device='cuda:0')
Coefficient gradients: tensor([-8.4483e-10, -8.4483e-10, -8.4483e-10], device='cuda:0')
Coefficient gradients: tensor([-2.9720e-09, -2.9720e-09, -2.9720e-09], device='cuda:0')
Coefficient gradients: tensor([-3.2292e-10, -3.2292e-10, -3.2292e-10], device='cuda:0')
Coefficient gradients: tensor([-3.7954e-09, -3.7954e-09, -3.7954e-09], device='cuda:0')
Coefficient gradients: tensor([-7.7028e-09, -7.7028e-09, -7.7028e-09], device='cuda:0')
Coefficient gradients: tensor([-3.9708e-09, -3.9708e-09, -3.9708e-09], device='cuda:0')
Coefficient gradients: tensor([-9.7311e-10, -9.7311e-10, -9.7311e-10], device='cuda:0')
Coefficient gradients: tensor([-2.1756e-09, -2.1756e-09, -2.1756e-09], device='cuda:0')
Epoch 20, Loss: 1.6102, Accuracy: 39.42%
Coefficients: [0.33333334 0.33333334 0.33333334]
Best coefficient accuracy: 39.42%
Final best coefficients: [0.33333334 0.33333334 0.33333334]

Merged model with TIES - Test Loss: 1.6660, Test Accuracy: 40.11%

Summary of All Runs:
Baseline Model Accuracy: 73.76% ± 0.00%
Merged Model Accuracy: 39.97% ± 0.12%
Average Coefficients:
  cartoon: 0.3333 ± 0.0000
  art_painting: 0.3333 ± 0.0000
  photo: 0.3333 ± 0.0000
