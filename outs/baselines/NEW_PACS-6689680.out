
--- Run 1/10 ---
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: tucson
Training domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'x5', 'zoe']

Running LoRA with Separate Classifiers experiment
Test domain: tucson
Train domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'x5', 'zoe']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 0.9108, Train Accuracy: 69.00%
Val Loss: 0.2645, Val Accuracy: 94.39%
Epoch 2/10, Train Loss: 0.1023, Train Accuracy: 98.33%
Val Loss: 0.1142, Val Accuracy: 97.28%
Epoch 3/10, Train Loss: 0.0376, Train Accuracy: 99.67%
Val Loss: 0.0657, Val Accuracy: 98.11%
Epoch 4/10, Train Loss: 0.0078, Train Accuracy: 100.00%
Val Loss: 0.0583, Val Accuracy: 98.17%
Epoch 5/10, Train Loss: 0.0024, Train Accuracy: 100.00%
Val Loss: 0.0498, Val Accuracy: 98.48%
Epoch 6/10, Train Loss: 0.0015, Train Accuracy: 100.00%
Val Loss: 0.0466, Val Accuracy: 98.59%
Epoch 7/10, Train Loss: 0.0012, Train Accuracy: 100.00%
Val Loss: 0.0461, Val Accuracy: 98.65%
Epoch 8/10, Train Loss: 0.0010, Train Accuracy: 100.00%
Val Loss: 0.0471, Val Accuracy: 98.59%
Epoch 9/10, Train Loss: 0.0008, Train Accuracy: 100.00%
Val Loss: 0.0462, Val Accuracy: 98.59%
Epoch 10/10, Train Loss: 0.0007, Train Accuracy: 100.00%
Val Loss: 0.0462, Val Accuracy: 98.59%
Baseline Model - Final Test Loss: 0.0461, Test Accuracy: 98.65%

Training LoRA adapter for domain: aclass
Epoch 1/10, Train Loss: 1.9216, Train Accuracy: 24.06%
Val Loss: 1.5441, Val Accuracy: 43.50%
Epoch 2/10, Train Loss: 1.2198, Train Accuracy: 58.44%
Val Loss: 0.9530, Val Accuracy: 69.58%
Epoch 3/10, Train Loss: 0.6343, Train Accuracy: 82.60%
Val Loss: 0.4615, Val Accuracy: 86.58%
Epoch 4/10, Train Loss: 0.2990, Train Accuracy: 92.58%
Val Loss: 0.2529, Val Accuracy: 92.67%
Epoch 5/10, Train Loss: 0.1759, Train Accuracy: 95.60%
Val Loss: 0.1642, Val Accuracy: 96.00%
Epoch 6/10, Train Loss: 0.1161, Train Accuracy: 97.02%
Val Loss: 0.1128, Val Accuracy: 97.42%
Epoch 7/10, Train Loss: 0.0783, Train Accuracy: 98.25%
Val Loss: 0.0833, Val Accuracy: 97.92%
Epoch 8/10, Train Loss: 0.0559, Train Accuracy: 99.04%
Val Loss: 0.0637, Val Accuracy: 98.25%
Epoch 9/10, Train Loss: 0.0414, Train Accuracy: 99.35%
Val Loss: 0.0495, Val Accuracy: 99.00%
Epoch 10/10, Train Loss: 0.0313, Train Accuracy: 99.54%
Val Loss: 0.0420, Val Accuracy: 99.25%
aclass adapter trained. Validation Accuracy: 99.25%

Training LoRA adapter for domain: escape
Epoch 1/10, Train Loss: 1.9450, Train Accuracy: 22.90%
Val Loss: 1.5585, Val Accuracy: 44.50%
Epoch 2/10, Train Loss: 1.3619, Train Accuracy: 53.73%
Val Loss: 1.1066, Val Accuracy: 62.67%
Epoch 3/10, Train Loss: 0.8768, Train Accuracy: 70.27%
Val Loss: 0.6269, Val Accuracy: 77.25%
Epoch 4/10, Train Loss: 0.4466, Train Accuracy: 85.65%
Val Loss: 0.3219, Val Accuracy: 89.67%
Epoch 5/10, Train Loss: 0.2339, Train Accuracy: 93.54%
Val Loss: 0.1816, Val Accuracy: 96.33%
Epoch 6/10, Train Loss: 0.1290, Train Accuracy: 97.71%
Val Loss: 0.1069, Val Accuracy: 97.83%
Epoch 7/10, Train Loss: 0.0756, Train Accuracy: 98.96%
Val Loss: 0.0720, Val Accuracy: 98.33%
Epoch 8/10, Train Loss: 0.0499, Train Accuracy: 99.42%
Val Loss: 0.0521, Val Accuracy: 98.75%
Epoch 9/10, Train Loss: 0.0351, Train Accuracy: 99.62%
Val Loss: 0.0416, Val Accuracy: 99.17%
Epoch 10/10, Train Loss: 0.0264, Train Accuracy: 99.75%
Val Loss: 0.0347, Val Accuracy: 99.33%
escape adapter trained. Validation Accuracy: 99.33%

Training LoRA adapter for domain: hilux
Epoch 1/10, Train Loss: 2.0035, Train Accuracy: 23.92%
Val Loss: 1.6537, Val Accuracy: 41.67%
Epoch 2/10, Train Loss: 1.4072, Train Accuracy: 50.00%
Val Loss: 1.1676, Val Accuracy: 61.58%
Epoch 3/10, Train Loss: 0.9314, Train Accuracy: 72.04%
Val Loss: 0.7077, Val Accuracy: 80.42%
Epoch 4/10, Train Loss: 0.5235, Train Accuracy: 86.35%
Val Loss: 0.3850, Val Accuracy: 90.75%
Epoch 5/10, Train Loss: 0.2939, Train Accuracy: 93.94%
Val Loss: 0.2350, Val Accuracy: 94.33%
Epoch 6/10, Train Loss: 0.1954, Train Accuracy: 95.85%
Val Loss: 0.1881, Val Accuracy: 95.67%
Epoch 7/10, Train Loss: 0.1539, Train Accuracy: 96.79%
Val Loss: 0.1558, Val Accuracy: 96.17%
Epoch 8/10, Train Loss: 0.1329, Train Accuracy: 97.02%
Val Loss: 0.1346, Val Accuracy: 96.92%
Epoch 9/10, Train Loss: 0.1180, Train Accuracy: 97.17%
Val Loss: 0.1206, Val Accuracy: 97.08%
Epoch 10/10, Train Loss: 0.1053, Train Accuracy: 97.33%
Val Loss: 0.1132, Val Accuracy: 96.92%
hilux adapter trained. Validation Accuracy: 97.08%

Training LoRA adapter for domain: i3
Epoch 1/10, Train Loss: 1.9840, Train Accuracy: 20.66%
Val Loss: 1.6961, Val Accuracy: 35.38%
Epoch 2/10, Train Loss: 1.4165, Train Accuracy: 50.66%
Val Loss: 1.1350, Val Accuracy: 64.75%
Epoch 3/10, Train Loss: 0.8804, Train Accuracy: 74.16%
Val Loss: 0.6555, Val Accuracy: 81.38%
Epoch 4/10, Train Loss: 0.5092, Train Accuracy: 86.84%
Val Loss: 0.3855, Val Accuracy: 89.38%
Epoch 5/10, Train Loss: 0.2982, Train Accuracy: 92.69%
Val Loss: 0.2220, Val Accuracy: 95.12%
Epoch 6/10, Train Loss: 0.1829, Train Accuracy: 96.09%
Val Loss: 0.1396, Val Accuracy: 97.75%
Epoch 7/10, Train Loss: 0.1162, Train Accuracy: 98.16%
Val Loss: 0.0981, Val Accuracy: 98.62%
Epoch 8/10, Train Loss: 0.0799, Train Accuracy: 98.94%
Val Loss: 0.0721, Val Accuracy: 98.88%
Epoch 9/10, Train Loss: 0.0576, Train Accuracy: 99.31%
Val Loss: 0.0527, Val Accuracy: 99.38%
Epoch 10/10, Train Loss: 0.0437, Train Accuracy: 99.53%
Val Loss: 0.0396, Val Accuracy: 99.50%
i3 adapter trained. Validation Accuracy: 99.50%

Training LoRA adapter for domain: lexus
Epoch 1/10, Train Loss: 1.9532, Train Accuracy: 22.17%
Val Loss: 1.6304, Val Accuracy: 40.58%
Epoch 2/10, Train Loss: 1.3698, Train Accuracy: 51.85%
Val Loss: 1.1034, Val Accuracy: 62.42%
Epoch 3/10, Train Loss: 0.8784, Train Accuracy: 72.54%
Val Loss: 0.6708, Val Accuracy: 79.42%
Epoch 4/10, Train Loss: 0.4971, Train Accuracy: 86.02%
Val Loss: 0.3962, Val Accuracy: 89.25%
Epoch 5/10, Train Loss: 0.2870, Train Accuracy: 92.40%
Val Loss: 0.2516, Val Accuracy: 92.75%
Epoch 6/10, Train Loss: 0.1839, Train Accuracy: 95.33%
Val Loss: 0.1775, Val Accuracy: 94.67%
Epoch 7/10, Train Loss: 0.1283, Train Accuracy: 96.46%
Val Loss: 0.1303, Val Accuracy: 96.17%
Epoch 8/10, Train Loss: 0.0912, Train Accuracy: 97.75%
Val Loss: 0.1009, Val Accuracy: 97.33%
Epoch 9/10, Train Loss: 0.0643, Train Accuracy: 98.71%
Val Loss: 0.0802, Val Accuracy: 98.08%
Epoch 10/10, Train Loss: 0.0474, Train Accuracy: 99.23%
Val Loss: 0.0756, Val Accuracy: 97.83%
lexus adapter trained. Validation Accuracy: 98.08%

Training LoRA adapter for domain: tesla
Epoch 1/10, Train Loss: 1.7937, Train Accuracy: 31.10%
Val Loss: 1.4408, Val Accuracy: 49.33%
Epoch 2/10, Train Loss: 1.2159, Train Accuracy: 58.00%
Val Loss: 0.9648, Val Accuracy: 70.25%
Epoch 3/10, Train Loss: 0.7013, Train Accuracy: 78.56%
Val Loss: 0.4873, Val Accuracy: 86.58%
Epoch 4/10, Train Loss: 0.3655, Train Accuracy: 89.25%
Val Loss: 0.2737, Val Accuracy: 93.67%
Epoch 5/10, Train Loss: 0.2198, Train Accuracy: 94.38%
Val Loss: 0.1665, Val Accuracy: 96.75%
Epoch 6/10, Train Loss: 0.1454, Train Accuracy: 97.04%
Val Loss: 0.1154, Val Accuracy: 97.67%
Epoch 7/10, Train Loss: 0.1052, Train Accuracy: 98.19%
Val Loss: 0.0851, Val Accuracy: 98.50%
Epoch 8/10, Train Loss: 0.0824, Train Accuracy: 98.60%
Val Loss: 0.0634, Val Accuracy: 98.83%
Epoch 9/10, Train Loss: 0.0678, Train Accuracy: 98.90%
Val Loss: 0.0525, Val Accuracy: 99.00%
Epoch 10/10, Train Loss: 0.0579, Train Accuracy: 99.00%
Val Loss: 0.0470, Val Accuracy: 99.17%
tesla adapter trained. Validation Accuracy: 99.17%

Training LoRA adapter for domain: tiguan
Epoch 1/10, Train Loss: 1.9759, Train Accuracy: 23.35%
Val Loss: 1.5947, Val Accuracy: 44.83%
Epoch 2/10, Train Loss: 1.2736, Train Accuracy: 57.94%
Val Loss: 1.0633, Val Accuracy: 65.50%
Epoch 3/10, Train Loss: 0.8219, Train Accuracy: 74.33%
Val Loss: 0.6537, Val Accuracy: 80.17%
Epoch 4/10, Train Loss: 0.4539, Train Accuracy: 87.52%
Val Loss: 0.3287, Val Accuracy: 91.25%
Epoch 5/10, Train Loss: 0.2359, Train Accuracy: 94.35%
Val Loss: 0.1900, Val Accuracy: 96.42%
Epoch 6/10, Train Loss: 0.1488, Train Accuracy: 97.15%
Val Loss: 0.1324, Val Accuracy: 97.67%
Epoch 7/10, Train Loss: 0.1077, Train Accuracy: 98.02%
Val Loss: 0.1017, Val Accuracy: 98.00%
Epoch 8/10, Train Loss: 0.0857, Train Accuracy: 98.29%
Val Loss: 0.0833, Val Accuracy: 98.25%
Epoch 9/10, Train Loss: 0.0696, Train Accuracy: 98.60%
Val Loss: 0.0700, Val Accuracy: 98.33%
Epoch 10/10, Train Loss: 0.0584, Train Accuracy: 98.75%
Val Loss: 0.0600, Val Accuracy: 98.42%
tiguan adapter trained. Validation Accuracy: 98.42%

Training LoRA adapter for domain: x5
Epoch 1/10, Train Loss: 1.8488, Train Accuracy: 28.94%
Val Loss: 1.4924, Val Accuracy: 46.75%
Epoch 2/10, Train Loss: 1.2162, Train Accuracy: 57.52%
Val Loss: 1.0153, Val Accuracy: 67.33%
Epoch 3/10, Train Loss: 0.7736, Train Accuracy: 74.25%
Val Loss: 0.5873, Val Accuracy: 80.75%
Epoch 4/10, Train Loss: 0.4448, Train Accuracy: 85.15%
Val Loss: 0.3488, Val Accuracy: 88.58%
Epoch 5/10, Train Loss: 0.2742, Train Accuracy: 91.62%
Val Loss: 0.2216, Val Accuracy: 93.67%
Epoch 6/10, Train Loss: 0.1826, Train Accuracy: 95.00%
Val Loss: 0.1499, Val Accuracy: 96.00%
Epoch 7/10, Train Loss: 0.1230, Train Accuracy: 97.19%
Val Loss: 0.1014, Val Accuracy: 97.42%
Epoch 8/10, Train Loss: 0.0826, Train Accuracy: 98.29%
Val Loss: 0.0697, Val Accuracy: 98.92%
Epoch 9/10, Train Loss: 0.0585, Train Accuracy: 98.92%
Val Loss: 0.0519, Val Accuracy: 99.08%
Epoch 10/10, Train Loss: 0.0427, Train Accuracy: 99.31%
Val Loss: 0.0402, Val Accuracy: 99.58%
x5 adapter trained. Validation Accuracy: 99.58%

Training LoRA adapter for domain: zoe
Epoch 1/10, Train Loss: 1.8262, Train Accuracy: 31.41%
Val Loss: 1.6041, Val Accuracy: 40.00%
Epoch 2/10, Train Loss: 1.3779, Train Accuracy: 51.69%
Val Loss: 1.1409, Val Accuracy: 64.62%
Epoch 3/10, Train Loss: 0.9099, Train Accuracy: 74.00%
Val Loss: 0.6847, Val Accuracy: 84.00%
Epoch 4/10, Train Loss: 0.5195, Train Accuracy: 87.75%
Val Loss: 0.3660, Val Accuracy: 93.00%
Epoch 5/10, Train Loss: 0.2795, Train Accuracy: 94.66%
Val Loss: 0.1991, Val Accuracy: 97.00%
Epoch 6/10, Train Loss: 0.1653, Train Accuracy: 97.44%
Val Loss: 0.1272, Val Accuracy: 98.38%
Epoch 7/10, Train Loss: 0.1123, Train Accuracy: 98.31%
Val Loss: 0.0926, Val Accuracy: 99.00%
Epoch 8/10, Train Loss: 0.0848, Train Accuracy: 98.72%
Val Loss: 0.0749, Val Accuracy: 99.12%
Epoch 9/10, Train Loss: 0.0678, Train Accuracy: 99.12%
Val Loss: 0.0597, Val Accuracy: 99.25%
Epoch 10/10, Train Loss: 0.0562, Train Accuracy: 99.09%
Val Loss: 0.0526, Val Accuracy: 99.38%
zoe adapter trained. Validation Accuracy: 99.38%

Training coefficients for adapter merging
Initial coefficients: [0.11077616 0.11118622 0.11500411 0.1104231  0.110641   0.11021249
 0.11128806 0.11039676 0.11007214]
Epoch 1, Loss: 1.6027, Accuracy: 49.67%
Coefficients: [2.5391444e-06 2.5195277e-03 9.9665231e-01 6.4910006e-07 6.9566659e-04
 1.5715819e-05 2.1839200e-05 5.4183627e-05 3.7552774e-05]
Epoch 2, Loss: 1.6045, Accuracy: 49.83%
Coefficients: [4.6559300e-08 5.2220539e-06 9.9997401e-01 9.5439283e-09 1.7579461e-05
 4.0902910e-07 3.1029458e-07 1.2053717e-06 1.2501771e-06]
Epoch 3, Loss: 1.6015, Accuracy: 50.00%
Coefficients: [2.3733120e-08 1.8442033e-06 9.9998701e-01 4.6878808e-09 9.3952567e-06
 2.2112685e-07 1.5153914e-07 6.3478888e-07 7.0485731e-07]
Epoch 4, Loss: 1.6038, Accuracy: 49.67%
Coefficients: [2.1286640e-08 1.5594790e-06 9.9998832e-01 4.1796686e-09 8.5402089e-06
 2.0021363e-07 1.3498808e-07 5.7232529e-07 6.4270870e-07]
Epoch 5, Loss: 1.6055, Accuracy: 50.00%
Coefficients: [2.0936769e-08 1.5199334e-06 9.9998844e-01 4.1071071e-09 8.4958074e-06
 1.9720422e-07 1.3262981e-07 5.6336899e-07 6.3493388e-07]
Epoch 6, Loss: 1.5943, Accuracy: 49.83%
Coefficients: [2.0877032e-08 1.5132961e-06 9.9998844e-01 4.0947401e-09 8.5688371e-06
 1.9668752e-07 1.3223475e-07 5.6197496e-07 6.3373722e-07]
Epoch 7, Loss: 1.6099, Accuracy: 49.83%
Coefficients: [2.0875916e-08 1.5130131e-06 9.9998832e-01 4.0942245e-09 8.6398559e-06
 1.9675315e-07 1.3221972e-07 5.6201344e-07 6.3443565e-07]
Epoch 8, Loss: 1.6030, Accuracy: 50.17%
Coefficients: [2.0855300e-08 1.5114109e-06 9.9998832e-01 4.0901891e-09 8.6872978e-06
 1.9655980e-07 1.3208765e-07 5.6145205e-07 6.3327565e-07]
Epoch 9, Loss: 1.6044, Accuracy: 50.17%
Coefficients: [2.0827274e-08 1.5094689e-06 9.9998820e-01 4.0845909e-09 8.7668031e-06
 1.9632991e-07 1.3190963e-07 5.6077664e-07 6.3289821e-07]
Epoch 10, Loss: 1.6060, Accuracy: 49.83%
Coefficients: [2.0786038e-08 1.5065251e-06 9.9998820e-01 4.0764268e-09 8.7236685e-06
 1.9594403e-07 1.3164735e-07 5.5957190e-07 6.3140789e-07]
Best coefficient accuracy: 50.17%
Final best coefficients: [2.0855300e-08 1.5114109e-06 9.9998832e-01 4.0901891e-09 8.6872978e-06
 1.9655980e-07 1.3208765e-07 5.6145205e-07 6.3327565e-07]

Merged model - Test Loss: 1.5828, Test Accuracy: 50.39%

Single Run Summary:
Test Domain: tucson
Domain Accuracies:
  aclass: 99.25%
  escape: 99.33%
  hilux: 97.08%
  i3: 99.50%
  lexus: 98.08%
  tesla: 99.17%
  tiguan: 98.42%
  x5: 99.58%
  zoe: 99.38%
Final Accuracy: 50.39%
Coefficients: ['0.0000', '0.0000', '1.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000']

--- Run 2/10 ---
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: i3
Training domains: ['aclass', 'escape', 'hilux', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Running LoRA with Separate Classifiers experiment
Test domain: i3
Train domains: ['aclass', 'escape', 'hilux', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.1069, Train Accuracy: 56.75%
Val Loss: 0.7523, Val Accuracy: 73.61%
Epoch 2/10, Train Loss: 0.6688, Train Accuracy: 78.50%
Val Loss: 0.5452, Val Accuracy: 84.47%
Epoch 3/10, Train Loss: 0.5221, Train Accuracy: 84.25%
Val Loss: 0.4534, Val Accuracy: 87.14%
Epoch 4/10, Train Loss: 0.4374, Train Accuracy: 88.50%
Val Loss: 0.3878, Val Accuracy: 88.86%
Epoch 5/10, Train Loss: 0.3696, Train Accuracy: 89.75%
Val Loss: 0.3424, Val Accuracy: 90.00%
Epoch 6/10, Train Loss: 0.3143, Train Accuracy: 91.50%
Val Loss: 0.3095, Val Accuracy: 91.22%
Epoch 7/10, Train Loss: 0.2761, Train Accuracy: 93.00%
Val Loss: 0.2827, Val Accuracy: 92.47%
Epoch 8/10, Train Loss: 0.2394, Train Accuracy: 94.50%
Val Loss: 0.2609, Val Accuracy: 93.06%
Epoch 9/10, Train Loss: 0.2159, Train Accuracy: 94.75%
Val Loss: 0.2422, Val Accuracy: 93.36%
Epoch 10/10, Train Loss: 0.1909, Train Accuracy: 95.75%
Val Loss: 0.2257, Val Accuracy: 94.14%
Baseline Model - Final Test Loss: 0.2257, Test Accuracy: 94.14%

Training LoRA adapter for domain: aclass
Epoch 1/10, Train Loss: 1.9170, Train Accuracy: 24.21%
Val Loss: 1.5933, Val Accuracy: 41.00%
Epoch 2/10, Train Loss: 1.2459, Train Accuracy: 55.83%
Val Loss: 1.0026, Val Accuracy: 69.17%
Epoch 3/10, Train Loss: 0.6712, Train Accuracy: 80.94%
Val Loss: 0.4636, Val Accuracy: 88.50%
Epoch 4/10, Train Loss: 0.3145, Train Accuracy: 91.98%
Val Loss: 0.2416, Val Accuracy: 93.75%
Epoch 5/10, Train Loss: 0.1792, Train Accuracy: 95.27%
Val Loss: 0.1508, Val Accuracy: 96.08%
Epoch 6/10, Train Loss: 0.1162, Train Accuracy: 96.88%
Val Loss: 0.1059, Val Accuracy: 97.25%
Epoch 7/10, Train Loss: 0.0812, Train Accuracy: 98.02%
Val Loss: 0.0757, Val Accuracy: 97.92%
Epoch 8/10, Train Loss: 0.0594, Train Accuracy: 98.73%
Val Loss: 0.0594, Val Accuracy: 98.92%
Epoch 9/10, Train Loss: 0.0449, Train Accuracy: 99.19%
Val Loss: 0.0448, Val Accuracy: 99.17%
Epoch 10/10, Train Loss: 0.0342, Train Accuracy: 99.44%
Val Loss: 0.0377, Val Accuracy: 99.33%
aclass adapter trained. Validation Accuracy: 99.33%

Training LoRA adapter for domain: escape
Epoch 1/10, Train Loss: 1.9638, Train Accuracy: 22.04%
Val Loss: 1.6246, Val Accuracy: 43.67%
Epoch 2/10, Train Loss: 1.3919, Train Accuracy: 52.25%
Val Loss: 1.1918, Val Accuracy: 61.50%
Epoch 3/10, Train Loss: 0.9277, Train Accuracy: 69.48%
Val Loss: 0.7021, Val Accuracy: 75.33%
Epoch 4/10, Train Loss: 0.4833, Train Accuracy: 85.02%
Val Loss: 0.3538, Val Accuracy: 89.67%
Epoch 5/10, Train Loss: 0.2499, Train Accuracy: 93.48%
Val Loss: 0.2063, Val Accuracy: 94.25%
Epoch 6/10, Train Loss: 0.1446, Train Accuracy: 96.71%
Val Loss: 0.1326, Val Accuracy: 96.00%
Epoch 7/10, Train Loss: 0.0893, Train Accuracy: 98.50%
Val Loss: 0.0821, Val Accuracy: 98.58%
Epoch 8/10, Train Loss: 0.0602, Train Accuracy: 99.04%
Val Loss: 0.0584, Val Accuracy: 98.92%
Epoch 9/10, Train Loss: 0.0427, Train Accuracy: 99.31%
Val Loss: 0.0432, Val Accuracy: 99.33%
Epoch 10/10, Train Loss: 0.0317, Train Accuracy: 99.58%
Val Loss: 0.0335, Val Accuracy: 99.42%
escape adapter trained. Validation Accuracy: 99.42%

Training LoRA adapter for domain: hilux
Epoch 1/10, Train Loss: 2.0070, Train Accuracy: 23.17%
Val Loss: 1.6640, Val Accuracy: 42.42%
Epoch 2/10, Train Loss: 1.3959, Train Accuracy: 50.85%
Val Loss: 1.1782, Val Accuracy: 59.83%
Epoch 3/10, Train Loss: 0.8939, Train Accuracy: 73.21%
Val Loss: 0.6800, Val Accuracy: 81.17%
Epoch 4/10, Train Loss: 0.4720, Train Accuracy: 88.31%
Val Loss: 0.3607, Val Accuracy: 91.75%
Epoch 5/10, Train Loss: 0.2591, Train Accuracy: 94.60%
Val Loss: 0.2293, Val Accuracy: 95.67%
Epoch 6/10, Train Loss: 0.1753, Train Accuracy: 96.27%
Val Loss: 0.1794, Val Accuracy: 96.25%
Epoch 7/10, Train Loss: 0.1402, Train Accuracy: 96.81%
Val Loss: 0.1619, Val Accuracy: 96.33%
Epoch 8/10, Train Loss: 0.1202, Train Accuracy: 97.10%
Val Loss: 0.1430, Val Accuracy: 96.67%
Epoch 9/10, Train Loss: 0.1074, Train Accuracy: 97.25%
Val Loss: 0.1366, Val Accuracy: 96.58%
Epoch 10/10, Train Loss: 0.0956, Train Accuracy: 97.25%
Val Loss: 0.1294, Val Accuracy: 96.92%
hilux adapter trained. Validation Accuracy: 96.92%

Training LoRA adapter for domain: lexus
Epoch 1/10, Train Loss: 1.9309, Train Accuracy: 23.12%
Val Loss: 1.6037, Val Accuracy: 41.92%
Epoch 2/10, Train Loss: 1.3496, Train Accuracy: 52.92%
Val Loss: 1.0819, Val Accuracy: 64.75%
Epoch 3/10, Train Loss: 0.8495, Train Accuracy: 73.52%
Val Loss: 0.6378, Val Accuracy: 80.50%
Epoch 4/10, Train Loss: 0.4832, Train Accuracy: 85.73%
Val Loss: 0.3637, Val Accuracy: 90.33%
Epoch 5/10, Train Loss: 0.2834, Train Accuracy: 92.62%
Val Loss: 0.2255, Val Accuracy: 94.25%
Epoch 6/10, Train Loss: 0.1853, Train Accuracy: 95.67%
Val Loss: 0.1613, Val Accuracy: 96.00%
Epoch 7/10, Train Loss: 0.1318, Train Accuracy: 96.73%
Val Loss: 0.1180, Val Accuracy: 96.50%
Epoch 8/10, Train Loss: 0.0956, Train Accuracy: 97.69%
Val Loss: 0.0873, Val Accuracy: 97.25%
Epoch 9/10, Train Loss: 0.0698, Train Accuracy: 98.44%
Val Loss: 0.0691, Val Accuracy: 98.17%
Epoch 10/10, Train Loss: 0.0533, Train Accuracy: 99.04%
Val Loss: 0.0576, Val Accuracy: 98.50%
lexus adapter trained. Validation Accuracy: 98.50%

Training LoRA adapter for domain: tesla
Epoch 1/10, Train Loss: 1.7967, Train Accuracy: 31.04%
Val Loss: 1.4718, Val Accuracy: 47.33%
Epoch 2/10, Train Loss: 1.2584, Train Accuracy: 55.88%
Val Loss: 1.0427, Val Accuracy: 64.42%
Epoch 3/10, Train Loss: 0.7770, Train Accuracy: 76.42%
Val Loss: 0.5324, Val Accuracy: 83.33%
Epoch 4/10, Train Loss: 0.4063, Train Accuracy: 88.04%
Val Loss: 0.2865, Val Accuracy: 92.33%
Epoch 5/10, Train Loss: 0.2365, Train Accuracy: 93.69%
Val Loss: 0.1786, Val Accuracy: 95.50%
Epoch 6/10, Train Loss: 0.1523, Train Accuracy: 97.10%
Val Loss: 0.1227, Val Accuracy: 98.33%
Epoch 7/10, Train Loss: 0.1077, Train Accuracy: 98.12%
Val Loss: 0.0931, Val Accuracy: 98.17%
Epoch 8/10, Train Loss: 0.0820, Train Accuracy: 98.75%
Val Loss: 0.0736, Val Accuracy: 99.00%
Epoch 9/10, Train Loss: 0.0666, Train Accuracy: 99.00%
Val Loss: 0.0686, Val Accuracy: 98.83%
Epoch 10/10, Train Loss: 0.0556, Train Accuracy: 99.02%
Val Loss: 0.0565, Val Accuracy: 99.25%
tesla adapter trained. Validation Accuracy: 99.25%

Training LoRA adapter for domain: tiguan
Epoch 1/10, Train Loss: 1.9716, Train Accuracy: 23.92%
Val Loss: 1.5729, Val Accuracy: 45.00%
Epoch 2/10, Train Loss: 1.2926, Train Accuracy: 56.31%
Val Loss: 1.0220, Val Accuracy: 66.17%
Epoch 3/10, Train Loss: 0.8298, Train Accuracy: 74.17%
Val Loss: 0.6119, Val Accuracy: 81.75%
Epoch 4/10, Train Loss: 0.4525, Train Accuracy: 88.27%
Val Loss: 0.3104, Val Accuracy: 93.00%
Epoch 5/10, Train Loss: 0.2380, Train Accuracy: 94.48%
Val Loss: 0.1820, Val Accuracy: 95.58%
Epoch 6/10, Train Loss: 0.1514, Train Accuracy: 96.94%
Val Loss: 0.1359, Val Accuracy: 96.83%
Epoch 7/10, Train Loss: 0.1117, Train Accuracy: 97.75%
Val Loss: 0.0972, Val Accuracy: 98.08%
Epoch 8/10, Train Loss: 0.0847, Train Accuracy: 98.17%
Val Loss: 0.0796, Val Accuracy: 98.17%
Epoch 9/10, Train Loss: 0.0670, Train Accuracy: 98.56%
Val Loss: 0.0664, Val Accuracy: 98.42%
Epoch 10/10, Train Loss: 0.0532, Train Accuracy: 98.81%
Val Loss: 0.0564, Val Accuracy: 98.58%
tiguan adapter trained. Validation Accuracy: 98.58%

Training LoRA adapter for domain: tucson
Epoch 1/10, Train Loss: 1.8324, Train Accuracy: 31.46%
Val Loss: 1.4502, Val Accuracy: 48.33%
Epoch 2/10, Train Loss: 1.1550, Train Accuracy: 60.44%
Val Loss: 0.9387, Val Accuracy: 70.08%
Epoch 3/10, Train Loss: 0.7021, Train Accuracy: 77.83%
Val Loss: 0.5122, Val Accuracy: 85.67%
Epoch 4/10, Train Loss: 0.3765, Train Accuracy: 90.92%
Val Loss: 0.2804, Val Accuracy: 93.00%
Epoch 5/10, Train Loss: 0.2223, Train Accuracy: 95.38%
Val Loss: 0.1798, Val Accuracy: 96.25%
Epoch 6/10, Train Loss: 0.1482, Train Accuracy: 96.71%
Val Loss: 0.1254, Val Accuracy: 97.17%
Epoch 7/10, Train Loss: 0.1031, Train Accuracy: 97.58%
Val Loss: 0.0918, Val Accuracy: 98.00%
Epoch 8/10, Train Loss: 0.0725, Train Accuracy: 98.48%
Val Loss: 0.0702, Val Accuracy: 98.42%
Epoch 9/10, Train Loss: 0.0520, Train Accuracy: 99.02%
Val Loss: 0.0558, Val Accuracy: 98.67%
Epoch 10/10, Train Loss: 0.0376, Train Accuracy: 99.42%
Val Loss: 0.0421, Val Accuracy: 99.17%
tucson adapter trained. Validation Accuracy: 99.17%

Training LoRA adapter for domain: x5
Epoch 1/10, Train Loss: 1.8709, Train Accuracy: 26.90%
Val Loss: 1.5099, Val Accuracy: 44.92%
Epoch 2/10, Train Loss: 1.1991, Train Accuracy: 58.29%
Val Loss: 1.0190, Val Accuracy: 64.25%
Epoch 3/10, Train Loss: 0.7458, Train Accuracy: 75.96%
Val Loss: 0.6073, Val Accuracy: 78.33%
Epoch 4/10, Train Loss: 0.4305, Train Accuracy: 86.42%
Val Loss: 0.3574, Val Accuracy: 88.58%
Epoch 5/10, Train Loss: 0.2637, Train Accuracy: 92.60%
Val Loss: 0.2297, Val Accuracy: 93.25%
Epoch 6/10, Train Loss: 0.1705, Train Accuracy: 95.83%
Val Loss: 0.1598, Val Accuracy: 95.25%
Epoch 7/10, Train Loss: 0.1125, Train Accuracy: 97.71%
Val Loss: 0.1088, Val Accuracy: 97.25%
Epoch 8/10, Train Loss: 0.0758, Train Accuracy: 98.56%
Val Loss: 0.0837, Val Accuracy: 97.75%
Epoch 9/10, Train Loss: 0.0530, Train Accuracy: 99.08%
Val Loss: 0.0658, Val Accuracy: 97.67%
Epoch 10/10, Train Loss: 0.0391, Train Accuracy: 99.40%
Val Loss: 0.0618, Val Accuracy: 98.17%
x5 adapter trained. Validation Accuracy: 98.17%

Training LoRA adapter for domain: zoe
Epoch 1/10, Train Loss: 1.8155, Train Accuracy: 31.75%
Val Loss: 1.6015, Val Accuracy: 38.88%
Epoch 2/10, Train Loss: 1.3720, Train Accuracy: 51.75%
Val Loss: 1.1438, Val Accuracy: 64.12%
Epoch 3/10, Train Loss: 0.9125, Train Accuracy: 73.53%
Val Loss: 0.7101, Val Accuracy: 79.75%
Epoch 4/10, Train Loss: 0.5332, Train Accuracy: 87.84%
Val Loss: 0.3931, Val Accuracy: 91.12%
Epoch 5/10, Train Loss: 0.2906, Train Accuracy: 94.66%
Val Loss: 0.2183, Val Accuracy: 96.50%
Epoch 6/10, Train Loss: 0.1688, Train Accuracy: 97.00%
Val Loss: 0.1382, Val Accuracy: 98.00%
Epoch 7/10, Train Loss: 0.1145, Train Accuracy: 98.34%
Val Loss: 0.0981, Val Accuracy: 99.00%
Epoch 8/10, Train Loss: 0.0861, Train Accuracy: 98.69%
Val Loss: 0.0769, Val Accuracy: 99.38%
Epoch 9/10, Train Loss: 0.0690, Train Accuracy: 98.88%
Val Loss: 0.0649, Val Accuracy: 99.38%
Epoch 10/10, Train Loss: 0.0594, Train Accuracy: 99.16%
Val Loss: 0.0546, Val Accuracy: 99.50%
zoe adapter trained. Validation Accuracy: 99.50%

Training coefficients for adapter merging
Initial coefficients: [0.11182256 0.11208049 0.11123234 0.11193466 0.1108643  0.11136514
 0.10941533 0.10977484 0.1115103 ]
Epoch 1, Loss: 1.6148, Accuracy: 44.50%
Coefficients: [1.2420973e-02 9.8497415e-01 4.5136248e-06 3.0105253e-05 2.0398744e-04
 3.1023083e-04 1.3518081e-05 2.0403396e-03 2.2046879e-06]
Epoch 2, Loss: 1.6039, Accuracy: 44.75%
Coefficients: [8.6760638e-06 9.9997509e-01 1.4540975e-08 1.4428127e-07 1.5189755e-06
 1.7854230e-06 5.6456329e-08 1.2775178e-05 5.3164415e-09]
Epoch 3, Loss: 1.6015, Accuracy: 44.75%
Coefficients: [1.0159201e-06 9.9999535e-01 2.6686571e-09 2.9768479e-08 3.5590594e-07
 3.8870485e-07 1.1185196e-08 2.8503298e-06 8.9582364e-10]
Epoch 4, Loss: 1.5864, Accuracy: 44.50%
Coefficients: [5.4020074e-07 9.9999702e-01 1.6198635e-09 1.8703437e-08 2.3216843e-07
 2.4812326e-07 6.9441173e-09 1.8325333e-06 5.3024585e-10]
Epoch 5, Loss: 1.6237, Accuracy: 44.75%
Coefficients: [4.5036407e-07 9.9999738e-01 1.4029348e-09 1.6360328e-08 2.0525449e-07
 2.1802521e-07 6.0533161e-09 1.6135527e-06 4.5592080e-10]
Epoch 6, Loss: 1.6076, Accuracy: 44.50%
Coefficients: [4.2795492e-07 9.9999762e-01 1.3475537e-09 1.5758685e-08 1.9828360e-07
 2.1027458e-07 5.8250058e-09 1.5570339e-06 4.3703130e-10]
Epoch 7, Loss: 1.5943, Accuracy: 44.75%
Coefficients: [4.2171203e-07 9.9999762e-01 1.3318390e-09 1.5587215e-08 1.9629731e-07
 2.0806574e-07 5.7600094e-09 1.5409764e-06 4.3169099e-10]
Epoch 8, Loss: 1.6478, Accuracy: 44.50%
Coefficients: [4.2000383e-07 9.9999762e-01 1.3275072e-09 1.5539928e-08 1.9574209e-07
 2.0746123e-07 5.7420637e-09 1.5366385e-06 4.3021964e-10]
Epoch 9, Loss: 1.5970, Accuracy: 44.75%
Coefficients: [4.1960229e-07 9.9999762e-01 1.3265050e-09 1.5529231e-08 1.9561948e-07
 2.0733009e-07 5.7379475e-09 1.5357522e-06 4.2987675e-10]
Epoch 10, Loss: 1.6275, Accuracy: 44.75%
Coefficients: [4.1959026e-07 9.9999762e-01 1.3265127e-09 1.5529558e-08 1.9568294e-07
 2.0734156e-07 5.7380456e-09 1.5359557e-06 4.2987350e-10]
Best coefficient accuracy: 44.75%
Final best coefficients: [8.6760638e-06 9.9997509e-01 1.4540975e-08 1.4428127e-07 1.5189755e-06
 1.7854230e-06 5.6456329e-08 1.2775178e-05 5.3164415e-09]

Merged model - Test Loss: 1.6056, Test Accuracy: 44.58%

Single Run Summary:
Test Domain: i3
Domain Accuracies:
  aclass: 99.33%
  escape: 99.42%
  hilux: 96.92%
  lexus: 98.50%
  tesla: 99.25%
  tiguan: 98.58%
  tucson: 99.17%
  x5: 98.17%
  zoe: 99.50%
Final Accuracy: 44.58%
Coefficients: ['0.0000', '1.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000']

--- Run 3/10 ---
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: hilux
Training domains: ['aclass', 'escape', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Running LoRA with Separate Classifiers experiment
Test domain: hilux
Train domains: ['aclass', 'escape', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.6379, Train Accuracy: 47.50%
Val Loss: 1.0494, Val Accuracy: 60.72%
Epoch 2/10, Train Loss: 0.8158, Train Accuracy: 69.50%
Val Loss: 0.7364, Val Accuracy: 74.59%
Epoch 3/10, Train Loss: 0.6364, Train Accuracy: 77.50%
Val Loss: 0.6188, Val Accuracy: 79.26%
Epoch 4/10, Train Loss: 0.5411, Train Accuracy: 83.50%
Val Loss: 0.5586, Val Accuracy: 82.17%
Epoch 5/10, Train Loss: 0.4835, Train Accuracy: 84.17%
Val Loss: 0.5115, Val Accuracy: 83.70%
Epoch 6/10, Train Loss: 0.4382, Train Accuracy: 86.83%
Val Loss: 0.4766, Val Accuracy: 84.76%
Epoch 7/10, Train Loss: 0.4033, Train Accuracy: 88.17%
Val Loss: 0.4492, Val Accuracy: 85.91%
Epoch 8/10, Train Loss: 0.3710, Train Accuracy: 89.00%
Val Loss: 0.4224, Val Accuracy: 86.74%
Epoch 9/10, Train Loss: 0.3465, Train Accuracy: 89.83%
Val Loss: 0.4045, Val Accuracy: 87.44%
Epoch 10/10, Train Loss: 0.3246, Train Accuracy: 91.50%
Val Loss: 0.3857, Val Accuracy: 88.28%
Baseline Model - Final Test Loss: 0.3857, Test Accuracy: 88.28%

Training LoRA adapter for domain: aclass
Epoch 1/10, Train Loss: 1.9288, Train Accuracy: 23.71%
Val Loss: 1.4920, Val Accuracy: 46.67%
Epoch 2/10, Train Loss: 1.2111, Train Accuracy: 58.33%
Val Loss: 0.8354, Val Accuracy: 74.50%
Epoch 3/10, Train Loss: 0.5880, Train Accuracy: 83.85%
Val Loss: 0.3712, Val Accuracy: 91.17%
Epoch 4/10, Train Loss: 0.2780, Train Accuracy: 93.25%
Val Loss: 0.2113, Val Accuracy: 94.67%
Epoch 5/10, Train Loss: 0.1674, Train Accuracy: 95.98%
Val Loss: 0.1415, Val Accuracy: 96.42%
Epoch 6/10, Train Loss: 0.1112, Train Accuracy: 97.29%
Val Loss: 0.0985, Val Accuracy: 97.50%
Epoch 7/10, Train Loss: 0.0764, Train Accuracy: 98.17%
Val Loss: 0.0740, Val Accuracy: 97.92%
Epoch 8/10, Train Loss: 0.0546, Train Accuracy: 98.94%
Val Loss: 0.0550, Val Accuracy: 99.00%
Epoch 9/10, Train Loss: 0.0404, Train Accuracy: 99.25%
Val Loss: 0.0439, Val Accuracy: 99.17%
Epoch 10/10, Train Loss: 0.0316, Train Accuracy: 99.52%
Val Loss: 0.0361, Val Accuracy: 99.33%
aclass adapter trained. Validation Accuracy: 99.33%

Training LoRA adapter for domain: escape
Epoch 1/10, Train Loss: 1.9515, Train Accuracy: 22.54%
Val Loss: 1.6009, Val Accuracy: 43.25%
Epoch 2/10, Train Loss: 1.3650, Train Accuracy: 53.23%
Val Loss: 1.1348, Val Accuracy: 62.50%
Epoch 3/10, Train Loss: 0.8897, Train Accuracy: 69.94%
Val Loss: 0.6742, Val Accuracy: 77.50%
Epoch 4/10, Train Loss: 0.4812, Train Accuracy: 84.96%
Val Loss: 0.3680, Val Accuracy: 88.08%
Epoch 5/10, Train Loss: 0.2553, Train Accuracy: 93.10%
Val Loss: 0.2122, Val Accuracy: 94.58%
Epoch 6/10, Train Loss: 0.1454, Train Accuracy: 97.00%
Val Loss: 0.1330, Val Accuracy: 97.17%
Epoch 7/10, Train Loss: 0.0915, Train Accuracy: 98.50%
Val Loss: 0.0910, Val Accuracy: 97.83%
Epoch 8/10, Train Loss: 0.0604, Train Accuracy: 99.21%
Val Loss: 0.0654, Val Accuracy: 98.58%
Epoch 9/10, Train Loss: 0.0426, Train Accuracy: 99.42%
Val Loss: 0.0516, Val Accuracy: 98.83%
Epoch 10/10, Train Loss: 0.0314, Train Accuracy: 99.67%
Val Loss: 0.0433, Val Accuracy: 99.08%
escape adapter trained. Validation Accuracy: 99.08%

Training LoRA adapter for domain: i3
Epoch 1/10, Train Loss: 1.9789, Train Accuracy: 20.53%
Val Loss: 1.6887, Val Accuracy: 37.75%
Epoch 2/10, Train Loss: 1.4018, Train Accuracy: 51.34%
Val Loss: 1.1371, Val Accuracy: 66.38%
Epoch 3/10, Train Loss: 0.8685, Train Accuracy: 74.59%
Val Loss: 0.6764, Val Accuracy: 80.62%
Epoch 4/10, Train Loss: 0.5063, Train Accuracy: 86.84%
Val Loss: 0.4024, Val Accuracy: 88.75%
Epoch 5/10, Train Loss: 0.2944, Train Accuracy: 92.75%
Val Loss: 0.2398, Val Accuracy: 94.12%
Epoch 6/10, Train Loss: 0.1790, Train Accuracy: 96.50%
Val Loss: 0.1518, Val Accuracy: 97.25%
Epoch 7/10, Train Loss: 0.1182, Train Accuracy: 98.12%
Val Loss: 0.1061, Val Accuracy: 98.25%
Epoch 8/10, Train Loss: 0.0806, Train Accuracy: 99.03%
Val Loss: 0.0768, Val Accuracy: 98.62%
Epoch 9/10, Train Loss: 0.0578, Train Accuracy: 99.59%
Val Loss: 0.0593, Val Accuracy: 98.88%
Epoch 10/10, Train Loss: 0.0434, Train Accuracy: 99.62%
Val Loss: 0.0462, Val Accuracy: 99.38%
i3 adapter trained. Validation Accuracy: 99.38%

Training LoRA adapter for domain: lexus
Epoch 1/10, Train Loss: 1.9621, Train Accuracy: 21.40%
Val Loss: 1.6858, Val Accuracy: 38.25%
Epoch 2/10, Train Loss: 1.4173, Train Accuracy: 49.35%
Val Loss: 1.1904, Val Accuracy: 59.83%
Epoch 3/10, Train Loss: 0.9300, Train Accuracy: 70.96%
Val Loss: 0.7375, Val Accuracy: 76.17%
Epoch 4/10, Train Loss: 0.5347, Train Accuracy: 84.15%
Val Loss: 0.4127, Val Accuracy: 87.75%
Epoch 5/10, Train Loss: 0.3060, Train Accuracy: 91.83%
Val Loss: 0.2548, Val Accuracy: 93.00%
Epoch 6/10, Train Loss: 0.1961, Train Accuracy: 95.06%
Val Loss: 0.1791, Val Accuracy: 95.08%
Epoch 7/10, Train Loss: 0.1379, Train Accuracy: 96.38%
Val Loss: 0.1316, Val Accuracy: 96.25%
Epoch 8/10, Train Loss: 0.0974, Train Accuracy: 97.50%
Val Loss: 0.0979, Val Accuracy: 96.92%
Epoch 9/10, Train Loss: 0.0704, Train Accuracy: 98.48%
Val Loss: 0.0712, Val Accuracy: 98.58%
Epoch 10/10, Train Loss: 0.0519, Train Accuracy: 99.00%
Val Loss: 0.0561, Val Accuracy: 99.08%
lexus adapter trained. Validation Accuracy: 99.08%

Training LoRA adapter for domain: tesla
Epoch 1/10, Train Loss: 1.8037, Train Accuracy: 30.52%
Val Loss: 1.4596, Val Accuracy: 48.75%
Epoch 2/10, Train Loss: 1.2448, Train Accuracy: 56.40%
Val Loss: 1.0056, Val Accuracy: 67.42%
Epoch 3/10, Train Loss: 0.7272, Train Accuracy: 78.67%
Val Loss: 0.5032, Val Accuracy: 84.00%
Epoch 4/10, Train Loss: 0.3695, Train Accuracy: 89.25%
Val Loss: 0.2869, Val Accuracy: 90.75%
Epoch 5/10, Train Loss: 0.2200, Train Accuracy: 94.79%
Val Loss: 0.1863, Val Accuracy: 95.25%
Epoch 6/10, Train Loss: 0.1447, Train Accuracy: 97.27%
Val Loss: 0.1311, Val Accuracy: 97.75%
Epoch 7/10, Train Loss: 0.1026, Train Accuracy: 98.29%
Val Loss: 0.1058, Val Accuracy: 97.67%
Epoch 8/10, Train Loss: 0.0779, Train Accuracy: 98.85%
Val Loss: 0.0838, Val Accuracy: 98.83%
Epoch 9/10, Train Loss: 0.0630, Train Accuracy: 99.04%
Val Loss: 0.0715, Val Accuracy: 98.92%
Epoch 10/10, Train Loss: 0.0522, Train Accuracy: 99.23%
Val Loss: 0.0691, Val Accuracy: 98.75%
tesla adapter trained. Validation Accuracy: 98.92%

Training LoRA adapter for domain: tiguan
Epoch 1/10, Train Loss: 1.9542, Train Accuracy: 24.56%
Val Loss: 1.5668, Val Accuracy: 45.25%
Epoch 2/10, Train Loss: 1.2823, Train Accuracy: 56.15%
Val Loss: 1.0307, Val Accuracy: 65.42%
Epoch 3/10, Train Loss: 0.8215, Train Accuracy: 73.77%
Val Loss: 0.6148, Val Accuracy: 82.50%
Epoch 4/10, Train Loss: 0.4554, Train Accuracy: 87.60%
Val Loss: 0.3043, Val Accuracy: 93.17%
Epoch 5/10, Train Loss: 0.2386, Train Accuracy: 94.67%
Val Loss: 0.1768, Val Accuracy: 96.58%
Epoch 6/10, Train Loss: 0.1498, Train Accuracy: 96.90%
Val Loss: 0.1180, Val Accuracy: 97.92%
Epoch 7/10, Train Loss: 0.1086, Train Accuracy: 97.60%
Val Loss: 0.0939, Val Accuracy: 98.58%
Epoch 8/10, Train Loss: 0.0858, Train Accuracy: 98.12%
Val Loss: 0.0720, Val Accuracy: 98.75%
Epoch 9/10, Train Loss: 0.0697, Train Accuracy: 98.31%
Val Loss: 0.0634, Val Accuracy: 98.83%
Epoch 10/10, Train Loss: 0.0562, Train Accuracy: 98.67%
Val Loss: 0.0505, Val Accuracy: 99.08%
tiguan adapter trained. Validation Accuracy: 99.08%

Training LoRA adapter for domain: tucson
Epoch 1/10, Train Loss: 1.8662, Train Accuracy: 30.17%
Val Loss: 1.4327, Val Accuracy: 49.58%
Epoch 2/10, Train Loss: 1.1820, Train Accuracy: 58.94%
Val Loss: 0.9145, Val Accuracy: 69.33%
Epoch 3/10, Train Loss: 0.7136, Train Accuracy: 77.31%
Val Loss: 0.4945, Val Accuracy: 86.00%
Epoch 4/10, Train Loss: 0.3784, Train Accuracy: 90.75%
Val Loss: 0.2657, Val Accuracy: 94.58%
Epoch 5/10, Train Loss: 0.2178, Train Accuracy: 95.71%
Val Loss: 0.1645, Val Accuracy: 97.42%
Epoch 6/10, Train Loss: 0.1414, Train Accuracy: 97.04%
Val Loss: 0.1104, Val Accuracy: 97.83%
Epoch 7/10, Train Loss: 0.0946, Train Accuracy: 97.98%
Val Loss: 0.0818, Val Accuracy: 97.92%
Epoch 8/10, Train Loss: 0.0651, Train Accuracy: 98.73%
Val Loss: 0.0586, Val Accuracy: 98.83%
Epoch 9/10, Train Loss: 0.0463, Train Accuracy: 99.21%
Val Loss: 0.0457, Val Accuracy: 99.00%
Epoch 10/10, Train Loss: 0.0336, Train Accuracy: 99.60%
Val Loss: 0.0372, Val Accuracy: 99.25%
tucson adapter trained. Validation Accuracy: 99.25%

Training LoRA adapter for domain: x5
Epoch 1/10, Train Loss: 1.8543, Train Accuracy: 27.79%
Val Loss: 1.4526, Val Accuracy: 48.33%
Epoch 2/10, Train Loss: 1.2332, Train Accuracy: 56.31%
Val Loss: 0.9557, Val Accuracy: 68.42%
Epoch 3/10, Train Loss: 0.7757, Train Accuracy: 74.54%
Val Loss: 0.5486, Val Accuracy: 82.58%
Epoch 4/10, Train Loss: 0.4418, Train Accuracy: 85.58%
Val Loss: 0.3232, Val Accuracy: 89.33%
Epoch 5/10, Train Loss: 0.2710, Train Accuracy: 91.96%
Val Loss: 0.2080, Val Accuracy: 94.92%
Epoch 6/10, Train Loss: 0.1767, Train Accuracy: 95.31%
Val Loss: 0.1435, Val Accuracy: 96.42%
Epoch 7/10, Train Loss: 0.1166, Train Accuracy: 97.75%
Val Loss: 0.1013, Val Accuracy: 97.67%
Epoch 8/10, Train Loss: 0.0800, Train Accuracy: 98.48%
Val Loss: 0.0780, Val Accuracy: 98.25%
Epoch 9/10, Train Loss: 0.0590, Train Accuracy: 99.02%
Val Loss: 0.0575, Val Accuracy: 98.58%
Epoch 10/10, Train Loss: 0.0451, Train Accuracy: 99.35%
Val Loss: 0.0451, Val Accuracy: 98.67%
x5 adapter trained. Validation Accuracy: 98.67%

Training LoRA adapter for domain: zoe
Epoch 1/10, Train Loss: 1.8125, Train Accuracy: 32.34%
Val Loss: 1.5849, Val Accuracy: 40.88%
Epoch 2/10, Train Loss: 1.3535, Train Accuracy: 53.56%
Val Loss: 1.1129, Val Accuracy: 64.62%
Epoch 3/10, Train Loss: 0.8739, Train Accuracy: 75.50%
Val Loss: 0.6686, Val Accuracy: 83.88%
Epoch 4/10, Train Loss: 0.4761, Train Accuracy: 90.25%
Val Loss: 0.3646, Val Accuracy: 92.25%
Epoch 5/10, Train Loss: 0.2474, Train Accuracy: 96.41%
Val Loss: 0.2186, Val Accuracy: 95.62%
Epoch 6/10, Train Loss: 0.1468, Train Accuracy: 98.03%
Val Loss: 0.1463, Val Accuracy: 97.62%
Epoch 7/10, Train Loss: 0.1021, Train Accuracy: 98.78%
Val Loss: 0.1085, Val Accuracy: 98.50%
Epoch 8/10, Train Loss: 0.0787, Train Accuracy: 99.03%
Val Loss: 0.0876, Val Accuracy: 98.50%
Epoch 9/10, Train Loss: 0.0644, Train Accuracy: 99.06%
Val Loss: 0.0737, Val Accuracy: 98.88%
Epoch 10/10, Train Loss: 0.0558, Train Accuracy: 99.25%
Val Loss: 0.0663, Val Accuracy: 99.00%
zoe adapter trained. Validation Accuracy: 99.00%

Training coefficients for adapter merging
Initial coefficients: [0.11219268 0.11247968 0.10847188 0.11020557 0.11093102 0.11032755
 0.11283907 0.11191815 0.11063449]
Epoch 1, Loss: 2.1741, Accuracy: 37.67%
Coefficients: [3.9383426e-04 4.4930425e-06 6.5789704e-05 4.5574323e-04 3.3673967e-04
 9.7231568e-06 1.9675953e-04 9.9853444e-01 2.4457779e-06]
Epoch 2, Loss: 2.1648, Accuracy: 37.67%
Coefficients: [9.06013229e-05 8.86588168e-07 1.32705645e-05 1.27534251e-04
 8.15916355e-05 2.17364664e-06 4.37398376e-05 9.99639750e-01
 4.44848553e-07]
Epoch 3, Loss: 2.1730, Accuracy: 37.67%
Coefficients: [7.09154847e-05 6.78715537e-07 1.01800879e-05 1.06818494e-04
 6.49322028e-05 1.69983139e-06 3.42043022e-05 9.99710262e-01
 3.35798262e-07]
Epoch 4, Loss: 2.1722, Accuracy: 37.67%
Coefficients: [6.6747816e-05 6.4733763e-07 9.6896165e-06 1.0166011e-04 6.2461761e-05
 1.6257885e-06 3.2629308e-05 9.9972421e-01 3.1947616e-07]
Epoch 5, Loss: 2.1615, Accuracy: 37.67%
Coefficients: [6.65189946e-05 6.47324043e-07 9.69475695e-06 1.03035374e-04
 6.30106369e-05 1.62713820e-06 3.26842528e-05 9.99722421e-01
 3.19337602e-07]
Epoch 6, Loss: 2.1704, Accuracy: 37.67%
Coefficients: [6.74443436e-05 6.51064965e-07 9.73937949e-06 1.05883686e-04
 6.35656907e-05 1.63639334e-06 3.29384056e-05 9.99717891e-01
 3.21216419e-07]
Epoch 7, Loss: 2.1643, Accuracy: 37.67%
Coefficients: [6.9656002e-05 6.5974325e-07 9.8752434e-06 1.1174946e-04 6.4511274e-05
 1.6603004e-06 3.3644468e-05 9.9970788e-01 3.2551978e-07]
Epoch 8, Loss: 2.1716, Accuracy: 37.67%
Coefficients: [7.0628012e-05 6.6678786e-07 9.9982562e-06 1.2077815e-04 6.5296001e-05
 1.6771248e-06 3.4068635e-05 9.9969661e-01 3.2893158e-07]
Epoch 9, Loss: 2.1739, Accuracy: 37.83%
Coefficients: [7.4600895e-05 6.8909122e-07 1.0340446e-05 1.5705939e-04 6.8053982e-05
 1.7354162e-06 3.5393896e-05 9.9965179e-01 3.3969974e-07]
Epoch 10, Loss: 2.1723, Accuracy: 37.50%
Coefficients: [7.73695137e-05 7.02141392e-07 1.05260615e-05 1.66098864e-04
 6.99644879e-05 1.77073696e-06 3.62449682e-05 9.99636889e-01
 3.45881574e-07]
Best coefficient accuracy: 37.83%
Final best coefficients: [7.4600895e-05 6.8909122e-07 1.0340446e-05 1.5705939e-04 6.8053982e-05
 1.7354162e-06 3.5393896e-05 9.9965179e-01 3.3969974e-07]

Merged model - Test Loss: 2.1017, Test Accuracy: 38.46%

Single Run Summary:
Test Domain: hilux
Domain Accuracies:
  aclass: 99.33%
  escape: 99.08%
  i3: 99.38%
  lexus: 99.08%
  tesla: 98.92%
  tiguan: 99.08%
  tucson: 99.25%
  x5: 98.67%
  zoe: 99.00%
Final Accuracy: 38.46%
Coefficients: ['0.0001', '0.0000', '0.0000', '0.0002', '0.0001', '0.0000', '0.0000', '0.9997', '0.0000']

--- Run 4/10 ---
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: x5
Training domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'zoe']

Running LoRA with Separate Classifiers experiment
Test domain: x5
Train domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'zoe']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 1.7729, Train Accuracy: 45.83%
Val Loss: 1.3369, Val Accuracy: 48.33%
Epoch 2/10, Train Loss: 1.2137, Train Accuracy: 54.00%
Val Loss: 1.0135, Val Accuracy: 60.96%
Epoch 3/10, Train Loss: 0.9286, Train Accuracy: 64.33%
Val Loss: 0.8000, Val Accuracy: 73.72%
Epoch 4/10, Train Loss: 0.7447, Train Accuracy: 73.67%
Val Loss: 0.6712, Val Accuracy: 78.89%
Epoch 5/10, Train Loss: 0.6299, Train Accuracy: 79.00%
Val Loss: 0.5855, Val Accuracy: 82.02%
Epoch 6/10, Train Loss: 0.5389, Train Accuracy: 82.33%
Val Loss: 0.5226, Val Accuracy: 83.78%
Epoch 7/10, Train Loss: 0.4701, Train Accuracy: 84.33%
Val Loss: 0.4737, Val Accuracy: 84.94%
Epoch 8/10, Train Loss: 0.4138, Train Accuracy: 85.83%
Val Loss: 0.4336, Val Accuracy: 85.96%
Epoch 9/10, Train Loss: 0.3662, Train Accuracy: 88.33%
Val Loss: 0.3997, Val Accuracy: 87.41%
Epoch 10/10, Train Loss: 0.3264, Train Accuracy: 90.67%
Val Loss: 0.3749, Val Accuracy: 88.02%
Baseline Model - Final Test Loss: 0.3749, Test Accuracy: 88.02%

Training LoRA adapter for domain: aclass
Epoch 1/10, Train Loss: 1.9300, Train Accuracy: 23.52%
Val Loss: 1.5729, Val Accuracy: 44.33%
Epoch 2/10, Train Loss: 1.2437, Train Accuracy: 57.21%
Val Loss: 0.9644, Val Accuracy: 67.75%
Epoch 3/10, Train Loss: 0.6595, Train Accuracy: 80.88%
Val Loss: 0.4621, Val Accuracy: 88.08%
Epoch 4/10, Train Loss: 0.3219, Train Accuracy: 92.02%
Val Loss: 0.2575, Val Accuracy: 93.33%
Epoch 5/10, Train Loss: 0.1865, Train Accuracy: 95.27%
Val Loss: 0.1720, Val Accuracy: 96.08%
Epoch 6/10, Train Loss: 0.1219, Train Accuracy: 97.08%
Val Loss: 0.1206, Val Accuracy: 96.58%
Epoch 7/10, Train Loss: 0.0837, Train Accuracy: 98.21%
Val Loss: 0.0902, Val Accuracy: 97.50%
Epoch 8/10, Train Loss: 0.0597, Train Accuracy: 98.90%
Val Loss: 0.0709, Val Accuracy: 97.92%
Epoch 9/10, Train Loss: 0.0445, Train Accuracy: 99.23%
Val Loss: 0.0604, Val Accuracy: 98.58%
Epoch 10/10, Train Loss: 0.0338, Train Accuracy: 99.40%
Val Loss: 0.0504, Val Accuracy: 98.33%
aclass adapter trained. Validation Accuracy: 98.58%

Training LoRA adapter for domain: escape
Epoch 1/10, Train Loss: 1.9505, Train Accuracy: 22.77%
Val Loss: 1.6449, Val Accuracy: 41.67%
Epoch 2/10, Train Loss: 1.3971, Train Accuracy: 53.83%
Val Loss: 1.2161, Val Accuracy: 58.50%
Epoch 3/10, Train Loss: 0.9127, Train Accuracy: 70.27%
Val Loss: 0.7128, Val Accuracy: 75.08%
Epoch 4/10, Train Loss: 0.4622, Train Accuracy: 85.29%
Val Loss: 0.3537, Val Accuracy: 88.50%
Epoch 5/10, Train Loss: 0.2393, Train Accuracy: 93.73%
Val Loss: 0.2024, Val Accuracy: 93.92%
Epoch 6/10, Train Loss: 0.1381, Train Accuracy: 97.40%
Val Loss: 0.1197, Val Accuracy: 98.00%
Epoch 7/10, Train Loss: 0.0842, Train Accuracy: 98.75%
Val Loss: 0.0803, Val Accuracy: 98.50%
Epoch 8/10, Train Loss: 0.0578, Train Accuracy: 99.19%
Val Loss: 0.0616, Val Accuracy: 98.67%
Epoch 9/10, Train Loss: 0.0423, Train Accuracy: 99.31%
Val Loss: 0.0490, Val Accuracy: 98.92%
Epoch 10/10, Train Loss: 0.0317, Train Accuracy: 99.48%
Val Loss: 0.0375, Val Accuracy: 99.08%
escape adapter trained. Validation Accuracy: 99.08%

Training LoRA adapter for domain: hilux
Epoch 1/10, Train Loss: 2.0108, Train Accuracy: 23.48%
Val Loss: 1.6357, Val Accuracy: 41.58%
Epoch 2/10, Train Loss: 1.4172, Train Accuracy: 49.88%
Val Loss: 1.1568, Val Accuracy: 61.50%
Epoch 3/10, Train Loss: 0.9305, Train Accuracy: 71.73%
Val Loss: 0.6684, Val Accuracy: 81.58%
Epoch 4/10, Train Loss: 0.5076, Train Accuracy: 87.25%
Val Loss: 0.3580, Val Accuracy: 90.75%
Epoch 5/10, Train Loss: 0.2834, Train Accuracy: 94.04%
Val Loss: 0.2216, Val Accuracy: 96.00%
Epoch 6/10, Train Loss: 0.1950, Train Accuracy: 95.52%
Val Loss: 0.1659, Val Accuracy: 96.50%
Epoch 7/10, Train Loss: 0.1569, Train Accuracy: 96.44%
Val Loss: 0.1398, Val Accuracy: 96.75%
Epoch 8/10, Train Loss: 0.1357, Train Accuracy: 96.79%
Val Loss: 0.1275, Val Accuracy: 96.92%
Epoch 9/10, Train Loss: 0.1218, Train Accuracy: 97.08%
Val Loss: 0.1143, Val Accuracy: 97.08%
Epoch 10/10, Train Loss: 0.1101, Train Accuracy: 97.10%
Val Loss: 0.1059, Val Accuracy: 97.08%
hilux adapter trained. Validation Accuracy: 97.08%

Training LoRA adapter for domain: i3
Epoch 1/10, Train Loss: 1.9859, Train Accuracy: 20.44%
Val Loss: 1.7043, Val Accuracy: 34.75%
Epoch 2/10, Train Loss: 1.4067, Train Accuracy: 51.81%
Val Loss: 1.1123, Val Accuracy: 66.12%
Epoch 3/10, Train Loss: 0.8572, Train Accuracy: 73.78%
Val Loss: 0.6411, Val Accuracy: 81.75%
Epoch 4/10, Train Loss: 0.4954, Train Accuracy: 87.28%
Val Loss: 0.3661, Val Accuracy: 91.88%
Epoch 5/10, Train Loss: 0.2909, Train Accuracy: 93.09%
Val Loss: 0.2133, Val Accuracy: 96.75%
Epoch 6/10, Train Loss: 0.1751, Train Accuracy: 96.88%
Val Loss: 0.1357, Val Accuracy: 97.88%
Epoch 7/10, Train Loss: 0.1137, Train Accuracy: 98.31%
Val Loss: 0.0931, Val Accuracy: 98.88%
Epoch 8/10, Train Loss: 0.0785, Train Accuracy: 99.03%
Val Loss: 0.0657, Val Accuracy: 99.25%
Epoch 9/10, Train Loss: 0.0571, Train Accuracy: 99.47%
Val Loss: 0.0498, Val Accuracy: 99.50%
Epoch 10/10, Train Loss: 0.0426, Train Accuracy: 99.62%
Val Loss: 0.0379, Val Accuracy: 99.75%
i3 adapter trained. Validation Accuracy: 99.75%

Training LoRA adapter for domain: lexus
Epoch 1/10, Train Loss: 1.9431, Train Accuracy: 23.06%
Val Loss: 1.6363, Val Accuracy: 40.25%
Epoch 2/10, Train Loss: 1.3677, Train Accuracy: 52.04%
Val Loss: 1.1223, Val Accuracy: 63.33%
Epoch 3/10, Train Loss: 0.8788, Train Accuracy: 71.29%
Val Loss: 0.6668, Val Accuracy: 80.83%
Epoch 4/10, Train Loss: 0.5080, Train Accuracy: 84.40%
Val Loss: 0.3845, Val Accuracy: 88.83%
Epoch 5/10, Train Loss: 0.3002, Train Accuracy: 91.88%
Val Loss: 0.2474, Val Accuracy: 94.08%
Epoch 6/10, Train Loss: 0.1943, Train Accuracy: 95.04%
Val Loss: 0.1813, Val Accuracy: 95.17%
Epoch 7/10, Train Loss: 0.1367, Train Accuracy: 96.44%
Val Loss: 0.1314, Val Accuracy: 96.33%
Epoch 8/10, Train Loss: 0.0986, Train Accuracy: 97.52%
Val Loss: 0.0978, Val Accuracy: 97.00%
Epoch 9/10, Train Loss: 0.0735, Train Accuracy: 98.31%
Val Loss: 0.0729, Val Accuracy: 98.17%
Epoch 10/10, Train Loss: 0.0555, Train Accuracy: 98.88%
Val Loss: 0.0584, Val Accuracy: 98.67%
lexus adapter trained. Validation Accuracy: 98.67%

Training LoRA adapter for domain: tesla
Epoch 1/10, Train Loss: 1.8267, Train Accuracy: 29.35%
Val Loss: 1.4794, Val Accuracy: 48.58%
Epoch 2/10, Train Loss: 1.2757, Train Accuracy: 55.00%
Val Loss: 1.0528, Val Accuracy: 64.83%
Epoch 3/10, Train Loss: 0.7801, Train Accuracy: 76.46%
Val Loss: 0.5518, Val Accuracy: 84.42%
Epoch 4/10, Train Loss: 0.4072, Train Accuracy: 88.12%
Val Loss: 0.3069, Val Accuracy: 91.58%
Epoch 5/10, Train Loss: 0.2376, Train Accuracy: 94.33%
Val Loss: 0.1896, Val Accuracy: 96.17%
Epoch 6/10, Train Loss: 0.1524, Train Accuracy: 97.21%
Val Loss: 0.1302, Val Accuracy: 98.08%
Epoch 7/10, Train Loss: 0.1061, Train Accuracy: 98.25%
Val Loss: 0.0977, Val Accuracy: 98.67%
Epoch 8/10, Train Loss: 0.0817, Train Accuracy: 98.73%
Val Loss: 0.0803, Val Accuracy: 99.00%
Epoch 9/10, Train Loss: 0.0653, Train Accuracy: 98.92%
Val Loss: 0.0674, Val Accuracy: 99.17%
Epoch 10/10, Train Loss: 0.0551, Train Accuracy: 99.00%
Val Loss: 0.0588, Val Accuracy: 99.17%
tesla adapter trained. Validation Accuracy: 99.17%

Training LoRA adapter for domain: tiguan
Epoch 1/10, Train Loss: 1.9325, Train Accuracy: 25.71%
Val Loss: 1.5387, Val Accuracy: 48.08%
Epoch 2/10, Train Loss: 1.2583, Train Accuracy: 56.83%
Val Loss: 1.0119, Val Accuracy: 66.08%
Epoch 3/10, Train Loss: 0.8152, Train Accuracy: 74.52%
Val Loss: 0.6095, Val Accuracy: 82.67%
Epoch 4/10, Train Loss: 0.4518, Train Accuracy: 87.69%
Val Loss: 0.3026, Val Accuracy: 93.42%
Epoch 5/10, Train Loss: 0.2365, Train Accuracy: 94.73%
Val Loss: 0.1780, Val Accuracy: 96.42%
Epoch 6/10, Train Loss: 0.1497, Train Accuracy: 97.17%
Val Loss: 0.1282, Val Accuracy: 97.75%
Epoch 7/10, Train Loss: 0.1095, Train Accuracy: 97.92%
Val Loss: 0.1030, Val Accuracy: 98.00%
Epoch 8/10, Train Loss: 0.0866, Train Accuracy: 98.33%
Val Loss: 0.0858, Val Accuracy: 98.08%
Epoch 9/10, Train Loss: 0.0714, Train Accuracy: 98.52%
Val Loss: 0.0761, Val Accuracy: 98.25%
Epoch 10/10, Train Loss: 0.0604, Train Accuracy: 98.67%
Val Loss: 0.0691, Val Accuracy: 98.33%
tiguan adapter trained. Validation Accuracy: 98.33%

Training LoRA adapter for domain: tucson
Epoch 1/10, Train Loss: 1.8366, Train Accuracy: 32.12%
Val Loss: 1.4426, Val Accuracy: 48.42%
Epoch 2/10, Train Loss: 1.1320, Train Accuracy: 61.44%
Val Loss: 0.9173, Val Accuracy: 69.75%
Epoch 3/10, Train Loss: 0.6692, Train Accuracy: 79.42%
Val Loss: 0.5165, Val Accuracy: 84.75%
Epoch 4/10, Train Loss: 0.3556, Train Accuracy: 91.58%
Val Loss: 0.2798, Val Accuracy: 93.33%
Epoch 5/10, Train Loss: 0.2055, Train Accuracy: 96.10%
Val Loss: 0.1814, Val Accuracy: 95.67%
Epoch 6/10, Train Loss: 0.1357, Train Accuracy: 97.23%
Val Loss: 0.1293, Val Accuracy: 96.50%
Epoch 7/10, Train Loss: 0.0941, Train Accuracy: 97.90%
Val Loss: 0.0935, Val Accuracy: 97.75%
Epoch 8/10, Train Loss: 0.0662, Train Accuracy: 98.69%
Val Loss: 0.0709, Val Accuracy: 98.17%
Epoch 9/10, Train Loss: 0.0465, Train Accuracy: 99.27%
Val Loss: 0.0549, Val Accuracy: 99.00%
Epoch 10/10, Train Loss: 0.0350, Train Accuracy: 99.60%
Val Loss: 0.0445, Val Accuracy: 99.08%
tucson adapter trained. Validation Accuracy: 99.08%

Training LoRA adapter for domain: zoe
Epoch 1/10, Train Loss: 1.8140, Train Accuracy: 31.69%
Val Loss: 1.6156, Val Accuracy: 40.38%
Epoch 2/10, Train Loss: 1.3638, Train Accuracy: 52.78%
Val Loss: 1.1698, Val Accuracy: 63.00%
Epoch 3/10, Train Loss: 0.8919, Train Accuracy: 75.09%
Val Loss: 0.7096, Val Accuracy: 81.12%
Epoch 4/10, Train Loss: 0.5016, Train Accuracy: 89.19%
Val Loss: 0.3898, Val Accuracy: 91.75%
Epoch 5/10, Train Loss: 0.2668, Train Accuracy: 95.62%
Val Loss: 0.2248, Val Accuracy: 95.62%
Epoch 6/10, Train Loss: 0.1578, Train Accuracy: 97.72%
Val Loss: 0.1476, Val Accuracy: 97.88%
Epoch 7/10, Train Loss: 0.1070, Train Accuracy: 98.72%
Val Loss: 0.1141, Val Accuracy: 97.75%
Epoch 8/10, Train Loss: 0.0809, Train Accuracy: 98.97%
Val Loss: 0.0923, Val Accuracy: 98.38%
Epoch 9/10, Train Loss: 0.0651, Train Accuracy: 99.06%
Val Loss: 0.0772, Val Accuracy: 98.38%
Epoch 10/10, Train Loss: 0.0554, Train Accuracy: 99.22%
Val Loss: 0.0692, Val Accuracy: 98.50%
zoe adapter trained. Validation Accuracy: 98.50%

Training coefficients for adapter merging
Initial coefficients: [0.11056558 0.11120673 0.11173368 0.11095659 0.11078094 0.11191448
 0.11083081 0.11211557 0.1098956 ]
Epoch 1, Loss: 2.8680, Accuracy: 32.67%
Coefficients: [1.3456804e-04 9.9794704e-01 2.3648054e-06 1.2237856e-06 5.4434789e-05
 1.8330222e-03 2.4295250e-07 2.6929551e-05 1.2700703e-07]
Epoch 2, Loss: 2.8766, Accuracy: 32.83%
Coefficients: [4.3469208e-05 9.9931669e-01 4.3786707e-07 2.1485104e-07 1.5099528e-05
 6.1862479e-04 3.2083943e-08 5.4145607e-06 1.5071898e-08]
Epoch 3, Loss: 2.8719, Accuracy: 32.83%
Coefficients: [3.7403755e-05 9.9939597e-01 3.4144472e-07 1.6607329e-07 1.2719641e-05
 5.4910610e-04 2.3638298e-08 4.2807228e-06 1.0906887e-08]
Epoch 4, Loss: 2.8744, Accuracy: 32.67%
Coefficients: [3.6993795e-05 9.9939287e-01 3.3281253e-07 1.6164844e-07 1.2506947e-05
 5.5294152e-04 2.2830731e-08 4.1812432e-06 1.0504034e-08]
Epoch 5, Loss: 2.8779, Accuracy: 32.67%
Coefficients: [3.6372690e-05 9.9941432e-01 3.2495680e-07 1.5783513e-07 1.2192879e-05
 5.3238007e-04 2.2261579e-08 4.0839823e-06 1.0237723e-08]
Epoch 6, Loss: 2.8623, Accuracy: 32.83%
Coefficients: [3.5800516e-05 9.9944669e-01 3.1540108e-07 1.5321879e-07 1.1896275e-05
 5.0112355e-04 2.1602192e-08 3.9649049e-06 9.9340660e-09]
Epoch 7, Loss: 2.8728, Accuracy: 32.67%
Coefficients: [3.72718896e-05 9.99398589e-01 3.30801271e-07 1.60732725e-07
 1.26155628e-05 5.46799856e-04 2.26563444e-08 4.16084958e-06
 1.04187725e-08]
Epoch 8, Loss: 2.8680, Accuracy: 32.67%
Coefficients: [3.6534766e-05 9.9940014e-01 3.2982905e-07 1.6031811e-07 1.2610206e-05
 5.4598518e-04 2.2590228e-08 4.1488461e-06 1.0388151e-08]
Epoch 9, Loss: 2.8581, Accuracy: 32.67%
Coefficients: [3.6898193e-05 9.9941266e-01 3.2618703e-07 1.5856658e-07 1.2532949e-05
 5.3328875e-04 2.2342576e-08 4.1056019e-06 1.0273895e-08]
Epoch 10, Loss: 2.8618, Accuracy: 32.67%
Coefficients: [3.60050035e-05 9.99430597e-01 3.20353621e-07 1.55712272e-07
 1.23423024e-05 5.16519940e-04 2.19426113e-08 4.03075182e-06
 1.00899955e-08]
Best coefficient accuracy: 32.83%
Final best coefficients: [4.3469208e-05 9.9931669e-01 4.3786707e-07 2.1485104e-07 1.5099528e-05
 6.1862479e-04 3.2083943e-08 5.4145607e-06 1.5071898e-08]

Merged model - Test Loss: 2.7040, Test Accuracy: 34.78%

Single Run Summary:
Test Domain: x5
Domain Accuracies:
  aclass: 98.58%
  escape: 99.08%
  hilux: 97.08%
  i3: 99.75%
  lexus: 98.67%
  tesla: 99.17%
  tiguan: 98.33%
  tucson: 99.08%
  zoe: 98.50%
Final Accuracy: 34.78%
Coefficients: ['0.0000', '0.9993', '0.0000', '0.0000', '0.0000', '0.0006', '0.0000', '0.0000', '0.0000']

--- Run 5/10 ---
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: tesla
Training domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tiguan', 'tucson', 'x5', 'zoe']

Running LoRA with Separate Classifiers experiment
Test domain: tesla
Train domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tiguan', 'tucson', 'x5', 'zoe']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.0850, Train Accuracy: 41.67%
Val Loss: 1.5349, Val Accuracy: 46.48%
Epoch 2/10, Train Loss: 1.3595, Train Accuracy: 50.17%
Val Loss: 1.0512, Val Accuracy: 60.04%
Epoch 3/10, Train Loss: 0.9162, Train Accuracy: 67.67%
Val Loss: 0.7671, Val Accuracy: 72.93%
Epoch 4/10, Train Loss: 0.6872, Train Accuracy: 76.67%
Val Loss: 0.6289, Val Accuracy: 78.87%
Epoch 5/10, Train Loss: 0.5710, Train Accuracy: 82.33%
Val Loss: 0.5334, Val Accuracy: 82.52%
Epoch 6/10, Train Loss: 0.4920, Train Accuracy: 85.33%
Val Loss: 0.4666, Val Accuracy: 84.70%
Epoch 7/10, Train Loss: 0.4335, Train Accuracy: 87.00%
Val Loss: 0.4170, Val Accuracy: 86.59%
Epoch 8/10, Train Loss: 0.3899, Train Accuracy: 88.50%
Val Loss: 0.3831, Val Accuracy: 87.81%
Epoch 9/10, Train Loss: 0.3519, Train Accuracy: 89.00%
Val Loss: 0.3544, Val Accuracy: 89.04%
Epoch 10/10, Train Loss: 0.3249, Train Accuracy: 90.00%
Val Loss: 0.3320, Val Accuracy: 89.94%
Baseline Model - Final Test Loss: 0.3320, Test Accuracy: 89.94%

Training LoRA adapter for domain: aclass
Epoch 1/10, Train Loss: 1.9144, Train Accuracy: 24.27%
Val Loss: 1.4555, Val Accuracy: 48.33%
Epoch 2/10, Train Loss: 1.1879, Train Accuracy: 58.58%
Val Loss: 0.8441, Val Accuracy: 75.17%
Epoch 3/10, Train Loss: 0.5960, Train Accuracy: 82.69%
Val Loss: 0.3965, Val Accuracy: 89.83%
Epoch 4/10, Train Loss: 0.2819, Train Accuracy: 92.96%
Val Loss: 0.2214, Val Accuracy: 94.25%
Epoch 5/10, Train Loss: 0.1646, Train Accuracy: 95.96%
Val Loss: 0.1493, Val Accuracy: 96.00%
Epoch 6/10, Train Loss: 0.1094, Train Accuracy: 97.44%
Val Loss: 0.1076, Val Accuracy: 97.25%
Epoch 7/10, Train Loss: 0.0780, Train Accuracy: 97.98%
Val Loss: 0.0785, Val Accuracy: 98.33%
Epoch 8/10, Train Loss: 0.0567, Train Accuracy: 99.02%
Val Loss: 0.0619, Val Accuracy: 98.83%
Epoch 9/10, Train Loss: 0.0428, Train Accuracy: 99.33%
Val Loss: 0.0498, Val Accuracy: 99.08%
Epoch 10/10, Train Loss: 0.0329, Train Accuracy: 99.56%
Val Loss: 0.0409, Val Accuracy: 99.25%
aclass adapter trained. Validation Accuracy: 99.25%

Training LoRA adapter for domain: escape
Epoch 1/10, Train Loss: 1.9472, Train Accuracy: 23.54%
Val Loss: 1.6163, Val Accuracy: 43.42%
Epoch 2/10, Train Loss: 1.4149, Train Accuracy: 51.48%
Val Loss: 1.1902, Val Accuracy: 61.50%
Epoch 3/10, Train Loss: 0.9511, Train Accuracy: 68.58%
Val Loss: 0.7122, Val Accuracy: 75.00%
Epoch 4/10, Train Loss: 0.4960, Train Accuracy: 83.79%
Val Loss: 0.3526, Val Accuracy: 88.00%
Epoch 5/10, Train Loss: 0.2562, Train Accuracy: 92.73%
Val Loss: 0.1970, Val Accuracy: 95.08%
Epoch 6/10, Train Loss: 0.1508, Train Accuracy: 96.46%
Val Loss: 0.1163, Val Accuracy: 97.75%
Epoch 7/10, Train Loss: 0.0936, Train Accuracy: 98.33%
Val Loss: 0.0723, Val Accuracy: 98.92%
Epoch 8/10, Train Loss: 0.0632, Train Accuracy: 98.94%
Val Loss: 0.0507, Val Accuracy: 99.42%
Epoch 9/10, Train Loss: 0.0468, Train Accuracy: 99.27%
Val Loss: 0.0397, Val Accuracy: 99.50%
Epoch 10/10, Train Loss: 0.0345, Train Accuracy: 99.50%
Val Loss: 0.0317, Val Accuracy: 99.67%
escape adapter trained. Validation Accuracy: 99.67%

Training LoRA adapter for domain: hilux
Epoch 1/10, Train Loss: 2.0033, Train Accuracy: 23.58%
Val Loss: 1.6567, Val Accuracy: 41.42%
Epoch 2/10, Train Loss: 1.4000, Train Accuracy: 51.00%
Val Loss: 1.1654, Val Accuracy: 61.42%
Epoch 3/10, Train Loss: 0.9111, Train Accuracy: 72.90%
Val Loss: 0.6715, Val Accuracy: 82.50%
Epoch 4/10, Train Loss: 0.4814, Train Accuracy: 88.27%
Val Loss: 0.3209, Val Accuracy: 93.25%
Epoch 5/10, Train Loss: 0.2548, Train Accuracy: 94.85%
Val Loss: 0.1965, Val Accuracy: 95.58%
Epoch 6/10, Train Loss: 0.1753, Train Accuracy: 96.33%
Val Loss: 0.1600, Val Accuracy: 95.92%
Epoch 7/10, Train Loss: 0.1450, Train Accuracy: 96.75%
Val Loss: 0.1258, Val Accuracy: 96.92%
Epoch 8/10, Train Loss: 0.1207, Train Accuracy: 97.10%
Val Loss: 0.1130, Val Accuracy: 96.92%
Epoch 9/10, Train Loss: 0.1069, Train Accuracy: 97.27%
Val Loss: 0.1020, Val Accuracy: 97.00%
Epoch 10/10, Train Loss: 0.0950, Train Accuracy: 97.35%
Val Loss: 0.0932, Val Accuracy: 97.17%
hilux adapter trained. Validation Accuracy: 97.17%

Training LoRA adapter for domain: i3
Epoch 1/10, Train Loss: 1.9742, Train Accuracy: 21.69%
Val Loss: 1.6871, Val Accuracy: 37.00%
Epoch 2/10, Train Loss: 1.3964, Train Accuracy: 51.66%
Val Loss: 1.1032, Val Accuracy: 65.88%
Epoch 3/10, Train Loss: 0.8569, Train Accuracy: 74.72%
Val Loss: 0.6412, Val Accuracy: 81.75%
Epoch 4/10, Train Loss: 0.5003, Train Accuracy: 87.09%
Val Loss: 0.3695, Val Accuracy: 91.25%
Epoch 5/10, Train Loss: 0.2894, Train Accuracy: 92.75%
Val Loss: 0.2155, Val Accuracy: 95.38%
Epoch 6/10, Train Loss: 0.1735, Train Accuracy: 96.81%
Val Loss: 0.1329, Val Accuracy: 98.38%
Epoch 7/10, Train Loss: 0.1123, Train Accuracy: 98.19%
Val Loss: 0.0927, Val Accuracy: 98.88%
Epoch 8/10, Train Loss: 0.0772, Train Accuracy: 98.88%
Val Loss: 0.0687, Val Accuracy: 99.25%
Epoch 9/10, Train Loss: 0.0557, Train Accuracy: 99.56%
Val Loss: 0.0504, Val Accuracy: 99.50%
Epoch 10/10, Train Loss: 0.0421, Train Accuracy: 99.69%
Val Loss: 0.0399, Val Accuracy: 99.62%
i3 adapter trained. Validation Accuracy: 99.62%

Training LoRA adapter for domain: lexus
Epoch 1/10, Train Loss: 1.9707, Train Accuracy: 21.35%
Val Loss: 1.6483, Val Accuracy: 40.83%
Epoch 2/10, Train Loss: 1.4069, Train Accuracy: 50.79%
Val Loss: 1.1303, Val Accuracy: 62.58%
Epoch 3/10, Train Loss: 0.9076, Train Accuracy: 71.23%
Val Loss: 0.6769, Val Accuracy: 78.50%
Epoch 4/10, Train Loss: 0.5250, Train Accuracy: 84.81%
Val Loss: 0.3930, Val Accuracy: 88.42%
Epoch 5/10, Train Loss: 0.3129, Train Accuracy: 91.58%
Val Loss: 0.2438, Val Accuracy: 94.08%
Epoch 6/10, Train Loss: 0.2072, Train Accuracy: 94.77%
Val Loss: 0.1716, Val Accuracy: 96.00%
Epoch 7/10, Train Loss: 0.1480, Train Accuracy: 96.17%
Val Loss: 0.1268, Val Accuracy: 96.42%
Epoch 8/10, Train Loss: 0.1087, Train Accuracy: 97.17%
Val Loss: 0.0974, Val Accuracy: 97.83%
Epoch 9/10, Train Loss: 0.0785, Train Accuracy: 98.08%
Val Loss: 0.0726, Val Accuracy: 98.25%
Epoch 10/10, Train Loss: 0.0587, Train Accuracy: 98.83%
Val Loss: 0.0580, Val Accuracy: 98.75%
lexus adapter trained. Validation Accuracy: 98.75%

Training LoRA adapter for domain: tiguan
Epoch 1/10, Train Loss: 1.9536, Train Accuracy: 24.35%
Val Loss: 1.5830, Val Accuracy: 44.25%
Epoch 2/10, Train Loss: 1.2728, Train Accuracy: 56.81%
Val Loss: 1.0467, Val Accuracy: 64.25%
Epoch 3/10, Train Loss: 0.8002, Train Accuracy: 75.75%
Val Loss: 0.6257, Val Accuracy: 80.08%
Epoch 4/10, Train Loss: 0.4298, Train Accuracy: 88.33%
Val Loss: 0.3180, Val Accuracy: 91.33%
Epoch 5/10, Train Loss: 0.2199, Train Accuracy: 94.98%
Val Loss: 0.1892, Val Accuracy: 95.17%
Epoch 6/10, Train Loss: 0.1394, Train Accuracy: 97.23%
Val Loss: 0.1362, Val Accuracy: 96.83%
Epoch 7/10, Train Loss: 0.1031, Train Accuracy: 97.96%
Val Loss: 0.1066, Val Accuracy: 97.25%
Epoch 8/10, Train Loss: 0.0799, Train Accuracy: 98.44%
Val Loss: 0.0886, Val Accuracy: 97.50%
Epoch 9/10, Train Loss: 0.0649, Train Accuracy: 98.58%
Val Loss: 0.0763, Val Accuracy: 97.92%
Epoch 10/10, Train Loss: 0.0527, Train Accuracy: 98.75%
Val Loss: 0.0665, Val Accuracy: 98.25%
tiguan adapter trained. Validation Accuracy: 98.25%

Training LoRA adapter for domain: tucson
Epoch 1/10, Train Loss: 1.8518, Train Accuracy: 31.15%
Val Loss: 1.4173, Val Accuracy: 49.17%
Epoch 2/10, Train Loss: 1.1582, Train Accuracy: 60.23%
Val Loss: 0.9222, Val Accuracy: 68.92%
Epoch 3/10, Train Loss: 0.7053, Train Accuracy: 78.00%
Val Loss: 0.5093, Val Accuracy: 86.25%
Epoch 4/10, Train Loss: 0.3742, Train Accuracy: 91.31%
Val Loss: 0.2805, Val Accuracy: 93.83%
Epoch 5/10, Train Loss: 0.2153, Train Accuracy: 95.44%
Val Loss: 0.1817, Val Accuracy: 96.25%
Epoch 6/10, Train Loss: 0.1393, Train Accuracy: 97.12%
Val Loss: 0.1205, Val Accuracy: 97.08%
Epoch 7/10, Train Loss: 0.0944, Train Accuracy: 97.96%
Val Loss: 0.0846, Val Accuracy: 98.08%
Epoch 8/10, Train Loss: 0.0648, Train Accuracy: 98.81%
Val Loss: 0.0594, Val Accuracy: 98.75%
Epoch 9/10, Train Loss: 0.0458, Train Accuracy: 99.27%
Val Loss: 0.0441, Val Accuracy: 99.17%
Epoch 10/10, Train Loss: 0.0334, Train Accuracy: 99.54%
Val Loss: 0.0357, Val Accuracy: 99.33%
tucson adapter trained. Validation Accuracy: 99.33%

Training LoRA adapter for domain: x5
Epoch 1/10, Train Loss: 1.8769, Train Accuracy: 26.96%
Val Loss: 1.4803, Val Accuracy: 48.25%
Epoch 2/10, Train Loss: 1.2391, Train Accuracy: 57.44%
Val Loss: 1.0185, Val Accuracy: 65.58%
Epoch 3/10, Train Loss: 0.8040, Train Accuracy: 73.90%
Val Loss: 0.6404, Val Accuracy: 78.33%
Epoch 4/10, Train Loss: 0.4795, Train Accuracy: 84.29%
Val Loss: 0.3788, Val Accuracy: 87.42%
Epoch 5/10, Train Loss: 0.2935, Train Accuracy: 91.54%
Val Loss: 0.2376, Val Accuracy: 93.83%
Epoch 6/10, Train Loss: 0.1922, Train Accuracy: 95.02%
Val Loss: 0.1625, Val Accuracy: 95.83%
Epoch 7/10, Train Loss: 0.1282, Train Accuracy: 96.92%
Val Loss: 0.1098, Val Accuracy: 98.08%
Epoch 8/10, Train Loss: 0.0878, Train Accuracy: 98.33%
Val Loss: 0.0787, Val Accuracy: 98.50%
Epoch 9/10, Train Loss: 0.0635, Train Accuracy: 98.83%
Val Loss: 0.0620, Val Accuracy: 98.75%
Epoch 10/10, Train Loss: 0.0480, Train Accuracy: 99.10%
Val Loss: 0.0463, Val Accuracy: 99.17%
x5 adapter trained. Validation Accuracy: 99.17%

Training LoRA adapter for domain: zoe
Epoch 1/10, Train Loss: 1.8120, Train Accuracy: 32.00%
Val Loss: 1.6026, Val Accuracy: 39.00%
Epoch 2/10, Train Loss: 1.3732, Train Accuracy: 52.12%
Val Loss: 1.1457, Val Accuracy: 66.00%
Epoch 3/10, Train Loss: 0.9247, Train Accuracy: 73.88%
Val Loss: 0.7014, Val Accuracy: 81.25%
Epoch 4/10, Train Loss: 0.5429, Train Accuracy: 86.84%
Val Loss: 0.3850, Val Accuracy: 93.12%
Epoch 5/10, Train Loss: 0.2962, Train Accuracy: 94.25%
Val Loss: 0.2212, Val Accuracy: 96.00%
Epoch 6/10, Train Loss: 0.1741, Train Accuracy: 97.09%
Val Loss: 0.1370, Val Accuracy: 98.38%
Epoch 7/10, Train Loss: 0.1170, Train Accuracy: 98.66%
Val Loss: 0.0989, Val Accuracy: 98.62%
Epoch 8/10, Train Loss: 0.0880, Train Accuracy: 98.88%
Val Loss: 0.0839, Val Accuracy: 98.62%
Epoch 9/10, Train Loss: 0.0708, Train Accuracy: 99.03%
Val Loss: 0.0669, Val Accuracy: 99.25%
Epoch 10/10, Train Loss: 0.0585, Train Accuracy: 99.25%
Val Loss: 0.0592, Val Accuracy: 99.00%
zoe adapter trained. Validation Accuracy: 99.25%

Training coefficients for adapter merging
Initial coefficients: [0.11049187 0.10934035 0.11037431 0.11015108 0.1106604  0.11228073
 0.11256295 0.11171754 0.1124208 ]
Epoch 1, Loss: 2.4521, Accuracy: 33.50%
Coefficients: [3.7351005e-05 1.0889107e-04 2.8337494e-01 5.3882479e-05 5.6643218e-01
 1.3015553e-01 1.9611472e-02 4.3587570e-05 1.8211216e-04]
Epoch 2, Loss: 2.4583, Accuracy: 33.33%
Coefficients: [1.5883862e-06 6.0446923e-06 3.9592232e-03 2.4267742e-06 9.8848236e-01
 7.1982844e-03 3.4138348e-04 1.8858919e-06 6.9216940e-06]
Epoch 3, Loss: 2.4444, Accuracy: 33.83%
Coefficients: [5.8246627e-07 2.3137784e-06 1.1021647e-03 8.9887118e-07 9.9708277e-01
 1.7024458e-03 1.0555998e-04 6.9339319e-07 2.4867979e-06]
Epoch 4, Loss: 2.4457, Accuracy: 33.50%
Coefficients: [4.7969382e-07 1.9211502e-06 8.6474972e-04 7.4159101e-07 9.9780101e-01
 1.2437123e-03 8.4811894e-05 5.7137254e-07 2.0426794e-06]
Epoch 5, Loss: 2.4508, Accuracy: 33.67%
Coefficients: [4.7806782e-07 1.9193876e-06 8.4899913e-04 7.3927600e-07 9.9777776e-01
 1.2821584e-03 8.5277563e-05 5.6939234e-07 2.0354817e-06]
Epoch 6, Loss: 2.4460, Accuracy: 33.67%
Coefficients: [4.8315331e-07 1.9361091e-06 8.5517426e-04 7.4715166e-07 9.9772221e-01
 1.3305093e-03 8.6342021e-05 5.7532969e-07 2.0562011e-06]
Epoch 7, Loss: 2.4571, Accuracy: 33.83%
Coefficients: [4.6987952e-07 1.8850128e-06 8.1201264e-04 7.2645855e-07 9.9780494e-01
 1.2933147e-03 8.3984814e-05 5.5931810e-07 1.9988543e-06]
Epoch 8, Loss: 2.4414, Accuracy: 33.67%
Coefficients: [4.1534804e-07 1.6590584e-06 6.6988054e-04 6.4223951e-07 9.9818772e-01
 1.0638509e-03 7.3648014e-05 4.9438705e-07 1.7670036e-06]
Epoch 9, Loss: 2.4428, Accuracy: 33.33%
Coefficients: [4.2477043e-07 1.6971240e-06 6.9005211e-04 6.5703091e-07 9.9810755e-01
 1.1226390e-03 7.4625656e-05 5.0572891e-07 1.8078613e-06]
Epoch 10, Loss: 2.4554, Accuracy: 33.50%
Coefficients: [4.5417187e-07 1.8201350e-06 7.7950145e-04 7.0260569e-07 9.9793696e-01
 1.1972205e-03 8.0849073e-05 5.4078606e-07 1.9346412e-06]
Best coefficient accuracy: 33.83%
Final best coefficients: [5.8246627e-07 2.3137784e-06 1.1021647e-03 8.9887118e-07 9.9708277e-01
 1.7024458e-03 1.0555998e-04 6.9339319e-07 2.4867979e-06]

Merged model - Test Loss: 2.3637, Test Accuracy: 32.57%

Single Run Summary:
Test Domain: tesla
Domain Accuracies:
  aclass: 99.25%
  escape: 99.67%
  hilux: 97.17%
  i3: 99.62%
  lexus: 98.75%
  tiguan: 98.25%
  tucson: 99.33%
  x5: 99.17%
  zoe: 99.25%
Final Accuracy: 32.57%
Coefficients: ['0.0000', '0.0000', '0.0011', '0.0000', '0.9971', '0.0017', '0.0001', '0.0000', '0.0000']

--- Run 6/10 ---
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: tiguan
Training domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tucson', 'x5', 'zoe']

Running LoRA with Separate Classifiers experiment
Test domain: tiguan
Train domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tucson', 'x5', 'zoe']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.0882, Train Accuracy: 42.00%
Val Loss: 1.5323, Val Accuracy: 44.98%
Epoch 2/10, Train Loss: 1.2656, Train Accuracy: 51.17%
Val Loss: 1.1237, Val Accuracy: 51.57%
Epoch 3/10, Train Loss: 0.9607, Train Accuracy: 65.00%
Val Loss: 0.8763, Val Accuracy: 69.81%
Epoch 4/10, Train Loss: 0.7701, Train Accuracy: 76.17%
Val Loss: 0.7231, Val Accuracy: 77.17%
Epoch 5/10, Train Loss: 0.6498, Train Accuracy: 82.17%
Val Loss: 0.6184, Val Accuracy: 80.76%
Epoch 6/10, Train Loss: 0.5483, Train Accuracy: 84.83%
Val Loss: 0.5281, Val Accuracy: 84.78%
Epoch 7/10, Train Loss: 0.4693, Train Accuracy: 87.33%
Val Loss: 0.4674, Val Accuracy: 86.54%
Epoch 8/10, Train Loss: 0.4119, Train Accuracy: 88.67%
Val Loss: 0.4188, Val Accuracy: 88.11%
Epoch 9/10, Train Loss: 0.3642, Train Accuracy: 90.67%
Val Loss: 0.3779, Val Accuracy: 89.44%
Epoch 10/10, Train Loss: 0.3301, Train Accuracy: 91.50%
Val Loss: 0.3439, Val Accuracy: 90.54%
Baseline Model - Final Test Loss: 0.3439, Test Accuracy: 90.54%

Training LoRA adapter for domain: aclass
Epoch 1/10, Train Loss: 1.9046, Train Accuracy: 24.94%
Val Loss: 1.5556, Val Accuracy: 42.75%
Epoch 2/10, Train Loss: 1.2118, Train Accuracy: 58.21%
Val Loss: 0.9796, Val Accuracy: 67.92%
Epoch 3/10, Train Loss: 0.6510, Train Accuracy: 80.94%
Val Loss: 0.4685, Val Accuracy: 87.25%
Epoch 4/10, Train Loss: 0.3105, Train Accuracy: 91.85%
Val Loss: 0.2711, Val Accuracy: 92.08%
Epoch 5/10, Train Loss: 0.1794, Train Accuracy: 95.69%
Val Loss: 0.1744, Val Accuracy: 94.58%
Epoch 6/10, Train Loss: 0.1146, Train Accuracy: 97.38%
Val Loss: 0.1203, Val Accuracy: 96.50%
Epoch 7/10, Train Loss: 0.0789, Train Accuracy: 98.27%
Val Loss: 0.0934, Val Accuracy: 97.17%
