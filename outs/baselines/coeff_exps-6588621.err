Epoch 1/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 1/10:   9%|▉         | 1/11 [00:02<00:21,  2.16s/it]Epoch 1/10:  18%|█▊        | 2/11 [00:02<00:08,  1.04it/s]Epoch 1/10:  27%|██▋       | 3/11 [00:02<00:04,  1.71it/s]Epoch 1/10:  36%|███▋      | 4/11 [00:02<00:02,  2.44it/s]Epoch 1/10:  45%|████▌     | 5/11 [00:02<00:01,  3.19it/s]Epoch 1/10:  55%|█████▍    | 6/11 [00:02<00:01,  3.92it/s]Epoch 1/10:  64%|██████▎   | 7/11 [00:02<00:00,  4.59it/s]Epoch 1/10:  73%|███████▎  | 8/11 [00:03<00:00,  5.17it/s]Epoch 1/10:  82%|████████▏ | 9/11 [00:03<00:00,  5.64it/s]Epoch 1/10:  91%|█████████ | 10/11 [00:03<00:00,  6.02it/s]Epoch 1/10: 100%|██████████| 11/11 [00:03<00:00,  6.29it/s]Epoch 1/10: 100%|██████████| 11/11 [00:03<00:00,  3.10it/s]
Epoch 2/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 2/10:   9%|▉         | 1/11 [00:00<00:01,  7.78it/s]Epoch 2/10:  18%|█▊        | 2/11 [00:00<00:01,  7.35it/s]Epoch 2/10:  27%|██▋       | 3/11 [00:00<00:01,  7.22it/s]Epoch 2/10:  36%|███▋      | 4/11 [00:00<00:00,  7.16it/s]Epoch 2/10:  45%|████▌     | 5/11 [00:00<00:00,  7.13it/s]Epoch 2/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.11it/s]Epoch 2/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.10it/s]Epoch 2/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.09it/s]Epoch 2/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.08it/s]Epoch 2/10:  91%|█████████ | 10/11 [00:01<00:00,  7.08it/s]Epoch 2/10: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s]Epoch 2/10: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s]
Epoch 3/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 3/10:   9%|▉         | 1/11 [00:00<00:01,  7.74it/s]Epoch 3/10:  18%|█▊        | 2/11 [00:00<00:01,  7.33it/s]Epoch 3/10:  27%|██▋       | 3/11 [00:00<00:01,  7.21it/s]Epoch 3/10:  36%|███▋      | 4/11 [00:00<00:00,  7.15it/s]Epoch 3/10:  45%|████▌     | 5/11 [00:00<00:00,  7.12it/s]Epoch 3/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.10it/s]Epoch 3/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.09it/s]Epoch 3/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.09it/s]Epoch 3/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.08it/s]Epoch 3/10:  91%|█████████ | 10/11 [00:01<00:00,  7.08it/s]Epoch 3/10: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s]Epoch 3/10: 100%|██████████| 11/11 [00:01<00:00,  7.12it/s]
Epoch 4/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 4/10:   9%|▉         | 1/11 [00:00<00:01,  7.75it/s]Epoch 4/10:  18%|█▊        | 2/11 [00:00<00:01,  7.34it/s]Epoch 4/10:  27%|██▋       | 3/11 [00:00<00:01,  7.21it/s]Epoch 4/10:  36%|███▋      | 4/11 [00:00<00:00,  7.16it/s]Epoch 4/10:  45%|████▌     | 5/11 [00:00<00:00,  7.13it/s]Epoch 4/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.11it/s]Epoch 4/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.10it/s]Epoch 4/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.09it/s]Epoch 4/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.08it/s]Epoch 4/10:  91%|█████████ | 10/11 [00:01<00:00,  7.08it/s]Epoch 4/10: 100%|██████████| 11/11 [00:01<00:00,  7.07it/s]Epoch 4/10: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s]
Epoch 5/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 5/10:   9%|▉         | 1/11 [00:00<00:01,  7.74it/s]Epoch 5/10:  18%|█▊        | 2/11 [00:00<00:01,  7.34it/s]Epoch 5/10:  27%|██▋       | 3/11 [00:00<00:01,  7.21it/s]Epoch 5/10:  36%|███▋      | 4/11 [00:00<00:00,  7.16it/s]Epoch 5/10:  45%|████▌     | 5/11 [00:00<00:00,  7.12it/s]Epoch 5/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.10it/s]Epoch 5/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.09it/s]Epoch 5/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.08it/s]Epoch 5/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.08it/s]Epoch 5/10:  91%|█████████ | 10/11 [00:01<00:00,  7.07it/s]Epoch 5/10: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s]Epoch 5/10: 100%|██████████| 11/11 [00:01<00:00,  7.12it/s]
Epoch 6/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 6/10:   9%|▉         | 1/11 [00:00<00:01,  7.75it/s]Epoch 6/10:  18%|█▊        | 2/11 [00:00<00:01,  7.33it/s]Epoch 6/10:  27%|██▋       | 3/11 [00:00<00:01,  7.21it/s]Epoch 6/10:  36%|███▋      | 4/11 [00:00<00:00,  7.16it/s]Epoch 6/10:  45%|████▌     | 5/11 [00:00<00:00,  7.13it/s]Epoch 6/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.11it/s]Epoch 6/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.09it/s]Epoch 6/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.09it/s]Epoch 6/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.08it/s]Epoch 6/10:  91%|█████████ | 10/11 [00:01<00:00,  7.08it/s]Epoch 6/10: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s]Epoch 6/10: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s]
Epoch 7/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 7/10:   9%|▉         | 1/11 [00:00<00:01,  7.73it/s]Epoch 7/10:  18%|█▊        | 2/11 [00:00<00:01,  7.33it/s]Epoch 7/10:  27%|██▋       | 3/11 [00:00<00:01,  7.21it/s]Epoch 7/10:  36%|███▋      | 4/11 [00:00<00:00,  7.15it/s]Epoch 7/10:  45%|████▌     | 5/11 [00:00<00:00,  7.12it/s]Epoch 7/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.09it/s]Epoch 7/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.09it/s]Epoch 7/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.09it/s]Epoch 7/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.07it/s]Epoch 7/10:  91%|█████████ | 10/11 [00:01<00:00,  7.07it/s]Epoch 7/10: 100%|██████████| 11/11 [00:01<00:00,  7.06it/s]Epoch 7/10: 100%|██████████| 11/11 [00:01<00:00,  7.12it/s]
Epoch 8/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 8/10:   9%|▉         | 1/11 [00:00<00:01,  7.74it/s]Epoch 8/10:  18%|█▊        | 2/11 [00:00<00:01,  7.32it/s]Epoch 8/10:  27%|██▋       | 3/11 [00:00<00:01,  7.20it/s]Epoch 8/10:  36%|███▋      | 4/11 [00:00<00:00,  7.12it/s]Epoch 8/10:  45%|████▌     | 5/11 [00:00<00:00,  7.09it/s]Epoch 8/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.08it/s]Epoch 8/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.05it/s]Epoch 8/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.05it/s]Epoch 8/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.06it/s]Epoch 8/10:  91%|█████████ | 10/11 [00:01<00:00,  7.06it/s]Epoch 8/10: 100%|██████████| 11/11 [00:01<00:00,  7.07it/s]Epoch 8/10: 100%|██████████| 11/11 [00:01<00:00,  7.10it/s]
Epoch 9/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 9/10:   9%|▉         | 1/11 [00:00<00:01,  7.74it/s]Epoch 9/10:  18%|█▊        | 2/11 [00:00<00:01,  7.34it/s]Epoch 9/10:  27%|██▋       | 3/11 [00:00<00:01,  7.21it/s]Epoch 9/10:  36%|███▋      | 4/11 [00:00<00:00,  7.16it/s]Epoch 9/10:  45%|████▌     | 5/11 [00:00<00:00,  7.13it/s]Epoch 9/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.11it/s]Epoch 9/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.09it/s]Epoch 9/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.07it/s]Epoch 9/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.07it/s]Epoch 9/10:  91%|█████████ | 10/11 [00:01<00:00,  7.06it/s]Epoch 9/10: 100%|██████████| 11/11 [00:01<00:00,  7.06it/s]Epoch 9/10: 100%|██████████| 11/11 [00:01<00:00,  7.12it/s]
Epoch 10/10:   0%|          | 0/11 [00:00<?, ?it/s]Epoch 10/10:   9%|▉         | 1/11 [00:00<00:01,  7.71it/s]Epoch 10/10:  18%|█▊        | 2/11 [00:00<00:01,  7.30it/s]Epoch 10/10:  27%|██▋       | 3/11 [00:00<00:01,  7.17it/s]Epoch 10/10:  36%|███▋      | 4/11 [00:00<00:00,  7.12it/s]Epoch 10/10:  45%|████▌     | 5/11 [00:00<00:00,  7.10it/s]Epoch 10/10:  55%|█████▍    | 6/11 [00:00<00:00,  7.09it/s]Epoch 10/10:  64%|██████▎   | 7/11 [00:00<00:00,  7.07it/s]Epoch 10/10:  73%|███████▎  | 8/11 [00:01<00:00,  7.07it/s]Epoch 10/10:  82%|████████▏ | 9/11 [00:01<00:00,  7.07it/s]Epoch 10/10:  91%|█████████ | 10/11 [00:01<00:00,  7.06it/s]Epoch 10/10: 100%|██████████| 11/11 [00:01<00:00,  7.06it/s]Epoch 10/10: 100%|██████████| 11/11 [00:01<00:00,  7.10it/s]
Traceback (most recent call last):
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/peft/peft_model.py", line 540, in __getattr__
    return super().__getattr__(name)  # defer to nn.Module's logic
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'PeftModel' object has no attribute 'get_peft_state_dict'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/peft/tuners/lora/model.py", line 311, in __getattr__
    return super().__getattr__(name)  # defer to nn.Module's logic
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'LoraModel' object has no attribute 'get_peft_state_dict'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 157, in <module>
    run_experiment(config)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 121, in run_experiment
    lora_adapters = train_lora_adapters(base_model, dataset, train_domains, config)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 43, in train_lora_adapters
    lora_adapters[domain] = lora_model.get_peft_state_dict()
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/peft/peft_model.py", line 542, in __getattr__
    return getattr(self.base_model, name)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/peft/tuners/lora/model.py", line 313, in __getattr__
    return getattr(self.model, name)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'VisionTransformer' object has no attribute 'get_peft_state_dict'
