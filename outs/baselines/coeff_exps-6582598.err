Epoch 1/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 1/5:  33%|███▎      | 1/3 [00:02<00:04,  2.23s/it]Epoch 1/5:  67%|██████▋   | 2/3 [00:02<00:01,  1.04s/it]Epoch 1/5: 100%|██████████| 3/3 [00:02<00:00,  1.21it/s]
Epoch 2/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 2/5:  33%|███▎      | 1/3 [00:00<00:00,  4.87it/s]Epoch 2/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.89it/s]Epoch 2/5: 100%|██████████| 3/3 [00:00<00:00,  6.63it/s]
Epoch 3/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 3/5:  33%|███▎      | 1/3 [00:00<00:00,  4.88it/s]Epoch 3/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.90it/s]Epoch 3/5: 100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
Epoch 4/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 4/5:  33%|███▎      | 1/3 [00:00<00:00,  4.88it/s]Epoch 4/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.90it/s]Epoch 4/5: 100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
Epoch 5/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 5/5:  33%|███▎      | 1/3 [00:00<00:00,  4.88it/s]Epoch 5/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.90it/s]Epoch 5/5: 100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
Evaluating:   0%|          | 0/3 [00:00<?, ?it/s]Evaluating:  33%|███▎      | 1/3 [00:00<00:00,  7.63it/s]Evaluating:  67%|██████▋   | 2/3 [00:00<00:00,  7.71it/s]Evaluating: 100%|██████████| 3/3 [00:00<00:00, 10.39it/s]
Epoch 1/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 1/5:  33%|███▎      | 1/3 [00:00<00:00,  4.97it/s]Epoch 1/5:  67%|██████▋   | 2/3 [00:00<00:00,  5.00it/s]Epoch 1/5: 100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
Epoch 2/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 2/5:  33%|███▎      | 1/3 [00:00<00:00,  5.03it/s]Epoch 2/5:  67%|██████▋   | 2/3 [00:00<00:00,  5.02it/s]Epoch 2/5: 100%|██████████| 3/3 [00:00<00:00,  6.81it/s]
Epoch 3/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 3/5:  33%|███▎      | 1/3 [00:00<00:00,  5.00it/s]Epoch 3/5:  67%|██████▋   | 2/3 [00:00<00:00,  5.03it/s]Epoch 3/5: 100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
Epoch 4/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 4/5:  33%|███▎      | 1/3 [00:00<00:00,  5.00it/s]Epoch 4/5:  67%|██████▋   | 2/3 [00:00<00:00,  5.02it/s]Epoch 4/5: 100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
Epoch 5/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 5/5:  33%|███▎      | 1/3 [00:00<00:00,  4.98it/s]Epoch 5/5:  67%|██████▋   | 2/3 [00:00<00:00,  5.00it/s]Epoch 5/5: 100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
Evaluating:   0%|          | 0/3 [00:00<?, ?it/s]Evaluating:  33%|███▎      | 1/3 [00:00<00:00,  7.71it/s]Evaluating:  67%|██████▋   | 2/3 [00:00<00:00,  7.72it/s]Evaluating: 100%|██████████| 3/3 [00:00<00:00, 10.41it/s]
Epoch 1/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 1/5:  33%|███▎      | 1/3 [00:00<00:00,  4.90it/s]Epoch 1/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.91it/s]Epoch 1/5: 100%|██████████| 3/3 [00:00<00:00,  6.65it/s]
Epoch 2/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 2/5:  33%|███▎      | 1/3 [00:00<00:00,  4.94it/s]Epoch 2/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.96it/s]Epoch 2/5: 100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
Epoch 3/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 3/5:  33%|███▎      | 1/3 [00:00<00:00,  4.92it/s]Epoch 3/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.94it/s]Epoch 3/5: 100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
Epoch 4/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 4/5:  33%|███▎      | 1/3 [00:00<00:00,  4.93it/s]Epoch 4/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.93it/s]Epoch 4/5: 100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
Epoch 5/5:   0%|          | 0/3 [00:00<?, ?it/s]Epoch 5/5:  33%|███▎      | 1/3 [00:00<00:00,  4.90it/s]Epoch 5/5:  67%|██████▋   | 2/3 [00:00<00:00,  4.93it/s]Epoch 5/5: 100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
Evaluating:   0%|          | 0/3 [00:00<?, ?it/s]Evaluating:  33%|███▎      | 1/3 [00:00<00:00,  7.66it/s]Evaluating:  67%|██████▋   | 2/3 [00:00<00:00,  7.77it/s]Evaluating: 100%|██████████| 3/3 [00:00<00:00, 10.47it/s]
Coefficient Epoch 1/5:   0%|          | 0/3 [00:00<?, ?it/s]Coefficient Epoch 1/5:   0%|          | 0/3 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 294, in <module>
    main(config)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 276, in main
    result = run_baseline_4_experiment(dataset_name, dataset_config, config)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 248, in run_baseline_4_experiment
    coefficients = train_coefficients(base_model, lora_adapters, DataLoader(test_subset, batch_size=global_config['batch_size'], shuffle=True), global_config, device)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 108, in train_coefficients
    outputs = sum(F.softmax(coefficients, dim=0)[i] * model(inputs)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/test.py", line 108, in <genexpr>
    outputs = sum(F.softmax(coefficients, dim=0)[i] * model(inputs)
TypeError: '_IncompatibleKeys' object is not callable
