rank 32

==================================================
Running experiments for dataset: OfficeHome
==================================================
Dataset config for OfficeHome:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home', 'max_samples_per_class': None, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 10, 'learning_rate': 1e-06, 'lora_r': 32, 'lora_alpha': 32, 'lora_dropout': 0.05, 'coefficient_learning_rate': 1, 'coefficient_epochs': 10, 'seed': 42}
Type of dataset_config: <class 'dict'>
Contents of dataset_config:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home', 'max_samples_per_class': None, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 10, 'learning_rate': 1e-06, 'lora_r': 32, 'lora_alpha': 32, 'lora_dropout': 0.05, 'coefficient_learning_rate': 1, 'coefficient_epochs': 10, 'seed': 42}

Run 1/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Art
Training domains: ['Clipart', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Art
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.5065
Epoch 2, Average Loss: 4.2307
Epoch 3, Average Loss: 4.0500
Epoch 4, Average Loss: 3.8835
Epoch 5, Average Loss: 3.7139
Epoch 6, Average Loss: 3.5315
Epoch 7, Average Loss: 3.3269
Epoch 8, Average Loss: 3.0931
Epoch 9, Average Loss: 2.8242
Epoch 10, Average Loss: 2.5240
Accuracy: 20.6755
Training domains: ['Clipart', 'Product', 'Real World']

Training expert models...

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 4.6251
Epoch 2, Average Loss: 4.5590
Epoch 3, Average Loss: 4.4943
Epoch 4, Average Loss: 4.4341
Epoch 5, Average Loss: 4.3809
Epoch 6, Average Loss: 4.3278
Epoch 7, Average Loss: 4.2798
Epoch 8, Average Loss: 4.2336
Epoch 9, Average Loss: 4.1914
Epoch 10, Average Loss: 4.1578
Merged model device: cuda:0
Accuracy: 2.0593
Accuracy of Clipart model on test domain: 2.0593

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 4.5409
Epoch 2, Average Loss: 4.4536
Epoch 3, Average Loss: 4.3860
Epoch 4, Average Loss: 4.3281
Epoch 5, Average Loss: 4.2754
Epoch 6, Average Loss: 4.2285
Epoch 7, Average Loss: 4.1843
Epoch 8, Average Loss: 4.1415
Epoch 9, Average Loss: 4.1002
Epoch 10, Average Loss: 4.0587
Merged model device: cuda:0
Accuracy: 2.9654
Accuracy of Product model on test domain: 2.9654

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 4.4299
Epoch 2, Average Loss: 4.3907
Epoch 3, Average Loss: 4.3431
Epoch 4, Average Loss: 4.3014
Epoch 5, Average Loss: 4.2652
Epoch 6, Average Loss: 4.2221
Epoch 7, Average Loss: 4.1771
Epoch 8, Average Loss: 4.1415
Epoch 9, Average Loss: 4.1079
Epoch 10, Average Loss: 4.0669
Merged model device: cuda:0
Accuracy: 3.2949
Accuracy of Real World model on test domain: 3.2949

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.1676
Coefficient Epoch 2, Average Loss: 4.1633
Coefficient Epoch 3, Average Loss: 4.1552
Coefficient Epoch 4, Average Loss: 4.2005
Coefficient Epoch 5, Average Loss: 4.2109
Coefficient Epoch 6, Average Loss: 4.1607
Coefficient Epoch 7, Average Loss: 4.1522
Coefficient Epoch 8, Average Loss: 4.2570
Coefficient Epoch 9, Average Loss: 4.1926
Coefficient Epoch 10, Average Loss: 4.1807
Final device check:
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.40704384446144104, 0.2241317629814148, 0.36882439255714417]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 4.8600
Final model accuracy on test domain: 4.8600

Run 2/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Clipart
Training domains: ['Art', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Clipart
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.4598
Epoch 2, Average Loss: 4.1358
Epoch 3, Average Loss: 3.9442
Epoch 4, Average Loss: 3.7439
Epoch 5, Average Loss: 3.4885
Epoch 6, Average Loss: 3.1853
Epoch 7, Average Loss: 2.8301
Epoch 8, Average Loss: 2.4047
Epoch 9, Average Loss: 1.9925
Epoch 10, Average Loss: 1.6296
Accuracy: 40.9528
Training domains: ['Art', 'Product', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 4.5223
Epoch 2, Average Loss: 4.4924
Epoch 3, Average Loss: 4.4648
Epoch 4, Average Loss: 4.4359
Epoch 5, Average Loss: 4.4066
Epoch 6, Average Loss: 4.3781
Epoch 7, Average Loss: 4.3497
Epoch 8, Average Loss: 4.3202
Epoch 9, Average Loss: 4.2907
Epoch 10, Average Loss: 4.2618
Merged model device: cuda:0
Accuracy: 2.5653
Accuracy of Art model on test domain: 2.5653

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 4.5032
Epoch 2, Average Loss: 4.4219
Epoch 3, Average Loss: 4.3591
Epoch 4, Average Loss: 4.3050
Epoch 5, Average Loss: 4.2553
Epoch 6, Average Loss: 4.2062
Epoch 7, Average Loss: 4.1600
Epoch 8, Average Loss: 4.1145
Epoch 9, Average Loss: 4.0705
Epoch 10, Average Loss: 4.0270
Merged model device: cuda:0
Accuracy: 2.7485
Accuracy of Product model on test domain: 2.7485

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 4.4810
Epoch 2, Average Loss: 4.4348
Epoch 3, Average Loss: 4.3889
Epoch 4, Average Loss: 4.3505
Epoch 5, Average Loss: 4.3053
Epoch 6, Average Loss: 4.2609
Epoch 7, Average Loss: 4.2244
Epoch 8, Average Loss: 4.1873
Epoch 9, Average Loss: 4.1521
Epoch 10, Average Loss: 4.1141
Merged model device: cuda:0
Accuracy: 2.4737
Accuracy of Real World model on test domain: 2.4737

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.2416
Coefficient Epoch 2, Average Loss: 4.1943
Coefficient Epoch 3, Average Loss: 4.2055
Coefficient Epoch 4, Average Loss: 4.2316
Coefficient Epoch 5, Average Loss: 4.2337
Coefficient Epoch 6, Average Loss: 4.2402
Coefficient Epoch 7, Average Loss: 4.2378
Coefficient Epoch 8, Average Loss: 4.2555
Coefficient Epoch 9, Average Loss: 4.2205
Coefficient Epoch 10, Average Loss: 4.2114
Final device check:
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.30467692017555237, 0.2318946272134781, 0.46342843770980835]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 2.1988
Final model accuracy on test domain: 2.1988

Run 3/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Product
Training domains: ['Art', 'Clipart', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Product
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.2378
Epoch 2, Average Loss: 3.9086
Epoch 3, Average Loss: 3.5792
Epoch 4, Average Loss: 3.1111
Epoch 5, Average Loss: 2.4300
Epoch 6, Average Loss: 1.7337
Epoch 7, Average Loss: 1.2444
Epoch 8, Average Loss: 0.9180
Epoch 9, Average Loss: 0.6933
Epoch 10, Average Loss: 0.5329
Accuracy: 72.4324
Training domains: ['Art', 'Clipart', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 4.5472
Epoch 2, Average Loss: 4.5203
Epoch 3, Average Loss: 4.4960
Epoch 4, Average Loss: 4.4696
Epoch 5, Average Loss: 4.4434
Epoch 6, Average Loss: 4.4166
Epoch 7, Average Loss: 4.3895
Epoch 8, Average Loss: 4.3624
Epoch 9, Average Loss: 4.3352
Epoch 10, Average Loss: 4.3074
Merged model device: cuda:0
Accuracy: 1.7117
Accuracy of Art model on test domain: 1.7117

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 4.7024
Epoch 2, Average Loss: 4.6400
Epoch 3, Average Loss: 4.5792
Epoch 4, Average Loss: 4.5231
Epoch 5, Average Loss: 4.4689
Epoch 6, Average Loss: 4.4176
Epoch 7, Average Loss: 4.3677
Epoch 8, Average Loss: 4.3247
Epoch 9, Average Loss: 4.2829
Epoch 10, Average Loss: 4.2436
Merged model device: cuda:0
Accuracy: 1.0811
Accuracy of Clipart model on test domain: 1.0811

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 4.4140
Epoch 2, Average Loss: 4.3730
Epoch 3, Average Loss: 4.3284
Epoch 4, Average Loss: 4.2918
Epoch 5, Average Loss: 4.2441
Epoch 6, Average Loss: 4.2063
Epoch 7, Average Loss: 4.1627
Epoch 8, Average Loss: 4.1266
Epoch 9, Average Loss: 4.0855
Epoch 10, Average Loss: 4.0443
Merged model device: cuda:0
Accuracy: 4.1892
Accuracy of Real World model on test domain: 4.1892

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.1533
Coefficient Epoch 2, Average Loss: 4.0798
Coefficient Epoch 3, Average Loss: 4.1127
Coefficient Epoch 4, Average Loss: 4.0992
Coefficient Epoch 5, Average Loss: 4.0666
Coefficient Epoch 6, Average Loss: 4.0734
Coefficient Epoch 7, Average Loss: 4.0839
Coefficient Epoch 8, Average Loss: 4.1061
Coefficient Epoch 9, Average Loss: 4.0772
Coefficient Epoch 10, Average Loss: 4.0984
Final device check:
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.19844935834407806, 0.473418265581131, 0.328132301568985]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 2.3423
Final model accuracy on test domain: 2.3423

Run 4/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Real World
Training domains: ['Art', 'Clipart', 'Product']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Real World
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3389
Epoch 2, Average Loss: 4.0591
Epoch 3, Average Loss: 3.8451
Epoch 4, Average Loss: 3.6112
Epoch 5, Average Loss: 3.3012
Epoch 6, Average Loss: 2.8786
Epoch 7, Average Loss: 2.4085
Epoch 8, Average Loss: 1.9104
Epoch 9, Average Loss: 1.4437
Epoch 10, Average Loss: 1.0887
Accuracy: 58.6508
Training domains: ['Art', 'Clipart', 'Product']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 4.5828
Epoch 2, Average Loss: 4.5585
Epoch 3, Average Loss: 4.5334
Epoch 4, Average Loss: 4.5071
Epoch 5, Average Loss: 4.4813
Epoch 6, Average Loss: 4.4559
Epoch 7, Average Loss: 4.4293
Epoch 8, Average Loss: 4.4023
Epoch 9, Average Loss: 4.3754
Epoch 10, Average Loss: 4.3476
Merged model device: cuda:0
Accuracy: 2.4323
Accuracy of Art model on test domain: 2.4323

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 4.6762
Epoch 2, Average Loss: 4.6144
Epoch 3, Average Loss: 4.5571
Epoch 4, Average Loss: 4.4968
Epoch 5, Average Loss: 4.4435
Epoch 6, Average Loss: 4.3851
Epoch 7, Average Loss: 4.3331
Epoch 8, Average Loss: 4.2802
Epoch 9, Average Loss: 4.2390
Epoch 10, Average Loss: 4.1981
Merged model device: cuda:0
Accuracy: 1.4686
Accuracy of Clipart model on test domain: 1.4686

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 4.5280
Epoch 2, Average Loss: 4.4468
Epoch 3, Average Loss: 4.3811
Epoch 4, Average Loss: 4.3231
Epoch 5, Average Loss: 4.2703
Epoch 6, Average Loss: 4.2198
Epoch 7, Average Loss: 4.1721
Epoch 8, Average Loss: 4.1264
Epoch 9, Average Loss: 4.0815
Epoch 10, Average Loss: 4.0379
Merged model device: cuda:0
Accuracy: 3.4878
Accuracy of Product model on test domain: 3.4878

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.1994
Coefficient Epoch 2, Average Loss: 4.1600
Coefficient Epoch 3, Average Loss: 4.1816
Coefficient Epoch 4, Average Loss: 4.1798
Coefficient Epoch 5, Average Loss: 4.2036
Coefficient Epoch 6, Average Loss: 4.1867
Coefficient Epoch 7, Average Loss: 4.2215
Coefficient Epoch 8, Average Loss: 4.1397
Coefficient Epoch 9, Average Loss: 4.2141
Coefficient Epoch 10, Average Loss: 4.1875
Final device check:
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Coefficient training complete.
Learned coefficients: [0.2963365316390991, 0.29207852482795715, 0.4115850031375885]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 3.4878
Final model accuracy on test domain: 3.4878

Run 5/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Art
Training domains: ['Clipart', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Art
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.4971
Epoch 2, Average Loss: 4.2294
Epoch 3, Average Loss: 4.0508
Epoch 4, Average Loss: 3.8828
Epoch 5, Average Loss: 3.7131
Epoch 6, Average Loss: 3.5271
Epoch 7, Average Loss: 3.3248
Epoch 8, Average Loss: 3.0962
Epoch 9, Average Loss: 2.8431
Epoch 10, Average Loss: 2.5647
Accuracy: 23.2290
Training domains: ['Clipart', 'Product', 'Real World']

Training expert models...

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 4.5640
Epoch 2, Average Loss: 4.5016
Epoch 3, Average Loss: 4.4383
Epoch 4, Average Loss: 4.3826
Epoch 5, Average Loss: 4.3306
Epoch 6, Average Loss: 4.2819
Epoch 7, Average Loss: 4.2389
Epoch 8, Average Loss: 4.1975
Epoch 9, Average Loss: 4.1608
Epoch 10, Average Loss: 4.1270
Merged model device: cuda:0
Accuracy: 2.8830
Accuracy of Clipart model on test domain: 2.8830

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 4.4886
Epoch 2, Average Loss: 4.4154
Epoch 3, Average Loss: 4.3503
Epoch 4, Average Loss: 4.2913
Epoch 5, Average Loss: 4.2392
Epoch 6, Average Loss: 4.1926
Epoch 7, Average Loss: 4.1475
Epoch 8, Average Loss: 4.1044
Epoch 9, Average Loss: 4.0631
Epoch 10, Average Loss: 4.0211
Merged model device: cuda:0
Accuracy: 2.9654
Accuracy of Product model on test domain: 2.9654

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 4.5617
Epoch 2, Average Loss: 4.5097
Epoch 3, Average Loss: 4.4602
Epoch 4, Average Loss: 4.4119
Epoch 5, Average Loss: 4.3647
Epoch 6, Average Loss: 4.3194
Epoch 7, Average Loss: 4.2764
Epoch 8, Average Loss: 4.2327
Epoch 9, Average Loss: 4.1913
Epoch 10, Average Loss: 4.1518
Merged model device: cuda:0
Accuracy: 2.1417
Accuracy of Real World model on test domain: 2.1417

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.2175
Coefficient Epoch 2, Average Loss: 4.1279
Coefficient Epoch 3, Average Loss: 4.1266
Coefficient Epoch 4, Average Loss: 4.1605
Coefficient Epoch 5, Average Loss: 4.1704
Coefficient Epoch 6, Average Loss: 4.1358
Coefficient Epoch 7, Average Loss: 4.1264
Coefficient Epoch 8, Average Loss: 4.1340
Coefficient Epoch 9, Average Loss: 4.1951
Coefficient Epoch 10, Average Loss: 4.1628
Final device check:
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.32504093647003174, 0.3626769781112671, 0.31228208541870117]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 2.9654
Final model accuracy on test domain: 2.9654

Run 6/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Clipart
Training domains: ['Art', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Clipart
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.4430
Epoch 2, Average Loss: 4.1665
Epoch 3, Average Loss: 3.9701
Epoch 4, Average Loss: 3.7549
Epoch 5, Average Loss: 3.4937
Epoch 6, Average Loss: 3.1569
Epoch 7, Average Loss: 2.7375
Epoch 8, Average Loss: 2.2897
Epoch 9, Average Loss: 1.8939
Epoch 10, Average Loss: 1.5421
Accuracy: 37.1965
Training domains: ['Art', 'Product', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 4.5913
Epoch 2, Average Loss: 4.5649
Epoch 3, Average Loss: 4.5396
Epoch 4, Average Loss: 4.5130
Epoch 5, Average Loss: 4.4873
Epoch 6, Average Loss: 4.4619
Epoch 7, Average Loss: 4.4350
Epoch 8, Average Loss: 4.4081
Epoch 9, Average Loss: 4.3806
Epoch 10, Average Loss: 4.3531
Merged model device: cuda:0
Accuracy: 1.9698
Accuracy of Art model on test domain: 1.9698

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 4.4640
Epoch 2, Average Loss: 4.3800
Epoch 3, Average Loss: 4.3142
Epoch 4, Average Loss: 4.2561
Epoch 5, Average Loss: 4.2049
Epoch 6, Average Loss: 4.1572
Epoch 7, Average Loss: 4.1108
Epoch 8, Average Loss: 4.0660
Epoch 9, Average Loss: 4.0231
Epoch 10, Average Loss: 3.9786
Merged model device: cuda:0
Accuracy: 2.0614
Accuracy of Product model on test domain: 2.0614

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 4.4830
Epoch 2, Average Loss: 4.4302
Epoch 3, Average Loss: 4.3914
Epoch 4, Average Loss: 4.3499
Epoch 5, Average Loss: 4.3043
Epoch 6, Average Loss: 4.2621
Epoch 7, Average Loss: 4.2247
Epoch 8, Average Loss: 4.1895
Epoch 9, Average Loss: 4.1447
Epoch 10, Average Loss: 4.1146
Merged model device: cuda:0
Accuracy: 2.7027
Accuracy of Real World model on test domain: 2.7027

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.2042
Coefficient Epoch 2, Average Loss: 4.1999
Coefficient Epoch 3, Average Loss: 4.2099
Coefficient Epoch 4, Average Loss: 4.1790
Coefficient Epoch 5, Average Loss: 4.2168
Coefficient Epoch 6, Average Loss: 4.1998
Coefficient Epoch 7, Average Loss: 4.1916
Coefficient Epoch 8, Average Loss: 4.1683
Coefficient Epoch 9, Average Loss: 4.2236
Coefficient Epoch 10, Average Loss: 4.1923
Final device check:
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.2623130977153778, 0.4672280550003052, 0.270458847284317]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 2.6569
Final model accuracy on test domain: 2.6569

Run 7/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Product
Training domains: ['Art', 'Clipart', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Product
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3228
Epoch 2, Average Loss: 4.0156
Epoch 3, Average Loss: 3.7076
Epoch 4, Average Loss: 3.2799
Epoch 5, Average Loss: 2.6182
Epoch 6, Average Loss: 1.8949
Epoch 7, Average Loss: 1.3437
Epoch 8, Average Loss: 0.9848
Epoch 9, Average Loss: 0.7376
Epoch 10, Average Loss: 0.5616
Accuracy: 73.0631
Training domains: ['Art', 'Clipart', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 4.5706
Epoch 2, Average Loss: 4.5454
Epoch 3, Average Loss: 4.5190
Epoch 4, Average Loss: 4.4927
Epoch 5, Average Loss: 4.4660
Epoch 6, Average Loss: 4.4398
Epoch 7, Average Loss: 4.4135
Epoch 8, Average Loss: 4.3873
Epoch 9, Average Loss: 4.3606
Epoch 10, Average Loss: 4.3341
Merged model device: cuda:0
Accuracy: 0.9459
Accuracy of Art model on test domain: 0.9459

Training model for domain: Clipart
Training model for domain: Clipart
