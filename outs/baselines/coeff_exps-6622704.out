Running experiments for dataset: PACS
Test Domain: cartoon, Run 1/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.4703
Epoch 2, Average Loss: 0.8796
Epoch 3, Average Loss: 0.0996
Epoch 4, Average Loss: 0.0132
Epoch 5, Average Loss: 0.0042
Epoch 6, Average Loss: 0.0020
Epoch 7, Average Loss: 0.0012
Epoch 8, Average Loss: 0.0009
Epoch 9, Average Loss: 0.0007
Epoch 10, Average Loss: 0.0005
Accuracy of naive model on cartoon: 27.7778
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.2278
Epoch 2, Average Loss: 2.0708
Epoch 3, Average Loss: 1.9278
Epoch 4, Average Loss: 1.9208
Epoch 5, Average Loss: 1.7844
Epoch 6, Average Loss: 1.5955
Epoch 7, Average Loss: 1.4471
Epoch 8, Average Loss: 1.2637
Epoch 9, Average Loss: 1.2816
Epoch 10, Average Loss: 1.2840
Merged model device: cuda:0
Accuracy of photo model on test domain: 22.2222

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.7639
Epoch 2, Average Loss: 2.0034
Epoch 3, Average Loss: 2.2055
Epoch 4, Average Loss: 2.0732
Epoch 5, Average Loss: 1.8874
Epoch 6, Average Loss: 1.9566
Epoch 7, Average Loss: 1.6936
Epoch 8, Average Loss: 1.8936
Epoch 9, Average Loss: 1.7556
Epoch 10, Average Loss: 1.6823
Merged model device: cuda:0
Accuracy of sketch model on test domain: 27.7778

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.4843
Epoch 2, Average Loss: 2.5071
Epoch 3, Average Loss: 2.1509
Epoch 4, Average Loss: 2.0543
Epoch 5, Average Loss: 1.8188
Epoch 6, Average Loss: 1.7946
Epoch 7, Average Loss: 1.4082
Epoch 8, Average Loss: 1.7737
Epoch 9, Average Loss: 1.4014
Epoch 10, Average Loss: 1.6500
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 27.7778

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.8396
Coefficient Epoch 2, Average Loss: 3.5453
Coefficient Epoch 3, Average Loss: 3.2628
Coefficient Epoch 4, Average Loss: 2.9955
Coefficient Epoch 5, Average Loss: 2.7476
Coefficient Epoch 6, Average Loss: 2.5242
Coefficient Epoch 7, Average Loss: 2.3313
Coefficient Epoch 8, Average Loss: 2.1744
Coefficient Epoch 9, Average Loss: 2.0579
Coefficient Epoch 10, Average Loss: 1.9831
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3341256380081177, 0.32908886671066284, 0.33678552508354187]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 22.2222
Test Domain: cartoon, Run 2/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.3226
Epoch 2, Average Loss: 1.3736
Epoch 3, Average Loss: 0.4230
Epoch 4, Average Loss: 0.0881
Epoch 5, Average Loss: 0.0156
Epoch 6, Average Loss: 0.0048
Epoch 7, Average Loss: 0.0024
Epoch 8, Average Loss: 0.0016
Epoch 9, Average Loss: 0.0013
Epoch 10, Average Loss: 0.0010
Accuracy of naive model on cartoon: 50.0000
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.3644
Epoch 2, Average Loss: 2.2860
Epoch 3, Average Loss: 2.0084
Epoch 4, Average Loss: 1.5373
Epoch 5, Average Loss: 1.4524
Epoch 6, Average Loss: 1.6522
Epoch 7, Average Loss: 1.4515
Epoch 8, Average Loss: 1.2266
Epoch 9, Average Loss: 1.2313
Epoch 10, Average Loss: 0.9905
Merged model device: cuda:0
Accuracy of photo model on test domain: 27.7778

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.3152
Epoch 2, Average Loss: 2.1525
Epoch 3, Average Loss: 1.9114
Epoch 4, Average Loss: 2.0758
Epoch 5, Average Loss: 1.8583
Epoch 6, Average Loss: 1.7283
Epoch 7, Average Loss: 1.6331
Epoch 8, Average Loss: 1.6016
Epoch 9, Average Loss: 1.5826
Epoch 10, Average Loss: 1.3782
Merged model device: cuda:0
Accuracy of sketch model on test domain: 16.6667

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.2585
Epoch 2, Average Loss: 2.1452
Epoch 3, Average Loss: 1.7755
Epoch 4, Average Loss: 1.6557
Epoch 5, Average Loss: 2.0174
Epoch 6, Average Loss: 1.7251
Epoch 7, Average Loss: 1.1938
Epoch 8, Average Loss: 1.2102
Epoch 9, Average Loss: 1.2979
Epoch 10, Average Loss: 0.9664
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 11.1111

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.2062
Coefficient Epoch 2, Average Loss: 2.9824
Coefficient Epoch 3, Average Loss: 2.7686
Coefficient Epoch 4, Average Loss: 2.5679
Coefficient Epoch 5, Average Loss: 2.3842
Coefficient Epoch 6, Average Loss: 2.2226
Coefficient Epoch 7, Average Loss: 2.0888
Coefficient Epoch 8, Average Loss: 1.9885
Coefficient Epoch 9, Average Loss: 1.9256
Coefficient Epoch 10, Average Loss: 1.9007
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33151090145111084, 0.32779034972190857, 0.340698778629303]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 22.2222
Test Domain: cartoon, Run 3/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: photo
Training domains: ['cartoon', 'sketch', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1968
Epoch 2, Average Loss: 0.4736
Epoch 3, Average Loss: 0.0198
Epoch 4, Average Loss: 0.0013
Epoch 5, Average Loss: 0.0003
Epoch 6, Average Loss: 0.0003
Epoch 7, Average Loss: 0.0002
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on photo: 55.5556
Training domains: ['cartoon', 'sketch', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 1.8099
Epoch 2, Average Loss: 2.2527
Epoch 3, Average Loss: 1.8616
Epoch 4, Average Loss: 1.6603
Epoch 5, Average Loss: 1.6534
Epoch 6, Average Loss: 1.3743
Epoch 7, Average Loss: 1.6399
Epoch 8, Average Loss: 0.9951
Epoch 9, Average Loss: 1.0098
Epoch 10, Average Loss: 1.1691
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 5.5556

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.6154
Epoch 2, Average Loss: 2.1182
Epoch 3, Average Loss: 1.9943
Epoch 4, Average Loss: 1.6734
Epoch 5, Average Loss: 1.5485
Epoch 6, Average Loss: 1.5199
Epoch 7, Average Loss: 1.6121
Epoch 8, Average Loss: 1.3780
Epoch 9, Average Loss: 1.4417
Epoch 10, Average Loss: 1.4990
Merged model device: cuda:0
Accuracy of sketch model on test domain: 5.5556

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.2128
Epoch 2, Average Loss: 2.1538
Epoch 3, Average Loss: 1.5321
Epoch 4, Average Loss: 1.3006
Epoch 5, Average Loss: 1.2618
Epoch 6, Average Loss: 1.0687
Epoch 7, Average Loss: 1.1860
Epoch 8, Average Loss: 1.2656
Epoch 9, Average Loss: 0.8094
Epoch 10, Average Loss: 1.1051
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 11.1111

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.2100
Coefficient Epoch 2, Average Loss: 2.9800
Coefficient Epoch 3, Average Loss: 2.7615
Coefficient Epoch 4, Average Loss: 2.5575
Coefficient Epoch 5, Average Loss: 2.3721
Coefficient Epoch 6, Average Loss: 2.2096
Coefficient Epoch 7, Average Loss: 2.0752
Coefficient Epoch 8, Average Loss: 1.9742
Coefficient Epoch 9, Average Loss: 1.9115
Coefficient Epoch 10, Average Loss: 1.8888
Final device check:
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3326040506362915, 0.328702837228775, 0.33869311213493347]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 5.5556
Test Domain: cartoon, Run 4/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.3442
Epoch 2, Average Loss: 0.9059
Epoch 3, Average Loss: 0.3447
Epoch 4, Average Loss: 0.0560
Epoch 5, Average Loss: 0.0117
Epoch 6, Average Loss: 0.0039
Epoch 7, Average Loss: 0.0036
Epoch 8, Average Loss: 0.0009
Epoch 9, Average Loss: 0.0005
Epoch 10, Average Loss: 0.0003
Accuracy of naive model on cartoon: 22.2222
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.1796
Epoch 2, Average Loss: 1.9864
Epoch 3, Average Loss: 1.7374
Epoch 4, Average Loss: 1.7776
Epoch 5, Average Loss: 1.7381
Epoch 6, Average Loss: 1.3343
Epoch 7, Average Loss: 1.2175
Epoch 8, Average Loss: 1.3110
Epoch 9, Average Loss: 1.0028
Epoch 10, Average Loss: 0.9222
Merged model device: cuda:0
Accuracy of photo model on test domain: 38.8889

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.2018
Epoch 2, Average Loss: 2.1296
Epoch 3, Average Loss: 2.0709
Epoch 4, Average Loss: 1.7596
Epoch 5, Average Loss: 1.6063
Epoch 6, Average Loss: 1.9132
Epoch 7, Average Loss: 1.6423
Epoch 8, Average Loss: 1.4777
Epoch 9, Average Loss: 1.5615
Epoch 10, Average Loss: 1.3941
Merged model device: cuda:0
Accuracy of sketch model on test domain: 33.3333

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 1.9680
Epoch 2, Average Loss: 2.0867
Epoch 3, Average Loss: 2.4932
Epoch 4, Average Loss: 1.8765
Epoch 5, Average Loss: 1.5706
Epoch 6, Average Loss: 1.5521
Epoch 7, Average Loss: 1.2652
Epoch 8, Average Loss: 1.3773
Epoch 9, Average Loss: 1.2700
Epoch 10, Average Loss: 1.1738
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 33.3333

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.8555
Coefficient Epoch 2, Average Loss: 3.5580
Coefficient Epoch 3, Average Loss: 3.2717
Coefficient Epoch 4, Average Loss: 2.9998
Coefficient Epoch 5, Average Loss: 2.7466
Coefficient Epoch 6, Average Loss: 2.5172
Coefficient Epoch 7, Average Loss: 2.3177
Coefficient Epoch 8, Average Loss: 2.1549
Coefficient Epoch 9, Average Loss: 2.0352
Coefficient Epoch 10, Average Loss: 1.9632
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3315439820289612, 0.33456525206565857, 0.333890825510025]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 38.8889
Test Domain: cartoon, Run 5/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: sketch
Training domains: ['cartoon', 'photo', 'art_painting']
Test domain: sketch
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.3566
Epoch 2, Average Loss: 2.0367
Epoch 3, Average Loss: 2.2038
Epoch 4, Average Loss: 1.7493
Epoch 5, Average Loss: 0.9622
Epoch 6, Average Loss: 0.7092
Epoch 7, Average Loss: 0.7384
Epoch 8, Average Loss: 0.2367
Epoch 9, Average Loss: 0.0686
Epoch 10, Average Loss: 0.0433
Accuracy of naive model on sketch: 50.0000
Training domains: ['cartoon', 'photo', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.6085
Epoch 2, Average Loss: 2.3146
Epoch 3, Average Loss: 1.9571
Epoch 4, Average Loss: 1.9933
Epoch 5, Average Loss: 1.9752
Epoch 6, Average Loss: 2.1128
Epoch 7, Average Loss: 1.7175
Epoch 8, Average Loss: 1.6053
Epoch 9, Average Loss: 1.7808
Epoch 10, Average Loss: 1.1662
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 5.5556

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 1.8622
Epoch 2, Average Loss: 1.7052
Epoch 3, Average Loss: 1.8579
Epoch 4, Average Loss: 1.4192
Epoch 5, Average Loss: 1.5093
Epoch 6, Average Loss: 1.4841
Epoch 7, Average Loss: 1.3196
Epoch 8, Average Loss: 1.0861
Epoch 9, Average Loss: 1.0505
Epoch 10, Average Loss: 1.0771
Merged model device: cuda:0
Accuracy of photo model on test domain: 5.5556

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.0246
Epoch 2, Average Loss: 1.8092
Epoch 3, Average Loss: 1.8418
Epoch 4, Average Loss: 1.8418
Epoch 5, Average Loss: 1.4457
Epoch 6, Average Loss: 1.6203
Epoch 7, Average Loss: 1.3731
Epoch 8, Average Loss: 1.0383
Epoch 9, Average Loss: 0.9279
Epoch 10, Average Loss: 0.8215
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 0.0000

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.1126
Coefficient Epoch 2, Average Loss: 3.7927
Coefficient Epoch 3, Average Loss: 3.4828
Coefficient Epoch 4, Average Loss: 3.1859
Coefficient Epoch 5, Average Loss: 2.9058
Coefficient Epoch 6, Average Loss: 2.6477
Coefficient Epoch 7, Average Loss: 2.4182
Coefficient Epoch 8, Average Loss: 2.2256
Coefficient Epoch 9, Average Loss: 2.0790
Coefficient Epoch 10, Average Loss: 1.9857
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33218157291412354, 0.3345251977443695, 0.33329322934150696]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 0.0000
Test Domain: photo, Run 1/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: sketch
Training domains: ['cartoon', 'photo', 'art_painting']
Test domain: sketch
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9374
Epoch 2, Average Loss: 2.3424
Epoch 3, Average Loss: 3.2055
Epoch 4, Average Loss: 2.2403
Epoch 5, Average Loss: 1.2406
Epoch 6, Average Loss: 0.8435
Epoch 7, Average Loss: 0.7134
Epoch 8, Average Loss: 0.4680
Epoch 9, Average Loss: 0.3477
Epoch 10, Average Loss: 0.2563
Accuracy of naive model on sketch: 33.3333
Training domains: ['cartoon', 'photo', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.4628
Epoch 2, Average Loss: 1.8681
Epoch 3, Average Loss: 1.8682
Epoch 4, Average Loss: 1.8065
Epoch 5, Average Loss: 1.8194
Epoch 6, Average Loss: 1.8176
Epoch 7, Average Loss: 1.7051
Epoch 8, Average Loss: 1.3633
Epoch 9, Average Loss: 1.2177
Epoch 10, Average Loss: 1.1904
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 5.5556

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.2278
Epoch 2, Average Loss: 1.8427
Epoch 3, Average Loss: 2.1452
Epoch 4, Average Loss: 1.4654
Epoch 5, Average Loss: 1.3474
Epoch 6, Average Loss: 1.4810
Epoch 7, Average Loss: 1.1485
Epoch 8, Average Loss: 1.1814
Epoch 9, Average Loss: 0.9656
Epoch 10, Average Loss: 1.2138
Merged model device: cuda:0
Accuracy of photo model on test domain: 22.2222

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.6628
Epoch 2, Average Loss: 1.8309
Epoch 3, Average Loss: 1.6449
Epoch 4, Average Loss: 1.5153
Epoch 5, Average Loss: 1.3050
Epoch 6, Average Loss: 1.3342
Epoch 7, Average Loss: 1.1993
Epoch 8, Average Loss: 1.0924
Epoch 9, Average Loss: 1.1836
Epoch 10, Average Loss: 1.0650
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 16.6667

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.6949
Coefficient Epoch 2, Average Loss: 2.5426
Coefficient Epoch 3, Average Loss: 2.3986
Coefficient Epoch 4, Average Loss: 2.2651
Coefficient Epoch 5, Average Loss: 2.1444
Coefficient Epoch 6, Average Loss: 2.0395
Coefficient Epoch 7, Average Loss: 1.9539
Coefficient Epoch 8, Average Loss: 1.8918
Coefficient Epoch 9, Average Loss: 1.8573
Coefficient Epoch 10, Average Loss: 1.8534
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.32851988077163696, 0.3388674557209015, 0.3326127231121063]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 16.6667
Test Domain: photo, Run 2/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: photo
Training domains: ['cartoon', 'sketch', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1435
Epoch 2, Average Loss: 0.3887
Epoch 3, Average Loss: 0.0102
Epoch 4, Average Loss: 0.0019
Epoch 5, Average Loss: 0.0011
Epoch 6, Average Loss: 0.0013
Epoch 7, Average Loss: 0.0007
Epoch 8, Average Loss: 0.0004
Epoch 9, Average Loss: 0.0003
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on photo: 72.2222
Training domains: ['cartoon', 'sketch', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.4235
Epoch 2, Average Loss: 2.1635
Epoch 3, Average Loss: 1.9873
Epoch 4, Average Loss: 2.1981
Epoch 5, Average Loss: 1.9361
Epoch 6, Average Loss: 1.5279
Epoch 7, Average Loss: 1.5218
Epoch 8, Average Loss: 1.9369
Epoch 9, Average Loss: 1.4371
Epoch 10, Average Loss: 1.1940
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 16.6667

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.0338
Epoch 2, Average Loss: 2.0891
Epoch 3, Average Loss: 1.7640
Epoch 4, Average Loss: 1.7097
Epoch 5, Average Loss: 1.7716
Epoch 6, Average Loss: 1.4526
Epoch 7, Average Loss: 1.4120
Epoch 8, Average Loss: 1.5282
Epoch 9, Average Loss: 1.3021
Epoch 10, Average Loss: 1.4479
Merged model device: cuda:0
Accuracy of sketch model on test domain: 16.6667

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.5421
Epoch 2, Average Loss: 1.8704
Epoch 3, Average Loss: 1.9040
Epoch 4, Average Loss: 2.1256
Epoch 5, Average Loss: 1.8132
Epoch 6, Average Loss: 1.5456
Epoch 7, Average Loss: 1.8955
Epoch 8, Average Loss: 1.2855
Epoch 9, Average Loss: 1.2190
Epoch 10, Average Loss: 1.0920
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 16.6667

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.1599
Coefficient Epoch 2, Average Loss: 2.9405
Coefficient Epoch 3, Average Loss: 2.7308
Coefficient Epoch 4, Average Loss: 2.5339
Coefficient Epoch 5, Average Loss: 2.3541
Coefficient Epoch 6, Average Loss: 2.1970
Coefficient Epoch 7, Average Loss: 2.0691
Coefficient Epoch 8, Average Loss: 1.9762
Coefficient Epoch 9, Average Loss: 1.9213
Coefficient Epoch 10, Average Loss: 1.9022
Final device check:
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.334621787071228, 0.3270529806613922, 0.33832523226737976]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 16.6667
Test Domain: photo, Run 3/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: sketch
Training domains: ['cartoon', 'photo', 'art_painting']
Test domain: sketch
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.3968
Epoch 2, Average Loss: 2.0626
Epoch 3, Average Loss: 1.7706
Epoch 4, Average Loss: 0.9969
Epoch 5, Average Loss: 0.7496
Epoch 6, Average Loss: 0.3751
Epoch 7, Average Loss: 0.2055
Epoch 8, Average Loss: 0.1451
Epoch 9, Average Loss: 0.0339
Epoch 10, Average Loss: 0.0201
Accuracy of naive model on sketch: 38.8889
Training domains: ['cartoon', 'photo', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.7362
Epoch 2, Average Loss: 2.1287
Epoch 3, Average Loss: 2.0532
Epoch 4, Average Loss: 1.9412
Epoch 5, Average Loss: 2.0141
Epoch 6, Average Loss: 1.5788
Epoch 7, Average Loss: 1.4701
Epoch 8, Average Loss: 1.3064
Epoch 9, Average Loss: 1.4985
Epoch 10, Average Loss: 1.3416
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 27.7778

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.1509
Epoch 2, Average Loss: 2.2383
Epoch 3, Average Loss: 1.9618
Epoch 4, Average Loss: 1.8210
Epoch 5, Average Loss: 1.5635
Epoch 6, Average Loss: 1.5546
Epoch 7, Average Loss: 1.5254
Epoch 8, Average Loss: 1.4394
Epoch 9, Average Loss: 1.4552
Epoch 10, Average Loss: 1.3072
Merged model device: cuda:0
Accuracy of photo model on test domain: 27.7778

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.2660
Epoch 2, Average Loss: 2.1907
Epoch 3, Average Loss: 1.6560
Epoch 4, Average Loss: 1.7635
Epoch 5, Average Loss: 1.4271
Epoch 6, Average Loss: 1.4702
Epoch 7, Average Loss: 1.2739
Epoch 8, Average Loss: 1.1185
Epoch 9, Average Loss: 1.3624
Epoch 10, Average Loss: 1.2655
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 22.2222

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.9103
Coefficient Epoch 2, Average Loss: 3.6109
Coefficient Epoch 3, Average Loss: 3.3232
Coefficient Epoch 4, Average Loss: 3.0511
Coefficient Epoch 5, Average Loss: 2.7988
Coefficient Epoch 6, Average Loss: 2.5718
Coefficient Epoch 7, Average Loss: 2.3756
Coefficient Epoch 8, Average Loss: 2.2150
Coefficient Epoch 9, Average Loss: 2.0927
Coefficient Epoch 10, Average Loss: 2.0086
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3350517749786377, 0.33204737305641174, 0.3329008221626282]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 27.7778
Test Domain: photo, Run 4/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: sketch
Training domains: ['cartoon', 'photo', 'art_painting']
Test domain: sketch
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9462
Epoch 2, Average Loss: 1.4315
Epoch 3, Average Loss: 1.1774
Epoch 4, Average Loss: 0.5490
Epoch 5, Average Loss: 0.2386
Epoch 6, Average Loss: 0.0772
Epoch 7, Average Loss: 0.0108
Epoch 8, Average Loss: 0.0017
Epoch 9, Average Loss: 0.0009
Epoch 10, Average Loss: 0.0010
Accuracy of naive model on sketch: 33.3333
Training domains: ['cartoon', 'photo', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.2847
Epoch 2, Average Loss: 1.9857
Epoch 3, Average Loss: 1.9070
Epoch 4, Average Loss: 1.8671
Epoch 5, Average Loss: 1.7816
Epoch 6, Average Loss: 2.0341
Epoch 7, Average Loss: 1.3385
Epoch 8, Average Loss: 1.3134
Epoch 9, Average Loss: 1.1211
Epoch 10, Average Loss: 1.2147
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 22.2222

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 1.7134
Epoch 2, Average Loss: 1.9311
Epoch 3, Average Loss: 1.4549
Epoch 4, Average Loss: 1.7736
Epoch 5, Average Loss: 1.5999
Epoch 6, Average Loss: 1.4763
Epoch 7, Average Loss: 1.5184
Epoch 8, Average Loss: 1.3143
Epoch 9, Average Loss: 1.0818
Epoch 10, Average Loss: 1.2364
Merged model device: cuda:0
Accuracy of photo model on test domain: 22.2222

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 1.9132
Epoch 2, Average Loss: 2.1527
Epoch 3, Average Loss: 1.8132
Epoch 4, Average Loss: 1.4864
Epoch 5, Average Loss: 1.5179
Epoch 6, Average Loss: 1.6039
Epoch 7, Average Loss: 1.3623
Epoch 8, Average Loss: 1.1141
Epoch 9, Average Loss: 1.1642
Epoch 10, Average Loss: 1.2220
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 22.2222

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.4990
Coefficient Epoch 2, Average Loss: 2.3694
Coefficient Epoch 3, Average Loss: 2.2495
Coefficient Epoch 4, Average Loss: 2.1415
Coefficient Epoch 5, Average Loss: 2.0478
Coefficient Epoch 6, Average Loss: 1.9711
Coefficient Epoch 7, Average Loss: 1.9142
Coefficient Epoch 8, Average Loss: 1.8790
Coefficient Epoch 9, Average Loss: 1.8657
Coefficient Epoch 10, Average Loss: 1.8717
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33662906289100647, 0.33021631836891174, 0.3331546187400818]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 27.7778
Test Domain: photo, Run 5/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: sketch
Training domains: ['cartoon', 'photo', 'art_painting']
Test domain: sketch
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9353
Epoch 2, Average Loss: 2.1254
Epoch 3, Average Loss: 1.9278
Epoch 4, Average Loss: 1.1656
Epoch 5, Average Loss: 0.6731
Epoch 6, Average Loss: 0.2681
Epoch 7, Average Loss: 0.1936
Epoch 8, Average Loss: 0.0645
Epoch 9, Average Loss: 0.0130
Epoch 10, Average Loss: 0.0052
Accuracy of naive model on sketch: 27.7778
Training domains: ['cartoon', 'photo', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 1.7990
Epoch 2, Average Loss: 1.7879
Epoch 3, Average Loss: 1.8256
Epoch 4, Average Loss: 1.6712
Epoch 5, Average Loss: 1.2661
Epoch 6, Average Loss: 1.5906
Epoch 7, Average Loss: 1.6458
Epoch 8, Average Loss: 1.2167
Epoch 9, Average Loss: 0.9274
Epoch 10, Average Loss: 1.0770
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 33.3333

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.6278
Epoch 2, Average Loss: 1.9422
Epoch 3, Average Loss: 2.3637
Epoch 4, Average Loss: 2.0014
Epoch 5, Average Loss: 1.6483
Epoch 6, Average Loss: 1.7395
Epoch 7, Average Loss: 1.6093
Epoch 8, Average Loss: 1.5163
Epoch 9, Average Loss: 1.5503
Epoch 10, Average Loss: 1.1587
Merged model device: cuda:0
Accuracy of photo model on test domain: 33.3333

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 1.8890
Epoch 2, Average Loss: 1.5456
Epoch 3, Average Loss: 1.8282
Epoch 4, Average Loss: 1.6485
Epoch 5, Average Loss: 1.2616
Epoch 6, Average Loss: 1.1865
Epoch 7, Average Loss: 1.0207
Epoch 8, Average Loss: 1.1103
Epoch 9, Average Loss: 1.1152
Epoch 10, Average Loss: 1.1403
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 38.8889

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.2468
Coefficient Epoch 2, Average Loss: 2.1558
Coefficient Epoch 3, Average Loss: 2.0719
Coefficient Epoch 4, Average Loss: 1.9968
Coefficient Epoch 5, Average Loss: 1.9325
Coefficient Epoch 6, Average Loss: 1.8814
Coefficient Epoch 7, Average Loss: 1.8461
Coefficient Epoch 8, Average Loss: 1.8284
Coefficient Epoch 9, Average Loss: 1.8279
Coefficient Epoch 10, Average Loss: 1.8407
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.341917484998703, 0.3227890431880951, 0.3352934420108795]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 44.4444
Test Domain: sketch, Run 1/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: art_painting
Training domains: ['cartoon', 'photo', 'sketch']
Test domain: art_painting
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.6701
Epoch 2, Average Loss: 1.0372
Epoch 3, Average Loss: 0.1358
Epoch 4, Average Loss: 0.0149
Epoch 5, Average Loss: 0.0044
Epoch 6, Average Loss: 0.0018
Epoch 7, Average Loss: 0.0011
Epoch 8, Average Loss: 0.0008
Epoch 9, Average Loss: 0.0007
Epoch 10, Average Loss: 0.0006
Accuracy of naive model on art_painting: 50.0000
Training domains: ['cartoon', 'photo', 'sketch']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.6160
Epoch 2, Average Loss: 2.2619
Epoch 3, Average Loss: 1.7876
Epoch 4, Average Loss: 1.9582
Epoch 5, Average Loss: 1.5305
Epoch 6, Average Loss: 1.6633
Epoch 7, Average Loss: 1.6402
Epoch 8, Average Loss: 1.9492
Epoch 9, Average Loss: 1.6050
Epoch 10, Average Loss: 1.3144
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 16.6667

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.3537
Epoch 2, Average Loss: 2.0961
Epoch 3, Average Loss: 2.0088
Epoch 4, Average Loss: 1.7255
Epoch 5, Average Loss: 1.8025
Epoch 6, Average Loss: 1.3633
Epoch 7, Average Loss: 1.5720
Epoch 8, Average Loss: 1.3999
Epoch 9, Average Loss: 1.1762
Epoch 10, Average Loss: 1.1649
Merged model device: cuda:0
Accuracy of photo model on test domain: 27.7778

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.2184
Epoch 2, Average Loss: 2.1623
Epoch 3, Average Loss: 1.8966
Epoch 4, Average Loss: 1.6736
Epoch 5, Average Loss: 1.8409
Epoch 6, Average Loss: 1.8135
Epoch 7, Average Loss: 1.5538
Epoch 8, Average Loss: 1.5058
Epoch 9, Average Loss: 1.4690
Epoch 10, Average Loss: 1.4595
Merged model device: cuda:0
Accuracy of sketch model on test domain: 11.1111

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.9100
Coefficient Epoch 2, Average Loss: 4.4991
Coefficient Epoch 3, Average Loss: 4.0963
Coefficient Epoch 4, Average Loss: 3.7045
Coefficient Epoch 5, Average Loss: 3.3281
Coefficient Epoch 6, Average Loss: 2.9737
Coefficient Epoch 7, Average Loss: 2.6513
Coefficient Epoch 8, Average Loss: 2.3750
Coefficient Epoch 9, Average Loss: 2.1612
Coefficient Epoch 10, Average Loss: 2.0216
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3334583640098572, 0.3346562683582306, 0.3318853974342346]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 22.2222
Test Domain: sketch, Run 2/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: art_painting
Training domains: ['cartoon', 'photo', 'sketch']
Test domain: art_painting
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.0649
Epoch 2, Average Loss: 0.5395
Epoch 3, Average Loss: 0.4773
Epoch 4, Average Loss: 0.0283
Epoch 5, Average Loss: 0.0065
Epoch 6, Average Loss: 0.0024
Epoch 7, Average Loss: 0.0013
Epoch 8, Average Loss: 0.0009
Epoch 9, Average Loss: 0.0008
Epoch 10, Average Loss: 0.0007
Accuracy of naive model on art_painting: 22.2222
Training domains: ['cartoon', 'photo', 'sketch']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 1.9545
Epoch 2, Average Loss: 2.0570
Epoch 3, Average Loss: 1.9722
Epoch 4, Average Loss: 1.9306
Epoch 5, Average Loss: 1.5831
Epoch 6, Average Loss: 1.8139
Epoch 7, Average Loss: 1.7384
Epoch 8, Average Loss: 1.3867
Epoch 9, Average Loss: 1.4478
Epoch 10, Average Loss: 1.2166
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 5.5556

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.2848
Epoch 2, Average Loss: 2.1552
Epoch 3, Average Loss: 2.2264
Epoch 4, Average Loss: 1.9425
Epoch 5, Average Loss: 1.7553
Epoch 6, Average Loss: 1.5755
Epoch 7, Average Loss: 1.5369
Epoch 8, Average Loss: 1.2577
Epoch 9, Average Loss: 1.2402
Epoch 10, Average Loss: 1.2326
Merged model device: cuda:0
Accuracy of photo model on test domain: 16.6667

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.3419
Epoch 2, Average Loss: 1.7320
Epoch 3, Average Loss: 1.7303
Epoch 4, Average Loss: 2.0790
Epoch 5, Average Loss: 1.7487
Epoch 6, Average Loss: 1.6599
Epoch 7, Average Loss: 1.5542
Epoch 8, Average Loss: 1.3659
Epoch 9, Average Loss: 1.2831
Epoch 10, Average Loss: 1.4469
Merged model device: cuda:0
Accuracy of sketch model on test domain: 0.0000

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.8797
Coefficient Epoch 2, Average Loss: 2.6875
Coefficient Epoch 3, Average Loss: 2.5051
Coefficient Epoch 4, Average Loss: 2.3353
Coefficient Epoch 5, Average Loss: 2.1819
Coefficient Epoch 6, Average Loss: 2.0499
Coefficient Epoch 7, Average Loss: 1.9454
Coefficient Epoch 8, Average Loss: 1.8750
Coefficient Epoch 9, Average Loss: 1.8429
Coefficient Epoch 10, Average Loss: 1.8470
Final device check:
Expert model cartoon device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3361084461212158, 0.33580824732780457, 0.328083336353302]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 5.5556
Test Domain: sketch, Run 3/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.7016
Epoch 2, Average Loss: 0.8973
Epoch 3, Average Loss: 0.2828
Epoch 4, Average Loss: 0.0352
Epoch 5, Average Loss: 0.0109
Epoch 6, Average Loss: 0.0063
Epoch 7, Average Loss: 0.0035
Epoch 8, Average Loss: 0.0014
Epoch 9, Average Loss: 0.0009
Epoch 10, Average Loss: 0.0006
Accuracy of naive model on cartoon: 22.2222
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.6373
Epoch 2, Average Loss: 2.2291
Epoch 3, Average Loss: 1.9699
Epoch 4, Average Loss: 2.0756
Epoch 5, Average Loss: 1.7364
Epoch 6, Average Loss: 1.8709
Epoch 7, Average Loss: 1.8284
Epoch 8, Average Loss: 1.8462
Epoch 9, Average Loss: 1.8347
Epoch 10, Average Loss: 1.2591
Merged model device: cuda:0
Accuracy of photo model on test domain: 11.1111

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.2155
Epoch 2, Average Loss: 2.2215
Epoch 3, Average Loss: 1.9319
Epoch 4, Average Loss: 1.9463
Epoch 5, Average Loss: 1.6085
Epoch 6, Average Loss: 1.7171
Epoch 7, Average Loss: 1.3844
Epoch 8, Average Loss: 1.4287
Epoch 9, Average Loss: 1.1948
Epoch 10, Average Loss: 1.5149
Merged model device: cuda:0
Accuracy of sketch model on test domain: 11.1111

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.3060
Epoch 2, Average Loss: 2.2253
Epoch 3, Average Loss: 2.0043
Epoch 4, Average Loss: 2.0744
Epoch 5, Average Loss: 2.2197
Epoch 6, Average Loss: 1.8094
Epoch 7, Average Loss: 1.5030
Epoch 8, Average Loss: 1.2909
Epoch 9, Average Loss: 1.6042
Epoch 10, Average Loss: 1.7777
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 0.0000

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.5254
Coefficient Epoch 2, Average Loss: 4.1516
Coefficient Epoch 3, Average Loss: 3.7889
Coefficient Epoch 4, Average Loss: 3.4408
Coefficient Epoch 5, Average Loss: 3.1123
Coefficient Epoch 6, Average Loss: 2.8095
Coefficient Epoch 7, Average Loss: 2.5403
Coefficient Epoch 8, Average Loss: 2.3137
Coefficient Epoch 9, Average Loss: 2.1386
Coefficient Epoch 10, Average Loss: 2.0206
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33341413736343384, 0.3322393596172333, 0.33434656262397766]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 0.0000
Test Domain: sketch, Run 4/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: photo
Training domains: ['cartoon', 'sketch', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.2717
Epoch 2, Average Loss: 0.4166
Epoch 3, Average Loss: 0.0130
Epoch 4, Average Loss: 0.0009
Epoch 5, Average Loss: 0.0009
Epoch 6, Average Loss: 0.0009
Epoch 7, Average Loss: 0.0006
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on photo: 77.7778
Training domains: ['cartoon', 'sketch', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.2224
Epoch 2, Average Loss: 2.1677
Epoch 3, Average Loss: 2.2462
Epoch 4, Average Loss: 1.7300
Epoch 5, Average Loss: 1.4754
Epoch 6, Average Loss: 1.6893
Epoch 7, Average Loss: 1.4190
Epoch 8, Average Loss: 1.3272
Epoch 9, Average Loss: 1.2166
Epoch 10, Average Loss: 1.2543
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 22.2222

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.3727
Epoch 2, Average Loss: 2.0037
Epoch 3, Average Loss: 1.8021
Epoch 4, Average Loss: 1.7626
Epoch 5, Average Loss: 1.6875
Epoch 6, Average Loss: 1.7735
Epoch 7, Average Loss: 1.6263
Epoch 8, Average Loss: 1.7674
Epoch 9, Average Loss: 1.4198
Epoch 10, Average Loss: 1.3419
Merged model device: cuda:0
Accuracy of sketch model on test domain: 5.5556

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.4763
Epoch 2, Average Loss: 1.9506
Epoch 3, Average Loss: 2.1268
Epoch 4, Average Loss: 1.8394
Epoch 5, Average Loss: 1.7242
Epoch 6, Average Loss: 1.6110
Epoch 7, Average Loss: 1.5177
Epoch 8, Average Loss: 1.1313
Epoch 9, Average Loss: 1.2348
Epoch 10, Average Loss: 0.9242
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 22.2222

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.0748
Coefficient Epoch 2, Average Loss: 2.8959
Coefficient Epoch 3, Average Loss: 2.7263
Coefficient Epoch 4, Average Loss: 2.5678
Coefficient Epoch 5, Average Loss: 2.4224
Coefficient Epoch 6, Average Loss: 2.2924
Coefficient Epoch 7, Average Loss: 2.1801
Coefficient Epoch 8, Average Loss: 2.0879
Coefficient Epoch 9, Average Loss: 2.0175
Coefficient Epoch 10, Average Loss: 1.9699
Final device check:
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.32996422052383423, 0.3277735710144043, 0.34226223826408386]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 11.1111
Test Domain: sketch, Run 5/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.4343
Epoch 2, Average Loss: 0.9503
Epoch 3, Average Loss: 0.2665
Epoch 4, Average Loss: 0.0331
Epoch 5, Average Loss: 0.0066
Epoch 6, Average Loss: 0.0026
Epoch 7, Average Loss: 0.0016
Epoch 8, Average Loss: 0.0012
Epoch 9, Average Loss: 0.0010
Epoch 10, Average Loss: 0.0007
Accuracy of naive model on cartoon: 27.7778
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 1.9789
Epoch 2, Average Loss: 2.0868
Epoch 3, Average Loss: 1.8026
Epoch 4, Average Loss: 1.5506
Epoch 5, Average Loss: 1.4062
Epoch 6, Average Loss: 1.2994
Epoch 7, Average Loss: 1.4035
Epoch 8, Average Loss: 1.3214
Epoch 9, Average Loss: 1.2386
Epoch 10, Average Loss: 0.9017
Merged model device: cuda:0
Accuracy of photo model on test domain: 16.6667

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.3316
Epoch 2, Average Loss: 2.0525
Epoch 3, Average Loss: 2.2409
Epoch 4, Average Loss: 1.9921
Epoch 5, Average Loss: 1.9176
Epoch 6, Average Loss: 1.6319
Epoch 7, Average Loss: 1.5591
Epoch 8, Average Loss: 1.5473
Epoch 9, Average Loss: 1.2762
Epoch 10, Average Loss: 1.4597
Merged model device: cuda:0
Accuracy of sketch model on test domain: 22.2222

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.4999
Epoch 2, Average Loss: 2.3736
Epoch 3, Average Loss: 1.8341
Epoch 4, Average Loss: 1.9206
Epoch 5, Average Loss: 1.6812
Epoch 6, Average Loss: 1.8508
Epoch 7, Average Loss: 1.8930
Epoch 8, Average Loss: 1.5080
Epoch 9, Average Loss: 1.4796
Epoch 10, Average Loss: 1.0989
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 16.6667

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.0979
Coefficient Epoch 2, Average Loss: 3.7696
Coefficient Epoch 3, Average Loss: 3.4518
Coefficient Epoch 4, Average Loss: 3.1479
Coefficient Epoch 5, Average Loss: 2.8626
Coefficient Epoch 6, Average Loss: 2.6019
Coefficient Epoch 7, Average Loss: 2.3734
Coefficient Epoch 8, Average Loss: 2.1858
Coefficient Epoch 9, Average Loss: 2.0481
Coefficient Epoch 10, Average Loss: 1.9658
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33510515093803406, 0.3301660120487213, 0.33472883701324463]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 11.1111
Test Domain: art_painting, Run 1/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: photo
Training domains: ['cartoon', 'sketch', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1838
Epoch 2, Average Loss: 0.3135
Epoch 3, Average Loss: 0.0186
Epoch 4, Average Loss: 0.0032
Epoch 5, Average Loss: 0.0010
Epoch 6, Average Loss: 0.0005
Epoch 7, Average Loss: 0.0004
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0003
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on photo: 66.6667
Training domains: ['cartoon', 'sketch', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.5128
Epoch 2, Average Loss: 2.4685
Epoch 3, Average Loss: 2.4200
Epoch 4, Average Loss: 1.9115
Epoch 5, Average Loss: 1.9941
Epoch 6, Average Loss: 1.9055
Epoch 7, Average Loss: 1.8740
Epoch 8, Average Loss: 1.4029
Epoch 9, Average Loss: 1.3957
Epoch 10, Average Loss: 1.2637
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 22.2222

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.5377
Epoch 2, Average Loss: 2.3067
Epoch 3, Average Loss: 2.2516
Epoch 4, Average Loss: 2.1090
Epoch 5, Average Loss: 1.9158
Epoch 6, Average Loss: 1.7975
Epoch 7, Average Loss: 1.6769
Epoch 8, Average Loss: 1.9485
Epoch 9, Average Loss: 1.4572
Epoch 10, Average Loss: 1.7093
Merged model device: cuda:0
Accuracy of sketch model on test domain: 22.2222

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.2730
Epoch 2, Average Loss: 1.7405
Epoch 3, Average Loss: 1.8825
Epoch 4, Average Loss: 1.7440
Epoch 5, Average Loss: 1.5578
Epoch 6, Average Loss: 1.3349
Epoch 7, Average Loss: 1.1475
Epoch 8, Average Loss: 1.6646
Epoch 9, Average Loss: 1.0830
Epoch 10, Average Loss: 1.0420
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 33.3333

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.1142
Coefficient Epoch 2, Average Loss: 2.9026
Coefficient Epoch 3, Average Loss: 2.7021
Coefficient Epoch 4, Average Loss: 2.5154
Coefficient Epoch 5, Average Loss: 2.3460
Coefficient Epoch 6, Average Loss: 2.1979
Coefficient Epoch 7, Average Loss: 2.0760
Coefficient Epoch 8, Average Loss: 1.9851
Coefficient Epoch 9, Average Loss: 1.9286
Coefficient Epoch 10, Average Loss: 1.9058
Final device check:
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33342841267585754, 0.3261537551879883, 0.3404178321361542]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 27.7778
Test Domain: art_painting, Run 2/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.5063
Epoch 2, Average Loss: 1.0055
Epoch 3, Average Loss: 0.3610
Epoch 4, Average Loss: 0.0285
Epoch 5, Average Loss: 0.0082
Epoch 6, Average Loss: 0.0037
Epoch 7, Average Loss: 0.0020
Epoch 8, Average Loss: 0.0011
Epoch 9, Average Loss: 0.0007
Epoch 10, Average Loss: 0.0005
Accuracy of naive model on cartoon: 55.5556
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.5644
Epoch 2, Average Loss: 2.3127
Epoch 3, Average Loss: 1.8659
Epoch 4, Average Loss: 2.2070
Epoch 5, Average Loss: 1.9137
Epoch 6, Average Loss: 1.7498
Epoch 7, Average Loss: 1.6393
Epoch 8, Average Loss: 1.7095
Epoch 9, Average Loss: 1.2370
Epoch 10, Average Loss: 1.7283
Merged model device: cuda:0
Accuracy of photo model on test domain: 16.6667

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.4320
Epoch 2, Average Loss: 1.9310
Epoch 3, Average Loss: 1.8317
Epoch 4, Average Loss: 1.6777
Epoch 5, Average Loss: 1.9690
Epoch 6, Average Loss: 1.8038
Epoch 7, Average Loss: 1.3731
Epoch 8, Average Loss: 1.3615
Epoch 9, Average Loss: 1.6574
Epoch 10, Average Loss: 1.3123
Merged model device: cuda:0
Accuracy of sketch model on test domain: 16.6667

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.5951
Epoch 2, Average Loss: 2.4246
Epoch 3, Average Loss: 1.9171
Epoch 4, Average Loss: 2.0073
Epoch 5, Average Loss: 1.8371
Epoch 6, Average Loss: 2.0628
Epoch 7, Average Loss: 1.6242
Epoch 8, Average Loss: 1.3462
Epoch 9, Average Loss: 1.0020
Epoch 10, Average Loss: 1.3427
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 33.3333

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.1266
Coefficient Epoch 2, Average Loss: 3.7899
Coefficient Epoch 3, Average Loss: 3.4640
Coefficient Epoch 4, Average Loss: 3.1525
Coefficient Epoch 5, Average Loss: 2.8606
Coefficient Epoch 6, Average Loss: 2.5950
Coefficient Epoch 7, Average Loss: 2.3641
Coefficient Epoch 8, Average Loss: 2.1773
Coefficient Epoch 9, Average Loss: 2.0430
Coefficient Epoch 10, Average Loss: 1.9652
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33322519063949585, 0.33226948976516724, 0.3345053195953369]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 22.2222
Test Domain: art_painting, Run 3/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1542
Epoch 2, Average Loss: 0.8352
Epoch 3, Average Loss: 0.0993
Epoch 4, Average Loss: 0.0107
Epoch 5, Average Loss: 0.0040
Epoch 6, Average Loss: 0.0037
Epoch 7, Average Loss: 0.0024
Epoch 8, Average Loss: 0.0011
Epoch 9, Average Loss: 0.0005
Epoch 10, Average Loss: 0.0003
Accuracy of naive model on cartoon: 50.0000
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 1.9982
Epoch 2, Average Loss: 1.8488
Epoch 3, Average Loss: 1.9764
Epoch 4, Average Loss: 1.3634
Epoch 5, Average Loss: 1.8675
Epoch 6, Average Loss: 1.5149
Epoch 7, Average Loss: 1.6925
Epoch 8, Average Loss: 1.0218
Epoch 9, Average Loss: 1.1062
Epoch 10, Average Loss: 0.9827
Merged model device: cuda:0
Accuracy of photo model on test domain: 44.4444

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.1296
Epoch 2, Average Loss: 1.8425
Epoch 3, Average Loss: 1.6933
Epoch 4, Average Loss: 1.6991
Epoch 5, Average Loss: 1.6298
Epoch 6, Average Loss: 1.6741
Epoch 7, Average Loss: 1.6570
Epoch 8, Average Loss: 1.2634
Epoch 9, Average Loss: 1.2645
Epoch 10, Average Loss: 1.7077
Merged model device: cuda:0
Accuracy of sketch model on test domain: 22.2222

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.1496
Epoch 2, Average Loss: 2.5114
Epoch 3, Average Loss: 2.2282
Epoch 4, Average Loss: 1.9520
Epoch 5, Average Loss: 1.7454
Epoch 6, Average Loss: 1.5562
Epoch 7, Average Loss: 1.5256
Epoch 8, Average Loss: 1.4112
Epoch 9, Average Loss: 1.2923
Epoch 10, Average Loss: 1.1777
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 33.3333

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.1279
Coefficient Epoch 2, Average Loss: 2.9003
Coefficient Epoch 3, Average Loss: 2.6831
Coefficient Epoch 4, Average Loss: 2.4798
Coefficient Epoch 5, Average Loss: 2.2951
Coefficient Epoch 6, Average Loss: 2.1347
Coefficient Epoch 7, Average Loss: 2.0057
Coefficient Epoch 8, Average Loss: 1.9147
Coefficient Epoch 9, Average Loss: 1.8664
Coefficient Epoch 10, Average Loss: 1.8600
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3327464163303375, 0.3324074149131775, 0.334846168756485]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 38.8889
Test Domain: art_painting, Run 4/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: photo
Training domains: ['cartoon', 'sketch', 'art_painting']
Test domain: photo
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1563
Epoch 2, Average Loss: 0.5115
Epoch 3, Average Loss: 0.0304
Epoch 4, Average Loss: 0.0048
Epoch 5, Average Loss: 0.0018
Epoch 6, Average Loss: 0.0011
Epoch 7, Average Loss: 0.0006
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on photo: 88.8889
Training domains: ['cartoon', 'sketch', 'art_painting']

Training expert models...

Training model for domain: cartoon
Training model for domain: cartoon
Epoch 1, Average Loss: 2.6089
Epoch 2, Average Loss: 2.0929
Epoch 3, Average Loss: 2.1494
Epoch 4, Average Loss: 1.9039
Epoch 5, Average Loss: 1.8995
Epoch 6, Average Loss: 1.7470
Epoch 7, Average Loss: 1.6591
Epoch 8, Average Loss: 1.3518
Epoch 9, Average Loss: 1.4000
Epoch 10, Average Loss: 1.3883
Merged model device: cuda:0
Accuracy of cartoon model on test domain: 16.6667

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 2.2959
Epoch 2, Average Loss: 2.0486
Epoch 3, Average Loss: 2.0421
Epoch 4, Average Loss: 2.1329
Epoch 5, Average Loss: 1.7386
Epoch 6, Average Loss: 1.6915
Epoch 7, Average Loss: 1.7186
Epoch 8, Average Loss: 1.5708
Epoch 9, Average Loss: 1.6515
Epoch 10, Average Loss: 1.4041
Merged model device: cuda:0
Accuracy of sketch model on test domain: 16.6667

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.7052
Epoch 2, Average Loss: 2.2483
Epoch 3, Average Loss: 1.8173
Epoch 4, Average Loss: 1.7313
Epoch 5, Average Loss: 2.0249
Epoch 6, Average Loss: 1.9277
Epoch 7, Average Loss: 1.4533
Epoch 8, Average Loss: 1.3882
Epoch 9, Average Loss: 1.8252
Epoch 10, Average Loss: 1.0641
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 16.6667

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain cartoon - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.9475
Coefficient Epoch 2, Average Loss: 2.7678
Coefficient Epoch 3, Average Loss: 2.5981
Coefficient Epoch 4, Average Loss: 2.4410
Coefficient Epoch 5, Average Loss: 2.2995
Coefficient Epoch 6, Average Loss: 2.1770
Coefficient Epoch 7, Average Loss: 2.0766
Coefficient Epoch 8, Average Loss: 2.0011
Coefficient Epoch 9, Average Loss: 1.9515
Coefficient Epoch 10, Average Loss: 1.9272
Final device check:
Expert model cartoon device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3322463035583496, 0.32703375816345215, 0.34071990847587585]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 16.6667
Test Domain: art_painting, Run 5/5
Preparing data...
Domains: ['cartoon', 'photo', 'sketch', 'art_painting']
Test domain: cartoon
Training domains: ['photo', 'sketch', 'art_painting']
Test domain: cartoon
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.6275
Epoch 2, Average Loss: 1.0112
Epoch 3, Average Loss: 0.2906
Epoch 4, Average Loss: 0.0333
Epoch 5, Average Loss: 0.0078
Epoch 6, Average Loss: 0.0026
Epoch 7, Average Loss: 0.0013
Epoch 8, Average Loss: 0.0007
Epoch 9, Average Loss: 0.0005
Epoch 10, Average Loss: 0.0004
Accuracy of naive model on cartoon: 27.7778
Training domains: ['photo', 'sketch', 'art_painting']

Training expert models...

Training model for domain: photo
Training model for domain: photo
Epoch 1, Average Loss: 2.4102
Epoch 2, Average Loss: 2.7497
Epoch 3, Average Loss: 2.0622
Epoch 4, Average Loss: 1.6895
Epoch 5, Average Loss: 1.9236
Epoch 6, Average Loss: 1.9616
Epoch 7, Average Loss: 1.5648
Epoch 8, Average Loss: 1.7632
Epoch 9, Average Loss: 1.3791
Epoch 10, Average Loss: 1.2763
Merged model device: cuda:0
Accuracy of photo model on test domain: 27.7778

Training model for domain: sketch
Training model for domain: sketch
Epoch 1, Average Loss: 1.8513
Epoch 2, Average Loss: 1.9125
Epoch 3, Average Loss: 1.7368
Epoch 4, Average Loss: 1.8632
Epoch 5, Average Loss: 1.5974
Epoch 6, Average Loss: 1.6072
Epoch 7, Average Loss: 1.5360
Epoch 8, Average Loss: 1.3739
Epoch 9, Average Loss: 1.3575
Epoch 10, Average Loss: 1.2881
Merged model device: cuda:0
Accuracy of sketch model on test domain: 33.3333

Training model for domain: art_painting
Training model for domain: art_painting
Epoch 1, Average Loss: 2.8344
Epoch 2, Average Loss: 2.2477
Epoch 3, Average Loss: 2.3579
Epoch 4, Average Loss: 1.9610
Epoch 5, Average Loss: 2.0202
Epoch 6, Average Loss: 1.9992
Epoch 7, Average Loss: 1.6999
Epoch 8, Average Loss: 1.5385
Epoch 9, Average Loss: 1.6587
Epoch 10, Average Loss: 1.2356
Merged model device: cuda:0
Accuracy of art_painting model on test domain: 22.2222

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Domain photo - Input device: cuda:0, Model device: cuda:0
Domain sketch - Input device: cuda:0, Model device: cuda:0
Domain art_painting - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.2066
Coefficient Epoch 2, Average Loss: 3.8718
Coefficient Epoch 3, Average Loss: 3.5476
Coefficient Epoch 4, Average Loss: 3.2370
Coefficient Epoch 5, Average Loss: 2.9439
Coefficient Epoch 6, Average Loss: 2.6732
Coefficient Epoch 7, Average Loss: 2.4316
Coefficient Epoch 8, Average Loss: 2.2276
Coefficient Epoch 9, Average Loss: 2.0720
Coefficient Epoch 10, Average Loss: 1.9758
Final device check:
Expert model photo device: cuda:0
Expert model sketch device: cuda:0
Expert model art_painting device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33327484130859375, 0.3322720527648926, 0.33445313572883606]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 22.2222
Debug: Type of results: <class 'list'>
Debug: Content of results: [{'test_domain': 'cartoon', 'domain_accuracies': {'photo': 22.22222222222222, 'sketch': 27.77777777777778, 'art_painting': 27.77777777777778}, 'final_accuracy': 22.22222222222222, 'coefficients': [0.3341256380081177, 0.32908886671066284, 0.33678552508354187]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 27.77777777777778, 'sketch': 16.666666666666664, 'art_painting': 11.11111111111111}, 'final_accuracy': 22.22222222222222, 'coefficients': [0.33151090145111084, 0.32779034972190857, 0.340698778629303]}, {'test_domain': 'photo', 'domain_accuracies': {'cartoon': 5.555555555555555, 'sketch': 5.555555555555555, 'art_painting': 11.11111111111111}, 'final_accuracy': 5.555555555555555, 'coefficients': [0.3326040506362915, 0.328702837228775, 0.33869311213493347]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 38.88888888888889, 'sketch': 33.33333333333333, 'art_painting': 33.33333333333333}, 'final_accuracy': 38.88888888888889, 'coefficients': [0.3315439820289612, 0.33456525206565857, 0.333890825510025]}, {'test_domain': 'sketch', 'domain_accuracies': {'cartoon': 5.555555555555555, 'photo': 5.555555555555555, 'art_painting': 0.0}, 'final_accuracy': 0.0, 'coefficients': [0.33218157291412354, 0.3345251977443695, 0.33329322934150696]}, {'test_domain': 'sketch', 'domain_accuracies': {'cartoon': 5.555555555555555, 'photo': 22.22222222222222, 'art_painting': 16.666666666666664}, 'final_accuracy': 16.666666666666664, 'coefficients': [0.32851988077163696, 0.3388674557209015, 0.3326127231121063]}, {'test_domain': 'photo', 'domain_accuracies': {'cartoon': 16.666666666666664, 'sketch': 16.666666666666664, 'art_painting': 16.666666666666664}, 'final_accuracy': 16.666666666666664, 'coefficients': [0.334621787071228, 0.3270529806613922, 0.33832523226737976]}, {'test_domain': 'sketch', 'domain_accuracies': {'cartoon': 27.77777777777778, 'photo': 27.77777777777778, 'art_painting': 22.22222222222222}, 'final_accuracy': 27.77777777777778, 'coefficients': [0.3350517749786377, 0.33204737305641174, 0.3329008221626282]}, {'test_domain': 'sketch', 'domain_accuracies': {'cartoon': 22.22222222222222, 'photo': 22.22222222222222, 'art_painting': 22.22222222222222}, 'final_accuracy': 27.77777777777778, 'coefficients': [0.33662906289100647, 0.33021631836891174, 0.3331546187400818]}, {'test_domain': 'sketch', 'domain_accuracies': {'cartoon': 33.33333333333333, 'photo': 33.33333333333333, 'art_painting': 38.88888888888889}, 'final_accuracy': 44.44444444444444, 'coefficients': [0.341917484998703, 0.3227890431880951, 0.3352934420108795]}, {'test_domain': 'art_painting', 'domain_accuracies': {'cartoon': 16.666666666666664, 'photo': 27.77777777777778, 'sketch': 11.11111111111111}, 'final_accuracy': 22.22222222222222, 'coefficients': [0.3334583640098572, 0.3346562683582306, 0.3318853974342346]}, {'test_domain': 'art_painting', 'domain_accuracies': {'cartoon': 5.555555555555555, 'photo': 16.666666666666664, 'sketch': 0.0}, 'final_accuracy': 5.555555555555555, 'coefficients': [0.3361084461212158, 0.33580824732780457, 0.328083336353302]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 11.11111111111111, 'sketch': 11.11111111111111, 'art_painting': 0.0}, 'final_accuracy': 0.0, 'coefficients': [0.33341413736343384, 0.3322393596172333, 0.33434656262397766]}, {'test_domain': 'photo', 'domain_accuracies': {'cartoon': 22.22222222222222, 'sketch': 5.555555555555555, 'art_painting': 22.22222222222222}, 'final_accuracy': 11.11111111111111, 'coefficients': [0.32996422052383423, 0.3277735710144043, 0.34226223826408386]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 16.666666666666664, 'sketch': 22.22222222222222, 'art_painting': 16.666666666666664}, 'final_accuracy': 11.11111111111111, 'coefficients': [0.33510515093803406, 0.3301660120487213, 0.33472883701324463]}, {'test_domain': 'photo', 'domain_accuracies': {'cartoon': 22.22222222222222, 'sketch': 22.22222222222222, 'art_painting': 33.33333333333333}, 'final_accuracy': 27.77777777777778, 'coefficients': [0.33342841267585754, 0.3261537551879883, 0.3404178321361542]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 16.666666666666664, 'sketch': 16.666666666666664, 'art_painting': 33.33333333333333}, 'final_accuracy': 22.22222222222222, 'coefficients': [0.33322519063949585, 0.33226948976516724, 0.3345053195953369]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 44.44444444444444, 'sketch': 22.22222222222222, 'art_painting': 33.33333333333333}, 'final_accuracy': 38.88888888888889, 'coefficients': [0.3327464163303375, 0.3324074149131775, 0.334846168756485]}, {'test_domain': 'photo', 'domain_accuracies': {'cartoon': 16.666666666666664, 'sketch': 16.666666666666664, 'art_painting': 16.666666666666664}, 'final_accuracy': 16.666666666666664, 'coefficients': [0.3322463035583496, 0.32703375816345215, 0.34071990847587585]}, {'test_domain': 'cartoon', 'domain_accuracies': {'photo': 27.77777777777778, 'sketch': 33.33333333333333, 'art_painting': 22.22222222222222}, 'final_accuracy': 22.22222222222222, 'coefficients': [0.33327484130859375, 0.3322720527648926, 0.33445313572883606]}]
Final Model Accuracy: 20.0000  12.0953
Domain-specific Accuracies:
  photo: 24.0741  9.8688
  sketch: 17.4074  9.4861
  art_painting: 20.9877  10.8859
  cartoon: 16.6667  9.0722
Average Coefficients:
  Coefficient 1: 0.3336  0.0027
  Coefficient 2: 0.3308  0.0038
  Coefficient 3: 0.3356  0.0035
Running experiments for dataset: VLCS
Test Domain: LabelMe, Run 1/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: SUN09
Training domains: ['LabelMe', 'VOC2007', 'Caltech101']
Test domain: SUN09
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1296
Epoch 2, Average Loss: 0.2238
Epoch 3, Average Loss: 0.0397
Epoch 4, Average Loss: 0.0085
Epoch 5, Average Loss: 0.0022
Epoch 6, Average Loss: 0.0007
Epoch 7, Average Loss: 0.0003
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on SUN09: 38.4615
Training domains: ['LabelMe', 'VOC2007', 'Caltech101']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.8867
Epoch 2, Average Loss: 1.7771
Epoch 3, Average Loss: 1.6713
Epoch 4, Average Loss: 1.5718
Epoch 5, Average Loss: 1.4751
Epoch 6, Average Loss: 1.3824
Epoch 7, Average Loss: 1.2931
Epoch 8, Average Loss: 1.2071
Epoch 9, Average Loss: 1.1228
Epoch 10, Average Loss: 1.0434
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 15.3846

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.7893
Epoch 2, Average Loss: 1.6578
Epoch 3, Average Loss: 1.5355
Epoch 4, Average Loss: 1.4174
Epoch 5, Average Loss: 1.3049
Epoch 6, Average Loss: 1.1996
Epoch 7, Average Loss: 1.1008
Epoch 8, Average Loss: 1.0064
Epoch 9, Average Loss: 0.9197
Epoch 10, Average Loss: 0.8376
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 15.3846

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.7746
Epoch 2, Average Loss: 1.6359
Epoch 3, Average Loss: 1.5144
Epoch 4, Average Loss: 1.3971
Epoch 5, Average Loss: 1.2904
Epoch 6, Average Loss: 1.1865
Epoch 7, Average Loss: 1.0876
Epoch 8, Average Loss: 0.9892
Epoch 9, Average Loss: 0.8968
Epoch 10, Average Loss: 0.8088
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.5873
Coefficient Epoch 2, Average Loss: 3.3163
Coefficient Epoch 3, Average Loss: 3.0525
Coefficient Epoch 4, Average Loss: 2.7983
Coefficient Epoch 5, Average Loss: 2.5564
Coefficient Epoch 6, Average Loss: 2.3306
Coefficient Epoch 7, Average Loss: 2.1258
Coefficient Epoch 8, Average Loss: 1.9476
Coefficient Epoch 9, Average Loss: 1.8019
Coefficient Epoch 10, Average Loss: 1.6933
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3317055106163025, 0.33463457226753235, 0.3336598873138428]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 15.3846
Test Domain: LabelMe, Run 2/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: VOC2007
Training domains: ['LabelMe', 'Caltech101', 'SUN09']
Test domain: VOC2007
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1460
Epoch 2, Average Loss: 0.1943
Epoch 3, Average Loss: 0.0339
Epoch 4, Average Loss: 0.0057
Epoch 5, Average Loss: 0.0022
Epoch 6, Average Loss: 0.0012
Epoch 7, Average Loss: 0.0007
Epoch 8, Average Loss: 0.0004
Epoch 9, Average Loss: 0.0003
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on VOC2007: 23.0769
Training domains: ['LabelMe', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.9087
Epoch 2, Average Loss: 1.7994
Epoch 3, Average Loss: 1.6966
Epoch 4, Average Loss: 1.5970
Epoch 5, Average Loss: 1.5038
Epoch 6, Average Loss: 1.4142
Epoch 7, Average Loss: 1.3255
Epoch 8, Average Loss: 1.2435
Epoch 9, Average Loss: 1.1620
Epoch 10, Average Loss: 1.0857
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 23.0769

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.4612
Epoch 2, Average Loss: 1.3338
Epoch 3, Average Loss: 1.2304
Epoch 4, Average Loss: 1.1352
Epoch 5, Average Loss: 1.0474
Epoch 6, Average Loss: 0.9627
Epoch 7, Average Loss: 0.8831
Epoch 8, Average Loss: 0.8042
Epoch 9, Average Loss: 0.7311
Epoch 10, Average Loss: 0.6616
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 38.4615

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.6696
Epoch 2, Average Loss: 1.5587
Epoch 3, Average Loss: 1.4542
Epoch 4, Average Loss: 1.3539
Epoch 5, Average Loss: 1.2579
Epoch 6, Average Loss: 1.1713
Epoch 7, Average Loss: 1.0836
Epoch 8, Average Loss: 1.0013
Epoch 9, Average Loss: 0.9292
Epoch 10, Average Loss: 0.8564
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 30.7692

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 4.1449
Coefficient Epoch 2, Average Loss: 3.7943
Coefficient Epoch 3, Average Loss: 3.4517
Coefficient Epoch 4, Average Loss: 3.1198
Coefficient Epoch 5, Average Loss: 2.8027
Coefficient Epoch 6, Average Loss: 2.5058
Coefficient Epoch 7, Average Loss: 2.2370
Coefficient Epoch 8, Average Loss: 2.0056
Coefficient Epoch 9, Average Loss: 1.8221
Coefficient Epoch 10, Average Loss: 1.6940
Final device check:
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33352333307266235, 0.3333975374698639, 0.33307912945747375]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 30.7692
Test Domain: LabelMe, Run 3/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9931
Epoch 2, Average Loss: 0.2463
Epoch 3, Average Loss: 0.0085
Epoch 4, Average Loss: 0.0017
Epoch 5, Average Loss: 0.0010
Epoch 6, Average Loss: 0.0005
Epoch 7, Average Loss: 0.0003
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on Caltech101: 76.9231
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.7807
Epoch 2, Average Loss: 1.6706
Epoch 3, Average Loss: 1.5551
Epoch 4, Average Loss: 1.4604
Epoch 5, Average Loss: 1.3623
Epoch 6, Average Loss: 1.2706
Epoch 7, Average Loss: 1.1817
Epoch 8, Average Loss: 1.0998
Epoch 9, Average Loss: 1.0189
Epoch 10, Average Loss: 0.9475
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 7.6923

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 2.0402
Epoch 2, Average Loss: 1.8954
Epoch 3, Average Loss: 1.7508
Epoch 4, Average Loss: 1.6261
Epoch 5, Average Loss: 1.5162
Epoch 6, Average Loss: 1.4085
Epoch 7, Average Loss: 1.3023
Epoch 8, Average Loss: 1.2017
Epoch 9, Average Loss: 1.1042
Epoch 10, Average Loss: 1.0150
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 7.6923

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 2.0347
Epoch 2, Average Loss: 1.9157
Epoch 3, Average Loss: 1.8029
Epoch 4, Average Loss: 1.6973
Epoch 5, Average Loss: 1.5932
Epoch 6, Average Loss: 1.4928
Epoch 7, Average Loss: 1.3964
Epoch 8, Average Loss: 1.3024
Epoch 9, Average Loss: 1.2116
Epoch 10, Average Loss: 1.1261
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 7.6923

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.4872
Coefficient Epoch 2, Average Loss: 3.2035
Coefficient Epoch 3, Average Loss: 2.9287
Coefficient Epoch 4, Average Loss: 2.6659
Coefficient Epoch 5, Average Loss: 2.4192
Coefficient Epoch 6, Average Loss: 2.1942
Coefficient Epoch 7, Average Loss: 1.9976
Coefficient Epoch 8, Average Loss: 1.8369
Coefficient Epoch 9, Average Loss: 1.7184
Coefficient Epoch 10, Average Loss: 1.6444
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33282753825187683, 0.3343113660812378, 0.3328610956668854]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 7.6923
Test Domain: LabelMe, Run 4/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.0210
Epoch 2, Average Loss: 0.2724
Epoch 3, Average Loss: 0.0340
Epoch 4, Average Loss: 0.0034
Epoch 5, Average Loss: 0.0007
Epoch 6, Average Loss: 0.0003
Epoch 7, Average Loss: 0.0006
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0000
Accuracy of naive model on Caltech101: 100.0000
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.9629
Epoch 2, Average Loss: 1.8489
Epoch 3, Average Loss: 1.7387
Epoch 4, Average Loss: 1.6300
Epoch 5, Average Loss: 1.5259
Epoch 6, Average Loss: 1.4268
Epoch 7, Average Loss: 1.3309
Epoch 8, Average Loss: 1.2366
Epoch 9, Average Loss: 1.1457
Epoch 10, Average Loss: 1.0572
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 38.4615

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.8901
Epoch 2, Average Loss: 1.7697
Epoch 3, Average Loss: 1.6477
Epoch 4, Average Loss: 1.5383
Epoch 5, Average Loss: 1.4291
Epoch 6, Average Loss: 1.3277
Epoch 7, Average Loss: 1.2233
Epoch 8, Average Loss: 1.1293
Epoch 9, Average Loss: 1.0410
Epoch 10, Average Loss: 0.9589
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 46.1538

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 2.0029
Epoch 2, Average Loss: 1.8844
Epoch 3, Average Loss: 1.7738
Epoch 4, Average Loss: 1.6611
Epoch 5, Average Loss: 1.5526
Epoch 6, Average Loss: 1.4445
Epoch 7, Average Loss: 1.3381
Epoch 8, Average Loss: 1.2358
Epoch 9, Average Loss: 1.1361
Epoch 10, Average Loss: 1.0455
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 46.1538

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.2943
Coefficient Epoch 2, Average Loss: 3.0492
Coefficient Epoch 3, Average Loss: 2.8112
Coefficient Epoch 4, Average Loss: 2.5826
Coefficient Epoch 5, Average Loss: 2.3663
Coefficient Epoch 6, Average Loss: 2.1662
Coefficient Epoch 7, Average Loss: 1.9878
Coefficient Epoch 8, Average Loss: 1.8380
Coefficient Epoch 9, Average Loss: 1.7238
Coefficient Epoch 10, Average Loss: 1.6495
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33297786116600037, 0.334663987159729, 0.33235815167427063]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 46.1538
Test Domain: LabelMe, Run 5/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1570
Epoch 2, Average Loss: 0.1005
Epoch 3, Average Loss: 0.0066
Epoch 4, Average Loss: 0.0008
Epoch 5, Average Loss: 0.0003
Epoch 6, Average Loss: 0.0001
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on Caltech101: 100.0000
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.9246
Epoch 2, Average Loss: 1.7982
Epoch 3, Average Loss: 1.6851
Epoch 4, Average Loss: 1.5858
Epoch 5, Average Loss: 1.4882
Epoch 6, Average Loss: 1.3938
Epoch 7, Average Loss: 1.3060
Epoch 8, Average Loss: 1.2187
Epoch 9, Average Loss: 1.1353
Epoch 10, Average Loss: 1.0569
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 23.0769

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 2.1676
Epoch 2, Average Loss: 2.0140
Epoch 3, Average Loss: 1.8933
Epoch 4, Average Loss: 1.7736
Epoch 5, Average Loss: 1.6589
Epoch 6, Average Loss: 1.5429
Epoch 7, Average Loss: 1.4315
Epoch 8, Average Loss: 1.3249
Epoch 9, Average Loss: 1.2185
Epoch 10, Average Loss: 1.1211
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 23.0769

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 2.2495
Epoch 2, Average Loss: 2.1082
Epoch 3, Average Loss: 1.9699
Epoch 4, Average Loss: 1.8352
Epoch 5, Average Loss: 1.7046
Epoch 6, Average Loss: 1.5757
Epoch 7, Average Loss: 1.4586
Epoch 8, Average Loss: 1.3409
Epoch 9, Average Loss: 1.2334
Epoch 10, Average Loss: 1.1325
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 23.0769

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.5577
Coefficient Epoch 2, Average Loss: 3.2879
Coefficient Epoch 3, Average Loss: 3.0251
Coefficient Epoch 4, Average Loss: 2.7716
Coefficient Epoch 5, Average Loss: 2.5306
Coefficient Epoch 6, Average Loss: 2.3065
Coefficient Epoch 7, Average Loss: 2.1043
Coefficient Epoch 8, Average Loss: 1.9302
Coefficient Epoch 9, Average Loss: 1.7900
Coefficient Epoch 10, Average Loss: 1.6876
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33195024728775024, 0.3344782292842865, 0.3335714638233185]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 23.0769
Test Domain: VOC2007, Run 1/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Training domains: ['VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.8948
Epoch 2, Average Loss: 0.4133
Epoch 3, Average Loss: 0.0751
Epoch 4, Average Loss: 0.0073
Epoch 5, Average Loss: 0.0034
Epoch 6, Average Loss: 0.0016
Epoch 7, Average Loss: 0.0008
Epoch 8, Average Loss: 0.0004
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on LabelMe: 38.4615
Training domains: ['VOC2007', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 2.0172
Epoch 2, Average Loss: 1.8797
Epoch 3, Average Loss: 1.7502
Epoch 4, Average Loss: 1.6277
Epoch 5, Average Loss: 1.5074
Epoch 6, Average Loss: 1.3953
Epoch 7, Average Loss: 1.2883
Epoch 8, Average Loss: 1.1874
Epoch 9, Average Loss: 1.0911
Epoch 10, Average Loss: 1.0028
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 30.7692

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.9417
Epoch 2, Average Loss: 1.8276
Epoch 3, Average Loss: 1.7186
Epoch 4, Average Loss: 1.6122
Epoch 5, Average Loss: 1.5074
Epoch 6, Average Loss: 1.4036
Epoch 7, Average Loss: 1.3021
Epoch 8, Average Loss: 1.2038
Epoch 9, Average Loss: 1.1096
Epoch 10, Average Loss: 1.0151
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 30.7692

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.6479
Epoch 2, Average Loss: 1.5322
Epoch 3, Average Loss: 1.4264
Epoch 4, Average Loss: 1.3237
Epoch 5, Average Loss: 1.2249
Epoch 6, Average Loss: 1.1297
Epoch 7, Average Loss: 1.0397
Epoch 8, Average Loss: 0.9535
Epoch 9, Average Loss: 0.8775
Epoch 10, Average Loss: 0.8033
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 30.7692

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.2439
Coefficient Epoch 2, Average Loss: 2.9964
Coefficient Epoch 3, Average Loss: 2.7564
Coefficient Epoch 4, Average Loss: 2.5262
Coefficient Epoch 5, Average Loss: 2.3093
Coefficient Epoch 6, Average Loss: 2.1102
Coefficient Epoch 7, Average Loss: 1.9348
Coefficient Epoch 8, Average Loss: 1.7905
Coefficient Epoch 9, Average Loss: 1.6847
Coefficient Epoch 10, Average Loss: 1.6226
Final device check:
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33445921540260315, 0.3333723545074463, 0.33216843008995056]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 30.7692
Test Domain: VOC2007, Run 2/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: SUN09
Training domains: ['LabelMe', 'VOC2007', 'Caltech101']
Test domain: SUN09
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9536
Epoch 2, Average Loss: 0.3551
Epoch 3, Average Loss: 0.0205
Epoch 4, Average Loss: 0.0070
Epoch 5, Average Loss: 0.0032
Epoch 6, Average Loss: 0.0010
Epoch 7, Average Loss: 0.0004
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0003
Accuracy of naive model on SUN09: 30.7692
Training domains: ['LabelMe', 'VOC2007', 'Caltech101']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.8153
Epoch 2, Average Loss: 1.6983
Epoch 3, Average Loss: 1.5918
Epoch 4, Average Loss: 1.4883
Epoch 5, Average Loss: 1.3923
Epoch 6, Average Loss: 1.2984
Epoch 7, Average Loss: 1.2102
Epoch 8, Average Loss: 1.1263
Epoch 9, Average Loss: 1.0484
Epoch 10, Average Loss: 0.9704
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 15.3846

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 2.0012
Epoch 2, Average Loss: 1.8621
Epoch 3, Average Loss: 1.7261
Epoch 4, Average Loss: 1.5904
Epoch 5, Average Loss: 1.4677
Epoch 6, Average Loss: 1.3445
Epoch 7, Average Loss: 1.2323
Epoch 8, Average Loss: 1.1263
Epoch 9, Average Loss: 1.0255
Epoch 10, Average Loss: 0.9342
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 7.6923

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.7375
Epoch 2, Average Loss: 1.6161
Epoch 3, Average Loss: 1.5026
Epoch 4, Average Loss: 1.3937
Epoch 5, Average Loss: 1.2872
Epoch 6, Average Loss: 1.1851
Epoch 7, Average Loss: 1.0870
Epoch 8, Average Loss: 0.9924
Epoch 9, Average Loss: 0.9061
Epoch 10, Average Loss: 0.8195
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.5355
Coefficient Epoch 2, Average Loss: 3.2694
Coefficient Epoch 3, Average Loss: 3.0104
Coefficient Epoch 4, Average Loss: 2.7607
Coefficient Epoch 5, Average Loss: 2.5232
Coefficient Epoch 6, Average Loss: 2.3021
Coefficient Epoch 7, Average Loss: 2.1023
Coefficient Epoch 8, Average Loss: 1.9300
Coefficient Epoch 9, Average Loss: 1.7909
Coefficient Epoch 10, Average Loss: 1.6887
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33283957839012146, 0.33261838555336, 0.33454206585884094]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 7.6923
Test Domain: VOC2007, Run 3/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Training domains: ['VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.4904
Epoch 2, Average Loss: 0.0488
Epoch 3, Average Loss: 0.0018
Epoch 4, Average Loss: 0.0005
Epoch 5, Average Loss: 0.0004
Epoch 6, Average Loss: 0.0004
Epoch 7, Average Loss: 0.0004
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on LabelMe: 30.7692
Training domains: ['VOC2007', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.8884
Epoch 2, Average Loss: 1.7736
Epoch 3, Average Loss: 1.6609
Epoch 4, Average Loss: 1.5587
Epoch 5, Average Loss: 1.4574
Epoch 6, Average Loss: 1.3592
Epoch 7, Average Loss: 1.2655
Epoch 8, Average Loss: 1.1755
Epoch 9, Average Loss: 1.0903
Epoch 10, Average Loss: 1.0085
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 23.0769

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.1527
Epoch 2, Average Loss: 1.0649
Epoch 3, Average Loss: 0.9789
Epoch 4, Average Loss: 0.8952
Epoch 5, Average Loss: 0.8144
Epoch 6, Average Loss: 0.7390
Epoch 7, Average Loss: 0.6660
Epoch 8, Average Loss: 0.5984
Epoch 9, Average Loss: 0.5357
Epoch 10, Average Loss: 0.4780
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 23.0769

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.6410
Epoch 2, Average Loss: 1.5246
Epoch 3, Average Loss: 1.4145
Epoch 4, Average Loss: 1.3167
Epoch 5, Average Loss: 1.2217
Epoch 6, Average Loss: 1.1307
Epoch 7, Average Loss: 1.0428
Epoch 8, Average Loss: 0.9623
Epoch 9, Average Loss: 0.8824
Epoch 10, Average Loss: 0.8057
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.0482
Coefficient Epoch 2, Average Loss: 1.9197
Coefficient Epoch 3, Average Loss: 1.8011
Coefficient Epoch 4, Average Loss: 1.6951
Coefficient Epoch 5, Average Loss: 1.6048
Coefficient Epoch 6, Average Loss: 1.5337
Coefficient Epoch 7, Average Loss: 1.4850
Coefficient Epoch 8, Average Loss: 1.4609
Coefficient Epoch 9, Average Loss: 1.4604
Coefficient Epoch 10, Average Loss: 1.4781
Final device check:
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33150041103363037, 0.3330172896385193, 0.33548232913017273]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 23.0769
Test Domain: VOC2007, Run 4/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: VOC2007
Training domains: ['LabelMe', 'Caltech101', 'SUN09']
Test domain: VOC2007
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.8474
Epoch 2, Average Loss: 0.1607
Epoch 3, Average Loss: 0.0060
Epoch 4, Average Loss: 0.0031
Epoch 5, Average Loss: 0.0029
Epoch 6, Average Loss: 0.0006
Epoch 7, Average Loss: 0.0005
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on VOC2007: 15.3846
Training domains: ['LabelMe', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.9346
Epoch 2, Average Loss: 1.8283
Epoch 3, Average Loss: 1.7267
Epoch 4, Average Loss: 1.6266
Epoch 5, Average Loss: 1.5307
Epoch 6, Average Loss: 1.4366
Epoch 7, Average Loss: 1.3469
Epoch 8, Average Loss: 1.2612
Epoch 9, Average Loss: 1.1698
Epoch 10, Average Loss: 1.0976
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 15.3846

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 2.0355
Epoch 2, Average Loss: 1.9111
Epoch 3, Average Loss: 1.7964
Epoch 4, Average Loss: 1.6832
Epoch 5, Average Loss: 1.5714
Epoch 6, Average Loss: 1.4608
Epoch 7, Average Loss: 1.3506
Epoch 8, Average Loss: 1.2467
Epoch 9, Average Loss: 1.1538
Epoch 10, Average Loss: 1.0584
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 23.0769

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.7915
Epoch 2, Average Loss: 1.6659
Epoch 3, Average Loss: 1.5714
Epoch 4, Average Loss: 1.4663
Epoch 5, Average Loss: 1.3655
Epoch 6, Average Loss: 1.2603
Epoch 7, Average Loss: 1.1767
Epoch 8, Average Loss: 1.0964
Epoch 9, Average Loss: 1.0196
Epoch 10, Average Loss: 0.9456
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.0238
Coefficient Epoch 2, Average Loss: 2.7858
Coefficient Epoch 3, Average Loss: 2.5563
Coefficient Epoch 4, Average Loss: 2.3377
Coefficient Epoch 5, Average Loss: 2.1336
Coefficient Epoch 6, Average Loss: 1.9489
Coefficient Epoch 7, Average Loss: 1.7906
Coefficient Epoch 8, Average Loss: 1.6673
Coefficient Epoch 9, Average Loss: 1.5883
Coefficient Epoch 10, Average Loss: 1.5586
Final device check:
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33160653710365295, 0.3328016400337219, 0.3355918228626251]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 15.3846
Test Domain: VOC2007, Run 5/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.3983
Epoch 2, Average Loss: 0.0608
Epoch 3, Average Loss: 0.0037
Epoch 4, Average Loss: 0.0009
Epoch 5, Average Loss: 0.0004
Epoch 6, Average Loss: 0.0003
Epoch 7, Average Loss: 0.0002
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on Caltech101: 69.2308
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.9092
Epoch 2, Average Loss: 1.7890
Epoch 3, Average Loss: 1.6756
Epoch 4, Average Loss: 1.5658
Epoch 5, Average Loss: 1.4634
Epoch 6, Average Loss: 1.3640
Epoch 7, Average Loss: 1.2699
Epoch 8, Average Loss: 1.1829
Epoch 9, Average Loss: 1.1004
Epoch 10, Average Loss: 1.0211
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 61.5385

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.9030
Epoch 2, Average Loss: 1.7699
Epoch 3, Average Loss: 1.6439
Epoch 4, Average Loss: 1.5198
Epoch 5, Average Loss: 1.4039
Epoch 6, Average Loss: 1.2861
Epoch 7, Average Loss: 1.1772
Epoch 8, Average Loss: 1.0746
Epoch 9, Average Loss: 0.9774
Epoch 10, Average Loss: 0.8835
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 61.5385

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.7981
Epoch 2, Average Loss: 1.6751
Epoch 3, Average Loss: 1.5605
Epoch 4, Average Loss: 1.4486
Epoch 5, Average Loss: 1.3413
Epoch 6, Average Loss: 1.2410
Epoch 7, Average Loss: 1.1448
Epoch 8, Average Loss: 1.0576
Epoch 9, Average Loss: 0.9736
Epoch 10, Average Loss: 0.8932
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 61.5385

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.6750
Coefficient Epoch 2, Average Loss: 1.5771
Coefficient Epoch 3, Average Loss: 1.4883
Coefficient Epoch 4, Average Loss: 1.4112
Coefficient Epoch 5, Average Loss: 1.3490
Coefficient Epoch 6, Average Loss: 1.3055
Coefficient Epoch 7, Average Loss: 1.2839
Coefficient Epoch 8, Average Loss: 1.2847
Coefficient Epoch 9, Average Loss: 1.3022
Coefficient Epoch 10, Average Loss: 1.3240
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.315995991230011, 0.3580058217048645, 0.32599812746047974]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 61.5385
Test Domain: Caltech101, Run 1/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: VOC2007
Training domains: ['LabelMe', 'Caltech101', 'SUN09']
Test domain: VOC2007
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.2419
Epoch 2, Average Loss: 0.4087
Epoch 3, Average Loss: 0.0191
Epoch 4, Average Loss: 0.0061
Epoch 5, Average Loss: 0.0050
Epoch 6, Average Loss: 0.0027
Epoch 7, Average Loss: 0.0013
Epoch 8, Average Loss: 0.0008
Epoch 9, Average Loss: 0.0006
Epoch 10, Average Loss: 0.0005
Accuracy of naive model on VOC2007: 30.7692
Training domains: ['LabelMe', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.8858
Epoch 2, Average Loss: 1.7721
Epoch 3, Average Loss: 1.6663
Epoch 4, Average Loss: 1.5661
Epoch 5, Average Loss: 1.4706
Epoch 6, Average Loss: 1.3793
Epoch 7, Average Loss: 1.2957
Epoch 8, Average Loss: 1.2135
Epoch 9, Average Loss: 1.1517
Epoch 10, Average Loss: 1.0738
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 23.0769

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.9226
Epoch 2, Average Loss: 1.7890
Epoch 3, Average Loss: 1.6808
Epoch 4, Average Loss: 1.5751
Epoch 5, Average Loss: 1.4711
Epoch 6, Average Loss: 1.3662
Epoch 7, Average Loss: 1.2602
Epoch 8, Average Loss: 1.1595
Epoch 9, Average Loss: 1.0577
Epoch 10, Average Loss: 0.9637
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 30.7692

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 2.0910
Epoch 2, Average Loss: 1.9509
Epoch 3, Average Loss: 1.8148
Epoch 4, Average Loss: 1.6936
Epoch 5, Average Loss: 1.5758
Epoch 6, Average Loss: 1.4639
Epoch 7, Average Loss: 1.3570
Epoch 8, Average Loss: 1.2580
Epoch 9, Average Loss: 1.1619
Epoch 10, Average Loss: 1.0706
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 30.7692

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.8455
Coefficient Epoch 2, Average Loss: 3.5399
Coefficient Epoch 3, Average Loss: 3.2416
Coefficient Epoch 4, Average Loss: 2.9526
Coefficient Epoch 5, Average Loss: 2.6760
Coefficient Epoch 6, Average Loss: 2.4161
Coefficient Epoch 7, Average Loss: 2.1790
Coefficient Epoch 8, Average Loss: 1.9731
Coefficient Epoch 9, Average Loss: 1.8080
Coefficient Epoch 10, Average Loss: 1.6907
Final device check:
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33272886276245117, 0.33473238348960876, 0.3325387239456177]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 23.0769
Test Domain: Caltech101, Run 2/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: VOC2007
Training domains: ['LabelMe', 'Caltech101', 'SUN09']
Test domain: VOC2007
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.6809
Epoch 2, Average Loss: 0.1340
Epoch 3, Average Loss: 0.0161
Epoch 4, Average Loss: 0.0026
Epoch 5, Average Loss: 0.0012
Epoch 6, Average Loss: 0.0010
Epoch 7, Average Loss: 0.0009
Epoch 8, Average Loss: 0.0007
Epoch 9, Average Loss: 0.0006
Epoch 10, Average Loss: 0.0005
Accuracy of naive model on VOC2007: 53.8462
Training domains: ['LabelMe', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 2.1590
Epoch 2, Average Loss: 2.0320
Epoch 3, Average Loss: 1.9107
Epoch 4, Average Loss: 1.7931
Epoch 5, Average Loss: 1.6794
Epoch 6, Average Loss: 1.5699
Epoch 7, Average Loss: 1.4674
Epoch 8, Average Loss: 1.3677
Epoch 9, Average Loss: 1.2759
Epoch 10, Average Loss: 1.1889
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 7.6923

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.5519
Epoch 2, Average Loss: 1.4337
Epoch 3, Average Loss: 1.3293
Epoch 4, Average Loss: 1.2290
Epoch 5, Average Loss: 1.1338
Epoch 6, Average Loss: 1.0407
Epoch 7, Average Loss: 0.9544
Epoch 8, Average Loss: 0.8685
Epoch 9, Average Loss: 0.7895
Epoch 10, Average Loss: 0.7164
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 23.0769

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 2.1506
Epoch 2, Average Loss: 2.0107
Epoch 3, Average Loss: 1.8742
Epoch 4, Average Loss: 1.7440
Epoch 5, Average Loss: 1.6205
Epoch 6, Average Loss: 1.5031
Epoch 7, Average Loss: 1.3919
Epoch 8, Average Loss: 1.2901
Epoch 9, Average Loss: 1.1900
Epoch 10, Average Loss: 1.1005
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 23.0769

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.2276
Coefficient Epoch 2, Average Loss: 2.0994
Coefficient Epoch 3, Average Loss: 1.9778
Coefficient Epoch 4, Average Loss: 1.8643
Coefficient Epoch 5, Average Loss: 1.7612
Coefficient Epoch 6, Average Loss: 1.6715
Coefficient Epoch 7, Average Loss: 1.5990
Coefficient Epoch 8, Average Loss: 1.5480
Coefficient Epoch 9, Average Loss: 1.5225
Coefficient Epoch 10, Average Loss: 1.5242
Final device check:
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.329961359500885, 0.34034237265586853, 0.32969629764556885]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 15.3846
Test Domain: Caltech101, Run 3/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.7764
Epoch 2, Average Loss: 0.1424
Epoch 3, Average Loss: 0.0031
Epoch 4, Average Loss: 0.0012
Epoch 5, Average Loss: 0.0009
Epoch 6, Average Loss: 0.0005
Epoch 7, Average Loss: 0.0002
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on Caltech101: 61.5385
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.4674
Epoch 2, Average Loss: 1.3703
Epoch 3, Average Loss: 1.2770
Epoch 4, Average Loss: 1.1870
Epoch 5, Average Loss: 1.1019
Epoch 6, Average Loss: 1.0198
Epoch 7, Average Loss: 0.9413
Epoch 8, Average Loss: 0.8680
Epoch 9, Average Loss: 0.7964
Epoch 10, Average Loss: 0.7303
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 46.1538

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.5810
Epoch 2, Average Loss: 1.4641
Epoch 3, Average Loss: 1.3509
Epoch 4, Average Loss: 1.2334
Epoch 5, Average Loss: 1.1323
Epoch 6, Average Loss: 1.0379
Epoch 7, Average Loss: 0.9487
Epoch 8, Average Loss: 0.8624
Epoch 9, Average Loss: 0.7800
Epoch 10, Average Loss: 0.7022
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 38.4615

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.8481
Epoch 2, Average Loss: 1.7234
Epoch 3, Average Loss: 1.6042
Epoch 4, Average Loss: 1.4948
Epoch 5, Average Loss: 1.3912
Epoch 6, Average Loss: 1.2917
Epoch 7, Average Loss: 1.1973
Epoch 8, Average Loss: 1.1056
Epoch 9, Average Loss: 1.0202
Epoch 10, Average Loss: 0.9399
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 46.1538

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.5858
Coefficient Epoch 2, Average Loss: 2.4101
Coefficient Epoch 3, Average Loss: 2.2426
Coefficient Epoch 4, Average Loss: 2.0854
Coefficient Epoch 5, Average Loss: 1.9415
Coefficient Epoch 6, Average Loss: 1.8143
Coefficient Epoch 7, Average Loss: 1.7084
Coefficient Epoch 8, Average Loss: 1.6285
Coefficient Epoch 9, Average Loss: 1.5790
Coefficient Epoch 10, Average Loss: 1.5618
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3280591666698456, 0.3368361294269562, 0.33510467410087585]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 46.1538
Test Domain: Caltech101, Run 4/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Training domains: ['VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9014
Epoch 2, Average Loss: 0.2250
Epoch 3, Average Loss: 0.0195
Epoch 4, Average Loss: 0.0054
Epoch 5, Average Loss: 0.0019
Epoch 6, Average Loss: 0.0010
Epoch 7, Average Loss: 0.0007
Epoch 8, Average Loss: 0.0005
Epoch 9, Average Loss: 0.0003
Epoch 10, Average Loss: 0.0002
Accuracy of naive model on LabelMe: 38.4615
Training domains: ['VOC2007', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 2.3494
Epoch 2, Average Loss: 2.2034
Epoch 3, Average Loss: 2.0638
Epoch 4, Average Loss: 1.9285
Epoch 5, Average Loss: 1.7932
Epoch 6, Average Loss: 1.6644
Epoch 7, Average Loss: 1.5374
Epoch 8, Average Loss: 1.4001
Epoch 9, Average Loss: 1.2898
Epoch 10, Average Loss: 1.1800
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 15.3846

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 2.0046
Epoch 2, Average Loss: 1.8757
Epoch 3, Average Loss: 1.7577
Epoch 4, Average Loss: 1.6400
Epoch 5, Average Loss: 1.5255
Epoch 6, Average Loss: 1.4203
Epoch 7, Average Loss: 1.3203
Epoch 8, Average Loss: 1.2206
Epoch 9, Average Loss: 1.1259
Epoch 10, Average Loss: 1.0370
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 15.3846

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.8211
Epoch 2, Average Loss: 1.6968
Epoch 3, Average Loss: 1.5685
Epoch 4, Average Loss: 1.4498
Epoch 5, Average Loss: 1.3450
Epoch 6, Average Loss: 1.2473
Epoch 7, Average Loss: 1.1529
Epoch 8, Average Loss: 1.0616
Epoch 9, Average Loss: 0.9778
Epoch 10, Average Loss: 0.8987
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.2435
Coefficient Epoch 2, Average Loss: 2.9915
Coefficient Epoch 3, Average Loss: 2.7462
Coefficient Epoch 4, Average Loss: 2.5096
Coefficient Epoch 5, Average Loss: 2.2849
Coefficient Epoch 6, Average Loss: 2.0768
Coefficient Epoch 7, Average Loss: 1.8923
Coefficient Epoch 8, Average Loss: 1.7416
Coefficient Epoch 9, Average Loss: 1.6369
Coefficient Epoch 10, Average Loss: 1.5874
Final device check:
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33254653215408325, 0.3329412639141083, 0.3345121741294861]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 15.3846
Test Domain: Caltech101, Run 5/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: VOC2007
Training domains: ['LabelMe', 'Caltech101', 'SUN09']
Test domain: VOC2007
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9790
Epoch 2, Average Loss: 0.2630
Epoch 3, Average Loss: 0.0077
Epoch 4, Average Loss: 0.0046
Epoch 5, Average Loss: 0.0030
Epoch 6, Average Loss: 0.0015
Epoch 7, Average Loss: 0.0006
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0002
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on VOC2007: 61.5385
Training domains: ['LabelMe', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.8784
Epoch 2, Average Loss: 1.7646
Epoch 3, Average Loss: 1.6542
Epoch 4, Average Loss: 1.5471
Epoch 5, Average Loss: 1.4435
Epoch 6, Average Loss: 1.3434
Epoch 7, Average Loss: 1.2480
Epoch 8, Average Loss: 1.1579
Epoch 9, Average Loss: 1.0723
Epoch 10, Average Loss: 0.9929
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 38.4615

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.9351
Epoch 2, Average Loss: 1.8089
Epoch 3, Average Loss: 1.6955
Epoch 4, Average Loss: 1.5831
Epoch 5, Average Loss: 1.4742
Epoch 6, Average Loss: 1.3677
Epoch 7, Average Loss: 1.2640
Epoch 8, Average Loss: 1.1615
Epoch 9, Average Loss: 1.0656
Epoch 10, Average Loss: 0.9705
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 38.4615

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.7363
Epoch 2, Average Loss: 1.6121
Epoch 3, Average Loss: 1.4930
Epoch 4, Average Loss: 1.3765
Epoch 5, Average Loss: 1.2664
Epoch 6, Average Loss: 1.1617
Epoch 7, Average Loss: 1.0657
Epoch 8, Average Loss: 0.9776
Epoch 9, Average Loss: 0.8956
Epoch 10, Average Loss: 0.8221
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 38.4615

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.8916
Coefficient Epoch 2, Average Loss: 2.6991
Coefficient Epoch 3, Average Loss: 2.5138
Coefficient Epoch 4, Average Loss: 2.3377
Coefficient Epoch 5, Average Loss: 2.1730
Coefficient Epoch 6, Average Loss: 2.0228
Coefficient Epoch 7, Average Loss: 1.8908
Coefficient Epoch 8, Average Loss: 1.7811
Coefficient Epoch 9, Average Loss: 1.6973
Coefficient Epoch 10, Average Loss: 1.6414
Final device check:
Expert model LabelMe device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33060532808303833, 0.33754631876945496, 0.3318483829498291]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 38.4615
Test Domain: SUN09, Run 1/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Training domains: ['VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.0897
Epoch 2, Average Loss: 0.7528
Epoch 3, Average Loss: 0.1755
Epoch 4, Average Loss: 0.0163
Epoch 5, Average Loss: 0.0045
Epoch 6, Average Loss: 0.0027
Epoch 7, Average Loss: 0.0017
Epoch 8, Average Loss: 0.0010
Epoch 9, Average Loss: 0.0006
Epoch 10, Average Loss: 0.0004
Accuracy of naive model on LabelMe: 23.0769
Training domains: ['VOC2007', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.7152
Epoch 2, Average Loss: 1.5817
Epoch 3, Average Loss: 1.4728
Epoch 4, Average Loss: 1.3662
Epoch 5, Average Loss: 1.2636
Epoch 6, Average Loss: 1.1598
Epoch 7, Average Loss: 1.0672
Epoch 8, Average Loss: 0.9804
Epoch 9, Average Loss: 0.8966
Epoch 10, Average Loss: 0.8143
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 23.0769

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.9643
Epoch 2, Average Loss: 1.8434
Epoch 3, Average Loss: 1.7298
Epoch 4, Average Loss: 1.6180
Epoch 5, Average Loss: 1.5065
Epoch 6, Average Loss: 1.3969
Epoch 7, Average Loss: 1.2909
Epoch 8, Average Loss: 1.1890
Epoch 9, Average Loss: 1.0913
Epoch 10, Average Loss: 0.9945
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 23.0769

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.7149
Epoch 2, Average Loss: 1.5906
Epoch 3, Average Loss: 1.4752
Epoch 4, Average Loss: 1.3654
Epoch 5, Average Loss: 1.2572
Epoch 6, Average Loss: 1.1601
Epoch 7, Average Loss: 1.0687
Epoch 8, Average Loss: 0.9820
Epoch 9, Average Loss: 0.9031
Epoch 10, Average Loss: 0.8264
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.6397
Coefficient Epoch 2, Average Loss: 3.3471
Coefficient Epoch 3, Average Loss: 3.0627
Coefficient Epoch 4, Average Loss: 2.7888
Coefficient Epoch 5, Average Loss: 2.5282
Coefficient Epoch 6, Average Loss: 2.2853
Coefficient Epoch 7, Average Loss: 2.0662
Coefficient Epoch 8, Average Loss: 1.8803
Coefficient Epoch 9, Average Loss: 1.7388
Coefficient Epoch 10, Average Loss: 1.6500
Final device check:
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3333943486213684, 0.33322858810424805, 0.33337700366973877]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 15.3846
Test Domain: SUN09, Run 2/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1243
Epoch 2, Average Loss: 0.2133
Epoch 3, Average Loss: 0.0031
Epoch 4, Average Loss: 0.0017
Epoch 5, Average Loss: 0.0020
Epoch 6, Average Loss: 0.0020
Epoch 7, Average Loss: 0.0010
Epoch 8, Average Loss: 0.0007
Epoch 9, Average Loss: 0.0006
Epoch 10, Average Loss: 0.0003
Accuracy of naive model on Caltech101: 92.3077
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 1.9177
Epoch 2, Average Loss: 1.8050
Epoch 3, Average Loss: 1.6958
Epoch 4, Average Loss: 1.5888
Epoch 5, Average Loss: 1.4856
Epoch 6, Average Loss: 1.3840
Epoch 7, Average Loss: 1.2880
Epoch 8, Average Loss: 1.1931
Epoch 9, Average Loss: 1.1013
Epoch 10, Average Loss: 1.0135
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 7.6923

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 2.2685
Epoch 2, Average Loss: 2.1284
Epoch 3, Average Loss: 1.9864
Epoch 4, Average Loss: 1.8625
Epoch 5, Average Loss: 1.7411
Epoch 6, Average Loss: 1.6187
Epoch 7, Average Loss: 1.5002
Epoch 8, Average Loss: 1.3859
Epoch 9, Average Loss: 1.2784
Epoch 10, Average Loss: 1.1714
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 0.0000

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 2.2097
Epoch 2, Average Loss: 2.0774
Epoch 3, Average Loss: 1.9474
Epoch 4, Average Loss: 1.8202
Epoch 5, Average Loss: 1.6913
Epoch 6, Average Loss: 1.5732
Epoch 7, Average Loss: 1.4583
Epoch 8, Average Loss: 1.3469
Epoch 9, Average Loss: 1.2402
Epoch 10, Average Loss: 1.1376
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 7.6923

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.4386
Coefficient Epoch 2, Average Loss: 3.1825
Coefficient Epoch 3, Average Loss: 2.9341
Coefficient Epoch 4, Average Loss: 2.6954
Coefficient Epoch 5, Average Loss: 2.4689
Coefficient Epoch 6, Average Loss: 2.2582
Coefficient Epoch 7, Average Loss: 2.0677
Coefficient Epoch 8, Average Loss: 1.9027
Coefficient Epoch 9, Average Loss: 1.7692
Coefficient Epoch 10, Average Loss: 1.6731
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3320428133010864, 0.3339335024356842, 0.334023654460907]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 7.6923
Test Domain: SUN09, Run 3/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Training domains: ['VOC2007', 'Caltech101', 'SUN09']
Test domain: LabelMe
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.9483
Epoch 2, Average Loss: 0.8891
Epoch 3, Average Loss: 0.2549
Epoch 4, Average Loss: 0.0372
Epoch 5, Average Loss: 0.0052
Epoch 6, Average Loss: 0.0029
Epoch 7, Average Loss: 0.0018
Epoch 8, Average Loss: 0.0015
Epoch 9, Average Loss: 0.0013
Epoch 10, Average Loss: 0.0009
Accuracy of naive model on LabelMe: 53.8462
Training domains: ['VOC2007', 'Caltech101', 'SUN09']

Training expert models...

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.9229
Epoch 2, Average Loss: 1.7966
Epoch 3, Average Loss: 1.6754
Epoch 4, Average Loss: 1.5594
Epoch 5, Average Loss: 1.4449
Epoch 6, Average Loss: 1.3355
Epoch 7, Average Loss: 1.2266
Epoch 8, Average Loss: 1.1293
Epoch 9, Average Loss: 1.0340
Epoch 10, Average Loss: 0.9449
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 30.7692

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 1.8963
Epoch 2, Average Loss: 1.7740
Epoch 3, Average Loss: 1.6581
Epoch 4, Average Loss: 1.5463
Epoch 5, Average Loss: 1.4361
Epoch 6, Average Loss: 1.3276
Epoch 7, Average Loss: 1.2221
Epoch 8, Average Loss: 1.1202
Epoch 9, Average Loss: 1.0188
Epoch 10, Average Loss: 0.9227
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 30.7692

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.8695
Epoch 2, Average Loss: 1.7510
Epoch 3, Average Loss: 1.6398
Epoch 4, Average Loss: 1.5327
Epoch 5, Average Loss: 1.4286
Epoch 6, Average Loss: 1.3290
Epoch 7, Average Loss: 1.2349
Epoch 8, Average Loss: 1.1450
Epoch 9, Average Loss: 1.0612
Epoch 10, Average Loss: 0.9808
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 30.7692

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.2033
Coefficient Epoch 2, Average Loss: 2.9761
Coefficient Epoch 3, Average Loss: 2.7562
Coefficient Epoch 4, Average Loss: 2.5455
Coefficient Epoch 5, Average Loss: 2.3463
Coefficient Epoch 6, Average Loss: 2.1617
Coefficient Epoch 7, Average Loss: 1.9958
Coefficient Epoch 8, Average Loss: 1.8538
Coefficient Epoch 9, Average Loss: 1.7412
Coefficient Epoch 10, Average Loss: 1.6623
Final device check:
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33371949195861816, 0.3337467908859253, 0.33253368735313416]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 30.7692
Test Domain: SUN09, Run 4/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: SUN09
Training domains: ['LabelMe', 'VOC2007', 'Caltech101']
Test domain: SUN09
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 2.1108
Epoch 2, Average Loss: 0.2239
Epoch 3, Average Loss: 0.0324
Epoch 4, Average Loss: 0.0035
Epoch 5, Average Loss: 0.0012
Epoch 6, Average Loss: 0.0005
Epoch 7, Average Loss: 0.0003
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on SUN09: 46.1538
Training domains: ['LabelMe', 'VOC2007', 'Caltech101']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 2.1124
Epoch 2, Average Loss: 1.9902
Epoch 3, Average Loss: 1.8725
Epoch 4, Average Loss: 1.7587
Epoch 5, Average Loss: 1.6500
Epoch 6, Average Loss: 1.5460
Epoch 7, Average Loss: 1.4445
Epoch 8, Average Loss: 1.3491
Epoch 9, Average Loss: 1.2549
Epoch 10, Average Loss: 1.1698
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 30.7692

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.8635
Epoch 2, Average Loss: 1.7291
Epoch 3, Average Loss: 1.6083
Epoch 4, Average Loss: 1.4866
Epoch 5, Average Loss: 1.3731
Epoch 6, Average Loss: 1.2645
Epoch 7, Average Loss: 1.1613
Epoch 8, Average Loss: 1.0657
Epoch 9, Average Loss: 0.9741
Epoch 10, Average Loss: 0.8907
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 30.7692

Training model for domain: Caltech101
Training model for domain: Caltech101
Epoch 1, Average Loss: 2.1555
Epoch 2, Average Loss: 2.0053
Epoch 3, Average Loss: 1.8771
Epoch 4, Average Loss: 1.7512
Epoch 5, Average Loss: 1.6308
Epoch 6, Average Loss: 1.5158
Epoch 7, Average Loss: 1.4069
Epoch 8, Average Loss: 1.2989
Epoch 9, Average Loss: 1.1977
Epoch 10, Average Loss: 1.1000
Merged model device: cuda:0
Accuracy of Caltech101 model on test domain: 23.0769

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain Caltech101 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 3.6141
Coefficient Epoch 2, Average Loss: 3.3360
Coefficient Epoch 3, Average Loss: 3.0651
Coefficient Epoch 4, Average Loss: 2.8034
Coefficient Epoch 5, Average Loss: 2.5532
Coefficient Epoch 6, Average Loss: 2.3182
Coefficient Epoch 7, Average Loss: 2.1032
Coefficient Epoch 8, Average Loss: 1.9156
Coefficient Epoch 9, Average Loss: 1.7658
Coefficient Epoch 10, Average Loss: 1.6644
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model Caltech101 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33149951696395874, 0.33525851368904114, 0.33324193954467773]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 23.0769
Test Domain: SUN09, Run 5/5
Preparing data...
Domains: ['LabelMe', 'VOC2007', 'Caltech101', 'SUN09']
Test domain: Caltech101
Training domains: ['LabelMe', 'VOC2007', 'SUN09']
Test domain: Caltech101
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 1.8038
Epoch 2, Average Loss: 0.1002
Epoch 3, Average Loss: 0.0022
Epoch 4, Average Loss: 0.0003
Epoch 5, Average Loss: 0.0002
Epoch 6, Average Loss: 0.0001
Epoch 7, Average Loss: 0.0001
Epoch 8, Average Loss: 0.0001
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0001
Accuracy of naive model on Caltech101: 76.9231
Training domains: ['LabelMe', 'VOC2007', 'SUN09']

Training expert models...

Training model for domain: LabelMe
Training model for domain: LabelMe
Epoch 1, Average Loss: 2.0683
Epoch 2, Average Loss: 1.9552
Epoch 3, Average Loss: 1.8466
Epoch 4, Average Loss: 1.7403
Epoch 5, Average Loss: 1.6363
Epoch 6, Average Loss: 1.5355
Epoch 7, Average Loss: 1.4397
Epoch 8, Average Loss: 1.3441
Epoch 9, Average Loss: 1.2540
Epoch 10, Average Loss: 1.1680
Merged model device: cuda:0
Accuracy of LabelMe model on test domain: 15.3846

Training model for domain: VOC2007
Training model for domain: VOC2007
Epoch 1, Average Loss: 1.7083
Epoch 2, Average Loss: 1.5672
Epoch 3, Average Loss: 1.4412
Epoch 4, Average Loss: 1.3381
Epoch 5, Average Loss: 1.2388
Epoch 6, Average Loss: 1.1424
Epoch 7, Average Loss: 1.0476
Epoch 8, Average Loss: 0.9589
Epoch 9, Average Loss: 0.8778
Epoch 10, Average Loss: 0.7981
Merged model device: cuda:0
Accuracy of VOC2007 model on test domain: 15.3846

Training model for domain: SUN09
Training model for domain: SUN09
Epoch 1, Average Loss: 1.9762
Epoch 2, Average Loss: 1.8548
Epoch 3, Average Loss: 1.7353
Epoch 4, Average Loss: 1.6201
Epoch 5, Average Loss: 1.5078
Epoch 6, Average Loss: 1.4003
Epoch 7, Average Loss: 1.2988
Epoch 8, Average Loss: 1.1982
Epoch 9, Average Loss: 1.1058
Epoch 10, Average Loss: 1.0195
Merged model device: cuda:0
Accuracy of SUN09 model on test domain: 15.3846

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Domain LabelMe - Input device: cuda:0, Model device: cuda:0
Domain VOC2007 - Input device: cuda:0, Model device: cuda:0
Domain SUN09 - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.7888
Coefficient Epoch 2, Average Loss: 2.5825
Coefficient Epoch 3, Average Loss: 2.3861
Coefficient Epoch 4, Average Loss: 2.2024
Coefficient Epoch 5, Average Loss: 2.0355
Coefficient Epoch 6, Average Loss: 1.8897
Coefficient Epoch 7, Average Loss: 1.7701
Coefficient Epoch 8, Average Loss: 1.6807
Coefficient Epoch 9, Average Loss: 1.6234
Coefficient Epoch 10, Average Loss: 1.5963
Final device check:
Expert model LabelMe device: cuda:0
Expert model VOC2007 device: cuda:0
Expert model SUN09 device: cuda:0
Coefficient training complete.
Learned coefficients: [0.32879355549812317, 0.3359336853027344, 0.33527278900146484]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Final model accuracy on test domain: 15.3846
Debug: Type of results: <class 'list'>
Debug: Content of results: [{'test_domain': 'SUN09', 'domain_accuracies': {'LabelMe': 15.384615384615385, 'VOC2007': 15.384615384615385, 'Caltech101': 15.384615384615385}, 'final_accuracy': 15.384615384615385, 'coefficients': [0.3317055106163025, 0.33463457226753235, 0.3336598873138428]}, {'test_domain': 'VOC2007', 'domain_accuracies': {'LabelMe': 23.076923076923077, 'Caltech101': 38.46153846153847, 'SUN09': 30.76923076923077}, 'final_accuracy': 30.76923076923077, 'coefficients': [0.33352333307266235, 0.3333975374698639, 0.33307912945747375]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 7.6923076923076925, 'VOC2007': 7.6923076923076925, 'SUN09': 7.6923076923076925}, 'final_accuracy': 7.6923076923076925, 'coefficients': [0.33282753825187683, 0.3343113660812378, 0.3328610956668854]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 38.46153846153847, 'VOC2007': 46.15384615384615, 'SUN09': 46.15384615384615}, 'final_accuracy': 46.15384615384615, 'coefficients': [0.33297786116600037, 0.334663987159729, 0.33235815167427063]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 23.076923076923077, 'VOC2007': 23.076923076923077, 'SUN09': 23.076923076923077}, 'final_accuracy': 23.076923076923077, 'coefficients': [0.33195024728775024, 0.3344782292842865, 0.3335714638233185]}, {'test_domain': 'LabelMe', 'domain_accuracies': {'VOC2007': 30.76923076923077, 'Caltech101': 30.76923076923077, 'SUN09': 30.76923076923077}, 'final_accuracy': 30.76923076923077, 'coefficients': [0.33445921540260315, 0.3333723545074463, 0.33216843008995056]}, {'test_domain': 'SUN09', 'domain_accuracies': {'LabelMe': 15.384615384615385, 'VOC2007': 7.6923076923076925, 'Caltech101': 15.384615384615385}, 'final_accuracy': 7.6923076923076925, 'coefficients': [0.33283957839012146, 0.33261838555336, 0.33454206585884094]}, {'test_domain': 'LabelMe', 'domain_accuracies': {'VOC2007': 23.076923076923077, 'Caltech101': 23.076923076923077, 'SUN09': 15.384615384615385}, 'final_accuracy': 23.076923076923077, 'coefficients': [0.33150041103363037, 0.3330172896385193, 0.33548232913017273]}, {'test_domain': 'VOC2007', 'domain_accuracies': {'LabelMe': 15.384615384615385, 'Caltech101': 23.076923076923077, 'SUN09': 15.384615384615385}, 'final_accuracy': 15.384615384615385, 'coefficients': [0.33160653710365295, 0.3328016400337219, 0.3355918228626251]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 61.53846153846154, 'VOC2007': 61.53846153846154, 'SUN09': 61.53846153846154}, 'final_accuracy': 61.53846153846154, 'coefficients': [0.315995991230011, 0.3580058217048645, 0.32599812746047974]}, {'test_domain': 'VOC2007', 'domain_accuracies': {'LabelMe': 23.076923076923077, 'Caltech101': 30.76923076923077, 'SUN09': 30.76923076923077}, 'final_accuracy': 23.076923076923077, 'coefficients': [0.33272886276245117, 0.33473238348960876, 0.3325387239456177]}, {'test_domain': 'VOC2007', 'domain_accuracies': {'LabelMe': 7.6923076923076925, 'Caltech101': 23.076923076923077, 'SUN09': 23.076923076923077}, 'final_accuracy': 15.384615384615385, 'coefficients': [0.329961359500885, 0.34034237265586853, 0.32969629764556885]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 46.15384615384615, 'VOC2007': 38.46153846153847, 'SUN09': 46.15384615384615}, 'final_accuracy': 46.15384615384615, 'coefficients': [0.3280591666698456, 0.3368361294269562, 0.33510467410087585]}, {'test_domain': 'LabelMe', 'domain_accuracies': {'VOC2007': 15.384615384615385, 'Caltech101': 15.384615384615385, 'SUN09': 15.384615384615385}, 'final_accuracy': 15.384615384615385, 'coefficients': [0.33254653215408325, 0.3329412639141083, 0.3345121741294861]}, {'test_domain': 'VOC2007', 'domain_accuracies': {'LabelMe': 38.46153846153847, 'Caltech101': 38.46153846153847, 'SUN09': 38.46153846153847}, 'final_accuracy': 38.46153846153847, 'coefficients': [0.33060532808303833, 0.33754631876945496, 0.3318483829498291]}, {'test_domain': 'LabelMe', 'domain_accuracies': {'VOC2007': 23.076923076923077, 'Caltech101': 23.076923076923077, 'SUN09': 15.384615384615385}, 'final_accuracy': 15.384615384615385, 'coefficients': [0.3333943486213684, 0.33322858810424805, 0.33337700366973877]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 7.6923076923076925, 'VOC2007': 0.0, 'SUN09': 7.6923076923076925}, 'final_accuracy': 7.6923076923076925, 'coefficients': [0.3320428133010864, 0.3339335024356842, 0.334023654460907]}, {'test_domain': 'LabelMe', 'domain_accuracies': {'VOC2007': 30.76923076923077, 'Caltech101': 30.76923076923077, 'SUN09': 30.76923076923077}, 'final_accuracy': 30.76923076923077, 'coefficients': [0.33371949195861816, 0.3337467908859253, 0.33253368735313416]}, {'test_domain': 'SUN09', 'domain_accuracies': {'LabelMe': 30.76923076923077, 'VOC2007': 30.76923076923077, 'Caltech101': 23.076923076923077}, 'final_accuracy': 23.076923076923077, 'coefficients': [0.33149951696395874, 0.33525851368904114, 0.33324193954467773]}, {'test_domain': 'Caltech101', 'domain_accuracies': {'LabelMe': 15.384615384615385, 'VOC2007': 15.384615384615385, 'SUN09': 15.384615384615385}, 'final_accuracy': 15.384615384615385, 'coefficients': [0.32879355549812317, 0.3359336853027344, 0.33527278900146484]}]
Final Model Accuracy: 24.6154  14.1002
Domain-specific Accuracies:
  LabelMe: 24.6154  15.1781
  VOC2007: 24.6154  15.4358
  Caltech101: 25.4438  7.6237
  SUN09: 26.6968  14.4796
Average Coefficients:
  Coefficient 1: 0.3311  0.0038
  Coefficient 2: 0.3358  0.0054
  Coefficient 3: 0.3331  0.0021
Running experiments for dataset: OfficeHome
