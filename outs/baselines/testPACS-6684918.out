
--- Run 1/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: art_painting
Train domains: ['cartoon', 'sketch', 'photo']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.2132, Train Accuracy: 0.00%
Val Loss: 2.1982, Val Accuracy: 20.63%
Epoch 2/10, Train Loss: 0.8417, Train Accuracy: 85.71%
Val Loss: 2.2118, Val Accuracy: 17.46%
Epoch 3/10, Train Loss: 0.3634, Train Accuracy: 100.00%
Val Loss: 2.2441, Val Accuracy: 17.46%
Epoch 4/10, Train Loss: 0.1702, Train Accuracy: 100.00%
Val Loss: 2.2808, Val Accuracy: 17.46%
Epoch 5/10, Train Loss: 0.0793, Train Accuracy: 100.00%
Val Loss: 2.3235, Val Accuracy: 17.46%
Epoch 6/10, Train Loss: 0.0389, Train Accuracy: 100.00%
Val Loss: 2.3670, Val Accuracy: 15.87%
Epoch 7/10, Train Loss: 0.0174, Train Accuracy: 100.00%
Val Loss: 2.4119, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 0.0092, Train Accuracy: 100.00%
Val Loss: 2.4551, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 0.0053, Train Accuracy: 100.00%
Val Loss: 2.4963, Val Accuracy: 20.63%
Epoch 10/10, Train Loss: 0.0033, Train Accuracy: 100.00%
Val Loss: 2.5344, Val Accuracy: 20.63%
Baseline Model - Final Test Loss: 2.1982, Test Accuracy: 20.63%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3655, Train Accuracy: 12.50%
Val Loss: 2.3466, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.1549, Train Accuracy: 14.29%
Val Loss: 2.2409, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.9903, Train Accuracy: 16.07%
Val Loss: 2.1743, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 1.8642, Train Accuracy: 16.07%
Val Loss: 2.1146, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 1.7229, Train Accuracy: 26.79%
Val Loss: 2.0609, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.6114, Train Accuracy: 32.14%
Val Loss: 2.0138, Val Accuracy: 21.43%
Epoch 7/10, Train Loss: 1.4989, Train Accuracy: 41.07%
Val Loss: 1.9634, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.3834, Train Accuracy: 51.79%
Val Loss: 1.9261, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.2773, Train Accuracy: 60.71%
Val Loss: 1.8936, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.1561, Train Accuracy: 76.79%
Val Loss: 1.8695, Val Accuracy: 28.57%
cartoon adapter trained. Validation Accuracy: 28.57%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.1713, Train Accuracy: 23.21%
Val Loss: 1.5584, Val Accuracy: 42.86%
Epoch 2/10, Train Loss: 1.9343, Train Accuracy: 25.00%
Val Loss: 1.4624, Val Accuracy: 50.00%
Epoch 3/10, Train Loss: 1.7695, Train Accuracy: 35.71%
Val Loss: 1.3952, Val Accuracy: 64.29%
Epoch 4/10, Train Loss: 1.6247, Train Accuracy: 37.50%
Val Loss: 1.3572, Val Accuracy: 57.14%
Epoch 5/10, Train Loss: 1.5337, Train Accuracy: 39.29%
Val Loss: 1.3149, Val Accuracy: 57.14%
Epoch 6/10, Train Loss: 1.4324, Train Accuracy: 51.79%
Val Loss: 1.2735, Val Accuracy: 64.29%
Epoch 7/10, Train Loss: 1.3497, Train Accuracy: 53.57%
Val Loss: 1.2235, Val Accuracy: 64.29%
Epoch 8/10, Train Loss: 1.2687, Train Accuracy: 58.93%
Val Loss: 1.1677, Val Accuracy: 71.43%
Epoch 9/10, Train Loss: 1.1817, Train Accuracy: 67.86%
Val Loss: 1.1047, Val Accuracy: 71.43%
Epoch 10/10, Train Loss: 1.0841, Train Accuracy: 69.64%
Val Loss: 1.0378, Val Accuracy: 64.29%
sketch adapter trained. Validation Accuracy: 71.43%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 1.9413, Train Accuracy: 28.57%
Val Loss: 1.6302, Val Accuracy: 50.00%
Epoch 2/10, Train Loss: 1.7683, Train Accuracy: 32.14%
Val Loss: 1.5517, Val Accuracy: 57.14%
Epoch 3/10, Train Loss: 1.6112, Train Accuracy: 37.50%
Val Loss: 1.4761, Val Accuracy: 64.29%
Epoch 4/10, Train Loss: 1.4868, Train Accuracy: 48.21%
Val Loss: 1.4018, Val Accuracy: 64.29%
Epoch 5/10, Train Loss: 1.3351, Train Accuracy: 53.57%
Val Loss: 1.3293, Val Accuracy: 71.43%
Epoch 6/10, Train Loss: 1.2054, Train Accuracy: 71.43%
Val Loss: 1.2585, Val Accuracy: 71.43%
Epoch 7/10, Train Loss: 1.0835, Train Accuracy: 80.36%
Val Loss: 1.1885, Val Accuracy: 71.43%
Epoch 8/10, Train Loss: 0.9571, Train Accuracy: 83.93%
Val Loss: 1.1170, Val Accuracy: 78.57%
Epoch 9/10, Train Loss: 0.8579, Train Accuracy: 87.50%
Val Loss: 1.0460, Val Accuracy: 78.57%
Epoch 10/10, Train Loss: 0.7546, Train Accuracy: 92.86%
Val Loss: 0.9754, Val Accuracy: 92.86%
photo adapter trained. Validation Accuracy: 92.86%

Training coefficients for adapter merging
Initial coefficients: [0.33517542 0.3314434  0.33338118]
Epoch 1, Loss: 1.7370, Accuracy: 28.57%
Coefficients: [0.12536208 0.74994344 0.12469452]
Epoch 2, Loss: 1.7353, Accuracy: 28.57%
Coefficients: [0.07299925 0.85592926 0.07107155]
Epoch 3, Loss: 1.7352, Accuracy: 28.57%
Coefficients: [0.05967415 0.88324827 0.05707764]
Epoch 4, Loss: 1.7376, Accuracy: 28.57%
Coefficients: [0.0550501  0.89273846 0.05221143]
Epoch 5, Loss: 1.7398, Accuracy: 28.57%
Coefficients: [0.05344592 0.8956445  0.05090958]
Epoch 6, Loss: 1.7388, Accuracy: 28.57%
Coefficients: [0.05276781 0.896707   0.05052513]
Epoch 7, Loss: 1.7369, Accuracy: 28.57%
Coefficients: [0.05247989 0.89692044 0.05059973]
Epoch 8, Loss: 1.7393, Accuracy: 28.57%
Coefficients: [0.05237657 0.89703435 0.05058903]
Epoch 9, Loss: 1.7355, Accuracy: 28.57%
Coefficients: [0.05231808 0.89713264 0.05054929]
Epoch 10, Loss: 1.7355, Accuracy: 28.57%
Coefficients: [0.05228728 0.8971708  0.05054187]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.12536208 0.74994344 0.12469452]

Merged model - Test Loss: 1.5006, Test Accuracy: 55.56%

--- Run 2/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: art_painting
Train domains: ['cartoon', 'sketch', 'photo']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.2132, Train Accuracy: 0.00%
Val Loss: 2.1982, Val Accuracy: 20.63%
Epoch 2/10, Train Loss: 0.8417, Train Accuracy: 85.71%
Val Loss: 2.2118, Val Accuracy: 17.46%
Epoch 3/10, Train Loss: 0.3634, Train Accuracy: 100.00%
Val Loss: 2.2441, Val Accuracy: 17.46%
Epoch 4/10, Train Loss: 0.1702, Train Accuracy: 100.00%
Val Loss: 2.2808, Val Accuracy: 17.46%
Epoch 5/10, Train Loss: 0.0793, Train Accuracy: 100.00%
Val Loss: 2.3235, Val Accuracy: 17.46%
Epoch 6/10, Train Loss: 0.0389, Train Accuracy: 100.00%
Val Loss: 2.3670, Val Accuracy: 15.87%
Epoch 7/10, Train Loss: 0.0174, Train Accuracy: 100.00%
Val Loss: 2.4119, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 0.0092, Train Accuracy: 100.00%
Val Loss: 2.4551, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 0.0053, Train Accuracy: 100.00%
Val Loss: 2.4963, Val Accuracy: 20.63%
Epoch 10/10, Train Loss: 0.0033, Train Accuracy: 100.00%
Val Loss: 2.5344, Val Accuracy: 20.63%
Baseline Model - Final Test Loss: 2.1982, Test Accuracy: 20.63%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3655, Train Accuracy: 12.50%
Val Loss: 2.3466, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.1549, Train Accuracy: 14.29%
Val Loss: 2.2409, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.9903, Train Accuracy: 16.07%
Val Loss: 2.1743, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 1.8642, Train Accuracy: 16.07%
Val Loss: 2.1146, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 1.7229, Train Accuracy: 26.79%
Val Loss: 2.0609, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.6114, Train Accuracy: 32.14%
Val Loss: 2.0138, Val Accuracy: 21.43%
Epoch 7/10, Train Loss: 1.4989, Train Accuracy: 41.07%
Val Loss: 1.9634, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.3834, Train Accuracy: 51.79%
Val Loss: 1.9261, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.2773, Train Accuracy: 60.71%
Val Loss: 1.8936, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.1561, Train Accuracy: 76.79%
Val Loss: 1.8695, Val Accuracy: 28.57%
cartoon adapter trained. Validation Accuracy: 28.57%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.1713, Train Accuracy: 23.21%
Val Loss: 1.5584, Val Accuracy: 42.86%
Epoch 2/10, Train Loss: 1.9343, Train Accuracy: 25.00%
Val Loss: 1.4624, Val Accuracy: 50.00%
Epoch 3/10, Train Loss: 1.7695, Train Accuracy: 35.71%
Val Loss: 1.3952, Val Accuracy: 64.29%
Epoch 4/10, Train Loss: 1.6247, Train Accuracy: 37.50%
Val Loss: 1.3572, Val Accuracy: 57.14%
Epoch 5/10, Train Loss: 1.5337, Train Accuracy: 39.29%
Val Loss: 1.3149, Val Accuracy: 57.14%
Epoch 6/10, Train Loss: 1.4324, Train Accuracy: 51.79%
Val Loss: 1.2735, Val Accuracy: 64.29%
Epoch 7/10, Train Loss: 1.3497, Train Accuracy: 53.57%
Val Loss: 1.2235, Val Accuracy: 64.29%
Epoch 8/10, Train Loss: 1.2687, Train Accuracy: 58.93%
Val Loss: 1.1677, Val Accuracy: 71.43%
Epoch 9/10, Train Loss: 1.1817, Train Accuracy: 67.86%
Val Loss: 1.1047, Val Accuracy: 71.43%
Epoch 10/10, Train Loss: 1.0841, Train Accuracy: 69.64%
Val Loss: 1.0378, Val Accuracy: 64.29%
sketch adapter trained. Validation Accuracy: 71.43%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 1.9413, Train Accuracy: 28.57%
Val Loss: 1.6302, Val Accuracy: 50.00%
Epoch 2/10, Train Loss: 1.7683, Train Accuracy: 32.14%
Val Loss: 1.5517, Val Accuracy: 57.14%
Epoch 3/10, Train Loss: 1.6112, Train Accuracy: 37.50%
Val Loss: 1.4761, Val Accuracy: 64.29%
Epoch 4/10, Train Loss: 1.4868, Train Accuracy: 48.21%
Val Loss: 1.4018, Val Accuracy: 64.29%
Epoch 5/10, Train Loss: 1.3351, Train Accuracy: 53.57%
Val Loss: 1.3293, Val Accuracy: 71.43%
Epoch 6/10, Train Loss: 1.2054, Train Accuracy: 71.43%
Val Loss: 1.2585, Val Accuracy: 71.43%
Epoch 7/10, Train Loss: 1.0835, Train Accuracy: 80.36%
Val Loss: 1.1885, Val Accuracy: 71.43%
Epoch 8/10, Train Loss: 0.9571, Train Accuracy: 83.93%
Val Loss: 1.1171, Val Accuracy: 78.57%
Epoch 9/10, Train Loss: 0.8579, Train Accuracy: 87.50%
Val Loss: 1.0461, Val Accuracy: 78.57%
Epoch 10/10, Train Loss: 0.7546, Train Accuracy: 92.86%
Val Loss: 0.9755, Val Accuracy: 92.86%
photo adapter trained. Validation Accuracy: 92.86%

Training coefficients for adapter merging
Initial coefficients: [0.33517542 0.3314434  0.33338118]
Epoch 1, Loss: 1.7372, Accuracy: 28.57%
Coefficients: [0.12536207 0.7499433  0.1246946 ]
Epoch 2, Loss: 1.7355, Accuracy: 28.57%
Coefficients: [0.07357489 0.8558715  0.0705536 ]
Epoch 3, Loss: 1.7354, Accuracy: 28.57%
Coefficients: [0.06034688 0.8830758  0.05657732]
Epoch 4, Loss: 1.7378, Accuracy: 28.57%
Coefficients: [0.05576187 0.89249206 0.051746  ]
Epoch 5, Loss: 1.7400, Accuracy: 28.57%
Coefficients: [0.05418549 0.89535844 0.05045607]
Epoch 6, Loss: 1.7390, Accuracy: 28.57%
Coefficients: [0.05351769 0.89640653 0.0500758 ]
Epoch 7, Loss: 1.7371, Accuracy: 28.57%
Coefficients: [0.05323203 0.8966175  0.05015046]
Epoch 8, Loss: 1.7395, Accuracy: 28.57%
Coefficients: [0.05313042 0.89672995 0.05013963]
Epoch 9, Loss: 1.7356, Accuracy: 28.57%
Coefficients: [0.05307228 0.8968272  0.05010052]
Epoch 10, Loss: 1.7357, Accuracy: 28.57%
Coefficients: [0.05304143 0.8968652  0.05009333]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.12536207 0.7499433  0.1246946 ]

Merged model - Test Loss: 1.5006, Test Accuracy: 55.56%

--- Run 3/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: art_painting
Train domains: ['cartoon', 'sketch', 'photo']

Running Baseline experiment (train and test on test domain)
Epoch 1/10, Train Loss: 2.2132, Train Accuracy: 0.00%
Val Loss: 2.1982, Val Accuracy: 20.63%
Epoch 2/10, Train Loss: 0.8417, Train Accuracy: 85.71%
Val Loss: 2.2118, Val Accuracy: 17.46%
Epoch 3/10, Train Loss: 0.3634, Train Accuracy: 100.00%
Val Loss: 2.2441, Val Accuracy: 17.46%
Epoch 4/10, Train Loss: 0.1702, Train Accuracy: 100.00%
Val Loss: 2.2808, Val Accuracy: 17.46%
Epoch 5/10, Train Loss: 0.0793, Train Accuracy: 100.00%
Val Loss: 2.3235, Val Accuracy: 17.46%
Epoch 6/10, Train Loss: 0.0389, Train Accuracy: 100.00%
Val Loss: 2.3670, Val Accuracy: 15.87%
Epoch 7/10, Train Loss: 0.0174, Train Accuracy: 100.00%
Val Loss: 2.4120, Val Accuracy: 17.46%
Epoch 8/10, Train Loss: 0.0092, Train Accuracy: 100.00%
Val Loss: 2.4552, Val Accuracy: 19.05%
Epoch 9/10, Train Loss: 0.0053, Train Accuracy: 100.00%
Val Loss: 2.4964, Val Accuracy: 20.63%
Epoch 10/10, Train Loss: 0.0033, Train Accuracy: 100.00%
Val Loss: 2.5344, Val Accuracy: 20.63%
Baseline Model - Final Test Loss: 2.1982, Test Accuracy: 20.63%

Training LoRA adapter for domain: cartoon
Epoch 1/10, Train Loss: 2.3655, Train Accuracy: 12.50%
Val Loss: 2.3466, Val Accuracy: 7.14%
Epoch 2/10, Train Loss: 2.1549, Train Accuracy: 14.29%
Val Loss: 2.2409, Val Accuracy: 14.29%
Epoch 3/10, Train Loss: 1.9903, Train Accuracy: 16.07%
Val Loss: 2.1743, Val Accuracy: 14.29%
Epoch 4/10, Train Loss: 1.8642, Train Accuracy: 16.07%
Val Loss: 2.1146, Val Accuracy: 14.29%
Epoch 5/10, Train Loss: 1.7229, Train Accuracy: 26.79%
Val Loss: 2.0609, Val Accuracy: 21.43%
Epoch 6/10, Train Loss: 1.6114, Train Accuracy: 32.14%
Val Loss: 2.0138, Val Accuracy: 21.43%
Epoch 7/10, Train Loss: 1.4989, Train Accuracy: 41.07%
Val Loss: 1.9634, Val Accuracy: 14.29%
Epoch 8/10, Train Loss: 1.3834, Train Accuracy: 51.79%
Val Loss: 1.9261, Val Accuracy: 14.29%
Epoch 9/10, Train Loss: 1.2773, Train Accuracy: 60.71%
Val Loss: 1.8936, Val Accuracy: 28.57%
Epoch 10/10, Train Loss: 1.1561, Train Accuracy: 76.79%
Val Loss: 1.8695, Val Accuracy: 28.57%
cartoon adapter trained. Validation Accuracy: 28.57%

Training LoRA adapter for domain: sketch
Epoch 1/10, Train Loss: 2.1713, Train Accuracy: 23.21%
Val Loss: 1.5584, Val Accuracy: 42.86%
Epoch 2/10, Train Loss: 1.9343, Train Accuracy: 25.00%
Val Loss: 1.4624, Val Accuracy: 50.00%
Epoch 3/10, Train Loss: 1.7695, Train Accuracy: 35.71%
Val Loss: 1.3952, Val Accuracy: 64.29%
Epoch 4/10, Train Loss: 1.6247, Train Accuracy: 37.50%
Val Loss: 1.3572, Val Accuracy: 57.14%
Epoch 5/10, Train Loss: 1.5337, Train Accuracy: 39.29%
Val Loss: 1.3149, Val Accuracy: 57.14%
Epoch 6/10, Train Loss: 1.4324, Train Accuracy: 51.79%
Val Loss: 1.2735, Val Accuracy: 64.29%
Epoch 7/10, Train Loss: 1.3497, Train Accuracy: 53.57%
Val Loss: 1.2235, Val Accuracy: 64.29%
Epoch 8/10, Train Loss: 1.2687, Train Accuracy: 58.93%
Val Loss: 1.1677, Val Accuracy: 71.43%
Epoch 9/10, Train Loss: 1.1817, Train Accuracy: 67.86%
Val Loss: 1.1047, Val Accuracy: 71.43%
Epoch 10/10, Train Loss: 1.0841, Train Accuracy: 69.64%
Val Loss: 1.0378, Val Accuracy: 64.29%
sketch adapter trained. Validation Accuracy: 71.43%

Training LoRA adapter for domain: photo
Epoch 1/10, Train Loss: 1.9413, Train Accuracy: 28.57%
Val Loss: 1.6302, Val Accuracy: 50.00%
Epoch 2/10, Train Loss: 1.7683, Train Accuracy: 32.14%
Val Loss: 1.5517, Val Accuracy: 57.14%
Epoch 3/10, Train Loss: 1.6112, Train Accuracy: 37.50%
Val Loss: 1.4761, Val Accuracy: 64.29%
Epoch 4/10, Train Loss: 1.4868, Train Accuracy: 48.21%
Val Loss: 1.4018, Val Accuracy: 64.29%
Epoch 5/10, Train Loss: 1.3351, Train Accuracy: 53.57%
Val Loss: 1.3293, Val Accuracy: 71.43%
Epoch 6/10, Train Loss: 1.2054, Train Accuracy: 71.43%
Val Loss: 1.2585, Val Accuracy: 71.43%
Epoch 7/10, Train Loss: 1.0835, Train Accuracy: 80.36%
Val Loss: 1.1885, Val Accuracy: 71.43%
Epoch 8/10, Train Loss: 0.9571, Train Accuracy: 83.93%
Val Loss: 1.1171, Val Accuracy: 78.57%
Epoch 9/10, Train Loss: 0.8579, Train Accuracy: 87.50%
Val Loss: 1.0462, Val Accuracy: 78.57%
Epoch 10/10, Train Loss: 0.7546, Train Accuracy: 92.86%
Val Loss: 0.9756, Val Accuracy: 92.86%
photo adapter trained. Validation Accuracy: 92.86%

Training coefficients for adapter merging
Initial coefficients: [0.33517542 0.3314434  0.33338118]
Epoch 1, Loss: 1.7370, Accuracy: 28.57%
Coefficients: [0.12536208 0.7499434  0.12469456]
Epoch 2, Loss: 1.7353, Accuracy: 28.57%
Coefficients: [0.0733782  0.8558232  0.07079859]
Epoch 3, Loss: 1.7352, Accuracy: 28.57%
Coefficients: [0.06012812 0.88292754 0.0569443 ]
Epoch 4, Loss: 1.7376, Accuracy: 28.57%
Coefficients: [0.05554852 0.892278   0.05217352]
Epoch 5, Loss: 1.7398, Accuracy: 28.57%
Coefficients: [0.0539749  0.89511156 0.05091349]
Epoch 6, Loss: 1.7388, Accuracy: 28.57%
Coefficients: [0.05331095 0.89614356 0.05054546]
Epoch 7, Loss: 1.7369, Accuracy: 28.57%
Coefficients: [0.05302707 0.8963466  0.05062625]
Epoch 8, Loss: 1.7393, Accuracy: 28.57%
Coefficients: [0.05292636 0.8964544  0.0506192 ]
Epoch 9, Loss: 1.7355, Accuracy: 28.57%
Coefficients: [0.05286894 0.89654887 0.05058216]
Epoch 10, Loss: 1.7355, Accuracy: 28.57%
Coefficients: [0.05283854 0.8965854  0.05057602]
Best coefficient accuracy: 28.57%
Final best coefficients: [0.12536208 0.7499434  0.12469456]

Merged model - Test Loss: 1.5007, Test Accuracy: 55.56%

Summary of All Runs:
Base Model Accuracy: 20.63% ± 0.00%
Merged Model Accuracy: 55.56% ± 0.00%
Average Coefficients:
  cartoon: 0.1254 ± 0.0000
  sketch: 0.7499 ± 0.0000
  photo: 0.1247 ± 0.0000
