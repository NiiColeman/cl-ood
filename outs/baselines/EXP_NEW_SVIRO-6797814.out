rank 32

==================================================
Running experiments for dataset: SVIRO
==================================================
Dataset config for SVIRO:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/sviro', 'max_samples_per_class': None, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 10, 'learning_rate': 0.001, 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.1, 'coefficient_learning_rate': 0.1, 'coefficient_epochs': 10, 'seed': 42}
Type of dataset_config: <class 'dict'>
Contents of dataset_config:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/sviro', 'max_samples_per_class': None, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 10, 'learning_rate': 0.001, 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.1, 'coefficient_learning_rate': 0.1, 'coefficient_epochs': 10, 'seed': 42}

Run 1/10
Preparing data...
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: aclass
Training domains: ['escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Domain: escape
  Class 0: 2079 samples
  Class 4: 742 samples
  Class 2: 581 samples
  Class 3: 940 samples
  Class 5: 443 samples
  Class 1: 489 samples
  Class 6: 726 samples
  Total samples: 6000

Domain: tiguan
  Class 0: 2196 samples
  Class 4: 650 samples
  Class 2: 645 samples
  Class 3: 944 samples
  Class 5: 461 samples
  Class 1: 458 samples
  Class 6: 646 samples
  Total samples: 6000

Domain: tucson
  Class 0: 2202 samples
  Class 4: 658 samples
  Class 2: 608 samples
  Class 3: 900 samples
  Class 5: 481 samples
  Class 1: 458 samples
  Class 6: 693 samples
  Total samples: 6000

Domain: hilux
  Class 0: 2218 samples
  Class 4: 769 samples
  Class 2: 560 samples
  Class 3: 847 samples
  Class 5: 510 samples
  Class 1: 457 samples
  Class 6: 639 samples
  Total samples: 6000

Domain: tesla
  Class 0: 2507 samples
  Class 4: 565 samples
  Class 2: 537 samples
  Class 3: 909 samples
  Class 5: 439 samples
  Class 1: 449 samples
  Class 6: 594 samples
  Total samples: 6000

Domain: zoe
  Class 0: 909 samples
  Class 4: 438 samples
  Class 2: 518 samples
  Class 3: 816 samples
  Class 5: 392 samples
  Class 1: 380 samples
  Class 6: 547 samples
  Total samples: 4000

Domain: x5
  Class 0: 2400 samples
  Class 4: 767 samples
  Class 2: 569 samples
  Class 3: 892 samples
  Class 5: 418 samples
  Class 1: 371 samples
  Class 6: 583 samples
  Total samples: 6000

Domain: aclass
  Class 0: 2134 samples
  Class 4: 755 samples
  Class 2: 611 samples
  Class 3: 884 samples
  Class 5: 486 samples
  Class 1: 457 samples
  Class 6: 673 samples
  Total samples: 6000

Domain: i3
  Class 0: 884 samples
  Class 4: 442 samples
  Class 2: 496 samples
  Class 3: 919 samples
  Class 5: 363 samples
  Class 1: 372 samples
  Class 6: 524 samples
  Total samples: 4000

Domain: lexus
  Class 0: 2127 samples
  Class 4: 791 samples
  Class 2: 579 samples
  Class 3: 907 samples
  Class 5: 468 samples
  Class 1: 465 samples
  Class 6: 663 samples
  Total samples: 6000
Test domain: aclass
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 3.0738
Epoch 2, Average Loss: 1.8485
Epoch 3, Average Loss: 1.6296
Epoch 4, Average Loss: 1.5673
Epoch 5, Average Loss: 1.2903
Epoch 6, Average Loss: 1.1341
Epoch 7, Average Loss: 1.1867
Epoch 8, Average Loss: 1.0540
Epoch 9, Average Loss: 1.0909
Epoch 10, Average Loss: 0.8981
Accuracy: 49.6852
Training domains: ['escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Training expert models...

Training model for domain: escape
Training model for domain: escape
Epoch 1, Average Loss: 0.1176
Epoch 2, Average Loss: 0.0555
Epoch 3, Average Loss: 0.0205
Epoch 4, Average Loss: 0.0325
Epoch 5, Average Loss: 0.0454
Epoch 6, Average Loss: 0.0457
Epoch 7, Average Loss: 2.7696
Epoch 8, Average Loss: 1.9455
Epoch 9, Average Loss: 1.9207
Epoch 10, Average Loss: 1.8848
Merged model device: cuda:0
Accuracy: 35.9259
Accuracy of escape model on test domain: 35.9259

Training model for domain: hilux
Training model for domain: hilux
Epoch 1, Average Loss: 0.1390
Epoch 2, Average Loss: 0.0404
Epoch 3, Average Loss: 0.0418
Epoch 4, Average Loss: 0.0701
Epoch 5, Average Loss: 0.0451
Epoch 6, Average Loss: 0.0156
Epoch 7, Average Loss: 0.0337
Epoch 8, Average Loss: 0.0297
Epoch 9, Average Loss: 0.0362
Epoch 10, Average Loss: 0.0392
Merged model device: cuda:0
Accuracy: 60.5556
Accuracy of hilux model on test domain: 60.5556

Training model for domain: i3
Training model for domain: i3
Epoch 1, Average Loss: 0.1163
Epoch 2, Average Loss: 0.0553
Epoch 3, Average Loss: 0.0397
Epoch 4, Average Loss: 0.0245
Epoch 5, Average Loss: 0.0997
Epoch 6, Average Loss: 0.0797
Epoch 7, Average Loss: 0.0218
Epoch 8, Average Loss: 0.0050
Epoch 9, Average Loss: 0.0007
Epoch 10, Average Loss: 0.0407
Merged model device: cuda:0
Accuracy: 38.9630
Accuracy of i3 model on test domain: 38.9630

Training model for domain: lexus
Training model for domain: lexus
Epoch 1, Average Loss: 0.1141
Epoch 2, Average Loss: 0.0765
Epoch 3, Average Loss: 0.0209
Epoch 4, Average Loss: 0.0148
Epoch 5, Average Loss: 0.0053
Epoch 6, Average Loss: 0.0141
Epoch 7, Average Loss: 1.0395
Epoch 8, Average Loss: 0.9312
Epoch 9, Average Loss: 0.5167
Epoch 10, Average Loss: 0.3543
Merged model device: cuda:0
Accuracy: 28.1852
Accuracy of lexus model on test domain: 28.1852

Training model for domain: tesla
Training model for domain: tesla
Epoch 1, Average Loss: 0.1450
Epoch 2, Average Loss: 0.0328
Epoch 3, Average Loss: 0.0363
Epoch 4, Average Loss: 0.0466
Epoch 5, Average Loss: 0.0403
Epoch 6, Average Loss: 0.0128
Epoch 7, Average Loss: 0.0510
Epoch 8, Average Loss: 0.1434
Epoch 9, Average Loss: 0.0778
Epoch 10, Average Loss: 0.0458
Merged model device: cuda:0
Accuracy: 45.1852
Accuracy of tesla model on test domain: 45.1852

Training model for domain: tiguan
Training model for domain: tiguan
Epoch 1, Average Loss: 0.1158
Epoch 2, Average Loss: 0.0277
Epoch 3, Average Loss: 0.0435
Epoch 4, Average Loss: 0.0575
Epoch 5, Average Loss: 0.0652
Epoch 6, Average Loss: 0.0175
Epoch 7, Average Loss: 0.0051
Epoch 8, Average Loss: 0.0184
Epoch 9, Average Loss: 0.0055
Epoch 10, Average Loss: 0.0042
Merged model device: cuda:0
Accuracy: 73.5370
Accuracy of tiguan model on test domain: 73.5370

Training model for domain: tucson
Training model for domain: tucson
Epoch 1, Average Loss: 0.1189
Epoch 2, Average Loss: 0.0322
Epoch 3, Average Loss: 0.0602
Epoch 4, Average Loss: 0.0531
Epoch 5, Average Loss: 0.0156
Epoch 6, Average Loss: 0.0088
Epoch 7, Average Loss: 0.0064
Epoch 8, Average Loss: 2.4285
Epoch 9, Average Loss: 1.9000
Epoch 10, Average Loss: 1.8887
Merged model device: cuda:0
Accuracy: 35.9259
Accuracy of tucson model on test domain: 35.9259

Training model for domain: x5
Training model for domain: x5
Epoch 1, Average Loss: 0.1416
Epoch 2, Average Loss: 0.0732
Epoch 3, Average Loss: 0.0281
Epoch 4, Average Loss: 1.2579
Epoch 5, Average Loss: 1.5414
Epoch 6, Average Loss: 1.0459
Epoch 7, Average Loss: 0.7942
Epoch 8, Average Loss: 0.9540
Epoch 9, Average Loss: 0.7118
Epoch 10, Average Loss: 0.5816
Merged model device: cuda:0
Accuracy: 27.7407
Accuracy of x5 model on test domain: 27.7407

Training model for domain: zoe
Training model for domain: zoe
Epoch 1, Average Loss: 0.1563
Epoch 2, Average Loss: 0.0657
Epoch 3, Average Loss: 0.0430
Epoch 4, Average Loss: 0.0173
Epoch 5, Average Loss: 0.0077
Epoch 6, Average Loss: 0.0061
Epoch 7, Average Loss: 0.0119
Epoch 8, Average Loss: 0.0003
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 63.2778
Accuracy of zoe model on test domain: 63.2778

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  escape: 0.1111
  hilux: 0.1111
  i3: 0.1111
  lexus: 0.1111
  tesla: 0.1111
  tiguan: 0.1111
  tucson: 0.1111
  x5: 0.1111
  zoe: 0.1111
Expert model escape device: cuda:0
Expert model hilux device: cuda:0
Expert model i3 device: cuda:0
Expert model lexus device: cuda:0
Expert model tesla device: cuda:0
Expert model tiguan device: cuda:0
Expert model tucson device: cuda:0
Expert model x5 device: cuda:0
Expert model zoe device: cuda:0
Domain escape - Input device: cuda:0, Model device: cuda:0
Domain hilux - Input device: cuda:0, Model device: cuda:0
Domain i3 - Input device: cuda:0, Model device: cuda:0
Domain lexus - Input device: cuda:0, Model device: cuda:0
Domain tesla - Input device: cuda:0, Model device: cuda:0
Domain tiguan - Input device: cuda:0, Model device: cuda:0
Domain tucson - Input device: cuda:0, Model device: cuda:0
Domain x5 - Input device: cuda:0, Model device: cuda:0
Domain zoe - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.7733
Coefficient Epoch 2, Average Loss: 0.1432
Coefficient Epoch 3, Average Loss: 0.0798
Coefficient Epoch 4, Average Loss: 0.0733
Coefficient Epoch 5, Average Loss: 0.0702
Coefficient Epoch 6, Average Loss: 0.0698
Coefficient Epoch 7, Average Loss: 0.0703
Coefficient Epoch 8, Average Loss: 0.0748
Coefficient Epoch 9, Average Loss: 0.0740
Coefficient Epoch 10, Average Loss: 0.0707
Final device check:
Expert model escape device: cuda:0
Expert model hilux device: cuda:0
Expert model i3 device: cuda:0
Expert model lexus device: cuda:0
Expert model tesla device: cuda:0
Expert model tiguan device: cuda:0
Expert model tucson device: cuda:0
Expert model x5 device: cuda:0
Expert model zoe device: cuda:0
Coefficient training complete.
Learned coefficients: [0.33003100752830505, 0.020357392728328705, 0.03865165263414383, 0.024050777778029442, 0.035410113632678986, 0.08375575393438339, 0.39677363634109497, 0.03444457799196243, 0.03652501478791237]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 35.9259
Final model accuracy on test domain: 35.9259

Run 2/10
Preparing data...
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: escape
Training domains: ['aclass', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Domain: escape
  Class 0: 2079 samples
  Class 4: 742 samples
  Class 2: 581 samples
  Class 3: 940 samples
  Class 5: 443 samples
  Class 1: 489 samples
  Class 6: 726 samples
  Total samples: 6000

Domain: tiguan
  Class 0: 2196 samples
  Class 4: 650 samples
  Class 2: 645 samples
  Class 3: 944 samples
  Class 5: 461 samples
  Class 1: 458 samples
  Class 6: 646 samples
  Total samples: 6000

Domain: tucson
  Class 0: 2202 samples
  Class 4: 658 samples
  Class 2: 608 samples
  Class 3: 900 samples
  Class 5: 481 samples
  Class 1: 458 samples
  Class 6: 693 samples
  Total samples: 6000

Domain: hilux
  Class 0: 2218 samples
  Class 4: 769 samples
  Class 2: 560 samples
  Class 3: 847 samples
  Class 5: 510 samples
  Class 1: 457 samples
  Class 6: 639 samples
  Total samples: 6000

Domain: tesla
  Class 0: 2507 samples
  Class 4: 565 samples
  Class 2: 537 samples
  Class 3: 909 samples
  Class 5: 439 samples
  Class 1: 449 samples
  Class 6: 594 samples
  Total samples: 6000

Domain: zoe
  Class 0: 909 samples
  Class 4: 438 samples
  Class 2: 518 samples
  Class 3: 816 samples
  Class 5: 392 samples
  Class 1: 380 samples
  Class 6: 547 samples
  Total samples: 4000

Domain: x5
  Class 0: 2400 samples
  Class 4: 767 samples
  Class 2: 569 samples
  Class 3: 892 samples
  Class 5: 418 samples
  Class 1: 371 samples
  Class 6: 583 samples
  Total samples: 6000

Domain: aclass
  Class 0: 2134 samples
  Class 4: 755 samples
  Class 2: 611 samples
  Class 3: 884 samples
  Class 5: 486 samples
  Class 1: 457 samples
  Class 6: 673 samples
  Total samples: 6000

Domain: i3
  Class 0: 884 samples
  Class 4: 442 samples
  Class 2: 496 samples
  Class 3: 919 samples
  Class 5: 363 samples
  Class 1: 372 samples
  Class 6: 524 samples
  Total samples: 4000

Domain: lexus
  Class 0: 2127 samples
  Class 4: 791 samples
  Class 2: 579 samples
  Class 3: 907 samples
  Class 5: 468 samples
  Class 1: 465 samples
  Class 6: 663 samples
  Total samples: 6000
Test domain: escape
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 3.4689
Epoch 2, Average Loss: 1.8288
Epoch 3, Average Loss: 1.7529
Epoch 4, Average Loss: 1.5722
Epoch 5, Average Loss: 1.4462
Epoch 6, Average Loss: 1.4417
Epoch 7, Average Loss: 1.2826
Epoch 8, Average Loss: 1.2597
Epoch 9, Average Loss: 1.1174
Epoch 10, Average Loss: 1.0066
Accuracy: 57.6481
Training domains: ['aclass', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Training expert models...

Training model for domain: aclass
Training model for domain: aclass
Epoch 1, Average Loss: 0.1182
Epoch 2, Average Loss: 0.0417
Epoch 3, Average Loss: 0.0463
Epoch 4, Average Loss: 0.0151
Epoch 5, Average Loss: 0.0146
Epoch 6, Average Loss: 0.0302
Epoch 7, Average Loss: 1.5412
Epoch 8, Average Loss: 1.6595
Epoch 9, Average Loss: 1.5387
Epoch 10, Average Loss: 1.5027
Merged model device: cuda:0
Accuracy: 28.0741
Accuracy of aclass model on test domain: 28.0741

Training model for domain: hilux
Training model for domain: hilux
Epoch 1, Average Loss: 0.1719
Epoch 2, Average Loss: 0.0239
Epoch 3, Average Loss: 0.0472
Epoch 4, Average Loss: 0.0181
Epoch 5, Average Loss: 0.0038
Epoch 6, Average Loss: 1.3281
Epoch 7, Average Loss: 1.7043
Epoch 8, Average Loss: 1.5255
Epoch 9, Average Loss: 1.2380
Epoch 10, Average Loss: 1.0324
Merged model device: cuda:0
Accuracy: 15.1667
Accuracy of hilux model on test domain: 15.1667

Training model for domain: i3
Training model for domain: i3
Epoch 1, Average Loss: 0.1318
Epoch 2, Average Loss: 0.0269
Epoch 3, Average Loss: 0.0040
Epoch 4, Average Loss: 0.0735
Epoch 5, Average Loss: 0.0292
Epoch 6, Average Loss: 0.0097
Epoch 7, Average Loss: 0.0328
Epoch 8, Average Loss: 1.4634
Epoch 9, Average Loss: 1.7360
Epoch 10, Average Loss: 0.9640
Merged model device: cuda:0
Accuracy: 16.2222
Accuracy of i3 model on test domain: 16.2222

Training model for domain: lexus
Training model for domain: lexus
Epoch 1, Average Loss: 0.1191
Epoch 2, Average Loss: 0.0279
Epoch 3, Average Loss: 0.0455
Epoch 4, Average Loss: 0.1231
Epoch 5, Average Loss: 0.0384
Epoch 6, Average Loss: 0.0172
Epoch 7, Average Loss: 0.0093
Epoch 8, Average Loss: 0.0002
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 92.3704
Accuracy of lexus model on test domain: 92.3704

Training model for domain: tesla
Training model for domain: tesla
Epoch 1, Average Loss: 0.1234
Epoch 2, Average Loss: 0.0417
Epoch 3, Average Loss: 0.0287
Epoch 4, Average Loss: 0.0365
Epoch 5, Average Loss: 0.2096
Epoch 6, Average Loss: 0.0405
Epoch 7, Average Loss: 0.0161
Epoch 8, Average Loss: 0.0206
Epoch 9, Average Loss: 0.6881
Epoch 10, Average Loss: 2.4423
Merged model device: cuda:0
Accuracy: 34.6481
Accuracy of tesla model on test domain: 34.6481

Training model for domain: tiguan
Training model for domain: tiguan
Epoch 1, Average Loss: 0.1294
Epoch 2, Average Loss: 0.0192
Epoch 3, Average Loss: 0.0680
Epoch 4, Average Loss: 0.0267
Epoch 5, Average Loss: 0.0125
Epoch 6, Average Loss: 0.1139
Epoch 7, Average Loss: 0.0576
Epoch 8, Average Loss: 0.0108
Epoch 9, Average Loss: 0.0411
Epoch 10, Average Loss: 0.0689
Merged model device: cuda:0
Accuracy: 49.5370
Accuracy of tiguan model on test domain: 49.5370

Training model for domain: tucson
Training model for domain: tucson
Epoch 1, Average Loss: 0.1207
Epoch 2, Average Loss: 0.0410
Epoch 3, Average Loss: 0.0347
Epoch 4, Average Loss: 0.0398
Epoch 5, Average Loss: 0.0360
Epoch 6, Average Loss: 0.0147
Epoch 7, Average Loss: 0.0054
Epoch 8, Average Loss: 0.0142
Epoch 9, Average Loss: 0.0485
Epoch 10, Average Loss: 0.0934
Merged model device: cuda:0
Accuracy: 72.2963
Accuracy of tucson model on test domain: 72.2963

Training model for domain: x5
Training model for domain: x5
Epoch 1, Average Loss: 0.1049
Epoch 2, Average Loss: 0.0363
Epoch 3, Average Loss: 0.0465
Epoch 4, Average Loss: 0.0306
Epoch 5, Average Loss: 0.0199
Epoch 6, Average Loss: 0.0252
Epoch 7, Average Loss: 0.0454
Epoch 8, Average Loss: 1.5271
Epoch 9, Average Loss: 1.4852
Epoch 10, Average Loss: 1.1539
Merged model device: cuda:0
Accuracy: 45.8148
Accuracy of x5 model on test domain: 45.8148

Training model for domain: zoe
Training model for domain: zoe
Epoch 1, Average Loss: 0.1506
Epoch 2, Average Loss: 0.0106
Epoch 3, Average Loss: 0.1063
Epoch 4, Average Loss: 0.0305
Epoch 5, Average Loss: 0.0001
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0000
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 56.8889
Accuracy of zoe model on test domain: 56.8889

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  aclass: 0.1111
  hilux: 0.1111
  i3: 0.1111
  lexus: 0.1111
  tesla: 0.1111
  tiguan: 0.1111
  tucson: 0.1111
  x5: 0.1111
  zoe: 0.1111
Expert model aclass device: cuda:0
Expert model hilux device: cuda:0
Expert model i3 device: cuda:0
Expert model lexus device: cuda:0
Expert model tesla device: cuda:0
Expert model tiguan device: cuda:0
Expert model tucson device: cuda:0
Expert model x5 device: cuda:0
Expert model zoe device: cuda:0
Domain aclass - Input device: cuda:0, Model device: cuda:0
Domain hilux - Input device: cuda:0, Model device: cuda:0
Domain i3 - Input device: cuda:0, Model device: cuda:0
Domain lexus - Input device: cuda:0, Model device: cuda:0
Domain tesla - Input device: cuda:0, Model device: cuda:0
Domain tiguan - Input device: cuda:0, Model device: cuda:0
Domain tucson - Input device: cuda:0, Model device: cuda:0
Domain x5 - Input device: cuda:0, Model device: cuda:0
Domain zoe - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.3016
Coefficient Epoch 2, Average Loss: 0.1389
Coefficient Epoch 3, Average Loss: 0.1308
Coefficient Epoch 4, Average Loss: 0.1031
Coefficient Epoch 5, Average Loss: 0.0863
Coefficient Epoch 6, Average Loss: 0.0958
Coefficient Epoch 7, Average Loss: 0.0849
Coefficient Epoch 8, Average Loss: 0.0775
Coefficient Epoch 9, Average Loss: 0.0717
Coefficient Epoch 10, Average Loss: 0.0820
Final device check:
Expert model aclass device: cuda:0
Expert model hilux device: cuda:0
Expert model i3 device: cuda:0
Expert model lexus device: cuda:0
Expert model tesla device: cuda:0
Expert model tiguan device: cuda:0
Expert model tucson device: cuda:0
Expert model x5 device: cuda:0
Expert model zoe device: cuda:0
Coefficient training complete.
Learned coefficients: [0.16383318603038788, 0.11031334847211838, 0.049856916069984436, 0.1481381356716156, 0.09702148288488388, 0.07056475430727005, 0.1484377086162567, 0.10085124522447586, 0.11098316311836243]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 15.6296
Final model accuracy on test domain: 15.6296

Run 3/10
Preparing data...
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: hilux
Training domains: ['aclass', 'escape', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Domain: escape
  Class 0: 2079 samples
  Class 4: 742 samples
  Class 2: 581 samples
  Class 3: 940 samples
  Class 5: 443 samples
  Class 1: 489 samples
  Class 6: 726 samples
  Total samples: 6000

Domain: tiguan
  Class 0: 2196 samples
  Class 4: 650 samples
  Class 2: 645 samples
  Class 3: 944 samples
  Class 5: 461 samples
  Class 1: 458 samples
  Class 6: 646 samples
  Total samples: 6000

Domain: tucson
  Class 0: 2202 samples
  Class 4: 658 samples
  Class 2: 608 samples
  Class 3: 900 samples
  Class 5: 481 samples
  Class 1: 458 samples
  Class 6: 693 samples
  Total samples: 6000

Domain: hilux
  Class 0: 2218 samples
  Class 4: 769 samples
  Class 2: 560 samples
  Class 3: 847 samples
  Class 5: 510 samples
  Class 1: 457 samples
  Class 6: 639 samples
  Total samples: 6000

Domain: tesla
  Class 0: 2507 samples
  Class 4: 565 samples
  Class 2: 537 samples
  Class 3: 909 samples
  Class 5: 439 samples
  Class 1: 449 samples
  Class 6: 594 samples
  Total samples: 6000

Domain: zoe
  Class 0: 909 samples
  Class 4: 438 samples
  Class 2: 518 samples
  Class 3: 816 samples
  Class 5: 392 samples
  Class 1: 380 samples
  Class 6: 547 samples
  Total samples: 4000

Domain: x5
  Class 0: 2400 samples
  Class 4: 767 samples
  Class 2: 569 samples
  Class 3: 892 samples
  Class 5: 418 samples
  Class 1: 371 samples
  Class 6: 583 samples
  Total samples: 6000

Domain: aclass
  Class 0: 2134 samples
  Class 4: 755 samples
  Class 2: 611 samples
  Class 3: 884 samples
  Class 5: 486 samples
  Class 1: 457 samples
  Class 6: 673 samples
  Total samples: 6000

Domain: i3
  Class 0: 884 samples
  Class 4: 442 samples
  Class 2: 496 samples
  Class 3: 919 samples
  Class 5: 363 samples
  Class 1: 372 samples
  Class 6: 524 samples
  Total samples: 4000

Domain: lexus
  Class 0: 2127 samples
  Class 4: 791 samples
  Class 2: 579 samples
  Class 3: 907 samples
  Class 5: 468 samples
  Class 1: 465 samples
  Class 6: 663 samples
  Total samples: 6000
Test domain: hilux
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 3.6262
Epoch 2, Average Loss: 1.7760
Epoch 3, Average Loss: 1.7718
Epoch 4, Average Loss: 1.7337
Epoch 5, Average Loss: 1.6936
Epoch 6, Average Loss: 1.6175
Epoch 7, Average Loss: 1.6247
Epoch 8, Average Loss: 1.6867
Epoch 9, Average Loss: 1.6781
Epoch 10, Average Loss: 1.6684
Accuracy: 42.8889
Training domains: ['aclass', 'escape', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Training expert models...

Training model for domain: aclass
Training model for domain: aclass
Epoch 1, Average Loss: 0.1275
Epoch 2, Average Loss: 0.0260
Epoch 3, Average Loss: 0.0205
Epoch 4, Average Loss: 0.0932
Epoch 5, Average Loss: 0.0196
Epoch 6, Average Loss: 0.0194
Epoch 7, Average Loss: 0.0029
Epoch 8, Average Loss: 0.0729
Epoch 9, Average Loss: 2.0686
Epoch 10, Average Loss: 1.5569
Merged model device: cuda:0
Accuracy: 17.4074
Accuracy of aclass model on test domain: 17.4074

Training model for domain: escape
Training model for domain: escape
Epoch 1, Average Loss: 0.1275
Epoch 2, Average Loss: 0.0377
Epoch 3, Average Loss: 0.0278
Epoch 4, Average Loss: 0.0736
Epoch 5, Average Loss: 0.0115
Epoch 6, Average Loss: 0.0132
Epoch 7, Average Loss: 0.0010
Epoch 8, Average Loss: 0.0210
Epoch 9, Average Loss: 1.6042
Epoch 10, Average Loss: 1.5878
Merged model device: cuda:0
Accuracy: 25.5185
Accuracy of escape model on test domain: 25.5185

Training model for domain: i3
Training model for domain: i3
Epoch 1, Average Loss: 0.0988
Epoch 2, Average Loss: 0.0015
Epoch 3, Average Loss: 0.0000
Epoch 4, Average Loss: 0.0000
Epoch 5, Average Loss: 0.0000
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0000
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 90.5000
Accuracy of i3 model on test domain: 90.5000

Training model for domain: lexus
Training model for domain: lexus
Epoch 1, Average Loss: 0.1355
Epoch 2, Average Loss: 0.0515
Epoch 3, Average Loss: 0.0648
Epoch 4, Average Loss: 0.0488
Epoch 5, Average Loss: 0.0186
Epoch 6, Average Loss: 0.0105
Epoch 7, Average Loss: 0.0191
Epoch 8, Average Loss: 0.0211
Epoch 9, Average Loss: 0.6493
Epoch 10, Average Loss: 1.6092
Merged model device: cuda:0
Accuracy: 32.6296
Accuracy of lexus model on test domain: 32.6296

Training model for domain: tesla
Training model for domain: tesla
Epoch 1, Average Loss: 0.1214
Epoch 2, Average Loss: 0.0552
Epoch 3, Average Loss: 0.0589
Epoch 4, Average Loss: 0.0258
Epoch 5, Average Loss: 0.0109
Epoch 6, Average Loss: 0.0341
Epoch 7, Average Loss: 0.0444
Epoch 8, Average Loss: 0.1019
Epoch 9, Average Loss: 0.0428
Epoch 10, Average Loss: 0.0175
Merged model device: cuda:0
Accuracy: 58.9630
Accuracy of tesla model on test domain: 58.9630

Training model for domain: tiguan
Training model for domain: tiguan
Epoch 1, Average Loss: 0.1220
Epoch 2, Average Loss: 0.0343
Epoch 3, Average Loss: 0.0414
Epoch 4, Average Loss: 0.0208
Epoch 5, Average Loss: 0.0351
Epoch 6, Average Loss: 0.0162
Epoch 7, Average Loss: 0.0296
Epoch 8, Average Loss: 2.0898
Epoch 9, Average Loss: 1.6417
Epoch 10, Average Loss: 1.5943
Merged model device: cuda:0
Accuracy: 40.0741
Accuracy of tiguan model on test domain: 40.0741

Training model for domain: tucson
Training model for domain: tucson
Epoch 1, Average Loss: 0.1306
Epoch 2, Average Loss: 0.0302
Epoch 3, Average Loss: 0.0187
Epoch 4, Average Loss: 0.0763
Epoch 5, Average Loss: 1.5382
Epoch 6, Average Loss: 1.5752
Epoch 7, Average Loss: 1.6639
Epoch 8, Average Loss: 1.4467
Epoch 9, Average Loss: 1.3004
Epoch 10, Average Loss: 1.1133
Merged model device: cuda:0
Accuracy: 16.7593
Accuracy of tucson model on test domain: 16.7593

Training model for domain: x5
Training model for domain: x5
Epoch 1, Average Loss: 0.1114
Epoch 2, Average Loss: 0.0326
Epoch 3, Average Loss: 0.0327
Epoch 4, Average Loss: 0.0455
Epoch 5, Average Loss: 0.0590
Epoch 6, Average Loss: 0.0605
Epoch 7, Average Loss: 0.0131
Epoch 8, Average Loss: 0.0222
Epoch 9, Average Loss: 0.0288
Epoch 10, Average Loss: 0.0298
Merged model device: cuda:0
Accuracy: 32.2778
Accuracy of x5 model on test domain: 32.2778

Training model for domain: zoe
Training model for domain: zoe
Epoch 1, Average Loss: 0.1642
Epoch 2, Average Loss: 0.0421
Epoch 3, Average Loss: 0.0101
Epoch 4, Average Loss: 0.0000
Epoch 5, Average Loss: 0.0000
Epoch 6, Average Loss: 0.0000
Epoch 7, Average Loss: 0.0000
Epoch 8, Average Loss: 0.0000
Epoch 9, Average Loss: 0.0000
Epoch 10, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 61.3333
Accuracy of zoe model on test domain: 61.3333

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  aclass: 0.1111
  escape: 0.1111
  i3: 0.1111
  lexus: 0.1111
  tesla: 0.1111
  tiguan: 0.1111
  tucson: 0.1111
  x5: 0.1111
  zoe: 0.1111
Expert model aclass device: cuda:0
Expert model escape device: cuda:0
Expert model i3 device: cuda:0
Expert model lexus device: cuda:0
Expert model tesla device: cuda:0
Expert model tiguan device: cuda:0
Expert model tucson device: cuda:0
Expert model x5 device: cuda:0
Expert model zoe device: cuda:0
Domain aclass - Input device: cuda:0, Model device: cuda:0
Domain escape - Input device: cuda:0, Model device: cuda:0
Domain i3 - Input device: cuda:0, Model device: cuda:0
Domain lexus - Input device: cuda:0, Model device: cuda:0
Domain tesla - Input device: cuda:0, Model device: cuda:0
Domain tiguan - Input device: cuda:0, Model device: cuda:0
Domain tucson - Input device: cuda:0, Model device: cuda:0
Domain x5 - Input device: cuda:0, Model device: cuda:0
Domain zoe - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.5857
Coefficient Epoch 2, Average Loss: 0.3030
Coefficient Epoch 3, Average Loss: 0.2447
Coefficient Epoch 4, Average Loss: 0.2442
Coefficient Epoch 5, Average Loss: 0.2006
Coefficient Epoch 6, Average Loss: 0.2358
Coefficient Epoch 7, Average Loss: 0.1978
Coefficient Epoch 8, Average Loss: 0.1990
Coefficient Epoch 9, Average Loss: 0.1854
Coefficient Epoch 10, Average Loss: 0.2341
Final device check:
Expert model aclass device: cuda:0
Expert model escape device: cuda:0
Expert model i3 device: cuda:0
Expert model lexus device: cuda:0
Expert model tesla device: cuda:0
Expert model tiguan device: cuda:0
Expert model tucson device: cuda:0
Expert model x5 device: cuda:0
Expert model zoe device: cuda:0
Coefficient training complete.
Learned coefficients: [0.043977756053209305, 0.05092931166291237, 0.09413045644760132, 0.07513563334941864, 0.09310968220233917, 0.48103347420692444, 0.03700285777449608, 0.04888660088181496, 0.07579430192708969]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 29.1481
Final model accuracy on test domain: 29.1481

Run 4/10
Preparing data...
Domains: ['aclass', 'escape', 'hilux', 'i3', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']
Selected test domain: i3
Training domains: ['aclass', 'escape', 'hilux', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Domain: escape
  Class 0: 2079 samples
  Class 4: 742 samples
  Class 2: 581 samples
  Class 3: 940 samples
  Class 5: 443 samples
  Class 1: 489 samples
  Class 6: 726 samples
  Total samples: 6000

Domain: tiguan
  Class 0: 2196 samples
  Class 4: 650 samples
  Class 2: 645 samples
  Class 3: 944 samples
  Class 5: 461 samples
  Class 1: 458 samples
  Class 6: 646 samples
  Total samples: 6000

Domain: tucson
  Class 0: 2202 samples
  Class 4: 658 samples
  Class 2: 608 samples
  Class 3: 900 samples
  Class 5: 481 samples
  Class 1: 458 samples
  Class 6: 693 samples
  Total samples: 6000

Domain: hilux
  Class 0: 2218 samples
  Class 4: 769 samples
  Class 2: 560 samples
  Class 3: 847 samples
  Class 5: 510 samples
  Class 1: 457 samples
  Class 6: 639 samples
  Total samples: 6000

Domain: tesla
  Class 0: 2507 samples
  Class 4: 565 samples
  Class 2: 537 samples
  Class 3: 909 samples
  Class 5: 439 samples
  Class 1: 449 samples
  Class 6: 594 samples
  Total samples: 6000

Domain: zoe
  Class 0: 909 samples
  Class 4: 438 samples
  Class 2: 518 samples
  Class 3: 816 samples
  Class 5: 392 samples
  Class 1: 380 samples
  Class 6: 547 samples
  Total samples: 4000

Domain: x5
  Class 0: 2400 samples
  Class 4: 767 samples
  Class 2: 569 samples
  Class 3: 892 samples
  Class 5: 418 samples
  Class 1: 371 samples
  Class 6: 583 samples
  Total samples: 6000

Domain: aclass
  Class 0: 2134 samples
  Class 4: 755 samples
  Class 2: 611 samples
  Class 3: 884 samples
  Class 5: 486 samples
  Class 1: 457 samples
  Class 6: 673 samples
  Total samples: 6000

Domain: i3
  Class 0: 884 samples
  Class 4: 442 samples
  Class 2: 496 samples
  Class 3: 919 samples
  Class 5: 363 samples
  Class 1: 372 samples
  Class 6: 524 samples
  Total samples: 4000

Domain: lexus
  Class 0: 2127 samples
  Class 4: 791 samples
  Class 2: 579 samples
  Class 3: 907 samples
  Class 5: 468 samples
  Class 1: 465 samples
  Class 6: 663 samples
  Total samples: 6000
Test domain: i3
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.1309
Epoch 2, Average Loss: 2.0958
Epoch 3, Average Loss: 1.7731
Epoch 4, Average Loss: 1.6105
Epoch 5, Average Loss: 1.3547
Epoch 6, Average Loss: 1.2714
Epoch 7, Average Loss: 1.1451
Epoch 8, Average Loss: 1.0321
Epoch 9, Average Loss: 0.9864
Epoch 10, Average Loss: 0.8918
Accuracy: 60.1944
Training domains: ['aclass', 'escape', 'hilux', 'lexus', 'tesla', 'tiguan', 'tucson', 'x5', 'zoe']

Training expert models...

Training model for domain: aclass
Training model for domain: aclass
Epoch 1, Average Loss: 0.1135
Epoch 2, Average Loss: 0.0454
Epoch 3, Average Loss: 0.0290
Epoch 4, Average Loss: 0.0041
Epoch 5, Average Loss: 1.4193
Epoch 6, Average Loss: 1.9514
Epoch 7, Average Loss: 1.6590
Epoch 8, Average Loss: 1.5283
Epoch 9, Average Loss: 1.3288
Epoch 10, Average Loss: 1.1568
Merged model device: cuda:0
Accuracy: 29.0278
Accuracy of aclass model on test domain: 29.0278

Training model for domain: escape
Training model for domain: escape
Epoch 1, Average Loss: 0.1011
Epoch 2, Average Loss: 0.0417
Epoch 3, Average Loss: 0.0180
Epoch 4, Average Loss: 0.1007
Epoch 5, Average Loss: 0.0887
Epoch 6, Average Loss: 0.0200
Epoch 7, Average Loss: 0.0243
Epoch 8, Average Loss: 0.0208
Epoch 9, Average Loss: 0.0317
Epoch 10, Average Loss: 0.0426
Merged model device: cuda:0
Accuracy: 68.1944
Accuracy of escape model on test domain: 68.1944

Training model for domain: hilux
Training model for domain: hilux
Epoch 1, Average Loss: 0.1563
Epoch 2, Average Loss: 0.0207
Epoch 3, Average Loss: 0.0831
Epoch 4, Average Loss: 0.0188
Epoch 5, Average Loss: 0.0069
Epoch 6, Average Loss: 0.0182
Epoch 7, Average Loss: 0.0425
Epoch 8, Average Loss: 1.8586
Epoch 9, Average Loss: 1.6570
Epoch 10, Average Loss: 1.4009
Merged model device: cuda:0
Accuracy: 23.0000
Accuracy of hilux model on test domain: 23.0000

Training model for domain: lexus
Training model for domain: lexus
Epoch 1, Average Loss: 0.1324
Epoch 2, Average Loss: 0.0282
Epoch 3, Average Loss: 0.0349
Epoch 4, Average Loss: 0.0706
Epoch 5, Average Loss: 0.0238
Epoch 6, Average Loss: 0.0218
Epoch 7, Average Loss: 1.2517
Epoch 8, Average Loss: 1.3332
Epoch 9, Average Loss: 1.0543
Epoch 10, Average Loss: 0.8742
Merged model device: cuda:0
Accuracy: 24.7500
Accuracy of lexus model on test domain: 24.7500

Training model for domain: tesla
Training model for domain: tesla
Epoch 1, Average Loss: 0.1220
Epoch 2, Average Loss: 0.0431
Epoch 3, Average Loss: 0.0323
Epoch 4, Average Loss: 0.0450
Epoch 5, Average Loss: 0.0293
Epoch 6, Average Loss: 0.0169
Epoch 7, Average Loss: 0.0175
Epoch 8, Average Loss: 0.0585
Epoch 9, Average Loss: 0.0638
Epoch 10, Average Loss: 0.0395
Merged model device: cuda:0
Accuracy: 92.9444
Accuracy of tesla model on test domain: 92.9444

Training model for domain: tiguan
Training model for domain: tiguan
Epoch 1, Average Loss: 0.1287
Epoch 2, Average Loss: 0.0341
Epoch 3, Average Loss: 0.0091
Epoch 4, Average Loss: 1.5855
Epoch 5, Average Loss: 1.8858
Epoch 6, Average Loss: 1.5186
Epoch 7, Average Loss: 1.2971
Epoch 8, Average Loss: 0.9666
Epoch 9, Average Loss: 0.7597
Epoch 10, Average Loss: 0.6212
Merged model device: cuda:0
Accuracy: 35.7778
Accuracy of tiguan model on test domain: 35.7778

Training model for domain: tucson
Training model for domain: tucson
Epoch 1, Average Loss: 0.1036
Epoch 2, Average Loss: 0.0895
Epoch 3, Average Loss: 0.0122
Epoch 4, Average Loss: 0.0001
Epoch 5, Average Loss: 0.0651
Epoch 6, Average Loss: 0.2186
Epoch 7, Average Loss: 0.0468
Epoch 8, Average Loss: 0.0593
Epoch 9, Average Loss: 0.0285
Epoch 10, Average Loss: 0.0483
Merged model device: cuda:0
Accuracy: 56.3333
Accuracy of tucson model on test domain: 56.3333

Training model for domain: x5
Training model for domain: x5
Epoch 1, Average Loss: 0.0987
Epoch 2, Average Loss: 0.0413
Epoch 3, Average Loss: 0.0232
Epoch 4, Average Loss: 0.0821
Epoch 5, Average Loss: 0.0790
Epoch 6, Average Loss: 0.0296
Epoch 7, Average Loss: 0.0148
Epoch 8, Average Loss: 0.0008
Epoch 9, Average Loss: 0.0001
Epoch 10, Average Loss: 0.0000
Merged model device: cuda:0
Accuracy: 77.0278
Accuracy of x5 model on test domain: 77.0278

Training model for domain: zoe
Training model for domain: zoe
Epoch 1, Average Loss: 0.1360
