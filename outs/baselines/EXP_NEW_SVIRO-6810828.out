50 OfficeHome

==================================================
Running experiments for dataset: OfficeHome
==================================================
Dataset config for OfficeHome:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home', 'max_samples_per_class': None, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 10, 'learning_rate': 0.001, 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.1, 'coefficient_learning_rate': 0.1, 'coefficient_epochs': 10, 'seed': 42}
Type of dataset_config: <class 'dict'>
Contents of dataset_config:
{'dataset_path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home', 'max_samples_per_class': None, 'base_model': 'vit_base_patch16_224', 'batch_size': 32, 'num_epochs': 10, 'learning_rate': 0.001, 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.1, 'coefficient_learning_rate': 0.1, 'coefficient_epochs': 10, 'seed': 42}

Run 1/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Art
Training domains: ['Clipart', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Art
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.5298
Epoch 2, Average Loss: 4.1554
Epoch 3, Average Loss: 4.1025
Epoch 4, Average Loss: 4.0593
Epoch 5, Average Loss: 3.9944
Epoch 6, Average Loss: 3.9501
Epoch 7, Average Loss: 3.9012
Epoch 8, Average Loss: 3.8613
Epoch 9, Average Loss: 3.8125
Epoch 10, Average Loss: 3.7288
Accuracy: 4.7776
Training domains: ['Clipart', 'Product', 'Real World']

Training expert models...

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.2993
Epoch 2, Average Loss: 0.3516
Epoch 3, Average Loss: 0.2797
Epoch 4, Average Loss: 0.2794
Epoch 5, Average Loss: 0.2532
Epoch 6, Average Loss: 0.2448
Epoch 7, Average Loss: 0.2339
Epoch 8, Average Loss: 0.2366
Epoch 9, Average Loss: 0.2404
Epoch 10, Average Loss: 0.2760
Merged model device: cuda:0
Accuracy: 53.2125
Accuracy of Clipart model on test domain: 53.2125

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.6979
Epoch 2, Average Loss: 0.1202
Epoch 3, Average Loss: 0.1351
Epoch 4, Average Loss: 0.1605
Epoch 5, Average Loss: 0.1711
Epoch 6, Average Loss: 0.1382
Epoch 7, Average Loss: 0.1565
Epoch 8, Average Loss: 0.1362
Epoch 9, Average Loss: 0.0883
Epoch 10, Average Loss: 0.0681
Merged model device: cuda:0
Accuracy: 44.6458
Accuracy of Product model on test domain: 44.6458

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8188
Epoch 2, Average Loss: 0.1911
Epoch 3, Average Loss: 0.1954
Epoch 4, Average Loss: 0.1790
Epoch 5, Average Loss: 0.2861
Epoch 6, Average Loss: 0.1928
Epoch 7, Average Loss: 0.1125
Epoch 8, Average Loss: 0.1081
Epoch 9, Average Loss: 0.0910
Epoch 10, Average Loss: 0.1028
Merged model device: cuda:0
Accuracy: 56.9193
Accuracy of Real World model on test domain: 56.9193

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Clipart: 0.3333
  Product: 0.3333
  Real World: 0.3333
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.5459
Coefficient Epoch 2, Average Loss: 1.3311
Coefficient Epoch 3, Average Loss: 1.3390
Coefficient Epoch 4, Average Loss: 1.3301
Coefficient Epoch 5, Average Loss: 1.3510
Coefficient Epoch 6, Average Loss: 1.3471
Coefficient Epoch 7, Average Loss: 1.3533
Coefficient Epoch 8, Average Loss: 1.3826
Coefficient Epoch 9, Average Loss: 1.3345
Coefficient Epoch 10, Average Loss: 1.3406
Final device check:
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.34779077768325806, 0.3073280453681946, 0.34488117694854736]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 79.9012
Final model accuracy on test domain: 79.9012

Run 2/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Clipart
Training domains: ['Art', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Clipart
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3591
Epoch 2, Average Loss: 4.1806
Epoch 3, Average Loss: 4.0598
Epoch 4, Average Loss: 3.9593
Epoch 5, Average Loss: 3.9281
Epoch 6, Average Loss: 3.9027
Epoch 7, Average Loss: 3.8552
Epoch 8, Average Loss: 3.8394
Epoch 9, Average Loss: 3.7756
Epoch 10, Average Loss: 3.7779
Accuracy: 6.4132
Training domains: ['Art', 'Product', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.4310
Epoch 2, Average Loss: 0.2274
Epoch 3, Average Loss: 0.1382
Epoch 4, Average Loss: 0.1046
Epoch 5, Average Loss: 0.1018
Epoch 6, Average Loss: 0.1102
Epoch 7, Average Loss: 0.1076
Epoch 8, Average Loss: 0.3813
Epoch 9, Average Loss: 0.2818
Epoch 10, Average Loss: 0.1378
Merged model device: cuda:0
Accuracy: 49.2900
Accuracy of Art model on test domain: 49.2900

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.6973
Epoch 2, Average Loss: 0.1330
Epoch 3, Average Loss: 0.1437
Epoch 4, Average Loss: 0.1077
Epoch 5, Average Loss: 0.1647
Epoch 6, Average Loss: 0.1849
Epoch 7, Average Loss: 0.1192
Epoch 8, Average Loss: 0.0999
Epoch 9, Average Loss: 0.1046
Epoch 10, Average Loss: 0.1019
Merged model device: cuda:0
Accuracy: 37.7004
Accuracy of Product model on test domain: 37.7004

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8120
Epoch 2, Average Loss: 0.2045
Epoch 3, Average Loss: 0.1590
Epoch 4, Average Loss: 0.1543
Epoch 5, Average Loss: 0.1494
Epoch 6, Average Loss: 0.1901
Epoch 7, Average Loss: 0.2609
Epoch 8, Average Loss: 0.1776
Epoch 9, Average Loss: 0.0988
Epoch 10, Average Loss: 0.0762
Merged model device: cuda:0
Accuracy: 44.9382
Accuracy of Real World model on test domain: 44.9382

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Product: 0.3333
  Real World: 0.3333
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.1323
Coefficient Epoch 2, Average Loss: 1.8569
Coefficient Epoch 3, Average Loss: 1.8615
Coefficient Epoch 4, Average Loss: 1.8779
Coefficient Epoch 5, Average Loss: 1.8422
Coefficient Epoch 6, Average Loss: 1.8761
Coefficient Epoch 7, Average Loss: 1.8759
Coefficient Epoch 8, Average Loss: 1.8597
Coefficient Epoch 9, Average Loss: 1.8489
Coefficient Epoch 10, Average Loss: 1.8636
Final device check:
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.37312230467796326, 0.2959737479686737, 0.33090394735336304]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 63.5822
Final model accuracy on test domain: 63.5822

Run 3/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Product
Training domains: ['Art', 'Clipart', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Product
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.2700
Epoch 2, Average Loss: 4.0668
Epoch 3, Average Loss: 3.9496
Epoch 4, Average Loss: 3.7981
Epoch 5, Average Loss: 3.6825
Epoch 6, Average Loss: 3.5872
Epoch 7, Average Loss: 3.4844
Epoch 8, Average Loss: 3.4682
Epoch 9, Average Loss: 3.3220
Epoch 10, Average Loss: 3.2216
Accuracy: 15.2703
Training domains: ['Art', 'Clipart', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.3753
Epoch 2, Average Loss: 0.2010
Epoch 3, Average Loss: 0.1147
Epoch 4, Average Loss: 0.1180
Epoch 5, Average Loss: 0.1640
Epoch 6, Average Loss: 0.2101
Epoch 7, Average Loss: 0.2168
Epoch 8, Average Loss: 0.2085
Epoch 9, Average Loss: 0.1531
Epoch 10, Average Loss: 0.1208
Merged model device: cuda:0
Accuracy: 69.7748
Accuracy of Art model on test domain: 69.7748

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.3256
Epoch 2, Average Loss: 0.3447
Epoch 3, Average Loss: 0.2243
Epoch 4, Average Loss: 0.2310
Epoch 5, Average Loss: 0.3202
Epoch 6, Average Loss: 0.3007
Epoch 7, Average Loss: 0.2125
Epoch 8, Average Loss: 0.2074
Epoch 9, Average Loss: 0.2832
Epoch 10, Average Loss: 0.2038
Merged model device: cuda:0
Accuracy: 65.5856
Accuracy of Clipart model on test domain: 65.5856

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8304
Epoch 2, Average Loss: 0.1822
Epoch 3, Average Loss: 0.1765
Epoch 4, Average Loss: 0.1808
Epoch 5, Average Loss: 0.1540
Epoch 6, Average Loss: 0.2361
Epoch 7, Average Loss: 0.1796
Epoch 8, Average Loss: 0.1440
Epoch 9, Average Loss: 0.1270
Epoch 10, Average Loss: 0.1364
Merged model device: cuda:0
Accuracy: 74.5495
Accuracy of Real World model on test domain: 74.5495

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Clipart: 0.3333
  Real World: 0.3333
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.7464
Coefficient Epoch 2, Average Loss: 0.6875
Coefficient Epoch 3, Average Loss: 0.7038
Coefficient Epoch 4, Average Loss: 0.6963
Coefficient Epoch 5, Average Loss: 0.6951
Coefficient Epoch 6, Average Loss: 0.6862
Coefficient Epoch 7, Average Loss: 0.6934
Coefficient Epoch 8, Average Loss: 0.6867
Coefficient Epoch 9, Average Loss: 0.6977
Coefficient Epoch 10, Average Loss: 0.7088
Final device check:
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.308834969997406, 0.34469926357269287, 0.3464657962322235]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 86.6216
Final model accuracy on test domain: 86.6216

Run 4/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Real World
Training domains: ['Art', 'Clipart', 'Product']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Real World
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3925
Epoch 2, Average Loss: 4.1961
Epoch 3, Average Loss: 4.0477
Epoch 4, Average Loss: 3.9766
Epoch 5, Average Loss: 3.9141
Epoch 6, Average Loss: 3.8890
Epoch 7, Average Loss: 3.8367
Epoch 8, Average Loss: 3.8078
Epoch 9, Average Loss: 3.7164
Epoch 10, Average Loss: 3.6973
Accuracy: 5.8743
Training domains: ['Art', 'Clipart', 'Product']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.4608
Epoch 2, Average Loss: 0.2238
Epoch 3, Average Loss: 0.0937
Epoch 4, Average Loss: 0.0805
Epoch 5, Average Loss: 0.0653
Epoch 6, Average Loss: 0.2349
Epoch 7, Average Loss: 0.4493
Epoch 8, Average Loss: 0.2269
Epoch 9, Average Loss: 0.1171
Epoch 10, Average Loss: 0.0817
Merged model device: cuda:0
Accuracy: 77.8798
Accuracy of Art model on test domain: 77.8798

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.3118
Epoch 2, Average Loss: 0.3633
Epoch 3, Average Loss: 0.2821
Epoch 4, Average Loss: 0.2521
Epoch 5, Average Loss: 0.2462
Epoch 6, Average Loss: 0.2710
Epoch 7, Average Loss: 0.2165
Epoch 8, Average Loss: 0.1719
Epoch 9, Average Loss: 0.1476
Epoch 10, Average Loss: 0.1718
Merged model device: cuda:0
Accuracy: 67.9211
Accuracy of Clipart model on test domain: 67.9211

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.7357
Epoch 2, Average Loss: 0.1394
Epoch 3, Average Loss: 0.1271
Epoch 4, Average Loss: 0.1359
Epoch 5, Average Loss: 0.1673
Epoch 6, Average Loss: 0.1359
Epoch 7, Average Loss: 0.1335
Epoch 8, Average Loss: 0.1165
Epoch 9, Average Loss: 0.0650
Epoch 10, Average Loss: 0.0851
Merged model device: cuda:0
Accuracy: 66.6820
Accuracy of Product model on test domain: 66.6820

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Clipart: 0.3333
  Product: 0.3333
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.6921
Coefficient Epoch 2, Average Loss: 0.6076
Coefficient Epoch 3, Average Loss: 0.6139
Coefficient Epoch 4, Average Loss: 0.6240
Coefficient Epoch 5, Average Loss: 0.6203
Coefficient Epoch 6, Average Loss: 0.6097
Coefficient Epoch 7, Average Loss: 0.6456
Coefficient Epoch 8, Average Loss: 0.6336
Coefficient Epoch 9, Average Loss: 0.6287
Coefficient Epoch 10, Average Loss: 0.6036
Final device check:
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3674052953720093, 0.28426292538642883, 0.34833183884620667]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 88.4351
Final model accuracy on test domain: 88.4351

Run 5/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Art
Training domains: ['Clipart', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Art
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.5480
Epoch 2, Average Loss: 4.1880
Epoch 3, Average Loss: 4.1241
Epoch 4, Average Loss: 4.0840
Epoch 5, Average Loss: 4.0416
Epoch 6, Average Loss: 4.0058
Epoch 7, Average Loss: 3.9998
Epoch 8, Average Loss: 3.9081
Epoch 9, Average Loss: 3.8733
Epoch 10, Average Loss: 3.7955
Accuracy: 5.5189
Training domains: ['Clipart', 'Product', 'Real World']

Training expert models...

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.3734
Epoch 2, Average Loss: 0.3659
Epoch 3, Average Loss: 0.2559
Epoch 4, Average Loss: 0.2263
Epoch 5, Average Loss: 0.2766
Epoch 6, Average Loss: 0.2732
Epoch 7, Average Loss: 0.2162
Epoch 8, Average Loss: 0.2559
Epoch 9, Average Loss: 0.2369
Epoch 10, Average Loss: 0.1758
Merged model device: cuda:0
Accuracy: 55.8484
Accuracy of Clipart model on test domain: 55.8484

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.6949
Epoch 2, Average Loss: 0.1447
Epoch 3, Average Loss: 0.1426
Epoch 4, Average Loss: 0.1354
Epoch 5, Average Loss: 0.0969
Epoch 6, Average Loss: 0.1416
Epoch 7, Average Loss: 0.1448
Epoch 8, Average Loss: 0.1342
Epoch 9, Average Loss: 0.1614
Epoch 10, Average Loss: 0.1142
Merged model device: cuda:0
Accuracy: 43.8221
Accuracy of Product model on test domain: 43.8221

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8195
Epoch 2, Average Loss: 0.1657
Epoch 3, Average Loss: 0.1253
Epoch 4, Average Loss: 0.1983
Epoch 5, Average Loss: 0.2149
Epoch 6, Average Loss: 0.2112
Epoch 7, Average Loss: 0.1512
Epoch 8, Average Loss: 0.1700
Epoch 9, Average Loss: 0.1485
Epoch 10, Average Loss: 0.1281
Merged model device: cuda:0
Accuracy: 57.3311
Accuracy of Real World model on test domain: 57.3311

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Clipart: 0.3333
  Product: 0.3333
  Real World: 0.3333
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.5876
Coefficient Epoch 2, Average Loss: 1.3555
Coefficient Epoch 3, Average Loss: 1.3677
Coefficient Epoch 4, Average Loss: 1.3616
Coefficient Epoch 5, Average Loss: 1.3555
Coefficient Epoch 6, Average Loss: 1.3726
Coefficient Epoch 7, Average Loss: 1.3683
Coefficient Epoch 8, Average Loss: 1.3642
Coefficient Epoch 9, Average Loss: 1.3830
Coefficient Epoch 10, Average Loss: 1.3775
Final device check:
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3467996418476105, 0.29520371556282043, 0.3579966723918915]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 81.9605
Final model accuracy on test domain: 81.9605

Run 6/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Clipart
Training domains: ['Art', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Clipart
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.4017
Epoch 2, Average Loss: 4.1279
Epoch 3, Average Loss: 3.9927
Epoch 4, Average Loss: 3.8989
Epoch 5, Average Loss: 3.8139
Epoch 6, Average Loss: 3.7542
Epoch 7, Average Loss: 3.6620
Epoch 8, Average Loss: 3.6910
Epoch 9, Average Loss: 3.6613
Epoch 10, Average Loss: 3.5671
Accuracy: 7.8791
Training domains: ['Art', 'Product', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.5437
Epoch 2, Average Loss: 0.2536
Epoch 3, Average Loss: 0.1390
Epoch 4, Average Loss: 0.0871
Epoch 5, Average Loss: 0.0768
Epoch 6, Average Loss: 0.1165
Epoch 7, Average Loss: 0.3798
Epoch 8, Average Loss: 0.3459
Epoch 9, Average Loss: 0.2273
Epoch 10, Average Loss: 0.1147
Merged model device: cuda:0
Accuracy: 46.0376
Accuracy of Art model on test domain: 46.0376

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.7110
Epoch 2, Average Loss: 0.1341
Epoch 3, Average Loss: 0.1288
Epoch 4, Average Loss: 0.1322
Epoch 5, Average Loss: 0.1343
Epoch 6, Average Loss: 0.1393
Epoch 7, Average Loss: 0.1183
Epoch 8, Average Loss: 0.1051
Epoch 9, Average Loss: 0.1000
Epoch 10, Average Loss: 0.1143
Merged model device: cuda:0
Accuracy: 40.6322
Accuracy of Product model on test domain: 40.6322

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8545
Epoch 2, Average Loss: 0.1895
Epoch 3, Average Loss: 0.2094
Epoch 4, Average Loss: 0.1474
Epoch 5, Average Loss: 0.1154
Epoch 6, Average Loss: 0.1535
Epoch 7, Average Loss: 0.2017
Epoch 8, Average Loss: 0.1836
Epoch 9, Average Loss: 0.1160
Epoch 10, Average Loss: 0.1175
Merged model device: cuda:0
Accuracy: 40.4489
Accuracy of Real World model on test domain: 40.4489

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Product: 0.3333
  Real World: 0.3333
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.1199
Coefficient Epoch 2, Average Loss: 1.8756
Coefficient Epoch 3, Average Loss: 1.9157
Coefficient Epoch 4, Average Loss: 1.8969
Coefficient Epoch 5, Average Loss: 1.9029
Coefficient Epoch 6, Average Loss: 1.9017
Coefficient Epoch 7, Average Loss: 1.8898
Coefficient Epoch 8, Average Loss: 1.8887
Coefficient Epoch 9, Average Loss: 1.8987
Coefficient Epoch 10, Average Loss: 1.9102
Final device check:
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3380795121192932, 0.31189557909965515, 0.35002490878105164]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 64.9107
Final model accuracy on test domain: 64.9107

Run 7/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Product
Training domains: ['Art', 'Clipart', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Product
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3282
Epoch 2, Average Loss: 3.9831
Epoch 3, Average Loss: 3.8299
Epoch 4, Average Loss: 3.7072
Epoch 5, Average Loss: 3.5911
Epoch 6, Average Loss: 3.5600
Epoch 7, Average Loss: 3.4666
Epoch 8, Average Loss: 3.3734
Epoch 9, Average Loss: 3.3075
Epoch 10, Average Loss: 3.2316
Accuracy: 12.5676
Training domains: ['Art', 'Clipart', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.5075
Epoch 2, Average Loss: 0.2787
Epoch 3, Average Loss: 0.1224
Epoch 4, Average Loss: 0.0779
Epoch 5, Average Loss: 0.1188
Epoch 6, Average Loss: 0.1356
Epoch 7, Average Loss: 0.2319
Epoch 8, Average Loss: 0.3064
Epoch 9, Average Loss: 0.2072
Epoch 10, Average Loss: 0.1139
Merged model device: cuda:0
Accuracy: 68.3333
Accuracy of Art model on test domain: 68.3333

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.3292
Epoch 2, Average Loss: 0.3446
Epoch 3, Average Loss: 0.2948
Epoch 4, Average Loss: 0.2188
Epoch 5, Average Loss: 0.2002
Epoch 6, Average Loss: 0.2256
Epoch 7, Average Loss: 0.3025
Epoch 8, Average Loss: 0.2963
Epoch 9, Average Loss: 0.2464
Epoch 10, Average Loss: 0.1792
Merged model device: cuda:0
Accuracy: 65.0000
Accuracy of Clipart model on test domain: 65.0000

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8355
Epoch 2, Average Loss: 0.2072
Epoch 3, Average Loss: 0.1365
Epoch 4, Average Loss: 0.1608
Epoch 5, Average Loss: 0.3534
Epoch 6, Average Loss: 0.1581
Epoch 7, Average Loss: 0.2227
Epoch 8, Average Loss: 0.1403
Epoch 9, Average Loss: 0.1088
Epoch 10, Average Loss: 0.1006
Merged model device: cuda:0
Accuracy: 73.8739
Accuracy of Real World model on test domain: 73.8739

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Clipart: 0.3333
  Real World: 0.3333
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.7240
Coefficient Epoch 2, Average Loss: 0.6431
Coefficient Epoch 3, Average Loss: 0.6463
Coefficient Epoch 4, Average Loss: 0.6560
Coefficient Epoch 5, Average Loss: 0.6422
Coefficient Epoch 6, Average Loss: 0.6450
Coefficient Epoch 7, Average Loss: 0.6499
Coefficient Epoch 8, Average Loss: 0.6493
Coefficient Epoch 9, Average Loss: 0.6528
Coefficient Epoch 10, Average Loss: 0.6525
Final device check:
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3047249913215637, 0.30474939942359924, 0.3905256390571594]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 85.4955
Final model accuracy on test domain: 85.4955

Run 8/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Real World
Training domains: ['Art', 'Clipart', 'Product']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Real World
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3703
Epoch 2, Average Loss: 4.1269
Epoch 3, Average Loss: 4.0501
Epoch 4, Average Loss: 3.9433
Epoch 5, Average Loss: 3.8676
Epoch 6, Average Loss: 3.8451
Epoch 7, Average Loss: 3.7650
Epoch 8, Average Loss: 3.6039
Epoch 9, Average Loss: 3.6191
Epoch 10, Average Loss: 3.5905
Accuracy: 9.6833
Training domains: ['Art', 'Clipart', 'Product']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.4642
Epoch 2, Average Loss: 0.1935
Epoch 3, Average Loss: 0.0953
Epoch 4, Average Loss: 0.1063
Epoch 5, Average Loss: 0.1218
Epoch 6, Average Loss: 0.2682
Epoch 7, Average Loss: 0.1977
Epoch 8, Average Loss: 0.1806
Epoch 9, Average Loss: 0.1446
Epoch 10, Average Loss: 0.0903
Merged model device: cuda:0
Accuracy: 78.2010
Accuracy of Art model on test domain: 78.2010

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.3462
Epoch 2, Average Loss: 0.3615
Epoch 3, Average Loss: 0.2561
Epoch 4, Average Loss: 0.2332
Epoch 5, Average Loss: 0.2616
Epoch 6, Average Loss: 0.2595
Epoch 7, Average Loss: 0.2821
Epoch 8, Average Loss: 0.3068
Epoch 9, Average Loss: 0.2378
Epoch 10, Average Loss: 0.1950
Merged model device: cuda:0
Accuracy: 69.9403
Accuracy of Clipart model on test domain: 69.9403

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.6986
Epoch 2, Average Loss: 0.1224
Epoch 3, Average Loss: 0.0862
Epoch 4, Average Loss: 0.2281
Epoch 5, Average Loss: 0.1816
Epoch 6, Average Loss: 0.1346
Epoch 7, Average Loss: 0.1199
Epoch 8, Average Loss: 0.1062
Epoch 9, Average Loss: 0.0814
Epoch 10, Average Loss: 0.1249
Merged model device: cuda:0
Accuracy: 64.3414
Accuracy of Product model on test domain: 64.3414

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Clipart: 0.3333
  Product: 0.3333
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 0.6513
Coefficient Epoch 2, Average Loss: 0.6106
Coefficient Epoch 3, Average Loss: 0.6127
Coefficient Epoch 4, Average Loss: 0.6215
Coefficient Epoch 5, Average Loss: 0.6111
Coefficient Epoch 6, Average Loss: 0.6148
Coefficient Epoch 7, Average Loss: 0.6075
Coefficient Epoch 8, Average Loss: 0.6367
Coefficient Epoch 9, Average Loss: 0.6333
Coefficient Epoch 10, Average Loss: 0.6310
Final device check:
Expert model Art device: cuda:0
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Coefficient training complete.
Learned coefficients: [0.34342557191848755, 0.3261095881462097, 0.33046481013298035]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 87.6549
Final model accuracy on test domain: 87.6549

Run 9/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Art
Training domains: ['Clipart', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Art
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.6139
Epoch 2, Average Loss: 4.2043
Epoch 3, Average Loss: 4.1173
Epoch 4, Average Loss: 4.0861
Epoch 5, Average Loss: 4.0369
Epoch 6, Average Loss: 3.9638
Epoch 7, Average Loss: 3.9315
Epoch 8, Average Loss: 3.8958
Epoch 9, Average Loss: 3.8825
Epoch 10, Average Loss: 3.8745
Accuracy: 6.8369
Training domains: ['Clipart', 'Product', 'Real World']

Training expert models...

Training model for domain: Clipart
Training model for domain: Clipart
Epoch 1, Average Loss: 1.2979
Epoch 2, Average Loss: 0.3510
Epoch 3, Average Loss: 0.2485
Epoch 4, Average Loss: 0.2403
Epoch 5, Average Loss: 0.2278
Epoch 6, Average Loss: 0.2566
Epoch 7, Average Loss: 0.2784
Epoch 8, Average Loss: 0.2560
Epoch 9, Average Loss: 0.1943
Epoch 10, Average Loss: 0.2891
Merged model device: cuda:0
Accuracy: 43.8221
Accuracy of Clipart model on test domain: 43.8221

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.6898
Epoch 2, Average Loss: 0.1320
Epoch 3, Average Loss: 0.1049
Epoch 4, Average Loss: 0.1379
Epoch 5, Average Loss: 0.2132
Epoch 6, Average Loss: 0.1656
Epoch 7, Average Loss: 0.1409
Epoch 8, Average Loss: 0.0870
Epoch 9, Average Loss: 0.1319
Epoch 10, Average Loss: 0.1102
Merged model device: cuda:0
Accuracy: 46.6227
Accuracy of Product model on test domain: 46.6227

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.8117
Epoch 2, Average Loss: 0.1870
Epoch 3, Average Loss: 0.1687
Epoch 4, Average Loss: 0.1552
Epoch 5, Average Loss: 0.1896
Epoch 6, Average Loss: 0.2012
Epoch 7, Average Loss: 0.2808
Epoch 8, Average Loss: 0.2048
Epoch 9, Average Loss: 0.1306
Epoch 10, Average Loss: 0.1014
Merged model device: cuda:0
Accuracy: 63.2619
Accuracy of Real World model on test domain: 63.2619

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Clipart: 0.3333
  Product: 0.3333
  Real World: 0.3333
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Clipart - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 1.5203
Coefficient Epoch 2, Average Loss: 1.2909
Coefficient Epoch 3, Average Loss: 1.3024
Coefficient Epoch 4, Average Loss: 1.2914
Coefficient Epoch 5, Average Loss: 1.2862
Coefficient Epoch 6, Average Loss: 1.3044
Coefficient Epoch 7, Average Loss: 1.2955
Coefficient Epoch 8, Average Loss: 1.3046
Coefficient Epoch 9, Average Loss: 1.2984
Coefficient Epoch 10, Average Loss: 1.2905
Final device check:
Expert model Clipart device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.32421576976776123, 0.3178692162036896, 0.3579150140285492]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 79.8188
Final model accuracy on test domain: 79.8188

Run 10/10
Preparing data...
Domains: ['Art', 'Clipart', 'Product', 'Real World']
Selected test domain: Clipart
Training domains: ['Art', 'Product', 'Real World']

Domain: Clipart
  Class ToothBrush: 39 samples
  Class File_Cabinet: 40 samples
  Class Glasses: 52 samples
  Class Drill: 48 samples
  Class Kettle: 40 samples
  Class Soda: 61 samples
  Class TV: 99 samples
  Class Ruler: 67 samples
  Class Push_Pin: 40 samples
  Class Sneakers: 43 samples
  Class Postit_Notes: 41 samples
  Class Oven: 40 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 40 samples
  Class Mouse: 76 samples
  Class Sink: 42 samples
  Class Screwdriver: 75 samples
  Class Keyboard: 99 samples
  Class Toys: 99 samples
  Class Shelf: 42 samples
  Class Calculator: 46 samples
  Class Eraser: 40 samples
  Class Computer: 99 samples
  Class Mug: 99 samples
  Class Pencil: 99 samples
  Class Knives: 53 samples
  Class Marker: 71 samples
  Class Fan: 50 samples
  Class Trash_Can: 53 samples
  Class Flipflops: 40 samples
  Class Clipboards: 40 samples
  Class Hammer: 99 samples
  Class Helmet: 69 samples
  Class Exit_Sign: 41 samples
  Class Alarm_Clock: 60 samples
  Class Mop: 40 samples
  Class Curtains: 42 samples
  Class Printer: 87 samples
  Class Pen: 99 samples
  Class Speaker: 90 samples
  Class Chair: 99 samples
  Class Folder: 99 samples
  Class Telephone: 99 samples
  Class Bucket: 73 samples
  Class Webcam: 40 samples
  Class Backpack: 56 samples
  Class Bottle: 99 samples
  Class Fork: 61 samples
  Class Pan: 51 samples
  Class Candles: 99 samples
  Class Notebook: 83 samples
  Class Calendar: 78 samples
  Class Table: 80 samples
  Class Flowers: 99 samples
  Class Laptop: 99 samples
  Class Monitor: 99 samples
  Class Desk_Lamp: 41 samples
  Class Spoon: 60 samples
  Class Scissors: 99 samples
  Class Radio: 46 samples
  Class Paper_Clip: 40 samples
  Class Couch: 64 samples
  Class Bike: 99 samples
  Class Refrigerator: 40 samples
  Class Bed: 98 samples
  Total samples: 4365

Domain: Product
  Class ToothBrush: 42 samples
  Class File_Cabinet: 71 samples
  Class Glasses: 67 samples
  Class Drill: 67 samples
  Class Kettle: 72 samples
  Class Soda: 43 samples
  Class TV: 76 samples
  Class Ruler: 58 samples
  Class Push_Pin: 43 samples
  Class Sneakers: 99 samples
  Class Postit_Notes: 38 samples
  Class Oven: 68 samples
  Class Batteries: 62 samples
  Class Lamp_Shade: 54 samples
  Class Mouse: 96 samples
  Class Sink: 46 samples
  Class Screwdriver: 40 samples
  Class Keyboard: 99 samples
  Class Toys: 45 samples
  Class Shelf: 49 samples
  Class Calculator: 81 samples
  Class Eraser: 41 samples
  Class Computer: 96 samples
  Class Mug: 41 samples
  Class Pencil: 40 samples
  Class Knives: 41 samples
  Class Marker: 56 samples
  Class Fan: 58 samples
  Class Trash_Can: 93 samples
  Class Flipflops: 99 samples
  Class Clipboards: 65 samples
  Class Hammer: 57 samples
  Class Helmet: 90 samples
  Class Exit_Sign: 67 samples
  Class Alarm_Clock: 79 samples
  Class Mop: 72 samples
  Class Curtains: 75 samples
  Class Printer: 99 samples
  Class Pen: 60 samples
  Class Speaker: 99 samples
  Class Chair: 99 samples
  Class Folder: 90 samples
  Class Telephone: 58 samples
  Class Bucket: 47 samples
  Class Webcam: 98 samples
  Class Backpack: 99 samples
  Class Bottle: 62 samples
  Class Fork: 41 samples
  Class Pan: 70 samples
  Class Candles: 56 samples
  Class Notebook: 93 samples
  Class Calendar: 81 samples
  Class Table: 60 samples
  Class Flowers: 91 samples
  Class Laptop: 99 samples
  Class Monitor: 98 samples
  Class Desk_Lamp: 83 samples
  Class Spoon: 47 samples
  Class Scissors: 99 samples
  Class Radio: 43 samples
  Class Paper_Clip: 47 samples
  Class Couch: 88 samples
  Class Bike: 44 samples
  Class Refrigerator: 59 samples
  Class Bed: 43 samples
  Total samples: 4439

Domain: Real World
  Class ToothBrush: 85 samples
  Class File_Cabinet: 58 samples
  Class Glasses: 60 samples
  Class Drill: 51 samples
  Class Kettle: 72 samples
  Class Soda: 63 samples
  Class TV: 53 samples
  Class Ruler: 41 samples
  Class Push_Pin: 53 samples
  Class Sneakers: 88 samples
  Class Postit_Notes: 67 samples
  Class Oven: 64 samples
  Class Batteries: 64 samples
  Class Lamp_Shade: 78 samples
  Class Mouse: 60 samples
  Class Sink: 77 samples
  Class Screwdriver: 51 samples
  Class Keyboard: 75 samples
  Class Toys: 67 samples
  Class Shelf: 66 samples
  Class Calculator: 73 samples
  Class Eraser: 43 samples
  Class Computer: 64 samples
  Class Mug: 58 samples
  Class Pencil: 59 samples
  Class Knives: 83 samples
  Class Marker: 23 samples
  Class Fan: 60 samples
  Class Trash_Can: 81 samples
  Class Flipflops: 85 samples
  Class Clipboards: 65 samples
  Class Hammer: 52 samples
  Class Helmet: 60 samples
  Class Exit_Sign: 81 samples
  Class Alarm_Clock: 86 samples
  Class Mop: 46 samples
  Class Curtains: 73 samples
  Class Printer: 52 samples
  Class Pen: 65 samples
  Class Speaker: 81 samples
  Class Chair: 96 samples
  Class Folder: 57 samples
  Class Telephone: 82 samples
  Class Bucket: 80 samples
  Class Webcam: 49 samples
  Class Backpack: 99 samples
  Class Bottle: 78 samples
  Class Fork: 36 samples
  Class Pan: 30 samples
  Class Candles: 99 samples
  Class Notebook: 68 samples
  Class Calendar: 68 samples
  Class Table: 59 samples
  Class Flowers: 75 samples
  Class Laptop: 67 samples
  Class Monitor: 71 samples
  Class Desk_Lamp: 62 samples
  Class Spoon: 54 samples
  Class Scissors: 77 samples
  Class Radio: 66 samples
  Class Paper_Clip: 68 samples
  Class Couch: 76 samples
  Class Bike: 99 samples
  Class Refrigerator: 75 samples
  Class Bed: 83 samples
  Total samples: 4357

Domain: Art
  Class ToothBrush: 43 samples
  Class File_Cabinet: 22 samples
  Class Glasses: 40 samples
  Class Drill: 15 samples
  Class Kettle: 46 samples
  Class Soda: 40 samples
  Class TV: 40 samples
  Class Ruler: 15 samples
  Class Push_Pin: 24 samples
  Class Sneakers: 46 samples
  Class Postit_Notes: 19 samples
  Class Oven: 20 samples
  Class Batteries: 27 samples
  Class Lamp_Shade: 49 samples
  Class Mouse: 18 samples
  Class Sink: 41 samples
  Class Screwdriver: 30 samples
  Class Keyboard: 18 samples
  Class Toys: 20 samples
  Class Shelf: 42 samples
  Class Calculator: 33 samples
  Class Eraser: 18 samples
  Class Computer: 44 samples
  Class Mug: 49 samples
  Class Pencil: 26 samples
  Class Knives: 72 samples
  Class Marker: 20 samples
  Class Fan: 45 samples
  Class Trash_Can: 21 samples
  Class Flipflops: 46 samples
  Class Clipboards: 25 samples
  Class Hammer: 40 samples
  Class Helmet: 79 samples
  Class Exit_Sign: 21 samples
  Class Alarm_Clock: 74 samples
  Class Mop: 32 samples
  Class Curtains: 40 samples
  Class Printer: 18 samples
  Class Pen: 20 samples
  Class Speaker: 20 samples
  Class Chair: 69 samples
  Class Folder: 20 samples
  Class Telephone: 44 samples
  Class Bucket: 40 samples
  Class Webcam: 16 samples
  Class Backpack: 41 samples
  Class Bottle: 99 samples
  Class Fork: 46 samples
  Class Pan: 19 samples
  Class Candles: 76 samples
  Class Notebook: 21 samples
  Class Calendar: 20 samples
  Class Table: 16 samples
  Class Flowers: 90 samples
  Class Laptop: 51 samples
  Class Monitor: 42 samples
  Class Desk_Lamp: 23 samples
  Class Spoon: 46 samples
  Class Scissors: 20 samples
  Class Radio: 47 samples
  Class Paper_Clip: 19 samples
  Class Couch: 40 samples
  Class Bike: 75 samples
  Class Refrigerator: 49 samples
  Class Bed: 40 samples
  Total samples: 2427
Test domain: Clipart
Performing naive fine-tuning on test domain
Epoch 1, Average Loss: 4.3455
Epoch 2, Average Loss: 4.0974
Epoch 3, Average Loss: 3.9611
Epoch 4, Average Loss: 3.8274
Epoch 5, Average Loss: 3.7165
Epoch 6, Average Loss: 3.6794
Epoch 7, Average Loss: 3.7262
Epoch 8, Average Loss: 3.6410
Epoch 9, Average Loss: 3.6208
Epoch 10, Average Loss: 3.6705
Accuracy: 7.7416
Training domains: ['Art', 'Product', 'Real World']

Training expert models...

Training model for domain: Art
Training model for domain: Art
Epoch 1, Average Loss: 1.4518
Epoch 2, Average Loss: 0.2402
Epoch 3, Average Loss: 0.1353
Epoch 4, Average Loss: 0.0918
Epoch 5, Average Loss: 0.1109
Epoch 6, Average Loss: 0.1862
Epoch 7, Average Loss: 0.1917
Epoch 8, Average Loss: 0.2597
Epoch 9, Average Loss: 0.1696
Epoch 10, Average Loss: 0.0893
Merged model device: cuda:0
Accuracy: 50.3894
Accuracy of Art model on test domain: 50.3894

Training model for domain: Product
Training model for domain: Product
Epoch 1, Average Loss: 0.7231
Epoch 2, Average Loss: 0.1149
Epoch 3, Average Loss: 0.1148
Epoch 4, Average Loss: 0.1734
Epoch 5, Average Loss: 0.1553
Epoch 6, Average Loss: 0.1600
Epoch 7, Average Loss: 0.1245
Epoch 8, Average Loss: 0.1391
Epoch 9, Average Loss: 0.1052
Epoch 10, Average Loss: 0.0929
Merged model device: cuda:0
Accuracy: 40.8154
Accuracy of Product model on test domain: 40.8154

Training model for domain: Real World
Training model for domain: Real World
Epoch 1, Average Loss: 0.7858
Epoch 2, Average Loss: 0.1784
Epoch 3, Average Loss: 0.1777
Epoch 4, Average Loss: 0.2047
Epoch 5, Average Loss: 0.1741
Epoch 6, Average Loss: 0.1584
Epoch 7, Average Loss: 0.1280
Epoch 8, Average Loss: 0.2028
Epoch 9, Average Loss: 0.1996
Epoch 10, Average Loss: 0.1668
Merged model device: cuda:0
Accuracy: 42.0064
Accuracy of Real World model on test domain: 42.0064

Training coefficients...
Training coefficients for weight averaging
Device: cuda
Coefficients device: cuda:0
Initial coefficients (after normalization):
  Art: 0.3333
  Product: 0.3333
  Real World: 0.3333
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Domain Art - Input device: cuda:0, Model device: cuda:0
Domain Product - Input device: cuda:0, Model device: cuda:0
Domain Real World - Input device: cuda:0, Model device: cuda:0
Coefficient Epoch 1, Average Loss: 2.1964
Coefficient Epoch 2, Average Loss: 1.9332
Coefficient Epoch 3, Average Loss: 1.9401
Coefficient Epoch 4, Average Loss: 1.9293
Coefficient Epoch 5, Average Loss: 1.9385
Coefficient Epoch 6, Average Loss: 1.9302
Coefficient Epoch 7, Average Loss: 1.9702
Coefficient Epoch 8, Average Loss: 1.9440
Coefficient Epoch 9, Average Loss: 1.9403
Coefficient Epoch 10, Average Loss: 1.9562
Final device check:
Expert model Art device: cuda:0
Expert model Product device: cuda:0
Expert model Real World device: cuda:0
Coefficient training complete.
Learned coefficients: [0.3456926941871643, 0.3167998790740967, 0.3375074565410614]

Creating weight-averaged model...
Creating weight-averaged model
Weight-averaged model created.

Evaluating final model...
Accuracy: 63.8571
Final model accuracy on test domain: 63.8571

Summary for OfficeHome:
Debug: Type of results: <class 'list'>
Debug: Content of results: [{'test_domain': 'Art', 'domain_accuracies': {'Clipart': 53.212520593080725, 'Product': 44.64579901153213, 'Real World': 56.919275123558485}, 'final_accuracy': 79.9011532125206, 'coefficients': [0.34779077768325806, 0.3073280453681946, 0.34488117694854736]}, {'test_domain': 'Clipart', 'domain_accuracies': {'Art': 49.28996793403574, 'Product': 37.700412276683466, 'Real World': 44.93815849748053}, 'final_accuracy': 63.5822262940907, 'coefficients': [0.37312230467796326, 0.2959737479686737, 0.33090394735336304]}, {'test_domain': 'Product', 'domain_accuracies': {'Art': 69.77477477477477, 'Clipart': 65.58558558558558, 'Real World': 74.54954954954955}, 'final_accuracy': 86.62162162162163, 'coefficients': [0.308834969997406, 0.34469926357269287, 0.3464657962322235]}, {'test_domain': 'Real World', 'domain_accuracies': {'Art': 77.87976135842129, 'Clipart': 67.92106470858191, 'Product': 66.68196420376319}, 'final_accuracy': 88.43506195502525, 'coefficients': [0.3674052953720093, 0.28426292538642883, 0.34833183884620667]}, {'test_domain': 'Art', 'domain_accuracies': {'Clipart': 55.84843492586491, 'Product': 43.82207578253707, 'Real World': 57.33113673805601}, 'final_accuracy': 81.96046128500824, 'coefficients': [0.3467996418476105, 0.29520371556282043, 0.3579966723918915]}, {'test_domain': 'Clipart', 'domain_accuracies': {'Art': 46.03756298671553, 'Product': 40.632157581310125, 'Real World': 40.448923499770956}, 'final_accuracy': 64.91067338524965, 'coefficients': [0.3380795121192932, 0.31189557909965515, 0.35002490878105164]}, {'test_domain': 'Product', 'domain_accuracies': {'Art': 68.33333333333333, 'Clipart': 65.0, 'Real World': 73.87387387387388}, 'final_accuracy': 85.4954954954955, 'coefficients': [0.3047249913215637, 0.30474939942359924, 0.3905256390571594]}, {'test_domain': 'Real World', 'domain_accuracies': {'Art': 78.20100963744837, 'Clipart': 69.94033960532354, 'Product': 64.34144102799449}, 'final_accuracy': 87.65488756310233, 'coefficients': [0.34342557191848755, 0.3261095881462097, 0.33046481013298035]}, {'test_domain': 'Art', 'domain_accuracies': {'Clipart': 43.82207578253707, 'Product': 46.62273476112026, 'Real World': 63.26194398682043}, 'final_accuracy': 79.81878088962108, 'coefficients': [0.32421576976776123, 0.3178692162036896, 0.3579150140285492]}, {'test_domain': 'Clipart', 'domain_accuracies': {'Art': 50.38937242327073, 'Product': 40.81539166284929, 'Real World': 42.00641319285387}, 'final_accuracy': 63.857077416399456, 'coefficients': [0.3456926941871643, 0.3167998790740967, 0.3375074565410614]}]
Final Model Accuracy: 78.2237 ± 9.6641
Domain-specific Accuracies:
  Clipart: 60.1900 ± 8.8037
  Product: 48.1577 ± 10.3589
  Real World: 56.6662 ± 12.6263
  Art: 62.8437 ± 12.8806
Average Coefficients:
  Coefficient 1: 0.3400 ± 0.0211
  Coefficient 2: 0.3105 ± 0.0164
  Coefficient 3: 0.3495 ± 0.0165
Debug: Type of results: <class 'dict'>
Debug: Content of results: {'OfficeHome': [{'test_domain': 'Art', 'domain_accuracies': {'Clipart': 53.212520593080725, 'Product': 44.64579901153213, 'Real World': 56.919275123558485}, 'final_accuracy': 79.9011532125206, 'coefficients': [0.34779077768325806, 0.3073280453681946, 0.34488117694854736]}, {'test_domain': 'Clipart', 'domain_accuracies': {'Art': 49.28996793403574, 'Product': 37.700412276683466, 'Real World': 44.93815849748053}, 'final_accuracy': 63.5822262940907, 'coefficients': [0.37312230467796326, 0.2959737479686737, 0.33090394735336304]}, {'test_domain': 'Product', 'domain_accuracies': {'Art': 69.77477477477477, 'Clipart': 65.58558558558558, 'Real World': 74.54954954954955}, 'final_accuracy': 86.62162162162163, 'coefficients': [0.308834969997406, 0.34469926357269287, 0.3464657962322235]}, {'test_domain': 'Real World', 'domain_accuracies': {'Art': 77.87976135842129, 'Clipart': 67.92106470858191, 'Product': 66.68196420376319}, 'final_accuracy': 88.43506195502525, 'coefficients': [0.3674052953720093, 0.28426292538642883, 0.34833183884620667]}, {'test_domain': 'Art', 'domain_accuracies': {'Clipart': 55.84843492586491, 'Product': 43.82207578253707, 'Real World': 57.33113673805601}, 'final_accuracy': 81.96046128500824, 'coefficients': [0.3467996418476105, 0.29520371556282043, 0.3579966723918915]}, {'test_domain': 'Clipart', 'domain_accuracies': {'Art': 46.03756298671553, 'Product': 40.632157581310125, 'Real World': 40.448923499770956}, 'final_accuracy': 64.91067338524965, 'coefficients': [0.3380795121192932, 0.31189557909965515, 0.35002490878105164]}, {'test_domain': 'Product', 'domain_accuracies': {'Art': 68.33333333333333, 'Clipart': 65.0, 'Real World': 73.87387387387388}, 'final_accuracy': 85.4954954954955, 'coefficients': [0.3047249913215637, 0.30474939942359924, 0.3905256390571594]}, {'test_domain': 'Real World', 'domain_accuracies': {'Art': 78.20100963744837, 'Clipart': 69.94033960532354, 'Product': 64.34144102799449}, 'final_accuracy': 87.65488756310233, 'coefficients': [0.34342557191848755, 0.3261095881462097, 0.33046481013298035]}, {'test_domain': 'Art', 'domain_accuracies': {'Clipart': 43.82207578253707, 'Product': 46.62273476112026, 'Real World': 63.26194398682043}, 'final_accuracy': 79.81878088962108, 'coefficients': [0.32421576976776123, 0.3178692162036896, 0.3579150140285492]}, {'test_domain': 'Clipart', 'domain_accuracies': {'Art': 50.38937242327073, 'Product': 40.81539166284929, 'Real World': 42.00641319285387}, 'final_accuracy': 63.857077416399456, 'coefficients': [0.3456926941871643, 0.3167998790740967, 0.3375074565410614]}]}
No valid results to summarize.
