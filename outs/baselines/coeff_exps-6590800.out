
--- Run 1/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: sketch
Train domains: ['cartoon', 'photo', 'art_painting']

Training LoRA adapter for domain: cartoon
Epoch 1/5, Train Loss: 3.0294, Train Accuracy: 11.43%
Val Loss: 2.3869, Val Accuracy: 11.43%
Epoch 2/5, Train Loss: 2.4375, Train Accuracy: 16.43%
Val Loss: 2.0979, Val Accuracy: 14.29%
Epoch 3/5, Train Loss: 2.2934, Train Accuracy: 14.29%
Val Loss: 2.3259, Val Accuracy: 11.43%
Epoch 4/5, Train Loss: 2.1472, Train Accuracy: 10.71%
Val Loss: 2.0483, Val Accuracy: 28.57%
Epoch 5/5, Train Loss: 1.9437, Train Accuracy: 22.86%
Val Loss: 1.7968, Val Accuracy: 37.14%
cartoon adapter trained. Validation Accuracy: 37.14%

Training LoRA adapter for domain: photo
Epoch 1/5, Train Loss: 2.5082, Train Accuracy: 18.57%
Val Loss: 3.3273, Val Accuracy: 17.14%
Epoch 2/5, Train Loss: 2.2751, Train Accuracy: 12.14%
Val Loss: 1.8673, Val Accuracy: 17.14%
Epoch 3/5, Train Loss: 1.9011, Train Accuracy: 23.57%
Val Loss: 1.7995, Val Accuracy: 22.86%
Epoch 4/5, Train Loss: 1.5983, Train Accuracy: 34.29%
Val Loss: 1.7472, Val Accuracy: 37.14%
Epoch 5/5, Train Loss: 1.3924, Train Accuracy: 44.29%
Val Loss: 1.6347, Val Accuracy: 45.71%
photo adapter trained. Validation Accuracy: 45.71%

Training LoRA adapter for domain: art_painting
Epoch 1/5, Train Loss: 2.3334, Train Accuracy: 13.57%
Val Loss: 1.6661, Val Accuracy: 22.86%
Epoch 2/5, Train Loss: 2.0484, Train Accuracy: 12.14%
Val Loss: 2.4891, Val Accuracy: 2.86%
Epoch 3/5, Train Loss: 2.0179, Train Accuracy: 20.00%
Val Loss: 1.8352, Val Accuracy: 28.57%
Epoch 4/5, Train Loss: 1.9428, Train Accuracy: 22.86%
Val Loss: 1.9171, Val Accuracy: 14.29%
Epoch 5/5, Train Loss: 1.8350, Train Accuracy: 26.43%
Val Loss: 1.8349, Val Accuracy: 25.71%
art_painting adapter trained. Validation Accuracy: 28.57%

Training coefficients for adapter merging
Epoch 1, Loss: 1.9869, Accuracy: 23.53%
Coefficients: [0.32215026 0.3309524  0.34689736]
Epoch 2, Loss: 1.9864, Accuracy: 23.53%
Coefficients: [0.32085654 0.33147198 0.34767145]
Epoch 3, Loss: 1.9866, Accuracy: 23.53%
Coefficients: [0.32039505 0.33116558 0.34843937]
Epoch 4, Loss: 1.9859, Accuracy: 23.53%
Coefficients: [0.32009134 0.3311533  0.34875536]
Epoch 5, Loss: 1.9855, Accuracy: 23.53%
Coefficients: [0.32002184 0.33113322 0.34884495]
Best coefficient accuracy: 23.53%
Final best coefficients: [0.32215026 0.3309524  0.34689736]

Merged model - Test Loss: 2.1961, Test Accuracy: 14.56%
Base model - Test Loss: 1.9959, Test Accuracy: 14.56%

--- Run 2/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: sketch
Train domains: ['cartoon', 'photo', 'art_painting']

Training LoRA adapter for domain: cartoon
Epoch 1/5, Train Loss: 3.0294, Train Accuracy: 11.43%
Val Loss: 2.3869, Val Accuracy: 11.43%
Epoch 2/5, Train Loss: 2.4375, Train Accuracy: 16.43%
Val Loss: 2.0979, Val Accuracy: 14.29%
Epoch 3/5, Train Loss: 2.2934, Train Accuracy: 14.29%
Val Loss: 2.3258, Val Accuracy: 11.43%
Epoch 4/5, Train Loss: 2.1472, Train Accuracy: 10.71%
Val Loss: 2.0483, Val Accuracy: 28.57%
Epoch 5/5, Train Loss: 1.9437, Train Accuracy: 22.86%
Val Loss: 1.7968, Val Accuracy: 37.14%
cartoon adapter trained. Validation Accuracy: 37.14%

Training LoRA adapter for domain: photo
Epoch 1/5, Train Loss: 2.5082, Train Accuracy: 18.57%
Val Loss: 3.3274, Val Accuracy: 17.14%
Epoch 2/5, Train Loss: 2.2751, Train Accuracy: 12.14%
Val Loss: 1.8673, Val Accuracy: 17.14%
Epoch 3/5, Train Loss: 1.9013, Train Accuracy: 23.57%
Val Loss: 1.8001, Val Accuracy: 22.86%
Epoch 4/5, Train Loss: 1.5975, Train Accuracy: 34.29%
Val Loss: 1.8113, Val Accuracy: 31.43%
Epoch 5/5, Train Loss: 1.5522, Train Accuracy: 38.57%
Val Loss: 1.6722, Val Accuracy: 37.14%
photo adapter trained. Validation Accuracy: 37.14%

Training LoRA adapter for domain: art_painting
Epoch 1/5, Train Loss: 2.3772, Train Accuracy: 13.57%
Val Loss: 1.7855, Val Accuracy: 28.57%
Epoch 2/5, Train Loss: 2.0932, Train Accuracy: 17.86%
Val Loss: 2.2973, Val Accuracy: 2.86%
Epoch 3/5, Train Loss: 1.9267, Train Accuracy: 25.71%
Val Loss: 1.9759, Val Accuracy: 14.29%
Epoch 4/5, Train Loss: 1.7661, Train Accuracy: 32.86%
Val Loss: 1.9624, Val Accuracy: 17.14%
Epoch 5/5, Train Loss: 1.5146, Train Accuracy: 37.14%
Val Loss: 2.1550, Val Accuracy: 8.57%
art_painting adapter trained. Validation Accuracy: 28.57%

Training coefficients for adapter merging
Epoch 1, Loss: 3.9496, Accuracy: 17.65%
Coefficients: [0.3243781  0.33324102 0.34238094]
Epoch 2, Loss: 3.9487, Accuracy: 17.65%
Coefficients: [0.32583085 0.33272392 0.34144524]
Epoch 3, Loss: 3.9497, Accuracy: 17.65%
Coefficients: [0.32584313 0.33226454 0.34189236]
Epoch 4, Loss: 3.9467, Accuracy: 17.65%
Coefficients: [0.32590246 0.33217263 0.34192497]
Epoch 5, Loss: 3.9497, Accuracy: 17.65%
Coefficients: [0.32595006 0.33204952 0.34200042]
Best coefficient accuracy: 17.65%
Final best coefficients: [0.3243781  0.33324102 0.34238094]

Merged model - Test Loss: 6.9043, Test Accuracy: 12.03%
Base model - Test Loss: 3.8854, Test Accuracy: 12.03%

--- Run 3/3 ---

Running LoRA with Separate Classifiers experiment
Test domain: sketch
Train domains: ['cartoon', 'photo', 'art_painting']

Training LoRA adapter for domain: cartoon
Epoch 1/5, Train Loss: 3.0294, Train Accuracy: 11.43%
Val Loss: 2.3869, Val Accuracy: 11.43%
Epoch 2/5, Train Loss: 2.4375, Train Accuracy: 16.43%
Val Loss: 2.0979, Val Accuracy: 14.29%
Epoch 3/5, Train Loss: 2.2934, Train Accuracy: 14.29%
Val Loss: 2.3259, Val Accuracy: 11.43%
Epoch 4/5, Train Loss: 2.1472, Train Accuracy: 10.71%
Val Loss: 2.0483, Val Accuracy: 28.57%
Epoch 5/5, Train Loss: 1.9437, Train Accuracy: 22.86%
Val Loss: 1.7968, Val Accuracy: 37.14%
cartoon adapter trained. Validation Accuracy: 37.14%

Training LoRA adapter for domain: photo
Epoch 1/5, Train Loss: 2.5082, Train Accuracy: 18.57%
Val Loss: 3.3274, Val Accuracy: 17.14%
Epoch 2/5, Train Loss: 2.2751, Train Accuracy: 12.14%
Val Loss: 1.8685, Val Accuracy: 17.14%
Epoch 3/5, Train Loss: 1.9006, Train Accuracy: 23.57%
Val Loss: 1.8013, Val Accuracy: 22.86%
Epoch 4/5, Train Loss: 1.5969, Train Accuracy: 34.29%
Val Loss: 1.8328, Val Accuracy: 31.43%
Epoch 5/5, Train Loss: 1.4719, Train Accuracy: 40.71%
Val Loss: 1.6430, Val Accuracy: 37.14%
photo adapter trained. Validation Accuracy: 37.14%

Training LoRA adapter for domain: art_painting
Epoch 1/5, Train Loss: 2.2110, Train Accuracy: 12.86%
Val Loss: 1.6720, Val Accuracy: 17.14%
Epoch 2/5, Train Loss: 2.0471, Train Accuracy: 17.14%
Val Loss: 2.4331, Val Accuracy: 2.86%
Epoch 3/5, Train Loss: 1.9863, Train Accuracy: 16.43%
Val Loss: 1.8881, Val Accuracy: 17.14%
Epoch 4/5, Train Loss: 1.7351, Train Accuracy: 28.57%
Val Loss: 1.6142, Val Accuracy: 20.00%
Epoch 5/5, Train Loss: 1.6510, Train Accuracy: 37.86%
Val Loss: 2.5267, Val Accuracy: 14.29%
art_painting adapter trained. Validation Accuracy: 20.00%

Training coefficients for adapter merging
Epoch 1, Loss: 2.4073, Accuracy: 23.53%
Coefficients: [0.33094606 0.32665804 0.34239584]
Epoch 2, Loss: 2.4080, Accuracy: 23.53%
Coefficients: [0.33285376 0.32554585 0.3416004 ]
Epoch 3, Loss: 2.4083, Accuracy: 23.53%
Coefficients: [0.33343408 0.32567632 0.3408896 ]
Epoch 4, Loss: 2.4090, Accuracy: 23.53%
Coefficients: [0.3338045  0.32562092 0.34057462]
Epoch 5, Loss: 2.4077, Accuracy: 23.53%
Coefficients: [0.33394685 0.32558525 0.3404679 ]
Best coefficient accuracy: 23.53%
Final best coefficients: [0.33094606 0.32665804 0.34239584]

Merged model - Test Loss: 3.6135, Test Accuracy: 13.29%
Base model - Test Loss: 2.4876, Test Accuracy: 13.29%

Summary of All Runs:
Base Model Accuracy: 13.29% ± 1.03%
Merged Model Accuracy: 13.29% ± 1.03%
Average Coefficients:
