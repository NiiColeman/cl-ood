No auxiliary_datasets specified. Using ['PACS', 'VLCS'] as auxiliary datasets.
Using device: cuda
Configuration:
{
  "datasets": {
    "PACS": {
      "path": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/PACS",
      "num_classes": 7
    },
    "VLCS": {
      "path": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS",
      "num_classes": 5
    },
    "OfficeHome": {
      "path": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home",
      "num_classes": 65
    }
  },
  "base_model": "vit_base_patch16_224",
  "max_samples_per_class": 20,
  "batch_size": 32,
  "num_epochs": 5,
  "learning_rate": "1e-4",
  "lora_r": 8,
  "lora_alpha": 32,
  "lora_dropout": 0.05,
  "output_dir": "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs",
  "test_dataset": "OfficeHome",
  "weighted_adapter_lr": "1e-4",
  "weighted_adapter_epochs": 5,
  "auxiliary_datasets": [
    "PACS",
    "VLCS"
  ]
}
Loading dataset: PACS
Dataset config: {'path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/PACS', 'num_classes': 7}
Loading dataset: VLCS
Dataset config: {'path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/VLCS', 'num_classes': 5}
Loading dataset: OfficeHome
Dataset config: {'path': '/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/datasets/office_home', 'num_classes': 65}
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 1.7409, Accuracy: 57.28%
Epoch 2/5, Loss: 0.4967, Accuracy: 86.04%
Epoch 3/5, Loss: 0.1955, Accuracy: 94.33%
Epoch 4/5, Loss: 0.1809, Accuracy: 94.97%
Epoch 5/5, Loss: 0.1461, Accuracy: 95.84%
Baseline 1 - Test Loss: 0.1434, Test Accuracy: 96.27%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on dataset: PACS
Epoch 1/5, Loss: 4.4333, Accuracy: 1.96%
Epoch 2/5, Loss: 3.3698, Accuracy: 17.50%
Epoch 3/5, Loss: 2.0921, Accuracy: 37.68%
Epoch 4/5, Loss: 1.4188, Accuracy: 50.71%
Epoch 5/5, Loss: 1.0442, Accuracy: 65.54%
Training on dataset: VLCS
Epoch 1/5, Loss: 2.5476, Accuracy: 12.50%
Epoch 2/5, Loss: 1.8982, Accuracy: 25.75%
Epoch 3/5, Loss: 1.4276, Accuracy: 41.50%
Epoch 4/5, Loss: 1.1084, Accuracy: 59.00%
Epoch 5/5, Loss: 0.9081, Accuracy: 68.75%
Baseline 2 - Test Loss: 10.3884, Test Accuracy: 1.06%
Baseline 3: Weighted Average of LoRA Adapters
Baseline 3 Epoch 1/5, Loss: 19.4590, Accuracy: 1.35%
Baseline 3 Epoch 2/5, Loss: 19.6696, Accuracy: 1.35%
Baseline 3 Epoch 3/5, Loss: 19.5674, Accuracy: 1.35%
Baseline 3 Epoch 4/5, Loss: 19.3463, Accuracy: 1.35%
Baseline 3 Epoch 5/5, Loss: 19.1281, Accuracy: 1.35%
Baseline 3 - Test Loss: 19.6164, Test Accuracy: 1.03%

Final Results:
Baseline 1 Accuracy: 1.03%
Baseline 2 Accuracy: 1.03%
Baseline 3 Accuracy: 1.03%
