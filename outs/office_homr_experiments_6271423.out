Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: art_painting
Train domains: ['sketch', 'photo', 'cartoon']
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 3.3471, Accuracy: 0.71%
Epoch 2/5, Loss: 2.4155, Accuracy: 11.43%
Epoch 3/5, Loss: 2.1416, Accuracy: 15.00%
Epoch 4/5, Loss: 1.9079, Accuracy: 14.29%
Epoch 5/5, Loss: 1.6322, Accuracy: 38.57%
Baseline 1 - Test Loss: 1.3117, Test Accuracy: 48.57%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: sketch
Epoch 1/5, Loss: 2.1635, Accuracy: 14.29%
Epoch 2/5, Loss: 2.0303, Accuracy: 16.43%
Epoch 3/5, Loss: 1.9396, Accuracy: 14.29%
Epoch 4/5, Loss: 1.8995, Accuracy: 30.71%
Epoch 5/5, Loss: 1.8620, Accuracy: 27.86%
Training on domain: photo
Epoch 1/5, Loss: 1.5368, Accuracy: 47.14%
Epoch 2/5, Loss: 1.4446, Accuracy: 51.43%
Epoch 3/5, Loss: 1.3093, Accuracy: 55.71%
Epoch 4/5, Loss: 1.1577, Accuracy: 64.29%
Epoch 5/5, Loss: 0.9465, Accuracy: 79.29%
Training on domain: cartoon
Epoch 1/5, Loss: 1.5269, Accuracy: 40.00%
Epoch 2/5, Loss: 1.3656, Accuracy: 55.71%
Epoch 3/5, Loss: 1.2554, Accuracy: 64.29%
Epoch 4/5, Loss: 1.1162, Accuracy: 65.71%
Epoch 5/5, Loss: 1.0436, Accuracy: 72.86%
Baseline 2 - Test Loss: 0.8935, Test Accuracy: 78.57%
Baseline 3: Sequential LoRA training with weight merging
Training on domain: sketch
Epoch 1/5, Loss: 1.6001, Accuracy: 29.29%
Epoch 2/5, Loss: 1.4821, Accuracy: 47.14%
Epoch 3/5, Loss: 1.4233, Accuracy: 57.86%
Epoch 4/5, Loss: 1.2858, Accuracy: 60.71%
Epoch 5/5, Loss: 1.1946, Accuracy: 62.86%
Training on domain: photo
Epoch 1/5, Loss: 0.7062, Accuracy: 74.29%
Epoch 2/5, Loss: 0.5504, Accuracy: 81.43%
Epoch 3/5, Loss: 0.4455, Accuracy: 94.29%
Epoch 4/5, Loss: 0.3721, Accuracy: 97.86%
Epoch 5/5, Loss: 0.2878, Accuracy: 97.86%
Training on domain: cartoon
Epoch 1/5, Loss: 1.0521, Accuracy: 62.14%
Epoch 2/5, Loss: 0.7938, Accuracy: 80.00%
Epoch 3/5, Loss: 0.6460, Accuracy: 77.86%
Epoch 4/5, Loss: 0.5557, Accuracy: 85.00%
Epoch 5/5, Loss: 0.4955, Accuracy: 91.43%
Baseline 3 - Test Loss: 0.6248, Test Accuracy: 82.14%
Baseline 4: Weighted average of LoRA adapters
Training coefficients for weighted average of LoRA adapters
