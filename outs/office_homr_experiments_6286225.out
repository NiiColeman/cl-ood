Running baseline experiments for dataset: PACS
Using device: cuda
Total number of domains: 4
Test domain: art_painting
Train domains: ['sketch', 'photo', 'cartoon']
Baseline 1: Training and testing on test domain only
Epoch 1/5, Loss: 2.5147, Accuracy: 22.86%
Epoch 2/5, Loss: 1.5919, Accuracy: 14.29%
Epoch 3/5, Loss: 0.7480, Accuracy: 60.00%
Epoch 4/5, Loss: 0.2330, Accuracy: 94.29%
Epoch 5/5, Loss: 0.0526, Accuracy: 100.00%
Baseline 1 - Test Loss: 0.0143, Test Accuracy: 100.00%
Baseline 2: Training on other domains with LoRA, then testing on test domain
Training on domain: sketch
Epoch 1/5, Loss: 2.1356, Accuracy: 25.71%
Epoch 2/5, Loss: 1.7821, Accuracy: 34.29%
Epoch 3/5, Loss: 1.8011, Accuracy: 28.57%
Epoch 4/5, Loss: 1.5602, Accuracy: 31.43%
Epoch 5/5, Loss: 1.3963, Accuracy: 45.71%
Training on domain: photo
Epoch 1/5, Loss: 0.8299, Accuracy: 71.43%
Epoch 2/5, Loss: 1.1292, Accuracy: 80.00%
Epoch 3/5, Loss: 0.4825, Accuracy: 88.57%
Epoch 4/5, Loss: 0.4243, Accuracy: 94.29%
Epoch 5/5, Loss: 0.4444, Accuracy: 94.29%
Training on domain: cartoon
Epoch 1/5, Loss: 1.6662, Accuracy: 48.57%
Epoch 2/5, Loss: 1.1065, Accuracy: 60.00%
Epoch 3/5, Loss: 1.2491, Accuracy: 65.71%
Epoch 4/5, Loss: 1.1841, Accuracy: 77.14%
Epoch 5/5, Loss: 0.7794, Accuracy: 85.71%
Baseline 2 - Test Loss: 0.0124, Test Accuracy: 100.00%
Baseline 3: Sequential LoRA training with weight merging
Training on domain: sketch
Epoch 1/5, Loss: 1.2238, Accuracy: 37.14%
Epoch 2/5, Loss: 1.5275, Accuracy: 57.14%
Epoch 3/5, Loss: 1.0544, Accuracy: 71.43%
Epoch 4/5, Loss: 1.1283, Accuracy: 74.29%
Epoch 5/5, Loss: 1.1871, Accuracy: 71.43%
Training on domain: photo
Epoch 1/5, Loss: 0.4307, Accuracy: 94.29%
Epoch 2/5, Loss: 0.2912, Accuracy: 100.00%
Epoch 3/5, Loss: 0.2469, Accuracy: 100.00%
Epoch 4/5, Loss: 0.1731, Accuracy: 100.00%
Epoch 5/5, Loss: 0.1302, Accuracy: 100.00%
Training on domain: cartoon
Epoch 1/5, Loss: 0.6955, Accuracy: 82.86%
Epoch 2/5, Loss: 0.5996, Accuracy: 91.43%
Epoch 3/5, Loss: 0.4503, Accuracy: 100.00%
Epoch 4/5, Loss: 0.3558, Accuracy: 100.00%
Epoch 5/5, Loss: 0.2993, Accuracy: 100.00%
Baseline 3 - Test Loss: 0.0074, Test Accuracy: 100.00%
Baseline 4: Weighted average of LoRA adapters
Training coefficients for weighted average of LoRA adapters
