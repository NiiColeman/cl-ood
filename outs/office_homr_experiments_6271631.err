Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:05<00:21,  5.28s/it]Epoch 1/5:  40%|████      | 2/5 [00:05<00:06,  2.33s/it]Epoch 1/5:  60%|██████    | 3/5 [00:05<00:02,  1.39s/it]Epoch 1/5:  80%|████████  | 4/5 [00:06<00:00,  1.06it/s]Epoch 1/5: 100%|██████████| 5/5 [00:06<00:00,  1.56it/s]Epoch 1/5: 100%|██████████| 5/5 [00:06<00:00,  1.23s/it]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:01,  3.86it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  3.87it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  3.89it/s]Epoch 2/5:  80%|████████  | 4/5 [00:01<00:00,  3.89it/s]Epoch 2/5: 100%|██████████| 5/5 [00:01<00:00,  4.94it/s]Epoch 2/5: 100%|██████████| 5/5 [00:01<00:00,  4.40it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:01,  3.86it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  3.87it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  3.88it/s]Epoch 3/5:  80%|████████  | 4/5 [00:01<00:00,  3.88it/s]Epoch 3/5: 100%|██████████| 5/5 [00:01<00:00,  4.94it/s]Epoch 3/5: 100%|██████████| 5/5 [00:01<00:00,  4.40it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:01,  3.90it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  3.89it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  3.89it/s]Epoch 4/5:  80%|████████  | 4/5 [00:01<00:00,  3.89it/s]Epoch 4/5: 100%|██████████| 5/5 [00:01<00:00,  4.94it/s]Epoch 4/5: 100%|██████████| 5/5 [00:01<00:00,  4.41it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:01,  3.91it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  3.89it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  3.89it/s]Epoch 5/5:  80%|████████  | 4/5 [00:01<00:00,  3.89it/s]Epoch 5/5: 100%|██████████| 5/5 [00:01<00:00,  4.95it/s]Epoch 5/5: 100%|██████████| 5/5 [00:01<00:00,  4.42it/s]
Evaluating:   0%|          | 0/5 [00:00<?, ?it/s]Evaluating:  20%|██        | 1/5 [00:00<00:00,  7.73it/s]Evaluating:  40%|████      | 2/5 [00:00<00:00,  7.83it/s]Evaluating:  60%|██████    | 3/5 [00:00<00:00,  7.92it/s]Evaluating:  80%|████████  | 4/5 [00:00<00:00,  7.96it/s]Evaluating: 100%|██████████| 5/5 [00:00<00:00,  9.02it/s]
Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:00<00:00,  4.20it/s]Epoch 1/5:  40%|████      | 2/5 [00:00<00:00,  4.37it/s]Epoch 1/5:  60%|██████    | 3/5 [00:00<00:00,  4.44it/s]Epoch 1/5:  80%|████████  | 4/5 [00:00<00:00,  4.45it/s]Epoch 1/5: 100%|██████████| 5/5 [00:00<00:00,  5.02it/s]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:00,  4.47it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  4.50it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  4.51it/s]Epoch 2/5:  80%|████████  | 4/5 [00:00<00:00,  4.52it/s]Epoch 2/5: 100%|██████████| 5/5 [00:00<00:00,  5.12it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:00,  4.48it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  4.47it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 3/5:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Epoch 3/5: 100%|██████████| 5/5 [00:00<00:00,  5.10it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:00,  4.48it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  4.47it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 4/5:  80%|████████  | 4/5 [00:00<00:00,  4.51it/s]Epoch 4/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:00,  4.47it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  4.47it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 5/5:  80%|████████  | 4/5 [00:00<00:00,  4.51it/s]Epoch 5/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:00<00:00,  4.53it/s]Epoch 1/5:  40%|████      | 2/5 [00:00<00:00,  4.54it/s]Epoch 1/5:  60%|██████    | 3/5 [00:00<00:00,  4.56it/s]Epoch 1/5:  80%|████████  | 4/5 [00:00<00:00,  4.57it/s]Epoch 1/5: 100%|██████████| 5/5 [00:00<00:00,  5.18it/s]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:00,  4.54it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  4.55it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  4.57it/s]Epoch 2/5:  80%|████████  | 4/5 [00:00<00:00,  4.53it/s]Epoch 2/5: 100%|██████████| 5/5 [00:00<00:00,  5.16it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:00,  4.53it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  4.55it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  4.57it/s]Epoch 3/5:  80%|████████  | 4/5 [00:00<00:00,  4.58it/s]Epoch 3/5: 100%|██████████| 5/5 [00:00<00:00,  5.19it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:00,  4.53it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  4.53it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  4.56it/s]Epoch 4/5:  80%|████████  | 4/5 [00:00<00:00,  4.57it/s]Epoch 4/5: 100%|██████████| 5/5 [00:00<00:00,  5.18it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:00,  4.54it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  4.55it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  4.58it/s]Epoch 5/5:  80%|████████  | 4/5 [00:00<00:00,  4.58it/s]Epoch 5/5: 100%|██████████| 5/5 [00:00<00:00,  5.19it/s]
Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:00<00:00,  4.45it/s]Epoch 1/5:  40%|████      | 2/5 [00:00<00:00,  4.49it/s]Epoch 1/5:  60%|██████    | 3/5 [00:00<00:00,  4.51it/s]Epoch 1/5:  80%|████████  | 4/5 [00:00<00:00,  4.51it/s]Epoch 1/5: 100%|██████████| 5/5 [00:00<00:00,  5.12it/s]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:00,  4.47it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  4.48it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 2/5:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Epoch 2/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:00,  4.48it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  4.49it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 3/5:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Epoch 3/5: 100%|██████████| 5/5 [00:00<00:00,  5.12it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:00,  4.43it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  4.47it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  4.47it/s]Epoch 4/5:  80%|████████  | 4/5 [00:00<00:00,  4.48it/s]Epoch 4/5: 100%|██████████| 5/5 [00:00<00:00,  5.09it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:00,  4.45it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  4.49it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 5/5:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Epoch 5/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Evaluating:   0%|          | 0/5 [00:00<?, ?it/s]Evaluating:  20%|██        | 1/5 [00:00<00:00,  7.89it/s]Evaluating:  40%|████      | 2/5 [00:00<00:00,  7.91it/s]Evaluating:  60%|██████    | 3/5 [00:00<00:00,  7.96it/s]Evaluating:  80%|████████  | 4/5 [00:00<00:00,  7.97it/s]Evaluating: 100%|██████████| 5/5 [00:00<00:00,  9.02it/s]
Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:00<00:00,  4.45it/s]Epoch 1/5:  40%|████      | 2/5 [00:00<00:00,  4.49it/s]Epoch 1/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 1/5:  80%|████████  | 4/5 [00:00<00:00,  4.52it/s]Epoch 1/5: 100%|██████████| 5/5 [00:00<00:00,  5.12it/s]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:00,  4.43it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  4.47it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  4.48it/s]Epoch 2/5:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Epoch 2/5: 100%|██████████| 5/5 [00:00<00:00,  5.10it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:00,  4.50it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  4.48it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 3/5:  80%|████████  | 4/5 [00:00<00:00,  4.49it/s]Epoch 3/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:00,  4.45it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  4.47it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 4/5:  80%|████████  | 4/5 [00:00<00:00,  4.49it/s]Epoch 4/5: 100%|██████████| 5/5 [00:00<00:00,  5.10it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:00,  4.48it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  4.50it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  4.49it/s]Epoch 5/5:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Epoch 5/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:00<00:00,  4.54it/s]Epoch 1/5:  40%|████      | 2/5 [00:00<00:00,  4.57it/s]Epoch 1/5:  60%|██████    | 3/5 [00:00<00:00,  4.57it/s]Epoch 1/5:  80%|████████  | 4/5 [00:00<00:00,  4.57it/s]Epoch 1/5: 100%|██████████| 5/5 [00:00<00:00,  5.19it/s]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:00,  4.53it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  4.51it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  4.52it/s]Epoch 2/5:  80%|████████  | 4/5 [00:00<00:00,  4.54it/s]Epoch 2/5: 100%|██████████| 5/5 [00:00<00:00,  5.16it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:00,  4.58it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  4.58it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  4.54it/s]Epoch 3/5:  80%|████████  | 4/5 [00:00<00:00,  4.55it/s]Epoch 3/5: 100%|██████████| 5/5 [00:00<00:00,  5.18it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:00,  4.51it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  4.55it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  4.57it/s]Epoch 4/5:  80%|████████  | 4/5 [00:00<00:00,  4.57it/s]Epoch 4/5: 100%|██████████| 5/5 [00:00<00:00,  5.19it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:00,  4.57it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  4.55it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  4.55it/s]Epoch 5/5:  80%|████████  | 4/5 [00:00<00:00,  4.56it/s]Epoch 5/5: 100%|██████████| 5/5 [00:00<00:00,  5.18it/s]
Epoch 1/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 1/5:  20%|██        | 1/5 [00:00<00:00,  4.47it/s]Epoch 1/5:  40%|████      | 2/5 [00:00<00:00,  4.49it/s]Epoch 1/5:  60%|██████    | 3/5 [00:00<00:00,  4.50it/s]Epoch 1/5:  80%|████████  | 4/5 [00:00<00:00,  4.51it/s]Epoch 1/5: 100%|██████████| 5/5 [00:00<00:00,  5.12it/s]
Epoch 2/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 2/5:  20%|██        | 1/5 [00:00<00:00,  4.45it/s]Epoch 2/5:  40%|████      | 2/5 [00:00<00:00,  4.46it/s]Epoch 2/5:  60%|██████    | 3/5 [00:00<00:00,  4.46it/s]Epoch 2/5:  80%|████████  | 4/5 [00:00<00:00,  4.49it/s]Epoch 2/5: 100%|██████████| 5/5 [00:00<00:00,  5.08it/s]
Epoch 3/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 3/5:  20%|██        | 1/5 [00:00<00:00,  4.52it/s]Epoch 3/5:  40%|████      | 2/5 [00:00<00:00,  4.48it/s]Epoch 3/5:  60%|██████    | 3/5 [00:00<00:00,  4.48it/s]Epoch 3/5:  80%|████████  | 4/5 [00:00<00:00,  4.48it/s]Epoch 3/5: 100%|██████████| 5/5 [00:00<00:00,  5.10it/s]
Epoch 4/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 4/5:  20%|██        | 1/5 [00:00<00:00,  4.48it/s]Epoch 4/5:  40%|████      | 2/5 [00:00<00:00,  4.48it/s]Epoch 4/5:  60%|██████    | 3/5 [00:00<00:00,  4.46it/s]Epoch 4/5:  80%|████████  | 4/5 [00:00<00:00,  4.47it/s]Epoch 4/5: 100%|██████████| 5/5 [00:00<00:00,  5.08it/s]
Epoch 5/5:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 5/5:  20%|██        | 1/5 [00:00<00:00,  4.52it/s]Epoch 5/5:  40%|████      | 2/5 [00:00<00:00,  4.50it/s]Epoch 5/5:  60%|██████    | 3/5 [00:00<00:00,  4.50it/s]Epoch 5/5:  80%|████████  | 4/5 [00:00<00:00,  4.49it/s]Epoch 5/5: 100%|██████████| 5/5 [00:00<00:00,  5.11it/s]
Evaluating:   0%|          | 0/5 [00:00<?, ?it/s]Evaluating:  20%|██        | 1/5 [00:00<00:00,  7.62it/s]Evaluating:  40%|████      | 2/5 [00:00<00:00,  7.79it/s]Evaluating:  60%|██████    | 3/5 [00:00<00:00,  7.90it/s]Evaluating:  80%|████████  | 4/5 [00:00<00:00,  7.94it/s]Evaluating: 100%|██████████| 5/5 [00:00<00:00,  8.95it/s]
Traceback (most recent call last):
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/weighted_avg.py", line 269, in <module>
    main(config)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/weighted_avg.py", line 251, in main
    result = run_baseline_experiments_for_dataset(dataset_name, dataset_config, config)
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/weighted_avg.py", line 206, in run_baseline_experiments_for_dataset
    coefficients = train_adapter_coefficients(
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/experiments/weighted_avg.py", line 75, in train_adapter_coefficients
    model = type(base_model)(**base_model.config.to_dict())
  File "/leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/l2/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'VisionTransformer' object has no attribute 'config'
