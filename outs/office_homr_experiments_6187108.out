Using device: cuda

Dataset: Office-Home
Number of classes: 65
Number of domains: 4
Total number of samples: 15588
Number of training samples: 12470
Number of validation samples: 3118

Trying: lr=1e-5, batch_size=32, num_epochs=5
Epoch 1/5, Train Loss: 1.5187, Train Acc: 64.92%, Val Loss: 0.4805, Val Acc: 87.88%
Epoch 2/5, Train Loss: 0.2492, Train Acc: 93.58%, Val Loss: 0.3781, Val Acc: 90.03%
Epoch 3/5, Train Loss: 0.0822, Train Acc: 98.08%, Val Loss: 0.3456, Val Acc: 90.51%
Epoch 4/5, Train Loss: 0.0518, Train Acc: 98.72%, Val Loss: 0.3446, Val Acc: 90.38%
Epoch 5/5, Train Loss: 0.0441, Train Acc: 98.80%, Val Loss: 0.3299, Val Acc: 91.69%

Best hyperparameters for Office-Home without LoRA:
Best params: {'lr': '1e-5', 'batch_size': 32, 'num_epochs': 5}
Best validation accuracy: 91.69%
Best model without LoRA saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/best_model_Office-Home_without_lora.pth

LoRA Hyperparameter Search for Dataset: Office-Home
Number of classes: 65
Number of domains: 4
Total number of samples: 15588
Number of training samples: 12470
Number of validation samples: 3118

Trying LoRA params: r=16, alpha=16, dropout=0.05
Epoch 1/5, Train Loss: 4.4326, Train Acc: 2.09%, Val Loss: 4.3353, Val Acc: 2.31%
Epoch 2/5, Train Loss: 4.2594, Train Acc: 2.51%, Val Loss: 4.1974, Val Acc: 3.40%
Epoch 3/5, Train Loss: 4.1356, Train Acc: 3.69%, Val Loss: 4.0880, Val Acc: 5.16%
Epoch 4/5, Train Loss: 4.0096, Train Acc: 6.42%, Val Loss: 3.9518, Val Acc: 8.43%
Epoch 5/5, Train Loss: 3.8270, Train Acc: 11.25%, Val Loss: 3.7267, Val Acc: 13.50%

Trying LoRA params: r=16, alpha=16, dropout=0.1
Epoch 1/5, Train Loss: 4.4319, Train Acc: 2.25%, Val Loss: 4.3240, Val Acc: 2.02%
Epoch 2/5, Train Loss: 4.2217, Train Acc: 3.37%, Val Loss: 4.1894, Val Acc: 3.27%
Epoch 3/5, Train Loss: 4.1087, Train Acc: 5.07%, Val Loss: 4.0879, Val Acc: 5.52%
Epoch 4/5, Train Loss: 3.9829, Train Acc: 8.26%, Val Loss: 3.9399, Val Acc: 9.53%
Epoch 5/5, Train Loss: 3.7639, Train Acc: 13.58%, Val Loss: 3.6435, Val Acc: 15.43%

Trying LoRA params: r=16, alpha=32, dropout=0.05
Epoch 1/5, Train Loss: 4.4532, Train Acc: 1.80%, Val Loss: 4.3172, Val Acc: 1.70%
Epoch 2/5, Train Loss: 4.2128, Train Acc: 2.70%, Val Loss: 4.1426, Val Acc: 3.43%
Epoch 3/5, Train Loss: 4.0569, Train Acc: 6.26%, Val Loss: 3.9795, Val Acc: 7.73%
Epoch 4/5, Train Loss: 3.7607, Train Acc: 13.39%, Val Loss: 3.4939, Val Acc: 17.74%
Epoch 5/5, Train Loss: 2.9798, Train Acc: 29.07%, Val Loss: 2.6598, Val Acc: 34.03%

Trying LoRA params: r=16, alpha=32, dropout=0.1
Epoch 1/5, Train Loss: 4.3587, Train Acc: 2.10%, Val Loss: 4.2535, Val Acc: 2.12%
Epoch 2/5, Train Loss: 4.1544, Train Acc: 3.49%, Val Loss: 4.0877, Val Acc: 5.20%
Epoch 3/5, Train Loss: 3.9549, Train Acc: 8.95%, Val Loss: 3.8379, Val Acc: 11.32%
Epoch 4/5, Train Loss: 3.4829, Train Acc: 19.25%, Val Loss: 3.0866, Val Acc: 24.92%
Epoch 5/5, Train Loss: 2.5742, Train Acc: 37.85%, Val Loss: 2.2761, Val Acc: 44.26%

Trying LoRA params: r=32, alpha=16, dropout=0.05
Epoch 1/5, Train Loss: 4.5092, Train Acc: 1.17%, Val Loss: 4.3685, Val Acc: 1.38%
Epoch 2/5, Train Loss: 4.2863, Train Acc: 1.10%, Val Loss: 4.2005, Val Acc: 1.89%
Epoch 3/5, Train Loss: 4.1412, Train Acc: 2.67%, Val Loss: 4.0875, Val Acc: 4.62%
Epoch 4/5, Train Loss: 4.0097, Train Acc: 7.36%, Val Loss: 3.9321, Val Acc: 10.36%
Epoch 5/5, Train Loss: 3.7446, Train Acc: 15.53%, Val Loss: 3.5242, Val Acc: 19.60%

Trying LoRA params: r=32, alpha=16, dropout=0.1
Epoch 1/5, Train Loss: 4.4199, Train Acc: 1.91%, Val Loss: 4.3106, Val Acc: 2.50%
Epoch 2/5, Train Loss: 4.2444, Train Acc: 2.57%, Val Loss: 4.1735, Val Acc: 3.05%
Epoch 3/5, Train Loss: 4.1136, Train Acc: 3.54%, Val Loss: 4.0617, Val Acc: 4.33%
Epoch 4/5, Train Loss: 3.9833, Train Acc: 6.22%, Val Loss: 3.9182, Val Acc: 8.02%
Epoch 5/5, Train Loss: 3.7806, Train Acc: 11.53%, Val Loss: 3.6547, Val Acc: 15.59%

Trying LoRA params: r=32, alpha=32, dropout=0.05
Epoch 1/5, Train Loss: 4.3485, Train Acc: 2.70%, Val Loss: 4.2219, Val Acc: 3.08%
Epoch 2/5, Train Loss: 4.1152, Train Acc: 4.96%, Val Loss: 4.0436, Val Acc: 6.99%
Epoch 3/5, Train Loss: 3.8664, Train Acc: 11.48%, Val Loss: 3.7002, Val Acc: 14.27%
Epoch 4/5, Train Loss: 3.2211, Train Acc: 25.53%, Val Loss: 2.8080, Val Acc: 33.64%
Epoch 5/5, Train Loss: 2.3477, Train Acc: 44.51%, Val Loss: 2.1725, Val Acc: 46.57%

Trying LoRA params: r=32, alpha=32, dropout=0.1
Epoch 1/5, Train Loss: 4.4248, Train Acc: 1.35%, Val Loss: 4.2661, Val Acc: 1.70%
Epoch 2/5, Train Loss: 4.1716, Train Acc: 2.41%, Val Loss: 4.1045, Val Acc: 4.55%
Epoch 3/5, Train Loss: 4.0129, Train Acc: 6.30%, Val Loss: 3.9415, Val Acc: 8.53%
Epoch 4/5, Train Loss: 3.6990, Train Acc: 14.31%, Val Loss: 3.4572, Val Acc: 20.08%
Epoch 5/5, Train Loss: 2.9656, Train Acc: 30.75%, Val Loss: 2.6651, Val Acc: 36.69%

Best LoRA hyperparameters for Office-Home:
Best LoRA params: {'r': 32, 'alpha': 32, 'dropout': 0.05}
Best LoRA validation accuracy: 46.57%
Best model with LoRA saved to /leonardo_scratch/fast/IscrC_FoundCL/cl/lora-CL/ratatouille/ood/exp_outs/best_model_Office-Home_with_lora.pth
